(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const s of a)if(s.type==="childList")for(const l of s.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function n(a){const s={};return a.integrity&&(s.integrity=a.integrity),a.referrerPolicy&&(s.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?s.credentials="include":a.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(a){if(a.ep)return;a.ep=!0;const s=n(a);fetch(a.href,s)}})();function mm(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function KC(t){if(Object.prototype.hasOwnProperty.call(t,"__esModule"))return t;var e=t.default;if(typeof e=="function"){var n=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var a=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,a.get?a:{enumerable:!0,get:function(){return t[r]}})}),n}var oh={exports:{}},Wl={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var lv;function ZC(){if(lv)return Wl;lv=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function n(r,a,s){var l=null;if(s!==void 0&&(l=""+s),a.key!==void 0&&(l=""+a.key),"key"in a){s={};for(var c in a)c!=="key"&&(s[c]=a[c])}else s=a;return a=s.ref,{$$typeof:t,type:r,key:l,ref:a!==void 0?a:null,props:s}}return Wl.Fragment=e,Wl.jsx=n,Wl.jsxs=n,Wl}var cv;function QC(){return cv||(cv=1,oh.exports=ZC()),oh.exports}var y=QC(),lh={exports:{}},at={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var uv;function eb(){if(uv)return at;uv=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),s=Symbol.for("react.consumer"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),g=Symbol.for("react.lazy"),x=Symbol.iterator;function _(z){return z===null||typeof z!="object"?null:(z=x&&z[x]||z["@@iterator"],typeof z=="function"?z:null)}var T={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},E=Object.assign,S={};function C(z,ce,L){this.props=z,this.context=ce,this.refs=S,this.updater=L||T}C.prototype.isReactComponent={},C.prototype.setState=function(z,ce){if(typeof z!="object"&&typeof z!="function"&&z!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,z,ce,"setState")},C.prototype.forceUpdate=function(z){this.updater.enqueueForceUpdate(this,z,"forceUpdate")};function k(){}k.prototype=C.prototype;function N(z,ce,L){this.props=z,this.context=ce,this.refs=S,this.updater=L||T}var b=N.prototype=new k;b.constructor=N,E(b,C.prototype),b.isPureReactComponent=!0;var I=Array.isArray,F={H:null,A:null,T:null,S:null,V:null},P=Object.prototype.hasOwnProperty;function D(z,ce,L,W,q,K){return L=K.ref,{$$typeof:t,type:z,key:ce,ref:L!==void 0?L:null,props:K}}function j(z,ce){return D(z.type,ce,void 0,void 0,void 0,z.props)}function B(z){return typeof z=="object"&&z!==null&&z.$$typeof===t}function te(z){var ce={"=":"=0",":":"=2"};return"$"+z.replace(/[=:]/g,function(L){return ce[L]})}var X=/\/+/g;function Z(z,ce){return typeof z=="object"&&z!==null&&z.key!=null?te(""+z.key):ce.toString(36)}function ye(){}function Me(z){switch(z.status){case"fulfilled":return z.value;case"rejected":throw z.reason;default:switch(typeof z.status=="string"?z.then(ye,ye):(z.status="pending",z.then(function(ce){z.status==="pending"&&(z.status="fulfilled",z.value=ce)},function(ce){z.status==="pending"&&(z.status="rejected",z.reason=ce)})),z.status){case"fulfilled":return z.value;case"rejected":throw z.reason}}throw z}function Se(z,ce,L,W,q){var K=typeof z;(K==="undefined"||K==="boolean")&&(z=null);var ie=!1;if(z===null)ie=!0;else switch(K){case"bigint":case"string":case"number":ie=!0;break;case"object":switch(z.$$typeof){case t:case e:ie=!0;break;case g:return ie=z._init,Se(ie(z._payload),ce,L,W,q)}}if(ie)return q=q(z),ie=W===""?"."+Z(z,0):W,I(q)?(L="",ie!=null&&(L=ie.replace(X,"$&/")+"/"),Se(q,ce,L,"",function(be){return be})):q!=null&&(B(q)&&(q=j(q,L+(q.key==null||z&&z.key===q.key?"":(""+q.key).replace(X,"$&/")+"/")+ie)),ce.push(q)),1;ie=0;var Ce=W===""?".":W+":";if(I(z))for(var Te=0;Te<z.length;Te++)W=z[Te],K=Ce+Z(W,Te),ie+=Se(W,ce,L,K,q);else if(Te=_(z),typeof Te=="function")for(z=Te.call(z),Te=0;!(W=z.next()).done;)W=W.value,K=Ce+Z(W,Te++),ie+=Se(W,ce,L,K,q);else if(K==="object"){if(typeof z.then=="function")return Se(Me(z),ce,L,W,q);throw ce=String(z),Error("Objects are not valid as a React child (found: "+(ce==="[object Object]"?"object with keys {"+Object.keys(z).join(", ")+"}":ce)+"). If you meant to render a collection of children, use an array instead.")}return ie}function ee(z,ce,L){if(z==null)return z;var W=[],q=0;return Se(z,W,"","",function(K){return ce.call(L,K,q++)}),W}function me(z){if(z._status===-1){var ce=z._result;ce=ce(),ce.then(function(L){(z._status===0||z._status===-1)&&(z._status=1,z._result=L)},function(L){(z._status===0||z._status===-1)&&(z._status=2,z._result=L)}),z._status===-1&&(z._status=0,z._result=ce)}if(z._status===1)return z._result.default;throw z._result}var Pe=typeof reportError=="function"?reportError:function(z){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var ce=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof z=="object"&&z!==null&&typeof z.message=="string"?String(z.message):String(z),error:z});if(!window.dispatchEvent(ce))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",z);return}console.error(z)};function re(){}return at.Children={map:ee,forEach:function(z,ce,L){ee(z,function(){ce.apply(this,arguments)},L)},count:function(z){var ce=0;return ee(z,function(){ce++}),ce},toArray:function(z){return ee(z,function(ce){return ce})||[]},only:function(z){if(!B(z))throw Error("React.Children.only expected to receive a single React element child.");return z}},at.Component=C,at.Fragment=n,at.Profiler=a,at.PureComponent=N,at.StrictMode=r,at.Suspense=f,at.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=F,at.__COMPILER_RUNTIME={__proto__:null,c:function(z){return F.H.useMemoCache(z)}},at.cache=function(z){return function(){return z.apply(null,arguments)}},at.cloneElement=function(z,ce,L){if(z==null)throw Error("The argument must be a React element, but you passed "+z+".");var W=E({},z.props),q=z.key,K=void 0;if(ce!=null)for(ie in ce.ref!==void 0&&(K=void 0),ce.key!==void 0&&(q=""+ce.key),ce)!P.call(ce,ie)||ie==="key"||ie==="__self"||ie==="__source"||ie==="ref"&&ce.ref===void 0||(W[ie]=ce[ie]);var ie=arguments.length-2;if(ie===1)W.children=L;else if(1<ie){for(var Ce=Array(ie),Te=0;Te<ie;Te++)Ce[Te]=arguments[Te+2];W.children=Ce}return D(z.type,q,void 0,void 0,K,W)},at.createContext=function(z){return z={$$typeof:l,_currentValue:z,_currentValue2:z,_threadCount:0,Provider:null,Consumer:null},z.Provider=z,z.Consumer={$$typeof:s,_context:z},z},at.createElement=function(z,ce,L){var W,q={},K=null;if(ce!=null)for(W in ce.key!==void 0&&(K=""+ce.key),ce)P.call(ce,W)&&W!=="key"&&W!=="__self"&&W!=="__source"&&(q[W]=ce[W]);var ie=arguments.length-2;if(ie===1)q.children=L;else if(1<ie){for(var Ce=Array(ie),Te=0;Te<ie;Te++)Ce[Te]=arguments[Te+2];q.children=Ce}if(z&&z.defaultProps)for(W in ie=z.defaultProps,ie)q[W]===void 0&&(q[W]=ie[W]);return D(z,K,void 0,void 0,null,q)},at.createRef=function(){return{current:null}},at.forwardRef=function(z){return{$$typeof:c,render:z}},at.isValidElement=B,at.lazy=function(z){return{$$typeof:g,_payload:{_status:-1,_result:z},_init:me}},at.memo=function(z,ce){return{$$typeof:d,type:z,compare:ce===void 0?null:ce}},at.startTransition=function(z){var ce=F.T,L={};F.T=L;try{var W=z(),q=F.S;q!==null&&q(L,W),typeof W=="object"&&W!==null&&typeof W.then=="function"&&W.then(re,Pe)}catch(K){Pe(K)}finally{F.T=ce}},at.unstable_useCacheRefresh=function(){return F.H.useCacheRefresh()},at.use=function(z){return F.H.use(z)},at.useActionState=function(z,ce,L){return F.H.useActionState(z,ce,L)},at.useCallback=function(z,ce){return F.H.useCallback(z,ce)},at.useContext=function(z){return F.H.useContext(z)},at.useDebugValue=function(){},at.useDeferredValue=function(z,ce){return F.H.useDeferredValue(z,ce)},at.useEffect=function(z,ce,L){var W=F.H;if(typeof L=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return W.useEffect(z,ce)},at.useId=function(){return F.H.useId()},at.useImperativeHandle=function(z,ce,L){return F.H.useImperativeHandle(z,ce,L)},at.useInsertionEffect=function(z,ce){return F.H.useInsertionEffect(z,ce)},at.useLayoutEffect=function(z,ce){return F.H.useLayoutEffect(z,ce)},at.useMemo=function(z,ce){return F.H.useMemo(z,ce)},at.useOptimistic=function(z,ce){return F.H.useOptimistic(z,ce)},at.useReducer=function(z,ce,L){return F.H.useReducer(z,ce,L)},at.useRef=function(z){return F.H.useRef(z)},at.useState=function(z){return F.H.useState(z)},at.useSyncExternalStore=function(z,ce,L){return F.H.useSyncExternalStore(z,ce,L)},at.useTransition=function(){return F.H.useTransition()},at.version="19.1.0",at}var fv;function pm(){return fv||(fv=1,lh.exports=eb()),lh.exports}var pe=pm();const Vf=mm(pe);var ch={exports:{}},Yl={},uh={exports:{}},fh={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var dv;function tb(){return dv||(dv=1,function(t){function e(ee,me){var Pe=ee.length;ee.push(me);e:for(;0<Pe;){var re=Pe-1>>>1,z=ee[re];if(0<a(z,me))ee[re]=me,ee[Pe]=z,Pe=re;else break e}}function n(ee){return ee.length===0?null:ee[0]}function r(ee){if(ee.length===0)return null;var me=ee[0],Pe=ee.pop();if(Pe!==me){ee[0]=Pe;e:for(var re=0,z=ee.length,ce=z>>>1;re<ce;){var L=2*(re+1)-1,W=ee[L],q=L+1,K=ee[q];if(0>a(W,Pe))q<z&&0>a(K,W)?(ee[re]=K,ee[q]=Pe,re=q):(ee[re]=W,ee[L]=Pe,re=L);else if(q<z&&0>a(K,Pe))ee[re]=K,ee[q]=Pe,re=q;else break e}}return me}function a(ee,me){var Pe=ee.sortIndex-me.sortIndex;return Pe!==0?Pe:ee.id-me.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var l=Date,c=l.now();t.unstable_now=function(){return l.now()-c}}var f=[],d=[],g=1,x=null,_=3,T=!1,E=!1,S=!1,C=!1,k=typeof setTimeout=="function"?setTimeout:null,N=typeof clearTimeout=="function"?clearTimeout:null,b=typeof setImmediate<"u"?setImmediate:null;function I(ee){for(var me=n(d);me!==null;){if(me.callback===null)r(d);else if(me.startTime<=ee)r(d),me.sortIndex=me.expirationTime,e(f,me);else break;me=n(d)}}function F(ee){if(S=!1,I(ee),!E)if(n(f)!==null)E=!0,P||(P=!0,Z());else{var me=n(d);me!==null&&Se(F,me.startTime-ee)}}var P=!1,D=-1,j=5,B=-1;function te(){return C?!0:!(t.unstable_now()-B<j)}function X(){if(C=!1,P){var ee=t.unstable_now();B=ee;var me=!0;try{e:{E=!1,S&&(S=!1,N(D),D=-1),T=!0;var Pe=_;try{t:{for(I(ee),x=n(f);x!==null&&!(x.expirationTime>ee&&te());){var re=x.callback;if(typeof re=="function"){x.callback=null,_=x.priorityLevel;var z=re(x.expirationTime<=ee);if(ee=t.unstable_now(),typeof z=="function"){x.callback=z,I(ee),me=!0;break t}x===n(f)&&r(f),I(ee)}else r(f);x=n(f)}if(x!==null)me=!0;else{var ce=n(d);ce!==null&&Se(F,ce.startTime-ee),me=!1}}break e}finally{x=null,_=Pe,T=!1}me=void 0}}finally{me?Z():P=!1}}}var Z;if(typeof b=="function")Z=function(){b(X)};else if(typeof MessageChannel<"u"){var ye=new MessageChannel,Me=ye.port2;ye.port1.onmessage=X,Z=function(){Me.postMessage(null)}}else Z=function(){k(X,0)};function Se(ee,me){D=k(function(){ee(t.unstable_now())},me)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(ee){ee.callback=null},t.unstable_forceFrameRate=function(ee){0>ee||125<ee?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):j=0<ee?Math.floor(1e3/ee):5},t.unstable_getCurrentPriorityLevel=function(){return _},t.unstable_next=function(ee){switch(_){case 1:case 2:case 3:var me=3;break;default:me=_}var Pe=_;_=me;try{return ee()}finally{_=Pe}},t.unstable_requestPaint=function(){C=!0},t.unstable_runWithPriority=function(ee,me){switch(ee){case 1:case 2:case 3:case 4:case 5:break;default:ee=3}var Pe=_;_=ee;try{return me()}finally{_=Pe}},t.unstable_scheduleCallback=function(ee,me,Pe){var re=t.unstable_now();switch(typeof Pe=="object"&&Pe!==null?(Pe=Pe.delay,Pe=typeof Pe=="number"&&0<Pe?re+Pe:re):Pe=re,ee){case 1:var z=-1;break;case 2:z=250;break;case 5:z=1073741823;break;case 4:z=1e4;break;default:z=5e3}return z=Pe+z,ee={id:g++,callback:me,priorityLevel:ee,startTime:Pe,expirationTime:z,sortIndex:-1},Pe>re?(ee.sortIndex=Pe,e(d,ee),n(f)===null&&ee===n(d)&&(S?(N(D),D=-1):S=!0,Se(F,Pe-re))):(ee.sortIndex=z,e(f,ee),E||T||(E=!0,P||(P=!0,Z()))),ee},t.unstable_shouldYield=te,t.unstable_wrapCallback=function(ee){var me=_;return function(){var Pe=_;_=me;try{return ee.apply(this,arguments)}finally{_=Pe}}}}(fh)),fh}var hv;function nb(){return hv||(hv=1,uh.exports=tb()),uh.exports}var dh={exports:{}},Yn={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mv;function rb(){if(mv)return Yn;mv=1;var t=pm();function e(f){var d="https://react.dev/errors/"+f;if(1<arguments.length){d+="?args[]="+encodeURIComponent(arguments[1]);for(var g=2;g<arguments.length;g++)d+="&args[]="+encodeURIComponent(arguments[g])}return"Minified React error #"+f+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(){}var r={d:{f:n,r:function(){throw Error(e(522))},D:n,C:n,L:n,m:n,X:n,S:n,M:n},p:0,findDOMNode:null},a=Symbol.for("react.portal");function s(f,d,g){var x=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:x==null?null:""+x,children:f,containerInfo:d,implementation:g}}var l=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(f,d){if(f==="font")return"";if(typeof d=="string")return d==="use-credentials"?d:""}return Yn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,Yn.createPortal=function(f,d){var g=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)throw Error(e(299));return s(f,d,null,g)},Yn.flushSync=function(f){var d=l.T,g=r.p;try{if(l.T=null,r.p=2,f)return f()}finally{l.T=d,r.p=g,r.d.f()}},Yn.preconnect=function(f,d){typeof f=="string"&&(d?(d=d.crossOrigin,d=typeof d=="string"?d==="use-credentials"?d:"":void 0):d=null,r.d.C(f,d))},Yn.prefetchDNS=function(f){typeof f=="string"&&r.d.D(f)},Yn.preinit=function(f,d){if(typeof f=="string"&&d&&typeof d.as=="string"){var g=d.as,x=c(g,d.crossOrigin),_=typeof d.integrity=="string"?d.integrity:void 0,T=typeof d.fetchPriority=="string"?d.fetchPriority:void 0;g==="style"?r.d.S(f,typeof d.precedence=="string"?d.precedence:void 0,{crossOrigin:x,integrity:_,fetchPriority:T}):g==="script"&&r.d.X(f,{crossOrigin:x,integrity:_,fetchPriority:T,nonce:typeof d.nonce=="string"?d.nonce:void 0})}},Yn.preinitModule=function(f,d){if(typeof f=="string")if(typeof d=="object"&&d!==null){if(d.as==null||d.as==="script"){var g=c(d.as,d.crossOrigin);r.d.M(f,{crossOrigin:g,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0})}}else d==null&&r.d.M(f)},Yn.preload=function(f,d){if(typeof f=="string"&&typeof d=="object"&&d!==null&&typeof d.as=="string"){var g=d.as,x=c(g,d.crossOrigin);r.d.L(f,g,{crossOrigin:x,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0,type:typeof d.type=="string"?d.type:void 0,fetchPriority:typeof d.fetchPriority=="string"?d.fetchPriority:void 0,referrerPolicy:typeof d.referrerPolicy=="string"?d.referrerPolicy:void 0,imageSrcSet:typeof d.imageSrcSet=="string"?d.imageSrcSet:void 0,imageSizes:typeof d.imageSizes=="string"?d.imageSizes:void 0,media:typeof d.media=="string"?d.media:void 0})}},Yn.preloadModule=function(f,d){if(typeof f=="string")if(d){var g=c(d.as,d.crossOrigin);r.d.m(f,{as:typeof d.as=="string"&&d.as!=="script"?d.as:void 0,crossOrigin:g,integrity:typeof d.integrity=="string"?d.integrity:void 0})}else r.d.m(f)},Yn.requestFormReset=function(f){r.d.r(f)},Yn.unstable_batchedUpdates=function(f,d){return f(d)},Yn.useFormState=function(f,d,g){return l.H.useFormState(f,d,g)},Yn.useFormStatus=function(){return l.H.useHostTransitionStatus()},Yn.version="19.1.0",Yn}var pv;function ab(){if(pv)return dh.exports;pv=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),dh.exports=rb(),dh.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gv;function ib(){if(gv)return Yl;gv=1;var t=nb(),e=pm(),n=ab();function r(i){var o="https://react.dev/errors/"+i;if(1<arguments.length){o+="?args[]="+encodeURIComponent(arguments[1]);for(var u=2;u<arguments.length;u++)o+="&args[]="+encodeURIComponent(arguments[u])}return"Minified React error #"+i+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function s(i){var o=i,u=i;if(i.alternate)for(;o.return;)o=o.return;else{i=o;do o=i,(o.flags&4098)!==0&&(u=o.return),i=o.return;while(i)}return o.tag===3?u:null}function l(i){if(i.tag===13){var o=i.memoizedState;if(o===null&&(i=i.alternate,i!==null&&(o=i.memoizedState)),o!==null)return o.dehydrated}return null}function c(i){if(s(i)!==i)throw Error(r(188))}function f(i){var o=i.alternate;if(!o){if(o=s(i),o===null)throw Error(r(188));return o!==i?null:i}for(var u=i,p=o;;){var v=u.return;if(v===null)break;var w=v.alternate;if(w===null){if(p=v.return,p!==null){u=p;continue}break}if(v.child===w.child){for(w=v.child;w;){if(w===u)return c(v),i;if(w===p)return c(v),o;w=w.sibling}throw Error(r(188))}if(u.return!==p.return)u=v,p=w;else{for(var A=!1,R=v.child;R;){if(R===u){A=!0,u=v,p=w;break}if(R===p){A=!0,p=v,u=w;break}R=R.sibling}if(!A){for(R=w.child;R;){if(R===u){A=!0,u=w,p=v;break}if(R===p){A=!0,p=w,u=v;break}R=R.sibling}if(!A)throw Error(r(189))}}if(u.alternate!==p)throw Error(r(190))}if(u.tag!==3)throw Error(r(188));return u.stateNode.current===u?i:o}function d(i){var o=i.tag;if(o===5||o===26||o===27||o===6)return i;for(i=i.child;i!==null;){if(o=d(i),o!==null)return o;i=i.sibling}return null}var g=Object.assign,x=Symbol.for("react.element"),_=Symbol.for("react.transitional.element"),T=Symbol.for("react.portal"),E=Symbol.for("react.fragment"),S=Symbol.for("react.strict_mode"),C=Symbol.for("react.profiler"),k=Symbol.for("react.provider"),N=Symbol.for("react.consumer"),b=Symbol.for("react.context"),I=Symbol.for("react.forward_ref"),F=Symbol.for("react.suspense"),P=Symbol.for("react.suspense_list"),D=Symbol.for("react.memo"),j=Symbol.for("react.lazy"),B=Symbol.for("react.activity"),te=Symbol.for("react.memo_cache_sentinel"),X=Symbol.iterator;function Z(i){return i===null||typeof i!="object"?null:(i=X&&i[X]||i["@@iterator"],typeof i=="function"?i:null)}var ye=Symbol.for("react.client.reference");function Me(i){if(i==null)return null;if(typeof i=="function")return i.$$typeof===ye?null:i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case E:return"Fragment";case C:return"Profiler";case S:return"StrictMode";case F:return"Suspense";case P:return"SuspenseList";case B:return"Activity"}if(typeof i=="object")switch(i.$$typeof){case T:return"Portal";case b:return(i.displayName||"Context")+".Provider";case N:return(i._context.displayName||"Context")+".Consumer";case I:var o=i.render;return i=i.displayName,i||(i=o.displayName||o.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case D:return o=i.displayName||null,o!==null?o:Me(i.type)||"Memo";case j:o=i._payload,i=i._init;try{return Me(i(o))}catch{}}return null}var Se=Array.isArray,ee=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,me=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Pe={pending:!1,data:null,method:null,action:null},re=[],z=-1;function ce(i){return{current:i}}function L(i){0>z||(i.current=re[z],re[z]=null,z--)}function W(i,o){z++,re[z]=i.current,i.current=o}var q=ce(null),K=ce(null),ie=ce(null),Ce=ce(null);function Te(i,o){switch(W(ie,o),W(K,i),W(q,null),o.nodeType){case 9:case 11:i=(i=o.documentElement)&&(i=i.namespaceURI)?L1(i):0;break;default:if(i=o.tagName,o=o.namespaceURI)o=L1(o),i=O1(o,i);else switch(i){case"svg":i=1;break;case"math":i=2;break;default:i=0}}L(q),W(q,i)}function be(){L(q),L(K),L(ie)}function Ae(i){i.memoizedState!==null&&W(Ce,i);var o=q.current,u=O1(o,i.type);o!==u&&(W(K,i),W(q,u))}function Xe(i){K.current===i&&(L(q),L(K)),Ce.current===i&&(L(Ce),Hl._currentValue=Pe)}var Y=Object.prototype.hasOwnProperty,yt=t.unstable_scheduleCallback,st=t.unstable_cancelCallback,_t=t.unstable_shouldYield,qe=t.unstable_requestPaint,Ne=t.unstable_now,bt=t.unstable_getCurrentPriorityLevel,Ln=t.unstable_ImmediatePriority,On=t.unstable_UserBlockingPriority,$n=t.unstable_NormalPriority,ha=t.unstable_LowPriority,Un=t.unstable_IdlePriority,Cn=t.log,yr=t.unstable_setDisableYieldValue,Bn=null,cn=null;function Ht(i){if(typeof Cn=="function"&&yr(i),cn&&typeof cn.setStrictMode=="function")try{cn.setStrictMode(Bn,i)}catch{}}var zt=Math.clz32?Math.clz32:ir,et=Math.log,Ft=Math.LN2;function ir(i){return i>>>=0,i===0?32:31-(et(i)/Ft|0)|0}var qt=256,sr=4194304;function Oe(i){var o=i&42;if(o!==0)return o;switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return i&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return i}}function St(i,o,u){var p=i.pendingLanes;if(p===0)return 0;var v=0,w=i.suspendedLanes,A=i.pingedLanes;i=i.warmLanes;var R=p&134217727;return R!==0?(p=R&~w,p!==0?v=Oe(p):(A&=R,A!==0?v=Oe(A):u||(u=R&~i,u!==0&&(v=Oe(u))))):(R=p&~w,R!==0?v=Oe(R):A!==0?v=Oe(A):u||(u=p&~i,u!==0&&(v=Oe(u)))),v===0?0:o!==0&&o!==v&&(o&w)===0&&(w=v&-v,u=o&-o,w>=u||w===32&&(u&4194048)!==0)?o:v}function Be(i,o){return(i.pendingLanes&~(i.suspendedLanes&~i.pingedLanes)&o)===0}function Zt(i,o){switch(i){case 1:case 2:case 4:case 8:case 64:return o+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Et(){var i=qt;return qt<<=1,(qt&4194048)===0&&(qt=256),i}function ma(){var i=sr;return sr<<=1,(sr&62914560)===0&&(sr=4194304),i}function Aa(i){for(var o=[],u=0;31>u;u++)o.push(i);return o}function Qr(i,o){i.pendingLanes|=o,o!==268435456&&(i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0)}function Rr(i,o,u,p,v,w){var A=i.pendingLanes;i.pendingLanes=u,i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0,i.expiredLanes&=u,i.entangledLanes&=u,i.errorRecoveryDisabledLanes&=u,i.shellSuspendCounter=0;var R=i.entanglements,J=i.expirationTimes,oe=i.hiddenUpdates;for(u=A&~u;0<u;){var ve=31-zt(u),we=1<<ve;R[ve]=0,J[ve]=-1;var fe=oe[ve];if(fe!==null)for(oe[ve]=null,ve=0;ve<fe.length;ve++){var he=fe[ve];he!==null&&(he.lane&=-536870913)}u&=~we}p!==0&&Rs(i,p,0),w!==0&&v===0&&i.tag!==0&&(i.suspendedLanes|=w&~(A&~o))}function Rs(i,o,u){i.pendingLanes|=o,i.suspendedLanes&=~o;var p=31-zt(o);i.entangledLanes|=o,i.entanglements[p]=i.entanglements[p]|1073741824|u&4194090}function ft(i,o){var u=i.entangledLanes|=o;for(i=i.entanglements;u;){var p=31-zt(u),v=1<<p;v&o|i[p]&o&&(i[p]|=o),u&=~v}}function Hi(i){switch(i){case 2:i=1;break;case 8:i=4;break;case 32:i=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:i=128;break;case 268435456:i=134217728;break;default:i=0}return i}function Qo(i){return i&=-i,2<i?8<i?(i&134217727)!==0?32:268435456:8:2}function $c(){var i=me.p;return i!==0?i:(i=window.event,i===void 0?32:nv(i.type))}function n0(i,o){var u=me.p;try{return me.p=i,o()}finally{me.p=u}}var pa=Math.random().toString(36).slice(2),bn="__reactFiber$"+pa,An="__reactProps$"+pa,ri="__reactContainer$"+pa,el="__reactEvents$"+pa,r0="__reactListeners$"+pa,M="__reactHandles$"+pa,G="__reactResources$"+pa,O="__reactMarker$"+pa;function U(i){delete i[bn],delete i[An],delete i[el],delete i[r0],delete i[M]}function V(i){var o=i[bn];if(o)return o;for(var u=i.parentNode;u;){if(o=u[ri]||u[bn]){if(u=o.alternate,o.child!==null||u!==null&&u.child!==null)for(i=G1(i);i!==null;){if(u=i[bn])return u;i=G1(i)}return o}i=u,u=i.parentNode}return null}function H(i){if(i=i[bn]||i[ri]){var o=i.tag;if(o===5||o===6||o===13||o===26||o===27||o===3)return i}return null}function le(i){var o=i.tag;if(o===5||o===26||o===27||o===6)return i.stateNode;throw Error(r(33))}function ge(i){var o=i[G];return o||(o=i[G]={hoistableStyles:new Map,hoistableScripts:new Map}),o}function ae(i){i[O]=!0}var ue=new Set,de={};function ke(i,o){Re(i,o),Re(i+"Capture",o)}function Re(i,o){for(de[i]=o,i=0;i<o.length;i++)ue.add(o[i])}var Ue=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),De={},Le={};function Qe(i){return Y.call(Le,i)?!0:Y.call(De,i)?!1:Ue.test(i)?Le[i]=!0:(De[i]=!0,!1)}function It(i,o,u){if(Qe(o))if(u===null)i.removeAttribute(o);else{switch(typeof u){case"undefined":case"function":case"symbol":i.removeAttribute(o);return;case"boolean":var p=o.toLowerCase().slice(0,5);if(p!=="data-"&&p!=="aria-"){i.removeAttribute(o);return}}i.setAttribute(o,""+u)}}function Pt(i,o,u){if(u===null)i.removeAttribute(o);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(o);return}i.setAttribute(o,""+u)}}function jt(i,o,u,p){if(p===null)i.removeAttribute(u);else{switch(typeof p){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(u);return}i.setAttributeNS(o,u,""+p)}}var ka,ai;function Fr(i){if(ka===void 0)try{throw Error()}catch(u){var o=u.stack.trim().match(/\n( *(at )?)/);ka=o&&o[1]||"",ai=-1<u.stack.indexOf(`
    at`)?" (<anonymous>)":-1<u.stack.indexOf("@")?"@unknown:0:0":""}return`
`+ka+i+ai}var ea=!1;function zi(i,o){if(!i||ea)return"";ea=!0;var u=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var p={DetermineComponentFrameRoot:function(){try{if(o){var we=function(){throw Error()};if(Object.defineProperty(we.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(we,[])}catch(he){var fe=he}Reflect.construct(i,[],we)}else{try{we.call()}catch(he){fe=he}i.call(we.prototype)}}else{try{throw Error()}catch(he){fe=he}(we=i())&&typeof we.catch=="function"&&we.catch(function(){})}}catch(he){if(he&&fe&&typeof he.stack=="string")return[he.stack,fe.stack]}return[null,null]}};p.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var v=Object.getOwnPropertyDescriptor(p.DetermineComponentFrameRoot,"name");v&&v.configurable&&Object.defineProperty(p.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var w=p.DetermineComponentFrameRoot(),A=w[0],R=w[1];if(A&&R){var J=A.split(`
`),oe=R.split(`
`);for(v=p=0;p<J.length&&!J[p].includes("DetermineComponentFrameRoot");)p++;for(;v<oe.length&&!oe[v].includes("DetermineComponentFrameRoot");)v++;if(p===J.length||v===oe.length)for(p=J.length-1,v=oe.length-1;1<=p&&0<=v&&J[p]!==oe[v];)v--;for(;1<=p&&0<=v;p--,v--)if(J[p]!==oe[v]){if(p!==1||v!==1)do if(p--,v--,0>v||J[p]!==oe[v]){var ve=`
`+J[p].replace(" at new "," at ");return i.displayName&&ve.includes("<anonymous>")&&(ve=ve.replace("<anonymous>",i.displayName)),ve}while(1<=p&&0<=v);break}}}finally{ea=!1,Error.prepareStackTrace=u}return(u=i?i.displayName||i.name:"")?Fr(u):""}function ta(i){switch(i.tag){case 26:case 27:case 5:return Fr(i.type);case 16:return Fr("Lazy");case 13:return Fr("Suspense");case 19:return Fr("SuspenseList");case 0:case 15:return zi(i.type,!1);case 11:return zi(i.type.render,!1);case 1:return zi(i.type,!0);case 31:return Fr("Activity");default:return""}}function Mp(i){try{var o="";do o+=ta(i),i=i.return;while(i);return o}catch(u){return`
Error generating stack: `+u.message+`
`+u.stack}}function Ir(i){switch(typeof i){case"bigint":case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function Dp(i){var o=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function $S(i){var o=Dp(i)?"checked":"value",u=Object.getOwnPropertyDescriptor(i.constructor.prototype,o),p=""+i[o];if(!i.hasOwnProperty(o)&&typeof u<"u"&&typeof u.get=="function"&&typeof u.set=="function"){var v=u.get,w=u.set;return Object.defineProperty(i,o,{configurable:!0,get:function(){return v.call(this)},set:function(A){p=""+A,w.call(this,A)}}),Object.defineProperty(i,o,{enumerable:u.enumerable}),{getValue:function(){return p},setValue:function(A){p=""+A},stopTracking:function(){i._valueTracker=null,delete i[o]}}}}function Wc(i){i._valueTracker||(i._valueTracker=$S(i))}function Rp(i){if(!i)return!1;var o=i._valueTracker;if(!o)return!0;var u=o.getValue(),p="";return i&&(p=Dp(i)?i.checked?"true":"false":i.value),i=p,i!==u?(o.setValue(i),!0):!1}function Yc(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}var WS=/[\n"\\]/g;function Pr(i){return i.replace(WS,function(o){return"\\"+o.charCodeAt(0).toString(16)+" "})}function a0(i,o,u,p,v,w,A,R){i.name="",A!=null&&typeof A!="function"&&typeof A!="symbol"&&typeof A!="boolean"?i.type=A:i.removeAttribute("type"),o!=null?A==="number"?(o===0&&i.value===""||i.value!=o)&&(i.value=""+Ir(o)):i.value!==""+Ir(o)&&(i.value=""+Ir(o)):A!=="submit"&&A!=="reset"||i.removeAttribute("value"),o!=null?i0(i,A,Ir(o)):u!=null?i0(i,A,Ir(u)):p!=null&&i.removeAttribute("value"),v==null&&w!=null&&(i.defaultChecked=!!w),v!=null&&(i.checked=v&&typeof v!="function"&&typeof v!="symbol"),R!=null&&typeof R!="function"&&typeof R!="symbol"&&typeof R!="boolean"?i.name=""+Ir(R):i.removeAttribute("name")}function Fp(i,o,u,p,v,w,A,R){if(w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"&&(i.type=w),o!=null||u!=null){if(!(w!=="submit"&&w!=="reset"||o!=null))return;u=u!=null?""+Ir(u):"",o=o!=null?""+Ir(o):u,R||o===i.value||(i.value=o),i.defaultValue=o}p=p??v,p=typeof p!="function"&&typeof p!="symbol"&&!!p,i.checked=R?i.checked:!!p,i.defaultChecked=!!p,A!=null&&typeof A!="function"&&typeof A!="symbol"&&typeof A!="boolean"&&(i.name=A)}function i0(i,o,u){o==="number"&&Yc(i.ownerDocument)===i||i.defaultValue===""+u||(i.defaultValue=""+u)}function Fs(i,o,u,p){if(i=i.options,o){o={};for(var v=0;v<u.length;v++)o["$"+u[v]]=!0;for(u=0;u<i.length;u++)v=o.hasOwnProperty("$"+i[u].value),i[u].selected!==v&&(i[u].selected=v),v&&p&&(i[u].defaultSelected=!0)}else{for(u=""+Ir(u),o=null,v=0;v<i.length;v++){if(i[v].value===u){i[v].selected=!0,p&&(i[v].defaultSelected=!0);return}o!==null||i[v].disabled||(o=i[v])}o!==null&&(o.selected=!0)}}function Ip(i,o,u){if(o!=null&&(o=""+Ir(o),o!==i.value&&(i.value=o),u==null)){i.defaultValue!==o&&(i.defaultValue=o);return}i.defaultValue=u!=null?""+Ir(u):""}function Pp(i,o,u,p){if(o==null){if(p!=null){if(u!=null)throw Error(r(92));if(Se(p)){if(1<p.length)throw Error(r(93));p=p[0]}u=p}u==null&&(u=""),o=u}u=Ir(o),i.defaultValue=u,p=i.textContent,p===u&&p!==""&&p!==null&&(i.value=p)}function Is(i,o){if(o){var u=i.firstChild;if(u&&u===i.lastChild&&u.nodeType===3){u.nodeValue=o;return}}i.textContent=o}var YS=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Lp(i,o,u){var p=o.indexOf("--")===0;u==null||typeof u=="boolean"||u===""?p?i.setProperty(o,""):o==="float"?i.cssFloat="":i[o]="":p?i.setProperty(o,u):typeof u!="number"||u===0||YS.has(o)?o==="float"?i.cssFloat=u:i[o]=(""+u).trim():i[o]=u+"px"}function Op(i,o,u){if(o!=null&&typeof o!="object")throw Error(r(62));if(i=i.style,u!=null){for(var p in u)!u.hasOwnProperty(p)||o!=null&&o.hasOwnProperty(p)||(p.indexOf("--")===0?i.setProperty(p,""):p==="float"?i.cssFloat="":i[p]="");for(var v in o)p=o[v],o.hasOwnProperty(v)&&u[v]!==p&&Lp(i,v,p)}else for(var w in o)o.hasOwnProperty(w)&&Lp(i,w,o[w])}function s0(i){if(i.indexOf("-")===-1)return!1;switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var JS=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),XS=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Jc(i){return XS.test(""+i)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":i}var o0=null;function l0(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var Ps=null,Ls=null;function Up(i){var o=H(i);if(o&&(i=o.stateNode)){var u=i[An]||null;e:switch(i=o.stateNode,o.type){case"input":if(a0(i,u.value,u.defaultValue,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name),o=u.name,u.type==="radio"&&o!=null){for(u=i;u.parentNode;)u=u.parentNode;for(u=u.querySelectorAll('input[name="'+Pr(""+o)+'"][type="radio"]'),o=0;o<u.length;o++){var p=u[o];if(p!==i&&p.form===i.form){var v=p[An]||null;if(!v)throw Error(r(90));a0(p,v.value,v.defaultValue,v.defaultValue,v.checked,v.defaultChecked,v.type,v.name)}}for(o=0;o<u.length;o++)p=u[o],p.form===i.form&&Rp(p)}break e;case"textarea":Ip(i,u.value,u.defaultValue);break e;case"select":o=u.value,o!=null&&Fs(i,!!u.multiple,o,!1)}}}var c0=!1;function Bp(i,o,u){if(c0)return i(o,u);c0=!0;try{var p=i(o);return p}finally{if(c0=!1,(Ps!==null||Ls!==null)&&(Iu(),Ps&&(o=Ps,i=Ls,Ls=Ps=null,Up(o),i)))for(o=0;o<i.length;o++)Up(i[o])}}function tl(i,o){var u=i.stateNode;if(u===null)return null;var p=u[An]||null;if(p===null)return null;u=p[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(p=!p.disabled)||(i=i.type,p=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!p;break e;default:i=!1}if(i)return null;if(u&&typeof u!="function")throw Error(r(231,o,typeof u));return u}var Na=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),u0=!1;if(Na)try{var nl={};Object.defineProperty(nl,"passive",{get:function(){u0=!0}}),window.addEventListener("test",nl,nl),window.removeEventListener("test",nl,nl)}catch{u0=!1}var ii=null,f0=null,Xc=null;function Vp(){if(Xc)return Xc;var i,o=f0,u=o.length,p,v="value"in ii?ii.value:ii.textContent,w=v.length;for(i=0;i<u&&o[i]===v[i];i++);var A=u-i;for(p=1;p<=A&&o[u-p]===v[w-p];p++);return Xc=v.slice(i,1<p?1-p:void 0)}function Kc(i){var o=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&o===13&&(i=13)):i=o,i===10&&(i=13),32<=i||i===13?i:0}function Zc(){return!0}function Gp(){return!1}function fr(i){function o(u,p,v,w,A){this._reactName=u,this._targetInst=v,this.type=p,this.nativeEvent=w,this.target=A,this.currentTarget=null;for(var R in i)i.hasOwnProperty(R)&&(u=i[R],this[R]=u?u(w):w[R]);return this.isDefaultPrevented=(w.defaultPrevented!=null?w.defaultPrevented:w.returnValue===!1)?Zc:Gp,this.isPropagationStopped=Gp,this}return g(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var u=this.nativeEvent;u&&(u.preventDefault?u.preventDefault():typeof u.returnValue!="unknown"&&(u.returnValue=!1),this.isDefaultPrevented=Zc)},stopPropagation:function(){var u=this.nativeEvent;u&&(u.stopPropagation?u.stopPropagation():typeof u.cancelBubble!="unknown"&&(u.cancelBubble=!0),this.isPropagationStopped=Zc)},persist:function(){},isPersistent:Zc}),o}var qi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Qc=fr(qi),rl=g({},qi,{view:0,detail:0}),KS=fr(rl),d0,h0,al,eu=g({},rl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:p0,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==al&&(al&&i.type==="mousemove"?(d0=i.screenX-al.screenX,h0=i.screenY-al.screenY):h0=d0=0,al=i),d0)},movementY:function(i){return"movementY"in i?i.movementY:h0}}),Hp=fr(eu),ZS=g({},eu,{dataTransfer:0}),QS=fr(ZS),eE=g({},rl,{relatedTarget:0}),m0=fr(eE),tE=g({},qi,{animationName:0,elapsedTime:0,pseudoElement:0}),nE=fr(tE),rE=g({},qi,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),aE=fr(rE),iE=g({},qi,{data:0}),zp=fr(iE),sE={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},oE={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},lE={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function cE(i){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(i):(i=lE[i])?!!o[i]:!1}function p0(){return cE}var uE=g({},rl,{key:function(i){if(i.key){var o=sE[i.key]||i.key;if(o!=="Unidentified")return o}return i.type==="keypress"?(i=Kc(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?oE[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:p0,charCode:function(i){return i.type==="keypress"?Kc(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?Kc(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),fE=fr(uE),dE=g({},eu,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),qp=fr(dE),hE=g({},rl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:p0}),mE=fr(hE),pE=g({},qi,{propertyName:0,elapsedTime:0,pseudoElement:0}),gE=fr(pE),xE=g({},eu,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),vE=fr(xE),yE=g({},qi,{newState:0,oldState:0}),_E=fr(yE),TE=[9,13,27,32],g0=Na&&"CompositionEvent"in window,il=null;Na&&"documentMode"in document&&(il=document.documentMode);var wE=Na&&"TextEvent"in window&&!il,jp=Na&&(!g0||il&&8<il&&11>=il),$p=" ",Wp=!1;function Yp(i,o){switch(i){case"keyup":return TE.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Jp(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var Os=!1;function SE(i,o){switch(i){case"compositionend":return Jp(o);case"keypress":return o.which!==32?null:(Wp=!0,$p);case"textInput":return i=o.data,i===$p&&Wp?null:i;default:return null}}function EE(i,o){if(Os)return i==="compositionend"||!g0&&Yp(i,o)?(i=Vp(),Xc=f0=ii=null,Os=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return jp&&o.locale!=="ko"?null:o.data;default:return null}}var CE={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Xp(i){var o=i&&i.nodeName&&i.nodeName.toLowerCase();return o==="input"?!!CE[i.type]:o==="textarea"}function Kp(i,o,u,p){Ps?Ls?Ls.push(p):Ls=[p]:Ps=p,o=Vu(o,"onChange"),0<o.length&&(u=new Qc("onChange","change",null,u,p),i.push({event:u,listeners:o}))}var sl=null,ol=null;function bE(i){D1(i,0)}function tu(i){var o=le(i);if(Rp(o))return i}function Zp(i,o){if(i==="change")return o}var Qp=!1;if(Na){var x0;if(Na){var v0="oninput"in document;if(!v0){var eg=document.createElement("div");eg.setAttribute("oninput","return;"),v0=typeof eg.oninput=="function"}x0=v0}else x0=!1;Qp=x0&&(!document.documentMode||9<document.documentMode)}function tg(){sl&&(sl.detachEvent("onpropertychange",ng),ol=sl=null)}function ng(i){if(i.propertyName==="value"&&tu(ol)){var o=[];Kp(o,ol,i,l0(i)),Bp(bE,o)}}function AE(i,o,u){i==="focusin"?(tg(),sl=o,ol=u,sl.attachEvent("onpropertychange",ng)):i==="focusout"&&tg()}function kE(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return tu(ol)}function NE(i,o){if(i==="click")return tu(o)}function ME(i,o){if(i==="input"||i==="change")return tu(o)}function DE(i,o){return i===o&&(i!==0||1/i===1/o)||i!==i&&o!==o}var _r=typeof Object.is=="function"?Object.is:DE;function ll(i,o){if(_r(i,o))return!0;if(typeof i!="object"||i===null||typeof o!="object"||o===null)return!1;var u=Object.keys(i),p=Object.keys(o);if(u.length!==p.length)return!1;for(p=0;p<u.length;p++){var v=u[p];if(!Y.call(o,v)||!_r(i[v],o[v]))return!1}return!0}function rg(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function ag(i,o){var u=rg(i);i=0;for(var p;u;){if(u.nodeType===3){if(p=i+u.textContent.length,i<=o&&p>=o)return{node:u,offset:o-i};i=p}e:{for(;u;){if(u.nextSibling){u=u.nextSibling;break e}u=u.parentNode}u=void 0}u=rg(u)}}function ig(i,o){return i&&o?i===o?!0:i&&i.nodeType===3?!1:o&&o.nodeType===3?ig(i,o.parentNode):"contains"in i?i.contains(o):i.compareDocumentPosition?!!(i.compareDocumentPosition(o)&16):!1:!1}function sg(i){i=i!=null&&i.ownerDocument!=null&&i.ownerDocument.defaultView!=null?i.ownerDocument.defaultView:window;for(var o=Yc(i.document);o instanceof i.HTMLIFrameElement;){try{var u=typeof o.contentWindow.location.href=="string"}catch{u=!1}if(u)i=o.contentWindow;else break;o=Yc(i.document)}return o}function y0(i){var o=i&&i.nodeName&&i.nodeName.toLowerCase();return o&&(o==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||o==="textarea"||i.contentEditable==="true")}var RE=Na&&"documentMode"in document&&11>=document.documentMode,Us=null,_0=null,cl=null,T0=!1;function og(i,o,u){var p=u.window===u?u.document:u.nodeType===9?u:u.ownerDocument;T0||Us==null||Us!==Yc(p)||(p=Us,"selectionStart"in p&&y0(p)?p={start:p.selectionStart,end:p.selectionEnd}:(p=(p.ownerDocument&&p.ownerDocument.defaultView||window).getSelection(),p={anchorNode:p.anchorNode,anchorOffset:p.anchorOffset,focusNode:p.focusNode,focusOffset:p.focusOffset}),cl&&ll(cl,p)||(cl=p,p=Vu(_0,"onSelect"),0<p.length&&(o=new Qc("onSelect","select",null,o,u),i.push({event:o,listeners:p}),o.target=Us)))}function ji(i,o){var u={};return u[i.toLowerCase()]=o.toLowerCase(),u["Webkit"+i]="webkit"+o,u["Moz"+i]="moz"+o,u}var Bs={animationend:ji("Animation","AnimationEnd"),animationiteration:ji("Animation","AnimationIteration"),animationstart:ji("Animation","AnimationStart"),transitionrun:ji("Transition","TransitionRun"),transitionstart:ji("Transition","TransitionStart"),transitioncancel:ji("Transition","TransitionCancel"),transitionend:ji("Transition","TransitionEnd")},w0={},lg={};Na&&(lg=document.createElement("div").style,"AnimationEvent"in window||(delete Bs.animationend.animation,delete Bs.animationiteration.animation,delete Bs.animationstart.animation),"TransitionEvent"in window||delete Bs.transitionend.transition);function $i(i){if(w0[i])return w0[i];if(!Bs[i])return i;var o=Bs[i],u;for(u in o)if(o.hasOwnProperty(u)&&u in lg)return w0[i]=o[u];return i}var cg=$i("animationend"),ug=$i("animationiteration"),fg=$i("animationstart"),FE=$i("transitionrun"),IE=$i("transitionstart"),PE=$i("transitioncancel"),dg=$i("transitionend"),hg=new Map,S0="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");S0.push("scrollEnd");function na(i,o){hg.set(i,o),ke(o,[i])}var mg=new WeakMap;function Lr(i,o){if(typeof i=="object"&&i!==null){var u=mg.get(i);return u!==void 0?u:(o={value:i,source:o,stack:Mp(o)},mg.set(i,o),o)}return{value:i,source:o,stack:Mp(o)}}var Or=[],Vs=0,E0=0;function nu(){for(var i=Vs,o=E0=Vs=0;o<i;){var u=Or[o];Or[o++]=null;var p=Or[o];Or[o++]=null;var v=Or[o];Or[o++]=null;var w=Or[o];if(Or[o++]=null,p!==null&&v!==null){var A=p.pending;A===null?v.next=v:(v.next=A.next,A.next=v),p.pending=v}w!==0&&pg(u,v,w)}}function ru(i,o,u,p){Or[Vs++]=i,Or[Vs++]=o,Or[Vs++]=u,Or[Vs++]=p,E0|=p,i.lanes|=p,i=i.alternate,i!==null&&(i.lanes|=p)}function C0(i,o,u,p){return ru(i,o,u,p),au(i)}function Gs(i,o){return ru(i,null,null,o),au(i)}function pg(i,o,u){i.lanes|=u;var p=i.alternate;p!==null&&(p.lanes|=u);for(var v=!1,w=i.return;w!==null;)w.childLanes|=u,p=w.alternate,p!==null&&(p.childLanes|=u),w.tag===22&&(i=w.stateNode,i===null||i._visibility&1||(v=!0)),i=w,w=w.return;return i.tag===3?(w=i.stateNode,v&&o!==null&&(v=31-zt(u),i=w.hiddenUpdates,p=i[v],p===null?i[v]=[o]:p.push(o),o.lane=u|536870912),w):null}function au(i){if(50<Il)throw Il=0,Dd=null,Error(r(185));for(var o=i.return;o!==null;)i=o,o=i.return;return i.tag===3?i.stateNode:null}var Hs={};function LE(i,o,u,p){this.tag=i,this.key=u,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=p,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Tr(i,o,u,p){return new LE(i,o,u,p)}function b0(i){return i=i.prototype,!(!i||!i.isReactComponent)}function Ma(i,o){var u=i.alternate;return u===null?(u=Tr(i.tag,o,i.key,i.mode),u.elementType=i.elementType,u.type=i.type,u.stateNode=i.stateNode,u.alternate=i,i.alternate=u):(u.pendingProps=o,u.type=i.type,u.flags=0,u.subtreeFlags=0,u.deletions=null),u.flags=i.flags&65011712,u.childLanes=i.childLanes,u.lanes=i.lanes,u.child=i.child,u.memoizedProps=i.memoizedProps,u.memoizedState=i.memoizedState,u.updateQueue=i.updateQueue,o=i.dependencies,u.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},u.sibling=i.sibling,u.index=i.index,u.ref=i.ref,u.refCleanup=i.refCleanup,u}function gg(i,o){i.flags&=65011714;var u=i.alternate;return u===null?(i.childLanes=0,i.lanes=o,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=u.childLanes,i.lanes=u.lanes,i.child=u.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=u.memoizedProps,i.memoizedState=u.memoizedState,i.updateQueue=u.updateQueue,i.type=u.type,o=u.dependencies,i.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext}),i}function iu(i,o,u,p,v,w){var A=0;if(p=i,typeof i=="function")b0(i)&&(A=1);else if(typeof i=="string")A=UC(i,u,q.current)?26:i==="html"||i==="head"||i==="body"?27:5;else e:switch(i){case B:return i=Tr(31,u,o,v),i.elementType=B,i.lanes=w,i;case E:return Wi(u.children,v,w,o);case S:A=8,v|=24;break;case C:return i=Tr(12,u,o,v|2),i.elementType=C,i.lanes=w,i;case F:return i=Tr(13,u,o,v),i.elementType=F,i.lanes=w,i;case P:return i=Tr(19,u,o,v),i.elementType=P,i.lanes=w,i;default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case k:case b:A=10;break e;case N:A=9;break e;case I:A=11;break e;case D:A=14;break e;case j:A=16,p=null;break e}A=29,u=Error(r(130,i===null?"null":typeof i,"")),p=null}return o=Tr(A,u,o,v),o.elementType=i,o.type=p,o.lanes=w,o}function Wi(i,o,u,p){return i=Tr(7,i,p,o),i.lanes=u,i}function A0(i,o,u){return i=Tr(6,i,null,o),i.lanes=u,i}function k0(i,o,u){return o=Tr(4,i.children!==null?i.children:[],i.key,o),o.lanes=u,o.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},o}var zs=[],qs=0,su=null,ou=0,Ur=[],Br=0,Yi=null,Da=1,Ra="";function Ji(i,o){zs[qs++]=ou,zs[qs++]=su,su=i,ou=o}function xg(i,o,u){Ur[Br++]=Da,Ur[Br++]=Ra,Ur[Br++]=Yi,Yi=i;var p=Da;i=Ra;var v=32-zt(p)-1;p&=~(1<<v),u+=1;var w=32-zt(o)+v;if(30<w){var A=v-v%5;w=(p&(1<<A)-1).toString(32),p>>=A,v-=A,Da=1<<32-zt(o)+v|u<<v|p,Ra=w+i}else Da=1<<w|u<<v|p,Ra=i}function N0(i){i.return!==null&&(Ji(i,1),xg(i,1,0))}function M0(i){for(;i===su;)su=zs[--qs],zs[qs]=null,ou=zs[--qs],zs[qs]=null;for(;i===Yi;)Yi=Ur[--Br],Ur[Br]=null,Ra=Ur[--Br],Ur[Br]=null,Da=Ur[--Br],Ur[Br]=null}var or=null,rn=null,Ct=!1,Xi=null,ga=!1,D0=Error(r(519));function Ki(i){var o=Error(r(418,""));throw dl(Lr(o,i)),D0}function vg(i){var o=i.stateNode,u=i.type,p=i.memoizedProps;switch(o[bn]=i,o[An]=p,u){case"dialog":ht("cancel",o),ht("close",o);break;case"iframe":case"object":case"embed":ht("load",o);break;case"video":case"audio":for(u=0;u<Ll.length;u++)ht(Ll[u],o);break;case"source":ht("error",o);break;case"img":case"image":case"link":ht("error",o),ht("load",o);break;case"details":ht("toggle",o);break;case"input":ht("invalid",o),Fp(o,p.value,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name,!0),Wc(o);break;case"select":ht("invalid",o);break;case"textarea":ht("invalid",o),Pp(o,p.value,p.defaultValue,p.children),Wc(o)}u=p.children,typeof u!="string"&&typeof u!="number"&&typeof u!="bigint"||o.textContent===""+u||p.suppressHydrationWarning===!0||P1(o.textContent,u)?(p.popover!=null&&(ht("beforetoggle",o),ht("toggle",o)),p.onScroll!=null&&ht("scroll",o),p.onScrollEnd!=null&&ht("scrollend",o),p.onClick!=null&&(o.onclick=Gu),o=!0):o=!1,o||Ki(i)}function yg(i){for(or=i.return;or;)switch(or.tag){case 5:case 13:ga=!1;return;case 27:case 3:ga=!0;return;default:or=or.return}}function ul(i){if(i!==or)return!1;if(!Ct)return yg(i),Ct=!0,!1;var o=i.tag,u;if((u=o!==3&&o!==27)&&((u=o===5)&&(u=i.type,u=!(u!=="form"&&u!=="button")||Wd(i.type,i.memoizedProps)),u=!u),u&&rn&&Ki(i),yg(i),o===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(r(317));e:{for(i=i.nextSibling,o=0;i;){if(i.nodeType===8)if(u=i.data,u==="/$"){if(o===0){rn=aa(i.nextSibling);break e}o--}else u!=="$"&&u!=="$!"&&u!=="$?"||o++;i=i.nextSibling}rn=null}}else o===27?(o=rn,Ti(i.type)?(i=Kd,Kd=null,rn=i):rn=o):rn=or?aa(i.stateNode.nextSibling):null;return!0}function fl(){rn=or=null,Ct=!1}function _g(){var i=Xi;return i!==null&&(mr===null?mr=i:mr.push.apply(mr,i),Xi=null),i}function dl(i){Xi===null?Xi=[i]:Xi.push(i)}var R0=ce(null),Zi=null,Fa=null;function si(i,o,u){W(R0,o._currentValue),o._currentValue=u}function Ia(i){i._currentValue=R0.current,L(R0)}function F0(i,o,u){for(;i!==null;){var p=i.alternate;if((i.childLanes&o)!==o?(i.childLanes|=o,p!==null&&(p.childLanes|=o)):p!==null&&(p.childLanes&o)!==o&&(p.childLanes|=o),i===u)break;i=i.return}}function I0(i,o,u,p){var v=i.child;for(v!==null&&(v.return=i);v!==null;){var w=v.dependencies;if(w!==null){var A=v.child;w=w.firstContext;e:for(;w!==null;){var R=w;w=v;for(var J=0;J<o.length;J++)if(R.context===o[J]){w.lanes|=u,R=w.alternate,R!==null&&(R.lanes|=u),F0(w.return,u,i),p||(A=null);break e}w=R.next}}else if(v.tag===18){if(A=v.return,A===null)throw Error(r(341));A.lanes|=u,w=A.alternate,w!==null&&(w.lanes|=u),F0(A,u,i),A=null}else A=v.child;if(A!==null)A.return=v;else for(A=v;A!==null;){if(A===i){A=null;break}if(v=A.sibling,v!==null){v.return=A.return,A=v;break}A=A.return}v=A}}function hl(i,o,u,p){i=null;for(var v=o,w=!1;v!==null;){if(!w){if((v.flags&524288)!==0)w=!0;else if((v.flags&262144)!==0)break}if(v.tag===10){var A=v.alternate;if(A===null)throw Error(r(387));if(A=A.memoizedProps,A!==null){var R=v.type;_r(v.pendingProps.value,A.value)||(i!==null?i.push(R):i=[R])}}else if(v===Ce.current){if(A=v.alternate,A===null)throw Error(r(387));A.memoizedState.memoizedState!==v.memoizedState.memoizedState&&(i!==null?i.push(Hl):i=[Hl])}v=v.return}i!==null&&I0(o,i,u,p),o.flags|=262144}function lu(i){for(i=i.firstContext;i!==null;){if(!_r(i.context._currentValue,i.memoizedValue))return!0;i=i.next}return!1}function Qi(i){Zi=i,Fa=null,i=i.dependencies,i!==null&&(i.firstContext=null)}function Wn(i){return Tg(Zi,i)}function cu(i,o){return Zi===null&&Qi(i),Tg(i,o)}function Tg(i,o){var u=o._currentValue;if(o={context:o,memoizedValue:u,next:null},Fa===null){if(i===null)throw Error(r(308));Fa=o,i.dependencies={lanes:0,firstContext:o},i.flags|=524288}else Fa=Fa.next=o;return u}var OE=typeof AbortController<"u"?AbortController:function(){var i=[],o=this.signal={aborted:!1,addEventListener:function(u,p){i.push(p)}};this.abort=function(){o.aborted=!0,i.forEach(function(u){return u()})}},UE=t.unstable_scheduleCallback,BE=t.unstable_NormalPriority,Tn={$$typeof:b,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function P0(){return{controller:new OE,data:new Map,refCount:0}}function ml(i){i.refCount--,i.refCount===0&&UE(BE,function(){i.controller.abort()})}var pl=null,L0=0,js=0,$s=null;function VE(i,o){if(pl===null){var u=pl=[];L0=0,js=Ud(),$s={status:"pending",value:void 0,then:function(p){u.push(p)}}}return L0++,o.then(wg,wg),o}function wg(){if(--L0===0&&pl!==null){$s!==null&&($s.status="fulfilled");var i=pl;pl=null,js=0,$s=null;for(var o=0;o<i.length;o++)(0,i[o])()}}function GE(i,o){var u=[],p={status:"pending",value:null,reason:null,then:function(v){u.push(v)}};return i.then(function(){p.status="fulfilled",p.value=o;for(var v=0;v<u.length;v++)(0,u[v])(o)},function(v){for(p.status="rejected",p.reason=v,v=0;v<u.length;v++)(0,u[v])(void 0)}),p}var Sg=ee.S;ee.S=function(i,o){typeof o=="object"&&o!==null&&typeof o.then=="function"&&VE(i,o),Sg!==null&&Sg(i,o)};var es=ce(null);function O0(){var i=es.current;return i!==null?i:$t.pooledCache}function uu(i,o){o===null?W(es,es.current):W(es,o.pool)}function Eg(){var i=O0();return i===null?null:{parent:Tn._currentValue,pool:i}}var gl=Error(r(460)),Cg=Error(r(474)),fu=Error(r(542)),U0={then:function(){}};function bg(i){return i=i.status,i==="fulfilled"||i==="rejected"}function du(){}function Ag(i,o,u){switch(u=i[u],u===void 0?i.push(o):u!==o&&(o.then(du,du),o=u),o.status){case"fulfilled":return o.value;case"rejected":throw i=o.reason,Ng(i),i;default:if(typeof o.status=="string")o.then(du,du);else{if(i=$t,i!==null&&100<i.shellSuspendCounter)throw Error(r(482));i=o,i.status="pending",i.then(function(p){if(o.status==="pending"){var v=o;v.status="fulfilled",v.value=p}},function(p){if(o.status==="pending"){var v=o;v.status="rejected",v.reason=p}})}switch(o.status){case"fulfilled":return o.value;case"rejected":throw i=o.reason,Ng(i),i}throw xl=o,gl}}var xl=null;function kg(){if(xl===null)throw Error(r(459));var i=xl;return xl=null,i}function Ng(i){if(i===gl||i===fu)throw Error(r(483))}var oi=!1;function B0(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function V0(i,o){i=i.updateQueue,o.updateQueue===i&&(o.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,callbacks:null})}function li(i){return{lane:i,tag:0,payload:null,callback:null,next:null}}function ci(i,o,u){var p=i.updateQueue;if(p===null)return null;if(p=p.shared,(At&2)!==0){var v=p.pending;return v===null?o.next=o:(o.next=v.next,v.next=o),p.pending=o,o=au(i),pg(i,null,u),o}return ru(i,p,o,u),au(i)}function vl(i,o,u){if(o=o.updateQueue,o!==null&&(o=o.shared,(u&4194048)!==0)){var p=o.lanes;p&=i.pendingLanes,u|=p,o.lanes=u,ft(i,u)}}function G0(i,o){var u=i.updateQueue,p=i.alternate;if(p!==null&&(p=p.updateQueue,u===p)){var v=null,w=null;if(u=u.firstBaseUpdate,u!==null){do{var A={lane:u.lane,tag:u.tag,payload:u.payload,callback:null,next:null};w===null?v=w=A:w=w.next=A,u=u.next}while(u!==null);w===null?v=w=o:w=w.next=o}else v=w=o;u={baseState:p.baseState,firstBaseUpdate:v,lastBaseUpdate:w,shared:p.shared,callbacks:p.callbacks},i.updateQueue=u;return}i=u.lastBaseUpdate,i===null?u.firstBaseUpdate=o:i.next=o,u.lastBaseUpdate=o}var H0=!1;function yl(){if(H0){var i=$s;if(i!==null)throw i}}function _l(i,o,u,p){H0=!1;var v=i.updateQueue;oi=!1;var w=v.firstBaseUpdate,A=v.lastBaseUpdate,R=v.shared.pending;if(R!==null){v.shared.pending=null;var J=R,oe=J.next;J.next=null,A===null?w=oe:A.next=oe,A=J;var ve=i.alternate;ve!==null&&(ve=ve.updateQueue,R=ve.lastBaseUpdate,R!==A&&(R===null?ve.firstBaseUpdate=oe:R.next=oe,ve.lastBaseUpdate=J))}if(w!==null){var we=v.baseState;A=0,ve=oe=J=null,R=w;do{var fe=R.lane&-536870913,he=fe!==R.lane;if(he?(pt&fe)===fe:(p&fe)===fe){fe!==0&&fe===js&&(H0=!0),ve!==null&&(ve=ve.next={lane:0,tag:R.tag,payload:R.payload,callback:null,next:null});e:{var Ke=i,je=R;fe=o;var Ut=u;switch(je.tag){case 1:if(Ke=je.payload,typeof Ke=="function"){we=Ke.call(Ut,we,fe);break e}we=Ke;break e;case 3:Ke.flags=Ke.flags&-65537|128;case 0:if(Ke=je.payload,fe=typeof Ke=="function"?Ke.call(Ut,we,fe):Ke,fe==null)break e;we=g({},we,fe);break e;case 2:oi=!0}}fe=R.callback,fe!==null&&(i.flags|=64,he&&(i.flags|=8192),he=v.callbacks,he===null?v.callbacks=[fe]:he.push(fe))}else he={lane:fe,tag:R.tag,payload:R.payload,callback:R.callback,next:null},ve===null?(oe=ve=he,J=we):ve=ve.next=he,A|=fe;if(R=R.next,R===null){if(R=v.shared.pending,R===null)break;he=R,R=he.next,he.next=null,v.lastBaseUpdate=he,v.shared.pending=null}}while(!0);ve===null&&(J=we),v.baseState=J,v.firstBaseUpdate=oe,v.lastBaseUpdate=ve,w===null&&(v.shared.lanes=0),xi|=A,i.lanes=A,i.memoizedState=we}}function Mg(i,o){if(typeof i!="function")throw Error(r(191,i));i.call(o)}function Dg(i,o){var u=i.callbacks;if(u!==null)for(i.callbacks=null,i=0;i<u.length;i++)Mg(u[i],o)}var Ws=ce(null),hu=ce(0);function Rg(i,o){i=Ga,W(hu,i),W(Ws,o),Ga=i|o.baseLanes}function z0(){W(hu,Ga),W(Ws,Ws.current)}function q0(){Ga=hu.current,L(Ws),L(hu)}var ui=0,ot=null,Lt=null,gn=null,mu=!1,Ys=!1,ts=!1,pu=0,Tl=0,Js=null,HE=0;function un(){throw Error(r(321))}function j0(i,o){if(o===null)return!1;for(var u=0;u<o.length&&u<i.length;u++)if(!_r(i[u],o[u]))return!1;return!0}function $0(i,o,u,p,v,w){return ui=w,ot=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,ee.H=i===null||i.memoizedState===null?px:gx,ts=!1,w=u(p,v),ts=!1,Ys&&(w=Ig(o,u,p,v)),Fg(i),w}function Fg(i){ee.H=Tu;var o=Lt!==null&&Lt.next!==null;if(ui=0,gn=Lt=ot=null,mu=!1,Tl=0,Js=null,o)throw Error(r(300));i===null||kn||(i=i.dependencies,i!==null&&lu(i)&&(kn=!0))}function Ig(i,o,u,p){ot=i;var v=0;do{if(Ys&&(Js=null),Tl=0,Ys=!1,25<=v)throw Error(r(301));if(v+=1,gn=Lt=null,i.updateQueue!=null){var w=i.updateQueue;w.lastEffect=null,w.events=null,w.stores=null,w.memoCache!=null&&(w.memoCache.index=0)}ee.H=JE,w=o(u,p)}while(Ys);return w}function zE(){var i=ee.H,o=i.useState()[0];return o=typeof o.then=="function"?wl(o):o,i=i.useState()[0],(Lt!==null?Lt.memoizedState:null)!==i&&(ot.flags|=1024),o}function W0(){var i=pu!==0;return pu=0,i}function Y0(i,o,u){o.updateQueue=i.updateQueue,o.flags&=-2053,i.lanes&=~u}function J0(i){if(mu){for(i=i.memoizedState;i!==null;){var o=i.queue;o!==null&&(o.pending=null),i=i.next}mu=!1}ui=0,gn=Lt=ot=null,Ys=!1,Tl=pu=0,Js=null}function dr(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return gn===null?ot.memoizedState=gn=i:gn=gn.next=i,gn}function xn(){if(Lt===null){var i=ot.alternate;i=i!==null?i.memoizedState:null}else i=Lt.next;var o=gn===null?ot.memoizedState:gn.next;if(o!==null)gn=o,Lt=i;else{if(i===null)throw ot.alternate===null?Error(r(467)):Error(r(310));Lt=i,i={memoizedState:Lt.memoizedState,baseState:Lt.baseState,baseQueue:Lt.baseQueue,queue:Lt.queue,next:null},gn===null?ot.memoizedState=gn=i:gn=gn.next=i}return gn}function X0(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function wl(i){var o=Tl;return Tl+=1,Js===null&&(Js=[]),i=Ag(Js,i,o),o=ot,(gn===null?o.memoizedState:gn.next)===null&&(o=o.alternate,ee.H=o===null||o.memoizedState===null?px:gx),i}function gu(i){if(i!==null&&typeof i=="object"){if(typeof i.then=="function")return wl(i);if(i.$$typeof===b)return Wn(i)}throw Error(r(438,String(i)))}function K0(i){var o=null,u=ot.updateQueue;if(u!==null&&(o=u.memoCache),o==null){var p=ot.alternate;p!==null&&(p=p.updateQueue,p!==null&&(p=p.memoCache,p!=null&&(o={data:p.data.map(function(v){return v.slice()}),index:0})))}if(o==null&&(o={data:[],index:0}),u===null&&(u=X0(),ot.updateQueue=u),u.memoCache=o,u=o.data[o.index],u===void 0)for(u=o.data[o.index]=Array(i),p=0;p<i;p++)u[p]=te;return o.index++,u}function Pa(i,o){return typeof o=="function"?o(i):o}function xu(i){var o=xn();return Z0(o,Lt,i)}function Z0(i,o,u){var p=i.queue;if(p===null)throw Error(r(311));p.lastRenderedReducer=u;var v=i.baseQueue,w=p.pending;if(w!==null){if(v!==null){var A=v.next;v.next=w.next,w.next=A}o.baseQueue=v=w,p.pending=null}if(w=i.baseState,v===null)i.memoizedState=w;else{o=v.next;var R=A=null,J=null,oe=o,ve=!1;do{var we=oe.lane&-536870913;if(we!==oe.lane?(pt&we)===we:(ui&we)===we){var fe=oe.revertLane;if(fe===0)J!==null&&(J=J.next={lane:0,revertLane:0,action:oe.action,hasEagerState:oe.hasEagerState,eagerState:oe.eagerState,next:null}),we===js&&(ve=!0);else if((ui&fe)===fe){oe=oe.next,fe===js&&(ve=!0);continue}else we={lane:0,revertLane:oe.revertLane,action:oe.action,hasEagerState:oe.hasEagerState,eagerState:oe.eagerState,next:null},J===null?(R=J=we,A=w):J=J.next=we,ot.lanes|=fe,xi|=fe;we=oe.action,ts&&u(w,we),w=oe.hasEagerState?oe.eagerState:u(w,we)}else fe={lane:we,revertLane:oe.revertLane,action:oe.action,hasEagerState:oe.hasEagerState,eagerState:oe.eagerState,next:null},J===null?(R=J=fe,A=w):J=J.next=fe,ot.lanes|=we,xi|=we;oe=oe.next}while(oe!==null&&oe!==o);if(J===null?A=w:J.next=R,!_r(w,i.memoizedState)&&(kn=!0,ve&&(u=$s,u!==null)))throw u;i.memoizedState=w,i.baseState=A,i.baseQueue=J,p.lastRenderedState=w}return v===null&&(p.lanes=0),[i.memoizedState,p.dispatch]}function Q0(i){var o=xn(),u=o.queue;if(u===null)throw Error(r(311));u.lastRenderedReducer=i;var p=u.dispatch,v=u.pending,w=o.memoizedState;if(v!==null){u.pending=null;var A=v=v.next;do w=i(w,A.action),A=A.next;while(A!==v);_r(w,o.memoizedState)||(kn=!0),o.memoizedState=w,o.baseQueue===null&&(o.baseState=w),u.lastRenderedState=w}return[w,p]}function Pg(i,o,u){var p=ot,v=xn(),w=Ct;if(w){if(u===void 0)throw Error(r(407));u=u()}else u=o();var A=!_r((Lt||v).memoizedState,u);A&&(v.memoizedState=u,kn=!0),v=v.queue;var R=Ug.bind(null,p,v,i);if(Sl(2048,8,R,[i]),v.getSnapshot!==o||A||gn!==null&&gn.memoizedState.tag&1){if(p.flags|=2048,Xs(9,vu(),Og.bind(null,p,v,u,o),null),$t===null)throw Error(r(349));w||(ui&124)!==0||Lg(p,o,u)}return u}function Lg(i,o,u){i.flags|=16384,i={getSnapshot:o,value:u},o=ot.updateQueue,o===null?(o=X0(),ot.updateQueue=o,o.stores=[i]):(u=o.stores,u===null?o.stores=[i]:u.push(i))}function Og(i,o,u,p){o.value=u,o.getSnapshot=p,Bg(o)&&Vg(i)}function Ug(i,o,u){return u(function(){Bg(o)&&Vg(i)})}function Bg(i){var o=i.getSnapshot;i=i.value;try{var u=o();return!_r(i,u)}catch{return!0}}function Vg(i){var o=Gs(i,2);o!==null&&br(o,i,2)}function ed(i){var o=dr();if(typeof i=="function"){var u=i;if(i=u(),ts){Ht(!0);try{u()}finally{Ht(!1)}}}return o.memoizedState=o.baseState=i,o.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Pa,lastRenderedState:i},o}function Gg(i,o,u,p){return i.baseState=u,Z0(i,Lt,typeof p=="function"?p:Pa)}function qE(i,o,u,p,v){if(_u(i))throw Error(r(485));if(i=o.action,i!==null){var w={payload:v,action:i,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(A){w.listeners.push(A)}};ee.T!==null?u(!0):w.isTransition=!1,p(w),u=o.pending,u===null?(w.next=o.pending=w,Hg(o,w)):(w.next=u.next,o.pending=u.next=w)}}function Hg(i,o){var u=o.action,p=o.payload,v=i.state;if(o.isTransition){var w=ee.T,A={};ee.T=A;try{var R=u(v,p),J=ee.S;J!==null&&J(A,R),zg(i,o,R)}catch(oe){td(i,o,oe)}finally{ee.T=w}}else try{w=u(v,p),zg(i,o,w)}catch(oe){td(i,o,oe)}}function zg(i,o,u){u!==null&&typeof u=="object"&&typeof u.then=="function"?u.then(function(p){qg(i,o,p)},function(p){return td(i,o,p)}):qg(i,o,u)}function qg(i,o,u){o.status="fulfilled",o.value=u,jg(o),i.state=u,o=i.pending,o!==null&&(u=o.next,u===o?i.pending=null:(u=u.next,o.next=u,Hg(i,u)))}function td(i,o,u){var p=i.pending;if(i.pending=null,p!==null){p=p.next;do o.status="rejected",o.reason=u,jg(o),o=o.next;while(o!==p)}i.action=null}function jg(i){i=i.listeners;for(var o=0;o<i.length;o++)(0,i[o])()}function $g(i,o){return o}function Wg(i,o){if(Ct){var u=$t.formState;if(u!==null){e:{var p=ot;if(Ct){if(rn){t:{for(var v=rn,w=ga;v.nodeType!==8;){if(!w){v=null;break t}if(v=aa(v.nextSibling),v===null){v=null;break t}}w=v.data,v=w==="F!"||w==="F"?v:null}if(v){rn=aa(v.nextSibling),p=v.data==="F!";break e}}Ki(p)}p=!1}p&&(o=u[0])}}return u=dr(),u.memoizedState=u.baseState=o,p={pending:null,lanes:0,dispatch:null,lastRenderedReducer:$g,lastRenderedState:o},u.queue=p,u=dx.bind(null,ot,p),p.dispatch=u,p=ed(!1),w=sd.bind(null,ot,!1,p.queue),p=dr(),v={state:o,dispatch:null,action:i,pending:null},p.queue=v,u=qE.bind(null,ot,v,w,u),v.dispatch=u,p.memoizedState=i,[o,u,!1]}function Yg(i){var o=xn();return Jg(o,Lt,i)}function Jg(i,o,u){if(o=Z0(i,o,$g)[0],i=xu(Pa)[0],typeof o=="object"&&o!==null&&typeof o.then=="function")try{var p=wl(o)}catch(A){throw A===gl?fu:A}else p=o;o=xn();var v=o.queue,w=v.dispatch;return u!==o.memoizedState&&(ot.flags|=2048,Xs(9,vu(),jE.bind(null,v,u),null)),[p,w,i]}function jE(i,o){i.action=o}function Xg(i){var o=xn(),u=Lt;if(u!==null)return Jg(o,u,i);xn(),o=o.memoizedState,u=xn();var p=u.queue.dispatch;return u.memoizedState=i,[o,p,!1]}function Xs(i,o,u,p){return i={tag:i,create:u,deps:p,inst:o,next:null},o=ot.updateQueue,o===null&&(o=X0(),ot.updateQueue=o),u=o.lastEffect,u===null?o.lastEffect=i.next=i:(p=u.next,u.next=i,i.next=p,o.lastEffect=i),i}function vu(){return{destroy:void 0,resource:void 0}}function Kg(){return xn().memoizedState}function yu(i,o,u,p){var v=dr();p=p===void 0?null:p,ot.flags|=i,v.memoizedState=Xs(1|o,vu(),u,p)}function Sl(i,o,u,p){var v=xn();p=p===void 0?null:p;var w=v.memoizedState.inst;Lt!==null&&p!==null&&j0(p,Lt.memoizedState.deps)?v.memoizedState=Xs(o,w,u,p):(ot.flags|=i,v.memoizedState=Xs(1|o,w,u,p))}function Zg(i,o){yu(8390656,8,i,o)}function Qg(i,o){Sl(2048,8,i,o)}function ex(i,o){return Sl(4,2,i,o)}function tx(i,o){return Sl(4,4,i,o)}function nx(i,o){if(typeof o=="function"){i=i();var u=o(i);return function(){typeof u=="function"?u():o(null)}}if(o!=null)return i=i(),o.current=i,function(){o.current=null}}function rx(i,o,u){u=u!=null?u.concat([i]):null,Sl(4,4,nx.bind(null,o,i),u)}function nd(){}function ax(i,o){var u=xn();o=o===void 0?null:o;var p=u.memoizedState;return o!==null&&j0(o,p[1])?p[0]:(u.memoizedState=[i,o],i)}function ix(i,o){var u=xn();o=o===void 0?null:o;var p=u.memoizedState;if(o!==null&&j0(o,p[1]))return p[0];if(p=i(),ts){Ht(!0);try{i()}finally{Ht(!1)}}return u.memoizedState=[p,o],p}function rd(i,o,u){return u===void 0||(ui&1073741824)!==0?i.memoizedState=o:(i.memoizedState=u,i=l1(),ot.lanes|=i,xi|=i,u)}function sx(i,o,u,p){return _r(u,o)?u:Ws.current!==null?(i=rd(i,u,p),_r(i,o)||(kn=!0),i):(ui&42)===0?(kn=!0,i.memoizedState=u):(i=l1(),ot.lanes|=i,xi|=i,o)}function ox(i,o,u,p,v){var w=me.p;me.p=w!==0&&8>w?w:8;var A=ee.T,R={};ee.T=R,sd(i,!1,o,u);try{var J=v(),oe=ee.S;if(oe!==null&&oe(R,J),J!==null&&typeof J=="object"&&typeof J.then=="function"){var ve=GE(J,p);El(i,o,ve,Cr(i))}else El(i,o,p,Cr(i))}catch(we){El(i,o,{then:function(){},status:"rejected",reason:we},Cr())}finally{me.p=w,ee.T=A}}function $E(){}function ad(i,o,u,p){if(i.tag!==5)throw Error(r(476));var v=lx(i).queue;ox(i,v,o,Pe,u===null?$E:function(){return cx(i),u(p)})}function lx(i){var o=i.memoizedState;if(o!==null)return o;o={memoizedState:Pe,baseState:Pe,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Pa,lastRenderedState:Pe},next:null};var u={};return o.next={memoizedState:u,baseState:u,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Pa,lastRenderedState:u},next:null},i.memoizedState=o,i=i.alternate,i!==null&&(i.memoizedState=o),o}function cx(i){var o=lx(i).next.queue;El(i,o,{},Cr())}function id(){return Wn(Hl)}function ux(){return xn().memoizedState}function fx(){return xn().memoizedState}function WE(i){for(var o=i.return;o!==null;){switch(o.tag){case 24:case 3:var u=Cr();i=li(u);var p=ci(o,i,u);p!==null&&(br(p,o,u),vl(p,o,u)),o={cache:P0()},i.payload=o;return}o=o.return}}function YE(i,o,u){var p=Cr();u={lane:p,revertLane:0,action:u,hasEagerState:!1,eagerState:null,next:null},_u(i)?hx(o,u):(u=C0(i,o,u,p),u!==null&&(br(u,i,p),mx(u,o,p)))}function dx(i,o,u){var p=Cr();El(i,o,u,p)}function El(i,o,u,p){var v={lane:p,revertLane:0,action:u,hasEagerState:!1,eagerState:null,next:null};if(_u(i))hx(o,v);else{var w=i.alternate;if(i.lanes===0&&(w===null||w.lanes===0)&&(w=o.lastRenderedReducer,w!==null))try{var A=o.lastRenderedState,R=w(A,u);if(v.hasEagerState=!0,v.eagerState=R,_r(R,A))return ru(i,o,v,0),$t===null&&nu(),!1}catch{}finally{}if(u=C0(i,o,v,p),u!==null)return br(u,i,p),mx(u,o,p),!0}return!1}function sd(i,o,u,p){if(p={lane:2,revertLane:Ud(),action:p,hasEagerState:!1,eagerState:null,next:null},_u(i)){if(o)throw Error(r(479))}else o=C0(i,u,p,2),o!==null&&br(o,i,2)}function _u(i){var o=i.alternate;return i===ot||o!==null&&o===ot}function hx(i,o){Ys=mu=!0;var u=i.pending;u===null?o.next=o:(o.next=u.next,u.next=o),i.pending=o}function mx(i,o,u){if((u&4194048)!==0){var p=o.lanes;p&=i.pendingLanes,u|=p,o.lanes=u,ft(i,u)}}var Tu={readContext:Wn,use:gu,useCallback:un,useContext:un,useEffect:un,useImperativeHandle:un,useLayoutEffect:un,useInsertionEffect:un,useMemo:un,useReducer:un,useRef:un,useState:un,useDebugValue:un,useDeferredValue:un,useTransition:un,useSyncExternalStore:un,useId:un,useHostTransitionStatus:un,useFormState:un,useActionState:un,useOptimistic:un,useMemoCache:un,useCacheRefresh:un},px={readContext:Wn,use:gu,useCallback:function(i,o){return dr().memoizedState=[i,o===void 0?null:o],i},useContext:Wn,useEffect:Zg,useImperativeHandle:function(i,o,u){u=u!=null?u.concat([i]):null,yu(4194308,4,nx.bind(null,o,i),u)},useLayoutEffect:function(i,o){return yu(4194308,4,i,o)},useInsertionEffect:function(i,o){yu(4,2,i,o)},useMemo:function(i,o){var u=dr();o=o===void 0?null:o;var p=i();if(ts){Ht(!0);try{i()}finally{Ht(!1)}}return u.memoizedState=[p,o],p},useReducer:function(i,o,u){var p=dr();if(u!==void 0){var v=u(o);if(ts){Ht(!0);try{u(o)}finally{Ht(!1)}}}else v=o;return p.memoizedState=p.baseState=v,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:v},p.queue=i,i=i.dispatch=YE.bind(null,ot,i),[p.memoizedState,i]},useRef:function(i){var o=dr();return i={current:i},o.memoizedState=i},useState:function(i){i=ed(i);var o=i.queue,u=dx.bind(null,ot,o);return o.dispatch=u,[i.memoizedState,u]},useDebugValue:nd,useDeferredValue:function(i,o){var u=dr();return rd(u,i,o)},useTransition:function(){var i=ed(!1);return i=ox.bind(null,ot,i.queue,!0,!1),dr().memoizedState=i,[!1,i]},useSyncExternalStore:function(i,o,u){var p=ot,v=dr();if(Ct){if(u===void 0)throw Error(r(407));u=u()}else{if(u=o(),$t===null)throw Error(r(349));(pt&124)!==0||Lg(p,o,u)}v.memoizedState=u;var w={value:u,getSnapshot:o};return v.queue=w,Zg(Ug.bind(null,p,w,i),[i]),p.flags|=2048,Xs(9,vu(),Og.bind(null,p,w,u,o),null),u},useId:function(){var i=dr(),o=$t.identifierPrefix;if(Ct){var u=Ra,p=Da;u=(p&~(1<<32-zt(p)-1)).toString(32)+u,o=""+o+"R"+u,u=pu++,0<u&&(o+="H"+u.toString(32)),o+=""}else u=HE++,o=""+o+"r"+u.toString(32)+"";return i.memoizedState=o},useHostTransitionStatus:id,useFormState:Wg,useActionState:Wg,useOptimistic:function(i){var o=dr();o.memoizedState=o.baseState=i;var u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return o.queue=u,o=sd.bind(null,ot,!0,u),u.dispatch=o,[i,o]},useMemoCache:K0,useCacheRefresh:function(){return dr().memoizedState=WE.bind(null,ot)}},gx={readContext:Wn,use:gu,useCallback:ax,useContext:Wn,useEffect:Qg,useImperativeHandle:rx,useInsertionEffect:ex,useLayoutEffect:tx,useMemo:ix,useReducer:xu,useRef:Kg,useState:function(){return xu(Pa)},useDebugValue:nd,useDeferredValue:function(i,o){var u=xn();return sx(u,Lt.memoizedState,i,o)},useTransition:function(){var i=xu(Pa)[0],o=xn().memoizedState;return[typeof i=="boolean"?i:wl(i),o]},useSyncExternalStore:Pg,useId:ux,useHostTransitionStatus:id,useFormState:Yg,useActionState:Yg,useOptimistic:function(i,o){var u=xn();return Gg(u,Lt,i,o)},useMemoCache:K0,useCacheRefresh:fx},JE={readContext:Wn,use:gu,useCallback:ax,useContext:Wn,useEffect:Qg,useImperativeHandle:rx,useInsertionEffect:ex,useLayoutEffect:tx,useMemo:ix,useReducer:Q0,useRef:Kg,useState:function(){return Q0(Pa)},useDebugValue:nd,useDeferredValue:function(i,o){var u=xn();return Lt===null?rd(u,i,o):sx(u,Lt.memoizedState,i,o)},useTransition:function(){var i=Q0(Pa)[0],o=xn().memoizedState;return[typeof i=="boolean"?i:wl(i),o]},useSyncExternalStore:Pg,useId:ux,useHostTransitionStatus:id,useFormState:Xg,useActionState:Xg,useOptimistic:function(i,o){var u=xn();return Lt!==null?Gg(u,Lt,i,o):(u.baseState=i,[i,u.queue.dispatch])},useMemoCache:K0,useCacheRefresh:fx},Ks=null,Cl=0;function wu(i){var o=Cl;return Cl+=1,Ks===null&&(Ks=[]),Ag(Ks,i,o)}function bl(i,o){o=o.props.ref,i.ref=o!==void 0?o:null}function Su(i,o){throw o.$$typeof===x?Error(r(525)):(i=Object.prototype.toString.call(o),Error(r(31,i==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":i)))}function xx(i){var o=i._init;return o(i._payload)}function vx(i){function o(ne,Q){if(i){var se=ne.deletions;se===null?(ne.deletions=[Q],ne.flags|=16):se.push(Q)}}function u(ne,Q){if(!i)return null;for(;Q!==null;)o(ne,Q),Q=Q.sibling;return null}function p(ne){for(var Q=new Map;ne!==null;)ne.key!==null?Q.set(ne.key,ne):Q.set(ne.index,ne),ne=ne.sibling;return Q}function v(ne,Q){return ne=Ma(ne,Q),ne.index=0,ne.sibling=null,ne}function w(ne,Q,se){return ne.index=se,i?(se=ne.alternate,se!==null?(se=se.index,se<Q?(ne.flags|=67108866,Q):se):(ne.flags|=67108866,Q)):(ne.flags|=1048576,Q)}function A(ne){return i&&ne.alternate===null&&(ne.flags|=67108866),ne}function R(ne,Q,se,_e){return Q===null||Q.tag!==6?(Q=A0(se,ne.mode,_e),Q.return=ne,Q):(Q=v(Q,se),Q.return=ne,Q)}function J(ne,Q,se,_e){var Ve=se.type;return Ve===E?ve(ne,Q,se.props.children,_e,se.key):Q!==null&&(Q.elementType===Ve||typeof Ve=="object"&&Ve!==null&&Ve.$$typeof===j&&xx(Ve)===Q.type)?(Q=v(Q,se.props),bl(Q,se),Q.return=ne,Q):(Q=iu(se.type,se.key,se.props,null,ne.mode,_e),bl(Q,se),Q.return=ne,Q)}function oe(ne,Q,se,_e){return Q===null||Q.tag!==4||Q.stateNode.containerInfo!==se.containerInfo||Q.stateNode.implementation!==se.implementation?(Q=k0(se,ne.mode,_e),Q.return=ne,Q):(Q=v(Q,se.children||[]),Q.return=ne,Q)}function ve(ne,Q,se,_e,Ve){return Q===null||Q.tag!==7?(Q=Wi(se,ne.mode,_e,Ve),Q.return=ne,Q):(Q=v(Q,se),Q.return=ne,Q)}function we(ne,Q,se){if(typeof Q=="string"&&Q!==""||typeof Q=="number"||typeof Q=="bigint")return Q=A0(""+Q,ne.mode,se),Q.return=ne,Q;if(typeof Q=="object"&&Q!==null){switch(Q.$$typeof){case _:return se=iu(Q.type,Q.key,Q.props,null,ne.mode,se),bl(se,Q),se.return=ne,se;case T:return Q=k0(Q,ne.mode,se),Q.return=ne,Q;case j:var _e=Q._init;return Q=_e(Q._payload),we(ne,Q,se)}if(Se(Q)||Z(Q))return Q=Wi(Q,ne.mode,se,null),Q.return=ne,Q;if(typeof Q.then=="function")return we(ne,wu(Q),se);if(Q.$$typeof===b)return we(ne,cu(ne,Q),se);Su(ne,Q)}return null}function fe(ne,Q,se,_e){var Ve=Q!==null?Q.key:null;if(typeof se=="string"&&se!==""||typeof se=="number"||typeof se=="bigint")return Ve!==null?null:R(ne,Q,""+se,_e);if(typeof se=="object"&&se!==null){switch(se.$$typeof){case _:return se.key===Ve?J(ne,Q,se,_e):null;case T:return se.key===Ve?oe(ne,Q,se,_e):null;case j:return Ve=se._init,se=Ve(se._payload),fe(ne,Q,se,_e)}if(Se(se)||Z(se))return Ve!==null?null:ve(ne,Q,se,_e,null);if(typeof se.then=="function")return fe(ne,Q,wu(se),_e);if(se.$$typeof===b)return fe(ne,Q,cu(ne,se),_e);Su(ne,se)}return null}function he(ne,Q,se,_e,Ve){if(typeof _e=="string"&&_e!==""||typeof _e=="number"||typeof _e=="bigint")return ne=ne.get(se)||null,R(Q,ne,""+_e,Ve);if(typeof _e=="object"&&_e!==null){switch(_e.$$typeof){case _:return ne=ne.get(_e.key===null?se:_e.key)||null,J(Q,ne,_e,Ve);case T:return ne=ne.get(_e.key===null?se:_e.key)||null,oe(Q,ne,_e,Ve);case j:var ct=_e._init;return _e=ct(_e._payload),he(ne,Q,se,_e,Ve)}if(Se(_e)||Z(_e))return ne=ne.get(se)||null,ve(Q,ne,_e,Ve,null);if(typeof _e.then=="function")return he(ne,Q,se,wu(_e),Ve);if(_e.$$typeof===b)return he(ne,Q,se,cu(Q,_e),Ve);Su(Q,_e)}return null}function Ke(ne,Q,se,_e){for(var Ve=null,ct=null,He=Q,We=Q=0,Mn=null;He!==null&&We<se.length;We++){He.index>We?(Mn=He,He=null):Mn=He.sibling;var Tt=fe(ne,He,se[We],_e);if(Tt===null){He===null&&(He=Mn);break}i&&He&&Tt.alternate===null&&o(ne,He),Q=w(Tt,Q,We),ct===null?Ve=Tt:ct.sibling=Tt,ct=Tt,He=Mn}if(We===se.length)return u(ne,He),Ct&&Ji(ne,We),Ve;if(He===null){for(;We<se.length;We++)He=we(ne,se[We],_e),He!==null&&(Q=w(He,Q,We),ct===null?Ve=He:ct.sibling=He,ct=He);return Ct&&Ji(ne,We),Ve}for(He=p(He);We<se.length;We++)Mn=he(He,ne,We,se[We],_e),Mn!==null&&(i&&Mn.alternate!==null&&He.delete(Mn.key===null?We:Mn.key),Q=w(Mn,Q,We),ct===null?Ve=Mn:ct.sibling=Mn,ct=Mn);return i&&He.forEach(function(bi){return o(ne,bi)}),Ct&&Ji(ne,We),Ve}function je(ne,Q,se,_e){if(se==null)throw Error(r(151));for(var Ve=null,ct=null,He=Q,We=Q=0,Mn=null,Tt=se.next();He!==null&&!Tt.done;We++,Tt=se.next()){He.index>We?(Mn=He,He=null):Mn=He.sibling;var bi=fe(ne,He,Tt.value,_e);if(bi===null){He===null&&(He=Mn);break}i&&He&&bi.alternate===null&&o(ne,He),Q=w(bi,Q,We),ct===null?Ve=bi:ct.sibling=bi,ct=bi,He=Mn}if(Tt.done)return u(ne,He),Ct&&Ji(ne,We),Ve;if(He===null){for(;!Tt.done;We++,Tt=se.next())Tt=we(ne,Tt.value,_e),Tt!==null&&(Q=w(Tt,Q,We),ct===null?Ve=Tt:ct.sibling=Tt,ct=Tt);return Ct&&Ji(ne,We),Ve}for(He=p(He);!Tt.done;We++,Tt=se.next())Tt=he(He,ne,We,Tt.value,_e),Tt!==null&&(i&&Tt.alternate!==null&&He.delete(Tt.key===null?We:Tt.key),Q=w(Tt,Q,We),ct===null?Ve=Tt:ct.sibling=Tt,ct=Tt);return i&&He.forEach(function(XC){return o(ne,XC)}),Ct&&Ji(ne,We),Ve}function Ut(ne,Q,se,_e){if(typeof se=="object"&&se!==null&&se.type===E&&se.key===null&&(se=se.props.children),typeof se=="object"&&se!==null){switch(se.$$typeof){case _:e:{for(var Ve=se.key;Q!==null;){if(Q.key===Ve){if(Ve=se.type,Ve===E){if(Q.tag===7){u(ne,Q.sibling),_e=v(Q,se.props.children),_e.return=ne,ne=_e;break e}}else if(Q.elementType===Ve||typeof Ve=="object"&&Ve!==null&&Ve.$$typeof===j&&xx(Ve)===Q.type){u(ne,Q.sibling),_e=v(Q,se.props),bl(_e,se),_e.return=ne,ne=_e;break e}u(ne,Q);break}else o(ne,Q);Q=Q.sibling}se.type===E?(_e=Wi(se.props.children,ne.mode,_e,se.key),_e.return=ne,ne=_e):(_e=iu(se.type,se.key,se.props,null,ne.mode,_e),bl(_e,se),_e.return=ne,ne=_e)}return A(ne);case T:e:{for(Ve=se.key;Q!==null;){if(Q.key===Ve)if(Q.tag===4&&Q.stateNode.containerInfo===se.containerInfo&&Q.stateNode.implementation===se.implementation){u(ne,Q.sibling),_e=v(Q,se.children||[]),_e.return=ne,ne=_e;break e}else{u(ne,Q);break}else o(ne,Q);Q=Q.sibling}_e=k0(se,ne.mode,_e),_e.return=ne,ne=_e}return A(ne);case j:return Ve=se._init,se=Ve(se._payload),Ut(ne,Q,se,_e)}if(Se(se))return Ke(ne,Q,se,_e);if(Z(se)){if(Ve=Z(se),typeof Ve!="function")throw Error(r(150));return se=Ve.call(se),je(ne,Q,se,_e)}if(typeof se.then=="function")return Ut(ne,Q,wu(se),_e);if(se.$$typeof===b)return Ut(ne,Q,cu(ne,se),_e);Su(ne,se)}return typeof se=="string"&&se!==""||typeof se=="number"||typeof se=="bigint"?(se=""+se,Q!==null&&Q.tag===6?(u(ne,Q.sibling),_e=v(Q,se),_e.return=ne,ne=_e):(u(ne,Q),_e=A0(se,ne.mode,_e),_e.return=ne,ne=_e),A(ne)):u(ne,Q)}return function(ne,Q,se,_e){try{Cl=0;var Ve=Ut(ne,Q,se,_e);return Ks=null,Ve}catch(He){if(He===gl||He===fu)throw He;var ct=Tr(29,He,null,ne.mode);return ct.lanes=_e,ct.return=ne,ct}finally{}}}var Zs=vx(!0),yx=vx(!1),Vr=ce(null),xa=null;function fi(i){var o=i.alternate;W(wn,wn.current&1),W(Vr,i),xa===null&&(o===null||Ws.current!==null||o.memoizedState!==null)&&(xa=i)}function _x(i){if(i.tag===22){if(W(wn,wn.current),W(Vr,i),xa===null){var o=i.alternate;o!==null&&o.memoizedState!==null&&(xa=i)}}else di()}function di(){W(wn,wn.current),W(Vr,Vr.current)}function La(i){L(Vr),xa===i&&(xa=null),L(wn)}var wn=ce(0);function Eu(i){for(var o=i;o!==null;){if(o.tag===13){var u=o.memoizedState;if(u!==null&&(u=u.dehydrated,u===null||u.data==="$?"||Xd(u)))return o}else if(o.tag===19&&o.memoizedProps.revealOrder!==void 0){if((o.flags&128)!==0)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===i)break;for(;o.sibling===null;){if(o.return===null||o.return===i)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}function od(i,o,u,p){o=i.memoizedState,u=u(p,o),u=u==null?o:g({},o,u),i.memoizedState=u,i.lanes===0&&(i.updateQueue.baseState=u)}var ld={enqueueSetState:function(i,o,u){i=i._reactInternals;var p=Cr(),v=li(p);v.payload=o,u!=null&&(v.callback=u),o=ci(i,v,p),o!==null&&(br(o,i,p),vl(o,i,p))},enqueueReplaceState:function(i,o,u){i=i._reactInternals;var p=Cr(),v=li(p);v.tag=1,v.payload=o,u!=null&&(v.callback=u),o=ci(i,v,p),o!==null&&(br(o,i,p),vl(o,i,p))},enqueueForceUpdate:function(i,o){i=i._reactInternals;var u=Cr(),p=li(u);p.tag=2,o!=null&&(p.callback=o),o=ci(i,p,u),o!==null&&(br(o,i,u),vl(o,i,u))}};function Tx(i,o,u,p,v,w,A){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(p,w,A):o.prototype&&o.prototype.isPureReactComponent?!ll(u,p)||!ll(v,w):!0}function wx(i,o,u,p){i=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(u,p),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(u,p),o.state!==i&&ld.enqueueReplaceState(o,o.state,null)}function ns(i,o){var u=o;if("ref"in o){u={};for(var p in o)p!=="ref"&&(u[p]=o[p])}if(i=i.defaultProps){u===o&&(u=g({},u));for(var v in i)u[v]===void 0&&(u[v]=i[v])}return u}var Cu=typeof reportError=="function"?reportError:function(i){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var o=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof i=="object"&&i!==null&&typeof i.message=="string"?String(i.message):String(i),error:i});if(!window.dispatchEvent(o))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",i);return}console.error(i)};function Sx(i){Cu(i)}function Ex(i){console.error(i)}function Cx(i){Cu(i)}function bu(i,o){try{var u=i.onUncaughtError;u(o.value,{componentStack:o.stack})}catch(p){setTimeout(function(){throw p})}}function bx(i,o,u){try{var p=i.onCaughtError;p(u.value,{componentStack:u.stack,errorBoundary:o.tag===1?o.stateNode:null})}catch(v){setTimeout(function(){throw v})}}function cd(i,o,u){return u=li(u),u.tag=3,u.payload={element:null},u.callback=function(){bu(i,o)},u}function Ax(i){return i=li(i),i.tag=3,i}function kx(i,o,u,p){var v=u.type.getDerivedStateFromError;if(typeof v=="function"){var w=p.value;i.payload=function(){return v(w)},i.callback=function(){bx(o,u,p)}}var A=u.stateNode;A!==null&&typeof A.componentDidCatch=="function"&&(i.callback=function(){bx(o,u,p),typeof v!="function"&&(vi===null?vi=new Set([this]):vi.add(this));var R=p.stack;this.componentDidCatch(p.value,{componentStack:R!==null?R:""})})}function XE(i,o,u,p,v){if(u.flags|=32768,p!==null&&typeof p=="object"&&typeof p.then=="function"){if(o=u.alternate,o!==null&&hl(o,u,v,!0),u=Vr.current,u!==null){switch(u.tag){case 13:return xa===null?Fd():u.alternate===null&&an===0&&(an=3),u.flags&=-257,u.flags|=65536,u.lanes=v,p===U0?u.flags|=16384:(o=u.updateQueue,o===null?u.updateQueue=new Set([p]):o.add(p),Pd(i,p,v)),!1;case 22:return u.flags|=65536,p===U0?u.flags|=16384:(o=u.updateQueue,o===null?(o={transitions:null,markerInstances:null,retryQueue:new Set([p])},u.updateQueue=o):(u=o.retryQueue,u===null?o.retryQueue=new Set([p]):u.add(p)),Pd(i,p,v)),!1}throw Error(r(435,u.tag))}return Pd(i,p,v),Fd(),!1}if(Ct)return o=Vr.current,o!==null?((o.flags&65536)===0&&(o.flags|=256),o.flags|=65536,o.lanes=v,p!==D0&&(i=Error(r(422),{cause:p}),dl(Lr(i,u)))):(p!==D0&&(o=Error(r(423),{cause:p}),dl(Lr(o,u))),i=i.current.alternate,i.flags|=65536,v&=-v,i.lanes|=v,p=Lr(p,u),v=cd(i.stateNode,p,v),G0(i,v),an!==4&&(an=2)),!1;var w=Error(r(520),{cause:p});if(w=Lr(w,u),Fl===null?Fl=[w]:Fl.push(w),an!==4&&(an=2),o===null)return!0;p=Lr(p,u),u=o;do{switch(u.tag){case 3:return u.flags|=65536,i=v&-v,u.lanes|=i,i=cd(u.stateNode,p,i),G0(u,i),!1;case 1:if(o=u.type,w=u.stateNode,(u.flags&128)===0&&(typeof o.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(vi===null||!vi.has(w))))return u.flags|=65536,v&=-v,u.lanes|=v,v=Ax(v),kx(v,i,u,p),G0(u,v),!1}u=u.return}while(u!==null);return!1}var Nx=Error(r(461)),kn=!1;function Vn(i,o,u,p){o.child=i===null?yx(o,null,u,p):Zs(o,i.child,u,p)}function Mx(i,o,u,p,v){u=u.render;var w=o.ref;if("ref"in p){var A={};for(var R in p)R!=="ref"&&(A[R]=p[R])}else A=p;return Qi(o),p=$0(i,o,u,A,w,v),R=W0(),i!==null&&!kn?(Y0(i,o,v),Oa(i,o,v)):(Ct&&R&&N0(o),o.flags|=1,Vn(i,o,p,v),o.child)}function Dx(i,o,u,p,v){if(i===null){var w=u.type;return typeof w=="function"&&!b0(w)&&w.defaultProps===void 0&&u.compare===null?(o.tag=15,o.type=w,Rx(i,o,w,p,v)):(i=iu(u.type,null,p,o,o.mode,v),i.ref=o.ref,i.return=o,o.child=i)}if(w=i.child,!xd(i,v)){var A=w.memoizedProps;if(u=u.compare,u=u!==null?u:ll,u(A,p)&&i.ref===o.ref)return Oa(i,o,v)}return o.flags|=1,i=Ma(w,p),i.ref=o.ref,i.return=o,o.child=i}function Rx(i,o,u,p,v){if(i!==null){var w=i.memoizedProps;if(ll(w,p)&&i.ref===o.ref)if(kn=!1,o.pendingProps=p=w,xd(i,v))(i.flags&131072)!==0&&(kn=!0);else return o.lanes=i.lanes,Oa(i,o,v)}return ud(i,o,u,p,v)}function Fx(i,o,u){var p=o.pendingProps,v=p.children,w=i!==null?i.memoizedState:null;if(p.mode==="hidden"){if((o.flags&128)!==0){if(p=w!==null?w.baseLanes|u:u,i!==null){for(v=o.child=i.child,w=0;v!==null;)w=w|v.lanes|v.childLanes,v=v.sibling;o.childLanes=w&~p}else o.childLanes=0,o.child=null;return Ix(i,o,p,u)}if((u&536870912)!==0)o.memoizedState={baseLanes:0,cachePool:null},i!==null&&uu(o,w!==null?w.cachePool:null),w!==null?Rg(o,w):z0(),_x(o);else return o.lanes=o.childLanes=536870912,Ix(i,o,w!==null?w.baseLanes|u:u,u)}else w!==null?(uu(o,w.cachePool),Rg(o,w),di(),o.memoizedState=null):(i!==null&&uu(o,null),z0(),di());return Vn(i,o,v,u),o.child}function Ix(i,o,u,p){var v=O0();return v=v===null?null:{parent:Tn._currentValue,pool:v},o.memoizedState={baseLanes:u,cachePool:v},i!==null&&uu(o,null),z0(),_x(o),i!==null&&hl(i,o,p,!0),null}function Au(i,o){var u=o.ref;if(u===null)i!==null&&i.ref!==null&&(o.flags|=4194816);else{if(typeof u!="function"&&typeof u!="object")throw Error(r(284));(i===null||i.ref!==u)&&(o.flags|=4194816)}}function ud(i,o,u,p,v){return Qi(o),u=$0(i,o,u,p,void 0,v),p=W0(),i!==null&&!kn?(Y0(i,o,v),Oa(i,o,v)):(Ct&&p&&N0(o),o.flags|=1,Vn(i,o,u,v),o.child)}function Px(i,o,u,p,v,w){return Qi(o),o.updateQueue=null,u=Ig(o,p,u,v),Fg(i),p=W0(),i!==null&&!kn?(Y0(i,o,w),Oa(i,o,w)):(Ct&&p&&N0(o),o.flags|=1,Vn(i,o,u,w),o.child)}function Lx(i,o,u,p,v){if(Qi(o),o.stateNode===null){var w=Hs,A=u.contextType;typeof A=="object"&&A!==null&&(w=Wn(A)),w=new u(p,w),o.memoizedState=w.state!==null&&w.state!==void 0?w.state:null,w.updater=ld,o.stateNode=w,w._reactInternals=o,w=o.stateNode,w.props=p,w.state=o.memoizedState,w.refs={},B0(o),A=u.contextType,w.context=typeof A=="object"&&A!==null?Wn(A):Hs,w.state=o.memoizedState,A=u.getDerivedStateFromProps,typeof A=="function"&&(od(o,u,A,p),w.state=o.memoizedState),typeof u.getDerivedStateFromProps=="function"||typeof w.getSnapshotBeforeUpdate=="function"||typeof w.UNSAFE_componentWillMount!="function"&&typeof w.componentWillMount!="function"||(A=w.state,typeof w.componentWillMount=="function"&&w.componentWillMount(),typeof w.UNSAFE_componentWillMount=="function"&&w.UNSAFE_componentWillMount(),A!==w.state&&ld.enqueueReplaceState(w,w.state,null),_l(o,p,w,v),yl(),w.state=o.memoizedState),typeof w.componentDidMount=="function"&&(o.flags|=4194308),p=!0}else if(i===null){w=o.stateNode;var R=o.memoizedProps,J=ns(u,R);w.props=J;var oe=w.context,ve=u.contextType;A=Hs,typeof ve=="object"&&ve!==null&&(A=Wn(ve));var we=u.getDerivedStateFromProps;ve=typeof we=="function"||typeof w.getSnapshotBeforeUpdate=="function",R=o.pendingProps!==R,ve||typeof w.UNSAFE_componentWillReceiveProps!="function"&&typeof w.componentWillReceiveProps!="function"||(R||oe!==A)&&wx(o,w,p,A),oi=!1;var fe=o.memoizedState;w.state=fe,_l(o,p,w,v),yl(),oe=o.memoizedState,R||fe!==oe||oi?(typeof we=="function"&&(od(o,u,we,p),oe=o.memoizedState),(J=oi||Tx(o,u,J,p,fe,oe,A))?(ve||typeof w.UNSAFE_componentWillMount!="function"&&typeof w.componentWillMount!="function"||(typeof w.componentWillMount=="function"&&w.componentWillMount(),typeof w.UNSAFE_componentWillMount=="function"&&w.UNSAFE_componentWillMount()),typeof w.componentDidMount=="function"&&(o.flags|=4194308)):(typeof w.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=p,o.memoizedState=oe),w.props=p,w.state=oe,w.context=A,p=J):(typeof w.componentDidMount=="function"&&(o.flags|=4194308),p=!1)}else{w=o.stateNode,V0(i,o),A=o.memoizedProps,ve=ns(u,A),w.props=ve,we=o.pendingProps,fe=w.context,oe=u.contextType,J=Hs,typeof oe=="object"&&oe!==null&&(J=Wn(oe)),R=u.getDerivedStateFromProps,(oe=typeof R=="function"||typeof w.getSnapshotBeforeUpdate=="function")||typeof w.UNSAFE_componentWillReceiveProps!="function"&&typeof w.componentWillReceiveProps!="function"||(A!==we||fe!==J)&&wx(o,w,p,J),oi=!1,fe=o.memoizedState,w.state=fe,_l(o,p,w,v),yl();var he=o.memoizedState;A!==we||fe!==he||oi||i!==null&&i.dependencies!==null&&lu(i.dependencies)?(typeof R=="function"&&(od(o,u,R,p),he=o.memoizedState),(ve=oi||Tx(o,u,ve,p,fe,he,J)||i!==null&&i.dependencies!==null&&lu(i.dependencies))?(oe||typeof w.UNSAFE_componentWillUpdate!="function"&&typeof w.componentWillUpdate!="function"||(typeof w.componentWillUpdate=="function"&&w.componentWillUpdate(p,he,J),typeof w.UNSAFE_componentWillUpdate=="function"&&w.UNSAFE_componentWillUpdate(p,he,J)),typeof w.componentDidUpdate=="function"&&(o.flags|=4),typeof w.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof w.componentDidUpdate!="function"||A===i.memoizedProps&&fe===i.memoizedState||(o.flags|=4),typeof w.getSnapshotBeforeUpdate!="function"||A===i.memoizedProps&&fe===i.memoizedState||(o.flags|=1024),o.memoizedProps=p,o.memoizedState=he),w.props=p,w.state=he,w.context=J,p=ve):(typeof w.componentDidUpdate!="function"||A===i.memoizedProps&&fe===i.memoizedState||(o.flags|=4),typeof w.getSnapshotBeforeUpdate!="function"||A===i.memoizedProps&&fe===i.memoizedState||(o.flags|=1024),p=!1)}return w=p,Au(i,o),p=(o.flags&128)!==0,w||p?(w=o.stateNode,u=p&&typeof u.getDerivedStateFromError!="function"?null:w.render(),o.flags|=1,i!==null&&p?(o.child=Zs(o,i.child,null,v),o.child=Zs(o,null,u,v)):Vn(i,o,u,v),o.memoizedState=w.state,i=o.child):i=Oa(i,o,v),i}function Ox(i,o,u,p){return fl(),o.flags|=256,Vn(i,o,u,p),o.child}var fd={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function dd(i){return{baseLanes:i,cachePool:Eg()}}function hd(i,o,u){return i=i!==null?i.childLanes&~u:0,o&&(i|=Gr),i}function Ux(i,o,u){var p=o.pendingProps,v=!1,w=(o.flags&128)!==0,A;if((A=w)||(A=i!==null&&i.memoizedState===null?!1:(wn.current&2)!==0),A&&(v=!0,o.flags&=-129),A=(o.flags&32)!==0,o.flags&=-33,i===null){if(Ct){if(v?fi(o):di(),Ct){var R=rn,J;if(J=R){e:{for(J=R,R=ga;J.nodeType!==8;){if(!R){R=null;break e}if(J=aa(J.nextSibling),J===null){R=null;break e}}R=J}R!==null?(o.memoizedState={dehydrated:R,treeContext:Yi!==null?{id:Da,overflow:Ra}:null,retryLane:536870912,hydrationErrors:null},J=Tr(18,null,null,0),J.stateNode=R,J.return=o,o.child=J,or=o,rn=null,J=!0):J=!1}J||Ki(o)}if(R=o.memoizedState,R!==null&&(R=R.dehydrated,R!==null))return Xd(R)?o.lanes=32:o.lanes=536870912,null;La(o)}return R=p.children,p=p.fallback,v?(di(),v=o.mode,R=ku({mode:"hidden",children:R},v),p=Wi(p,v,u,null),R.return=o,p.return=o,R.sibling=p,o.child=R,v=o.child,v.memoizedState=dd(u),v.childLanes=hd(i,A,u),o.memoizedState=fd,p):(fi(o),md(o,R))}if(J=i.memoizedState,J!==null&&(R=J.dehydrated,R!==null)){if(w)o.flags&256?(fi(o),o.flags&=-257,o=pd(i,o,u)):o.memoizedState!==null?(di(),o.child=i.child,o.flags|=128,o=null):(di(),v=p.fallback,R=o.mode,p=ku({mode:"visible",children:p.children},R),v=Wi(v,R,u,null),v.flags|=2,p.return=o,v.return=o,p.sibling=v,o.child=p,Zs(o,i.child,null,u),p=o.child,p.memoizedState=dd(u),p.childLanes=hd(i,A,u),o.memoizedState=fd,o=v);else if(fi(o),Xd(R)){if(A=R.nextSibling&&R.nextSibling.dataset,A)var oe=A.dgst;A=oe,p=Error(r(419)),p.stack="",p.digest=A,dl({value:p,source:null,stack:null}),o=pd(i,o,u)}else if(kn||hl(i,o,u,!1),A=(u&i.childLanes)!==0,kn||A){if(A=$t,A!==null&&(p=u&-u,p=(p&42)!==0?1:Hi(p),p=(p&(A.suspendedLanes|u))!==0?0:p,p!==0&&p!==J.retryLane))throw J.retryLane=p,Gs(i,p),br(A,i,p),Nx;R.data==="$?"||Fd(),o=pd(i,o,u)}else R.data==="$?"?(o.flags|=192,o.child=i.child,o=null):(i=J.treeContext,rn=aa(R.nextSibling),or=o,Ct=!0,Xi=null,ga=!1,i!==null&&(Ur[Br++]=Da,Ur[Br++]=Ra,Ur[Br++]=Yi,Da=i.id,Ra=i.overflow,Yi=o),o=md(o,p.children),o.flags|=4096);return o}return v?(di(),v=p.fallback,R=o.mode,J=i.child,oe=J.sibling,p=Ma(J,{mode:"hidden",children:p.children}),p.subtreeFlags=J.subtreeFlags&65011712,oe!==null?v=Ma(oe,v):(v=Wi(v,R,u,null),v.flags|=2),v.return=o,p.return=o,p.sibling=v,o.child=p,p=v,v=o.child,R=i.child.memoizedState,R===null?R=dd(u):(J=R.cachePool,J!==null?(oe=Tn._currentValue,J=J.parent!==oe?{parent:oe,pool:oe}:J):J=Eg(),R={baseLanes:R.baseLanes|u,cachePool:J}),v.memoizedState=R,v.childLanes=hd(i,A,u),o.memoizedState=fd,p):(fi(o),u=i.child,i=u.sibling,u=Ma(u,{mode:"visible",children:p.children}),u.return=o,u.sibling=null,i!==null&&(A=o.deletions,A===null?(o.deletions=[i],o.flags|=16):A.push(i)),o.child=u,o.memoizedState=null,u)}function md(i,o){return o=ku({mode:"visible",children:o},i.mode),o.return=i,i.child=o}function ku(i,o){return i=Tr(22,i,null,o),i.lanes=0,i.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},i}function pd(i,o,u){return Zs(o,i.child,null,u),i=md(o,o.pendingProps.children),i.flags|=2,o.memoizedState=null,i}function Bx(i,o,u){i.lanes|=o;var p=i.alternate;p!==null&&(p.lanes|=o),F0(i.return,o,u)}function gd(i,o,u,p,v){var w=i.memoizedState;w===null?i.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:p,tail:u,tailMode:v}:(w.isBackwards=o,w.rendering=null,w.renderingStartTime=0,w.last=p,w.tail=u,w.tailMode=v)}function Vx(i,o,u){var p=o.pendingProps,v=p.revealOrder,w=p.tail;if(Vn(i,o,p.children,u),p=wn.current,(p&2)!==0)p=p&1|2,o.flags|=128;else{if(i!==null&&(i.flags&128)!==0)e:for(i=o.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&Bx(i,u,o);else if(i.tag===19)Bx(i,u,o);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===o)break e;for(;i.sibling===null;){if(i.return===null||i.return===o)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}p&=1}switch(W(wn,p),v){case"forwards":for(u=o.child,v=null;u!==null;)i=u.alternate,i!==null&&Eu(i)===null&&(v=u),u=u.sibling;u=v,u===null?(v=o.child,o.child=null):(v=u.sibling,u.sibling=null),gd(o,!1,v,u,w);break;case"backwards":for(u=null,v=o.child,o.child=null;v!==null;){if(i=v.alternate,i!==null&&Eu(i)===null){o.child=v;break}i=v.sibling,v.sibling=u,u=v,v=i}gd(o,!0,u,null,w);break;case"together":gd(o,!1,null,null,void 0);break;default:o.memoizedState=null}return o.child}function Oa(i,o,u){if(i!==null&&(o.dependencies=i.dependencies),xi|=o.lanes,(u&o.childLanes)===0)if(i!==null){if(hl(i,o,u,!1),(u&o.childLanes)===0)return null}else return null;if(i!==null&&o.child!==i.child)throw Error(r(153));if(o.child!==null){for(i=o.child,u=Ma(i,i.pendingProps),o.child=u,u.return=o;i.sibling!==null;)i=i.sibling,u=u.sibling=Ma(i,i.pendingProps),u.return=o;u.sibling=null}return o.child}function xd(i,o){return(i.lanes&o)!==0?!0:(i=i.dependencies,!!(i!==null&&lu(i)))}function KE(i,o,u){switch(o.tag){case 3:Te(o,o.stateNode.containerInfo),si(o,Tn,i.memoizedState.cache),fl();break;case 27:case 5:Ae(o);break;case 4:Te(o,o.stateNode.containerInfo);break;case 10:si(o,o.type,o.memoizedProps.value);break;case 13:var p=o.memoizedState;if(p!==null)return p.dehydrated!==null?(fi(o),o.flags|=128,null):(u&o.child.childLanes)!==0?Ux(i,o,u):(fi(o),i=Oa(i,o,u),i!==null?i.sibling:null);fi(o);break;case 19:var v=(i.flags&128)!==0;if(p=(u&o.childLanes)!==0,p||(hl(i,o,u,!1),p=(u&o.childLanes)!==0),v){if(p)return Vx(i,o,u);o.flags|=128}if(v=o.memoizedState,v!==null&&(v.rendering=null,v.tail=null,v.lastEffect=null),W(wn,wn.current),p)break;return null;case 22:case 23:return o.lanes=0,Fx(i,o,u);case 24:si(o,Tn,i.memoizedState.cache)}return Oa(i,o,u)}function Gx(i,o,u){if(i!==null)if(i.memoizedProps!==o.pendingProps)kn=!0;else{if(!xd(i,u)&&(o.flags&128)===0)return kn=!1,KE(i,o,u);kn=(i.flags&131072)!==0}else kn=!1,Ct&&(o.flags&1048576)!==0&&xg(o,ou,o.index);switch(o.lanes=0,o.tag){case 16:e:{i=o.pendingProps;var p=o.elementType,v=p._init;if(p=v(p._payload),o.type=p,typeof p=="function")b0(p)?(i=ns(p,i),o.tag=1,o=Lx(null,o,p,i,u)):(o.tag=0,o=ud(null,o,p,i,u));else{if(p!=null){if(v=p.$$typeof,v===I){o.tag=11,o=Mx(null,o,p,i,u);break e}else if(v===D){o.tag=14,o=Dx(null,o,p,i,u);break e}}throw o=Me(p)||p,Error(r(306,o,""))}}return o;case 0:return ud(i,o,o.type,o.pendingProps,u);case 1:return p=o.type,v=ns(p,o.pendingProps),Lx(i,o,p,v,u);case 3:e:{if(Te(o,o.stateNode.containerInfo),i===null)throw Error(r(387));p=o.pendingProps;var w=o.memoizedState;v=w.element,V0(i,o),_l(o,p,null,u);var A=o.memoizedState;if(p=A.cache,si(o,Tn,p),p!==w.cache&&I0(o,[Tn],u,!0),yl(),p=A.element,w.isDehydrated)if(w={element:p,isDehydrated:!1,cache:A.cache},o.updateQueue.baseState=w,o.memoizedState=w,o.flags&256){o=Ox(i,o,p,u);break e}else if(p!==v){v=Lr(Error(r(424)),o),dl(v),o=Ox(i,o,p,u);break e}else{switch(i=o.stateNode.containerInfo,i.nodeType){case 9:i=i.body;break;default:i=i.nodeName==="HTML"?i.ownerDocument.body:i}for(rn=aa(i.firstChild),or=o,Ct=!0,Xi=null,ga=!0,u=yx(o,null,p,u),o.child=u;u;)u.flags=u.flags&-3|4096,u=u.sibling}else{if(fl(),p===v){o=Oa(i,o,u);break e}Vn(i,o,p,u)}o=o.child}return o;case 26:return Au(i,o),i===null?(u=j1(o.type,null,o.pendingProps,null))?o.memoizedState=u:Ct||(u=o.type,i=o.pendingProps,p=Hu(ie.current).createElement(u),p[bn]=o,p[An]=i,Hn(p,u,i),ae(p),o.stateNode=p):o.memoizedState=j1(o.type,i.memoizedProps,o.pendingProps,i.memoizedState),null;case 27:return Ae(o),i===null&&Ct&&(p=o.stateNode=H1(o.type,o.pendingProps,ie.current),or=o,ga=!0,v=rn,Ti(o.type)?(Kd=v,rn=aa(p.firstChild)):rn=v),Vn(i,o,o.pendingProps.children,u),Au(i,o),i===null&&(o.flags|=4194304),o.child;case 5:return i===null&&Ct&&((v=p=rn)&&(p=CC(p,o.type,o.pendingProps,ga),p!==null?(o.stateNode=p,or=o,rn=aa(p.firstChild),ga=!1,v=!0):v=!1),v||Ki(o)),Ae(o),v=o.type,w=o.pendingProps,A=i!==null?i.memoizedProps:null,p=w.children,Wd(v,w)?p=null:A!==null&&Wd(v,A)&&(o.flags|=32),o.memoizedState!==null&&(v=$0(i,o,zE,null,null,u),Hl._currentValue=v),Au(i,o),Vn(i,o,p,u),o.child;case 6:return i===null&&Ct&&((i=u=rn)&&(u=bC(u,o.pendingProps,ga),u!==null?(o.stateNode=u,or=o,rn=null,i=!0):i=!1),i||Ki(o)),null;case 13:return Ux(i,o,u);case 4:return Te(o,o.stateNode.containerInfo),p=o.pendingProps,i===null?o.child=Zs(o,null,p,u):Vn(i,o,p,u),o.child;case 11:return Mx(i,o,o.type,o.pendingProps,u);case 7:return Vn(i,o,o.pendingProps,u),o.child;case 8:return Vn(i,o,o.pendingProps.children,u),o.child;case 12:return Vn(i,o,o.pendingProps.children,u),o.child;case 10:return p=o.pendingProps,si(o,o.type,p.value),Vn(i,o,p.children,u),o.child;case 9:return v=o.type._context,p=o.pendingProps.children,Qi(o),v=Wn(v),p=p(v),o.flags|=1,Vn(i,o,p,u),o.child;case 14:return Dx(i,o,o.type,o.pendingProps,u);case 15:return Rx(i,o,o.type,o.pendingProps,u);case 19:return Vx(i,o,u);case 31:return p=o.pendingProps,u=o.mode,p={mode:p.mode,children:p.children},i===null?(u=ku(p,u),u.ref=o.ref,o.child=u,u.return=o,o=u):(u=Ma(i.child,p),u.ref=o.ref,o.child=u,u.return=o,o=u),o;case 22:return Fx(i,o,u);case 24:return Qi(o),p=Wn(Tn),i===null?(v=O0(),v===null&&(v=$t,w=P0(),v.pooledCache=w,w.refCount++,w!==null&&(v.pooledCacheLanes|=u),v=w),o.memoizedState={parent:p,cache:v},B0(o),si(o,Tn,v)):((i.lanes&u)!==0&&(V0(i,o),_l(o,null,null,u),yl()),v=i.memoizedState,w=o.memoizedState,v.parent!==p?(v={parent:p,cache:p},o.memoizedState=v,o.lanes===0&&(o.memoizedState=o.updateQueue.baseState=v),si(o,Tn,p)):(p=w.cache,si(o,Tn,p),p!==v.cache&&I0(o,[Tn],u,!0))),Vn(i,o,o.pendingProps.children,u),o.child;case 29:throw o.pendingProps}throw Error(r(156,o.tag))}function Ua(i){i.flags|=4}function Hx(i,o){if(o.type!=="stylesheet"||(o.state.loading&4)!==0)i.flags&=-16777217;else if(i.flags|=16777216,!X1(o)){if(o=Vr.current,o!==null&&((pt&4194048)===pt?xa!==null:(pt&62914560)!==pt&&(pt&536870912)===0||o!==xa))throw xl=U0,Cg;i.flags|=8192}}function Nu(i,o){o!==null&&(i.flags|=4),i.flags&16384&&(o=i.tag!==22?ma():536870912,i.lanes|=o,no|=o)}function Al(i,o){if(!Ct)switch(i.tailMode){case"hidden":o=i.tail;for(var u=null;o!==null;)o.alternate!==null&&(u=o),o=o.sibling;u===null?i.tail=null:u.sibling=null;break;case"collapsed":u=i.tail;for(var p=null;u!==null;)u.alternate!==null&&(p=u),u=u.sibling;p===null?o||i.tail===null?i.tail=null:i.tail.sibling=null:p.sibling=null}}function en(i){var o=i.alternate!==null&&i.alternate.child===i.child,u=0,p=0;if(o)for(var v=i.child;v!==null;)u|=v.lanes|v.childLanes,p|=v.subtreeFlags&65011712,p|=v.flags&65011712,v.return=i,v=v.sibling;else for(v=i.child;v!==null;)u|=v.lanes|v.childLanes,p|=v.subtreeFlags,p|=v.flags,v.return=i,v=v.sibling;return i.subtreeFlags|=p,i.childLanes=u,o}function ZE(i,o,u){var p=o.pendingProps;switch(M0(o),o.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return en(o),null;case 1:return en(o),null;case 3:return u=o.stateNode,p=null,i!==null&&(p=i.memoizedState.cache),o.memoizedState.cache!==p&&(o.flags|=2048),Ia(Tn),be(),u.pendingContext&&(u.context=u.pendingContext,u.pendingContext=null),(i===null||i.child===null)&&(ul(o)?Ua(o):i===null||i.memoizedState.isDehydrated&&(o.flags&256)===0||(o.flags|=1024,_g())),en(o),null;case 26:return u=o.memoizedState,i===null?(Ua(o),u!==null?(en(o),Hx(o,u)):(en(o),o.flags&=-16777217)):u?u!==i.memoizedState?(Ua(o),en(o),Hx(o,u)):(en(o),o.flags&=-16777217):(i.memoizedProps!==p&&Ua(o),en(o),o.flags&=-16777217),null;case 27:Xe(o),u=ie.current;var v=o.type;if(i!==null&&o.stateNode!=null)i.memoizedProps!==p&&Ua(o);else{if(!p){if(o.stateNode===null)throw Error(r(166));return en(o),null}i=q.current,ul(o)?vg(o):(i=H1(v,p,u),o.stateNode=i,Ua(o))}return en(o),null;case 5:if(Xe(o),u=o.type,i!==null&&o.stateNode!=null)i.memoizedProps!==p&&Ua(o);else{if(!p){if(o.stateNode===null)throw Error(r(166));return en(o),null}if(i=q.current,ul(o))vg(o);else{switch(v=Hu(ie.current),i){case 1:i=v.createElementNS("http://www.w3.org/2000/svg",u);break;case 2:i=v.createElementNS("http://www.w3.org/1998/Math/MathML",u);break;default:switch(u){case"svg":i=v.createElementNS("http://www.w3.org/2000/svg",u);break;case"math":i=v.createElementNS("http://www.w3.org/1998/Math/MathML",u);break;case"script":i=v.createElement("div"),i.innerHTML="<script><\/script>",i=i.removeChild(i.firstChild);break;case"select":i=typeof p.is=="string"?v.createElement("select",{is:p.is}):v.createElement("select"),p.multiple?i.multiple=!0:p.size&&(i.size=p.size);break;default:i=typeof p.is=="string"?v.createElement(u,{is:p.is}):v.createElement(u)}}i[bn]=o,i[An]=p;e:for(v=o.child;v!==null;){if(v.tag===5||v.tag===6)i.appendChild(v.stateNode);else if(v.tag!==4&&v.tag!==27&&v.child!==null){v.child.return=v,v=v.child;continue}if(v===o)break e;for(;v.sibling===null;){if(v.return===null||v.return===o)break e;v=v.return}v.sibling.return=v.return,v=v.sibling}o.stateNode=i;e:switch(Hn(i,u,p),u){case"button":case"input":case"select":case"textarea":i=!!p.autoFocus;break e;case"img":i=!0;break e;default:i=!1}i&&Ua(o)}}return en(o),o.flags&=-16777217,null;case 6:if(i&&o.stateNode!=null)i.memoizedProps!==p&&Ua(o);else{if(typeof p!="string"&&o.stateNode===null)throw Error(r(166));if(i=ie.current,ul(o)){if(i=o.stateNode,u=o.memoizedProps,p=null,v=or,v!==null)switch(v.tag){case 27:case 5:p=v.memoizedProps}i[bn]=o,i=!!(i.nodeValue===u||p!==null&&p.suppressHydrationWarning===!0||P1(i.nodeValue,u)),i||Ki(o)}else i=Hu(i).createTextNode(p),i[bn]=o,o.stateNode=i}return en(o),null;case 13:if(p=o.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(v=ul(o),p!==null&&p.dehydrated!==null){if(i===null){if(!v)throw Error(r(318));if(v=o.memoizedState,v=v!==null?v.dehydrated:null,!v)throw Error(r(317));v[bn]=o}else fl(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;en(o),v=!1}else v=_g(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=v),v=!0;if(!v)return o.flags&256?(La(o),o):(La(o),null)}if(La(o),(o.flags&128)!==0)return o.lanes=u,o;if(u=p!==null,i=i!==null&&i.memoizedState!==null,u){p=o.child,v=null,p.alternate!==null&&p.alternate.memoizedState!==null&&p.alternate.memoizedState.cachePool!==null&&(v=p.alternate.memoizedState.cachePool.pool);var w=null;p.memoizedState!==null&&p.memoizedState.cachePool!==null&&(w=p.memoizedState.cachePool.pool),w!==v&&(p.flags|=2048)}return u!==i&&u&&(o.child.flags|=8192),Nu(o,o.updateQueue),en(o),null;case 4:return be(),i===null&&Hd(o.stateNode.containerInfo),en(o),null;case 10:return Ia(o.type),en(o),null;case 19:if(L(wn),v=o.memoizedState,v===null)return en(o),null;if(p=(o.flags&128)!==0,w=v.rendering,w===null)if(p)Al(v,!1);else{if(an!==0||i!==null&&(i.flags&128)!==0)for(i=o.child;i!==null;){if(w=Eu(i),w!==null){for(o.flags|=128,Al(v,!1),i=w.updateQueue,o.updateQueue=i,Nu(o,i),o.subtreeFlags=0,i=u,u=o.child;u!==null;)gg(u,i),u=u.sibling;return W(wn,wn.current&1|2),o.child}i=i.sibling}v.tail!==null&&Ne()>Ru&&(o.flags|=128,p=!0,Al(v,!1),o.lanes=4194304)}else{if(!p)if(i=Eu(w),i!==null){if(o.flags|=128,p=!0,i=i.updateQueue,o.updateQueue=i,Nu(o,i),Al(v,!0),v.tail===null&&v.tailMode==="hidden"&&!w.alternate&&!Ct)return en(o),null}else 2*Ne()-v.renderingStartTime>Ru&&u!==536870912&&(o.flags|=128,p=!0,Al(v,!1),o.lanes=4194304);v.isBackwards?(w.sibling=o.child,o.child=w):(i=v.last,i!==null?i.sibling=w:o.child=w,v.last=w)}return v.tail!==null?(o=v.tail,v.rendering=o,v.tail=o.sibling,v.renderingStartTime=Ne(),o.sibling=null,i=wn.current,W(wn,p?i&1|2:i&1),o):(en(o),null);case 22:case 23:return La(o),q0(),p=o.memoizedState!==null,i!==null?i.memoizedState!==null!==p&&(o.flags|=8192):p&&(o.flags|=8192),p?(u&536870912)!==0&&(o.flags&128)===0&&(en(o),o.subtreeFlags&6&&(o.flags|=8192)):en(o),u=o.updateQueue,u!==null&&Nu(o,u.retryQueue),u=null,i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(u=i.memoizedState.cachePool.pool),p=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(p=o.memoizedState.cachePool.pool),p!==u&&(o.flags|=2048),i!==null&&L(es),null;case 24:return u=null,i!==null&&(u=i.memoizedState.cache),o.memoizedState.cache!==u&&(o.flags|=2048),Ia(Tn),en(o),null;case 25:return null;case 30:return null}throw Error(r(156,o.tag))}function QE(i,o){switch(M0(o),o.tag){case 1:return i=o.flags,i&65536?(o.flags=i&-65537|128,o):null;case 3:return Ia(Tn),be(),i=o.flags,(i&65536)!==0&&(i&128)===0?(o.flags=i&-65537|128,o):null;case 26:case 27:case 5:return Xe(o),null;case 13:if(La(o),i=o.memoizedState,i!==null&&i.dehydrated!==null){if(o.alternate===null)throw Error(r(340));fl()}return i=o.flags,i&65536?(o.flags=i&-65537|128,o):null;case 19:return L(wn),null;case 4:return be(),null;case 10:return Ia(o.type),null;case 22:case 23:return La(o),q0(),i!==null&&L(es),i=o.flags,i&65536?(o.flags=i&-65537|128,o):null;case 24:return Ia(Tn),null;case 25:return null;default:return null}}function zx(i,o){switch(M0(o),o.tag){case 3:Ia(Tn),be();break;case 26:case 27:case 5:Xe(o);break;case 4:be();break;case 13:La(o);break;case 19:L(wn);break;case 10:Ia(o.type);break;case 22:case 23:La(o),q0(),i!==null&&L(es);break;case 24:Ia(Tn)}}function kl(i,o){try{var u=o.updateQueue,p=u!==null?u.lastEffect:null;if(p!==null){var v=p.next;u=v;do{if((u.tag&i)===i){p=void 0;var w=u.create,A=u.inst;p=w(),A.destroy=p}u=u.next}while(u!==v)}}catch(R){Gt(o,o.return,R)}}function hi(i,o,u){try{var p=o.updateQueue,v=p!==null?p.lastEffect:null;if(v!==null){var w=v.next;p=w;do{if((p.tag&i)===i){var A=p.inst,R=A.destroy;if(R!==void 0){A.destroy=void 0,v=o;var J=u,oe=R;try{oe()}catch(ve){Gt(v,J,ve)}}}p=p.next}while(p!==w)}}catch(ve){Gt(o,o.return,ve)}}function qx(i){var o=i.updateQueue;if(o!==null){var u=i.stateNode;try{Dg(o,u)}catch(p){Gt(i,i.return,p)}}}function jx(i,o,u){u.props=ns(i.type,i.memoizedProps),u.state=i.memoizedState;try{u.componentWillUnmount()}catch(p){Gt(i,o,p)}}function Nl(i,o){try{var u=i.ref;if(u!==null){switch(i.tag){case 26:case 27:case 5:var p=i.stateNode;break;case 30:p=i.stateNode;break;default:p=i.stateNode}typeof u=="function"?i.refCleanup=u(p):u.current=p}}catch(v){Gt(i,o,v)}}function va(i,o){var u=i.ref,p=i.refCleanup;if(u!==null)if(typeof p=="function")try{p()}catch(v){Gt(i,o,v)}finally{i.refCleanup=null,i=i.alternate,i!=null&&(i.refCleanup=null)}else if(typeof u=="function")try{u(null)}catch(v){Gt(i,o,v)}else u.current=null}function $x(i){var o=i.type,u=i.memoizedProps,p=i.stateNode;try{e:switch(o){case"button":case"input":case"select":case"textarea":u.autoFocus&&p.focus();break e;case"img":u.src?p.src=u.src:u.srcSet&&(p.srcset=u.srcSet)}}catch(v){Gt(i,i.return,v)}}function vd(i,o,u){try{var p=i.stateNode;_C(p,i.type,u,o),p[An]=o}catch(v){Gt(i,i.return,v)}}function Wx(i){return i.tag===5||i.tag===3||i.tag===26||i.tag===27&&Ti(i.type)||i.tag===4}function yd(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||Wx(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.tag===27&&Ti(i.type)||i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function _d(i,o,u){var p=i.tag;if(p===5||p===6)i=i.stateNode,o?(u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u).insertBefore(i,o):(o=u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u,o.appendChild(i),u=u._reactRootContainer,u!=null||o.onclick!==null||(o.onclick=Gu));else if(p!==4&&(p===27&&Ti(i.type)&&(u=i.stateNode,o=null),i=i.child,i!==null))for(_d(i,o,u),i=i.sibling;i!==null;)_d(i,o,u),i=i.sibling}function Mu(i,o,u){var p=i.tag;if(p===5||p===6)i=i.stateNode,o?u.insertBefore(i,o):u.appendChild(i);else if(p!==4&&(p===27&&Ti(i.type)&&(u=i.stateNode),i=i.child,i!==null))for(Mu(i,o,u),i=i.sibling;i!==null;)Mu(i,o,u),i=i.sibling}function Yx(i){var o=i.stateNode,u=i.memoizedProps;try{for(var p=i.type,v=o.attributes;v.length;)o.removeAttributeNode(v[0]);Hn(o,p,u),o[bn]=i,o[An]=u}catch(w){Gt(i,i.return,w)}}var Ba=!1,fn=!1,Td=!1,Jx=typeof WeakSet=="function"?WeakSet:Set,Nn=null;function eC(i,o){if(i=i.containerInfo,jd=Yu,i=sg(i),y0(i)){if("selectionStart"in i)var u={start:i.selectionStart,end:i.selectionEnd};else e:{u=(u=i.ownerDocument)&&u.defaultView||window;var p=u.getSelection&&u.getSelection();if(p&&p.rangeCount!==0){u=p.anchorNode;var v=p.anchorOffset,w=p.focusNode;p=p.focusOffset;try{u.nodeType,w.nodeType}catch{u=null;break e}var A=0,R=-1,J=-1,oe=0,ve=0,we=i,fe=null;t:for(;;){for(var he;we!==u||v!==0&&we.nodeType!==3||(R=A+v),we!==w||p!==0&&we.nodeType!==3||(J=A+p),we.nodeType===3&&(A+=we.nodeValue.length),(he=we.firstChild)!==null;)fe=we,we=he;for(;;){if(we===i)break t;if(fe===u&&++oe===v&&(R=A),fe===w&&++ve===p&&(J=A),(he=we.nextSibling)!==null)break;we=fe,fe=we.parentNode}we=he}u=R===-1||J===-1?null:{start:R,end:J}}else u=null}u=u||{start:0,end:0}}else u=null;for($d={focusedElem:i,selectionRange:u},Yu=!1,Nn=o;Nn!==null;)if(o=Nn,i=o.child,(o.subtreeFlags&1024)!==0&&i!==null)i.return=o,Nn=i;else for(;Nn!==null;){switch(o=Nn,w=o.alternate,i=o.flags,o.tag){case 0:break;case 11:case 15:break;case 1:if((i&1024)!==0&&w!==null){i=void 0,u=o,v=w.memoizedProps,w=w.memoizedState,p=u.stateNode;try{var Ke=ns(u.type,v,u.elementType===u.type);i=p.getSnapshotBeforeUpdate(Ke,w),p.__reactInternalSnapshotBeforeUpdate=i}catch(je){Gt(u,u.return,je)}}break;case 3:if((i&1024)!==0){if(i=o.stateNode.containerInfo,u=i.nodeType,u===9)Jd(i);else if(u===1)switch(i.nodeName){case"HEAD":case"HTML":case"BODY":Jd(i);break;default:i.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((i&1024)!==0)throw Error(r(163))}if(i=o.sibling,i!==null){i.return=o.return,Nn=i;break}Nn=o.return}}function Xx(i,o,u){var p=u.flags;switch(u.tag){case 0:case 11:case 15:mi(i,u),p&4&&kl(5,u);break;case 1:if(mi(i,u),p&4)if(i=u.stateNode,o===null)try{i.componentDidMount()}catch(A){Gt(u,u.return,A)}else{var v=ns(u.type,o.memoizedProps);o=o.memoizedState;try{i.componentDidUpdate(v,o,i.__reactInternalSnapshotBeforeUpdate)}catch(A){Gt(u,u.return,A)}}p&64&&qx(u),p&512&&Nl(u,u.return);break;case 3:if(mi(i,u),p&64&&(i=u.updateQueue,i!==null)){if(o=null,u.child!==null)switch(u.child.tag){case 27:case 5:o=u.child.stateNode;break;case 1:o=u.child.stateNode}try{Dg(i,o)}catch(A){Gt(u,u.return,A)}}break;case 27:o===null&&p&4&&Yx(u);case 26:case 5:mi(i,u),o===null&&p&4&&$x(u),p&512&&Nl(u,u.return);break;case 12:mi(i,u);break;case 13:mi(i,u),p&4&&Qx(i,u),p&64&&(i=u.memoizedState,i!==null&&(i=i.dehydrated,i!==null&&(u=cC.bind(null,u),AC(i,u))));break;case 22:if(p=u.memoizedState!==null||Ba,!p){o=o!==null&&o.memoizedState!==null||fn,v=Ba;var w=fn;Ba=p,(fn=o)&&!w?pi(i,u,(u.subtreeFlags&8772)!==0):mi(i,u),Ba=v,fn=w}break;case 30:break;default:mi(i,u)}}function Kx(i){var o=i.alternate;o!==null&&(i.alternate=null,Kx(o)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(o=i.stateNode,o!==null&&U(o)),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}var Qt=null,hr=!1;function Va(i,o,u){for(u=u.child;u!==null;)Zx(i,o,u),u=u.sibling}function Zx(i,o,u){if(cn&&typeof cn.onCommitFiberUnmount=="function")try{cn.onCommitFiberUnmount(Bn,u)}catch{}switch(u.tag){case 26:fn||va(u,o),Va(i,o,u),u.memoizedState?u.memoizedState.count--:u.stateNode&&(u=u.stateNode,u.parentNode.removeChild(u));break;case 27:fn||va(u,o);var p=Qt,v=hr;Ti(u.type)&&(Qt=u.stateNode,hr=!1),Va(i,o,u),Ul(u.stateNode),Qt=p,hr=v;break;case 5:fn||va(u,o);case 6:if(p=Qt,v=hr,Qt=null,Va(i,o,u),Qt=p,hr=v,Qt!==null)if(hr)try{(Qt.nodeType===9?Qt.body:Qt.nodeName==="HTML"?Qt.ownerDocument.body:Qt).removeChild(u.stateNode)}catch(w){Gt(u,o,w)}else try{Qt.removeChild(u.stateNode)}catch(w){Gt(u,o,w)}break;case 18:Qt!==null&&(hr?(i=Qt,V1(i.nodeType===9?i.body:i.nodeName==="HTML"?i.ownerDocument.body:i,u.stateNode),$l(i)):V1(Qt,u.stateNode));break;case 4:p=Qt,v=hr,Qt=u.stateNode.containerInfo,hr=!0,Va(i,o,u),Qt=p,hr=v;break;case 0:case 11:case 14:case 15:fn||hi(2,u,o),fn||hi(4,u,o),Va(i,o,u);break;case 1:fn||(va(u,o),p=u.stateNode,typeof p.componentWillUnmount=="function"&&jx(u,o,p)),Va(i,o,u);break;case 21:Va(i,o,u);break;case 22:fn=(p=fn)||u.memoizedState!==null,Va(i,o,u),fn=p;break;default:Va(i,o,u)}}function Qx(i,o){if(o.memoizedState===null&&(i=o.alternate,i!==null&&(i=i.memoizedState,i!==null&&(i=i.dehydrated,i!==null))))try{$l(i)}catch(u){Gt(o,o.return,u)}}function tC(i){switch(i.tag){case 13:case 19:var o=i.stateNode;return o===null&&(o=i.stateNode=new Jx),o;case 22:return i=i.stateNode,o=i._retryCache,o===null&&(o=i._retryCache=new Jx),o;default:throw Error(r(435,i.tag))}}function wd(i,o){var u=tC(i);o.forEach(function(p){var v=uC.bind(null,i,p);u.has(p)||(u.add(p),p.then(v,v))})}function wr(i,o){var u=o.deletions;if(u!==null)for(var p=0;p<u.length;p++){var v=u[p],w=i,A=o,R=A;e:for(;R!==null;){switch(R.tag){case 27:if(Ti(R.type)){Qt=R.stateNode,hr=!1;break e}break;case 5:Qt=R.stateNode,hr=!1;break e;case 3:case 4:Qt=R.stateNode.containerInfo,hr=!0;break e}R=R.return}if(Qt===null)throw Error(r(160));Zx(w,A,v),Qt=null,hr=!1,w=v.alternate,w!==null&&(w.return=null),v.return=null}if(o.subtreeFlags&13878)for(o=o.child;o!==null;)e1(o,i),o=o.sibling}var ra=null;function e1(i,o){var u=i.alternate,p=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:wr(o,i),Sr(i),p&4&&(hi(3,i,i.return),kl(3,i),hi(5,i,i.return));break;case 1:wr(o,i),Sr(i),p&512&&(fn||u===null||va(u,u.return)),p&64&&Ba&&(i=i.updateQueue,i!==null&&(p=i.callbacks,p!==null&&(u=i.shared.hiddenCallbacks,i.shared.hiddenCallbacks=u===null?p:u.concat(p))));break;case 26:var v=ra;if(wr(o,i),Sr(i),p&512&&(fn||u===null||va(u,u.return)),p&4){var w=u!==null?u.memoizedState:null;if(p=i.memoizedState,u===null)if(p===null)if(i.stateNode===null){e:{p=i.type,u=i.memoizedProps,v=v.ownerDocument||v;t:switch(p){case"title":w=v.getElementsByTagName("title")[0],(!w||w[O]||w[bn]||w.namespaceURI==="http://www.w3.org/2000/svg"||w.hasAttribute("itemprop"))&&(w=v.createElement(p),v.head.insertBefore(w,v.querySelector("head > title"))),Hn(w,p,u),w[bn]=i,ae(w),p=w;break e;case"link":var A=Y1("link","href",v).get(p+(u.href||""));if(A){for(var R=0;R<A.length;R++)if(w=A[R],w.getAttribute("href")===(u.href==null||u.href===""?null:u.href)&&w.getAttribute("rel")===(u.rel==null?null:u.rel)&&w.getAttribute("title")===(u.title==null?null:u.title)&&w.getAttribute("crossorigin")===(u.crossOrigin==null?null:u.crossOrigin)){A.splice(R,1);break t}}w=v.createElement(p),Hn(w,p,u),v.head.appendChild(w);break;case"meta":if(A=Y1("meta","content",v).get(p+(u.content||""))){for(R=0;R<A.length;R++)if(w=A[R],w.getAttribute("content")===(u.content==null?null:""+u.content)&&w.getAttribute("name")===(u.name==null?null:u.name)&&w.getAttribute("property")===(u.property==null?null:u.property)&&w.getAttribute("http-equiv")===(u.httpEquiv==null?null:u.httpEquiv)&&w.getAttribute("charset")===(u.charSet==null?null:u.charSet)){A.splice(R,1);break t}}w=v.createElement(p),Hn(w,p,u),v.head.appendChild(w);break;default:throw Error(r(468,p))}w[bn]=i,ae(w),p=w}i.stateNode=p}else J1(v,i.type,i.stateNode);else i.stateNode=W1(v,p,i.memoizedProps);else w!==p?(w===null?u.stateNode!==null&&(u=u.stateNode,u.parentNode.removeChild(u)):w.count--,p===null?J1(v,i.type,i.stateNode):W1(v,p,i.memoizedProps)):p===null&&i.stateNode!==null&&vd(i,i.memoizedProps,u.memoizedProps)}break;case 27:wr(o,i),Sr(i),p&512&&(fn||u===null||va(u,u.return)),u!==null&&p&4&&vd(i,i.memoizedProps,u.memoizedProps);break;case 5:if(wr(o,i),Sr(i),p&512&&(fn||u===null||va(u,u.return)),i.flags&32){v=i.stateNode;try{Is(v,"")}catch(he){Gt(i,i.return,he)}}p&4&&i.stateNode!=null&&(v=i.memoizedProps,vd(i,v,u!==null?u.memoizedProps:v)),p&1024&&(Td=!0);break;case 6:if(wr(o,i),Sr(i),p&4){if(i.stateNode===null)throw Error(r(162));p=i.memoizedProps,u=i.stateNode;try{u.nodeValue=p}catch(he){Gt(i,i.return,he)}}break;case 3:if(ju=null,v=ra,ra=zu(o.containerInfo),wr(o,i),ra=v,Sr(i),p&4&&u!==null&&u.memoizedState.isDehydrated)try{$l(o.containerInfo)}catch(he){Gt(i,i.return,he)}Td&&(Td=!1,t1(i));break;case 4:p=ra,ra=zu(i.stateNode.containerInfo),wr(o,i),Sr(i),ra=p;break;case 12:wr(o,i),Sr(i);break;case 13:wr(o,i),Sr(i),i.child.flags&8192&&i.memoizedState!==null!=(u!==null&&u.memoizedState!==null)&&(kd=Ne()),p&4&&(p=i.updateQueue,p!==null&&(i.updateQueue=null,wd(i,p)));break;case 22:v=i.memoizedState!==null;var J=u!==null&&u.memoizedState!==null,oe=Ba,ve=fn;if(Ba=oe||v,fn=ve||J,wr(o,i),fn=ve,Ba=oe,Sr(i),p&8192)e:for(o=i.stateNode,o._visibility=v?o._visibility&-2:o._visibility|1,v&&(u===null||J||Ba||fn||rs(i)),u=null,o=i;;){if(o.tag===5||o.tag===26){if(u===null){J=u=o;try{if(w=J.stateNode,v)A=w.style,typeof A.setProperty=="function"?A.setProperty("display","none","important"):A.display="none";else{R=J.stateNode;var we=J.memoizedProps.style,fe=we!=null&&we.hasOwnProperty("display")?we.display:null;R.style.display=fe==null||typeof fe=="boolean"?"":(""+fe).trim()}}catch(he){Gt(J,J.return,he)}}}else if(o.tag===6){if(u===null){J=o;try{J.stateNode.nodeValue=v?"":J.memoizedProps}catch(he){Gt(J,J.return,he)}}}else if((o.tag!==22&&o.tag!==23||o.memoizedState===null||o===i)&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===i)break e;for(;o.sibling===null;){if(o.return===null||o.return===i)break e;u===o&&(u=null),o=o.return}u===o&&(u=null),o.sibling.return=o.return,o=o.sibling}p&4&&(p=i.updateQueue,p!==null&&(u=p.retryQueue,u!==null&&(p.retryQueue=null,wd(i,u))));break;case 19:wr(o,i),Sr(i),p&4&&(p=i.updateQueue,p!==null&&(i.updateQueue=null,wd(i,p)));break;case 30:break;case 21:break;default:wr(o,i),Sr(i)}}function Sr(i){var o=i.flags;if(o&2){try{for(var u,p=i.return;p!==null;){if(Wx(p)){u=p;break}p=p.return}if(u==null)throw Error(r(160));switch(u.tag){case 27:var v=u.stateNode,w=yd(i);Mu(i,w,v);break;case 5:var A=u.stateNode;u.flags&32&&(Is(A,""),u.flags&=-33);var R=yd(i);Mu(i,R,A);break;case 3:case 4:var J=u.stateNode.containerInfo,oe=yd(i);_d(i,oe,J);break;default:throw Error(r(161))}}catch(ve){Gt(i,i.return,ve)}i.flags&=-3}o&4096&&(i.flags&=-4097)}function t1(i){if(i.subtreeFlags&1024)for(i=i.child;i!==null;){var o=i;t1(o),o.tag===5&&o.flags&1024&&o.stateNode.reset(),i=i.sibling}}function mi(i,o){if(o.subtreeFlags&8772)for(o=o.child;o!==null;)Xx(i,o.alternate,o),o=o.sibling}function rs(i){for(i=i.child;i!==null;){var o=i;switch(o.tag){case 0:case 11:case 14:case 15:hi(4,o,o.return),rs(o);break;case 1:va(o,o.return);var u=o.stateNode;typeof u.componentWillUnmount=="function"&&jx(o,o.return,u),rs(o);break;case 27:Ul(o.stateNode);case 26:case 5:va(o,o.return),rs(o);break;case 22:o.memoizedState===null&&rs(o);break;case 30:rs(o);break;default:rs(o)}i=i.sibling}}function pi(i,o,u){for(u=u&&(o.subtreeFlags&8772)!==0,o=o.child;o!==null;){var p=o.alternate,v=i,w=o,A=w.flags;switch(w.tag){case 0:case 11:case 15:pi(v,w,u),kl(4,w);break;case 1:if(pi(v,w,u),p=w,v=p.stateNode,typeof v.componentDidMount=="function")try{v.componentDidMount()}catch(oe){Gt(p,p.return,oe)}if(p=w,v=p.updateQueue,v!==null){var R=p.stateNode;try{var J=v.shared.hiddenCallbacks;if(J!==null)for(v.shared.hiddenCallbacks=null,v=0;v<J.length;v++)Mg(J[v],R)}catch(oe){Gt(p,p.return,oe)}}u&&A&64&&qx(w),Nl(w,w.return);break;case 27:Yx(w);case 26:case 5:pi(v,w,u),u&&p===null&&A&4&&$x(w),Nl(w,w.return);break;case 12:pi(v,w,u);break;case 13:pi(v,w,u),u&&A&4&&Qx(v,w);break;case 22:w.memoizedState===null&&pi(v,w,u),Nl(w,w.return);break;case 30:break;default:pi(v,w,u)}o=o.sibling}}function Sd(i,o){var u=null;i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(u=i.memoizedState.cachePool.pool),i=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(i=o.memoizedState.cachePool.pool),i!==u&&(i!=null&&i.refCount++,u!=null&&ml(u))}function Ed(i,o){i=null,o.alternate!==null&&(i=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==i&&(o.refCount++,i!=null&&ml(i))}function ya(i,o,u,p){if(o.subtreeFlags&10256)for(o=o.child;o!==null;)n1(i,o,u,p),o=o.sibling}function n1(i,o,u,p){var v=o.flags;switch(o.tag){case 0:case 11:case 15:ya(i,o,u,p),v&2048&&kl(9,o);break;case 1:ya(i,o,u,p);break;case 3:ya(i,o,u,p),v&2048&&(i=null,o.alternate!==null&&(i=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==i&&(o.refCount++,i!=null&&ml(i)));break;case 12:if(v&2048){ya(i,o,u,p),i=o.stateNode;try{var w=o.memoizedProps,A=w.id,R=w.onPostCommit;typeof R=="function"&&R(A,o.alternate===null?"mount":"update",i.passiveEffectDuration,-0)}catch(J){Gt(o,o.return,J)}}else ya(i,o,u,p);break;case 13:ya(i,o,u,p);break;case 23:break;case 22:w=o.stateNode,A=o.alternate,o.memoizedState!==null?w._visibility&2?ya(i,o,u,p):Ml(i,o):w._visibility&2?ya(i,o,u,p):(w._visibility|=2,Qs(i,o,u,p,(o.subtreeFlags&10256)!==0)),v&2048&&Sd(A,o);break;case 24:ya(i,o,u,p),v&2048&&Ed(o.alternate,o);break;default:ya(i,o,u,p)}}function Qs(i,o,u,p,v){for(v=v&&(o.subtreeFlags&10256)!==0,o=o.child;o!==null;){var w=i,A=o,R=u,J=p,oe=A.flags;switch(A.tag){case 0:case 11:case 15:Qs(w,A,R,J,v),kl(8,A);break;case 23:break;case 22:var ve=A.stateNode;A.memoizedState!==null?ve._visibility&2?Qs(w,A,R,J,v):Ml(w,A):(ve._visibility|=2,Qs(w,A,R,J,v)),v&&oe&2048&&Sd(A.alternate,A);break;case 24:Qs(w,A,R,J,v),v&&oe&2048&&Ed(A.alternate,A);break;default:Qs(w,A,R,J,v)}o=o.sibling}}function Ml(i,o){if(o.subtreeFlags&10256)for(o=o.child;o!==null;){var u=i,p=o,v=p.flags;switch(p.tag){case 22:Ml(u,p),v&2048&&Sd(p.alternate,p);break;case 24:Ml(u,p),v&2048&&Ed(p.alternate,p);break;default:Ml(u,p)}o=o.sibling}}var Dl=8192;function eo(i){if(i.subtreeFlags&Dl)for(i=i.child;i!==null;)r1(i),i=i.sibling}function r1(i){switch(i.tag){case 26:eo(i),i.flags&Dl&&i.memoizedState!==null&&VC(ra,i.memoizedState,i.memoizedProps);break;case 5:eo(i);break;case 3:case 4:var o=ra;ra=zu(i.stateNode.containerInfo),eo(i),ra=o;break;case 22:i.memoizedState===null&&(o=i.alternate,o!==null&&o.memoizedState!==null?(o=Dl,Dl=16777216,eo(i),Dl=o):eo(i));break;default:eo(i)}}function a1(i){var o=i.alternate;if(o!==null&&(i=o.child,i!==null)){o.child=null;do o=i.sibling,i.sibling=null,i=o;while(i!==null)}}function Rl(i){var o=i.deletions;if((i.flags&16)!==0){if(o!==null)for(var u=0;u<o.length;u++){var p=o[u];Nn=p,s1(p,i)}a1(i)}if(i.subtreeFlags&10256)for(i=i.child;i!==null;)i1(i),i=i.sibling}function i1(i){switch(i.tag){case 0:case 11:case 15:Rl(i),i.flags&2048&&hi(9,i,i.return);break;case 3:Rl(i);break;case 12:Rl(i);break;case 22:var o=i.stateNode;i.memoizedState!==null&&o._visibility&2&&(i.return===null||i.return.tag!==13)?(o._visibility&=-3,Du(i)):Rl(i);break;default:Rl(i)}}function Du(i){var o=i.deletions;if((i.flags&16)!==0){if(o!==null)for(var u=0;u<o.length;u++){var p=o[u];Nn=p,s1(p,i)}a1(i)}for(i=i.child;i!==null;){switch(o=i,o.tag){case 0:case 11:case 15:hi(8,o,o.return),Du(o);break;case 22:u=o.stateNode,u._visibility&2&&(u._visibility&=-3,Du(o));break;default:Du(o)}i=i.sibling}}function s1(i,o){for(;Nn!==null;){var u=Nn;switch(u.tag){case 0:case 11:case 15:hi(8,u,o);break;case 23:case 22:if(u.memoizedState!==null&&u.memoizedState.cachePool!==null){var p=u.memoizedState.cachePool.pool;p!=null&&p.refCount++}break;case 24:ml(u.memoizedState.cache)}if(p=u.child,p!==null)p.return=u,Nn=p;else e:for(u=i;Nn!==null;){p=Nn;var v=p.sibling,w=p.return;if(Kx(p),p===u){Nn=null;break e}if(v!==null){v.return=w,Nn=v;break e}Nn=w}}}var nC={getCacheForType:function(i){var o=Wn(Tn),u=o.data.get(i);return u===void 0&&(u=i(),o.data.set(i,u)),u}},rC=typeof WeakMap=="function"?WeakMap:Map,At=0,$t=null,dt=null,pt=0,kt=0,Er=null,gi=!1,to=!1,Cd=!1,Ga=0,an=0,xi=0,as=0,bd=0,Gr=0,no=0,Fl=null,mr=null,Ad=!1,kd=0,Ru=1/0,Fu=null,vi=null,Gn=0,yi=null,ro=null,ao=0,Nd=0,Md=null,o1=null,Il=0,Dd=null;function Cr(){if((At&2)!==0&&pt!==0)return pt&-pt;if(ee.T!==null){var i=js;return i!==0?i:Ud()}return $c()}function l1(){Gr===0&&(Gr=(pt&536870912)===0||Ct?Et():536870912);var i=Vr.current;return i!==null&&(i.flags|=32),Gr}function br(i,o,u){(i===$t&&(kt===2||kt===9)||i.cancelPendingCommit!==null)&&(io(i,0),_i(i,pt,Gr,!1)),Qr(i,u),((At&2)===0||i!==$t)&&(i===$t&&((At&2)===0&&(as|=u),an===4&&_i(i,pt,Gr,!1)),_a(i))}function c1(i,o,u){if((At&6)!==0)throw Error(r(327));var p=!u&&(o&124)===0&&(o&i.expiredLanes)===0||Be(i,o),v=p?sC(i,o):Id(i,o,!0),w=p;do{if(v===0){to&&!p&&_i(i,o,0,!1);break}else{if(u=i.current.alternate,w&&!aC(u)){v=Id(i,o,!1),w=!1;continue}if(v===2){if(w=o,i.errorRecoveryDisabledLanes&w)var A=0;else A=i.pendingLanes&-536870913,A=A!==0?A:A&536870912?536870912:0;if(A!==0){o=A;e:{var R=i;v=Fl;var J=R.current.memoizedState.isDehydrated;if(J&&(io(R,A).flags|=256),A=Id(R,A,!1),A!==2){if(Cd&&!J){R.errorRecoveryDisabledLanes|=w,as|=w,v=4;break e}w=mr,mr=v,w!==null&&(mr===null?mr=w:mr.push.apply(mr,w))}v=A}if(w=!1,v!==2)continue}}if(v===1){io(i,0),_i(i,o,0,!0);break}e:{switch(p=i,w=v,w){case 0:case 1:throw Error(r(345));case 4:if((o&4194048)!==o)break;case 6:_i(p,o,Gr,!gi);break e;case 2:mr=null;break;case 3:case 5:break;default:throw Error(r(329))}if((o&62914560)===o&&(v=kd+300-Ne(),10<v)){if(_i(p,o,Gr,!gi),St(p,0,!0)!==0)break e;p.timeoutHandle=U1(u1.bind(null,p,u,mr,Fu,Ad,o,Gr,as,no,gi,w,2,-0,0),v);break e}u1(p,u,mr,Fu,Ad,o,Gr,as,no,gi,w,0,-0,0)}}break}while(!0);_a(i)}function u1(i,o,u,p,v,w,A,R,J,oe,ve,we,fe,he){if(i.timeoutHandle=-1,we=o.subtreeFlags,(we&8192||(we&16785408)===16785408)&&(Gl={stylesheets:null,count:0,unsuspend:BC},r1(o),we=GC(),we!==null)){i.cancelPendingCommit=we(x1.bind(null,i,o,w,u,p,v,A,R,J,ve,1,fe,he)),_i(i,w,A,!oe);return}x1(i,o,w,u,p,v,A,R,J)}function aC(i){for(var o=i;;){var u=o.tag;if((u===0||u===11||u===15)&&o.flags&16384&&(u=o.updateQueue,u!==null&&(u=u.stores,u!==null)))for(var p=0;p<u.length;p++){var v=u[p],w=v.getSnapshot;v=v.value;try{if(!_r(w(),v))return!1}catch{return!1}}if(u=o.child,o.subtreeFlags&16384&&u!==null)u.return=o,o=u;else{if(o===i)break;for(;o.sibling===null;){if(o.return===null||o.return===i)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function _i(i,o,u,p){o&=~bd,o&=~as,i.suspendedLanes|=o,i.pingedLanes&=~o,p&&(i.warmLanes|=o),p=i.expirationTimes;for(var v=o;0<v;){var w=31-zt(v),A=1<<w;p[w]=-1,v&=~A}u!==0&&Rs(i,u,o)}function Iu(){return(At&6)===0?(Pl(0),!1):!0}function Rd(){if(dt!==null){if(kt===0)var i=dt.return;else i=dt,Fa=Zi=null,J0(i),Ks=null,Cl=0,i=dt;for(;i!==null;)zx(i.alternate,i),i=i.return;dt=null}}function io(i,o){var u=i.timeoutHandle;u!==-1&&(i.timeoutHandle=-1,wC(u)),u=i.cancelPendingCommit,u!==null&&(i.cancelPendingCommit=null,u()),Rd(),$t=i,dt=u=Ma(i.current,null),pt=o,kt=0,Er=null,gi=!1,to=Be(i,o),Cd=!1,no=Gr=bd=as=xi=an=0,mr=Fl=null,Ad=!1,(o&8)!==0&&(o|=o&32);var p=i.entangledLanes;if(p!==0)for(i=i.entanglements,p&=o;0<p;){var v=31-zt(p),w=1<<v;o|=i[v],p&=~w}return Ga=o,nu(),u}function f1(i,o){ot=null,ee.H=Tu,o===gl||o===fu?(o=kg(),kt=3):o===Cg?(o=kg(),kt=4):kt=o===Nx?8:o!==null&&typeof o=="object"&&typeof o.then=="function"?6:1,Er=o,dt===null&&(an=1,bu(i,Lr(o,i.current)))}function d1(){var i=ee.H;return ee.H=Tu,i===null?Tu:i}function h1(){var i=ee.A;return ee.A=nC,i}function Fd(){an=4,gi||(pt&4194048)!==pt&&Vr.current!==null||(to=!0),(xi&134217727)===0&&(as&134217727)===0||$t===null||_i($t,pt,Gr,!1)}function Id(i,o,u){var p=At;At|=2;var v=d1(),w=h1();($t!==i||pt!==o)&&(Fu=null,io(i,o)),o=!1;var A=an;e:do try{if(kt!==0&&dt!==null){var R=dt,J=Er;switch(kt){case 8:Rd(),A=6;break e;case 3:case 2:case 9:case 6:Vr.current===null&&(o=!0);var oe=kt;if(kt=0,Er=null,so(i,R,J,oe),u&&to){A=0;break e}break;default:oe=kt,kt=0,Er=null,so(i,R,J,oe)}}iC(),A=an;break}catch(ve){f1(i,ve)}while(!0);return o&&i.shellSuspendCounter++,Fa=Zi=null,At=p,ee.H=v,ee.A=w,dt===null&&($t=null,pt=0,nu()),A}function iC(){for(;dt!==null;)m1(dt)}function sC(i,o){var u=At;At|=2;var p=d1(),v=h1();$t!==i||pt!==o?(Fu=null,Ru=Ne()+500,io(i,o)):to=Be(i,o);e:do try{if(kt!==0&&dt!==null){o=dt;var w=Er;t:switch(kt){case 1:kt=0,Er=null,so(i,o,w,1);break;case 2:case 9:if(bg(w)){kt=0,Er=null,p1(o);break}o=function(){kt!==2&&kt!==9||$t!==i||(kt=7),_a(i)},w.then(o,o);break e;case 3:kt=7;break e;case 4:kt=5;break e;case 7:bg(w)?(kt=0,Er=null,p1(o)):(kt=0,Er=null,so(i,o,w,7));break;case 5:var A=null;switch(dt.tag){case 26:A=dt.memoizedState;case 5:case 27:var R=dt;if(!A||X1(A)){kt=0,Er=null;var J=R.sibling;if(J!==null)dt=J;else{var oe=R.return;oe!==null?(dt=oe,Pu(oe)):dt=null}break t}}kt=0,Er=null,so(i,o,w,5);break;case 6:kt=0,Er=null,so(i,o,w,6);break;case 8:Rd(),an=6;break e;default:throw Error(r(462))}}oC();break}catch(ve){f1(i,ve)}while(!0);return Fa=Zi=null,ee.H=p,ee.A=v,At=u,dt!==null?0:($t=null,pt=0,nu(),an)}function oC(){for(;dt!==null&&!_t();)m1(dt)}function m1(i){var o=Gx(i.alternate,i,Ga);i.memoizedProps=i.pendingProps,o===null?Pu(i):dt=o}function p1(i){var o=i,u=o.alternate;switch(o.tag){case 15:case 0:o=Px(u,o,o.pendingProps,o.type,void 0,pt);break;case 11:o=Px(u,o,o.pendingProps,o.type.render,o.ref,pt);break;case 5:J0(o);default:zx(u,o),o=dt=gg(o,Ga),o=Gx(u,o,Ga)}i.memoizedProps=i.pendingProps,o===null?Pu(i):dt=o}function so(i,o,u,p){Fa=Zi=null,J0(o),Ks=null,Cl=0;var v=o.return;try{if(XE(i,v,o,u,pt)){an=1,bu(i,Lr(u,i.current)),dt=null;return}}catch(w){if(v!==null)throw dt=v,w;an=1,bu(i,Lr(u,i.current)),dt=null;return}o.flags&32768?(Ct||p===1?i=!0:to||(pt&536870912)!==0?i=!1:(gi=i=!0,(p===2||p===9||p===3||p===6)&&(p=Vr.current,p!==null&&p.tag===13&&(p.flags|=16384))),g1(o,i)):Pu(o)}function Pu(i){var o=i;do{if((o.flags&32768)!==0){g1(o,gi);return}i=o.return;var u=ZE(o.alternate,o,Ga);if(u!==null){dt=u;return}if(o=o.sibling,o!==null){dt=o;return}dt=o=i}while(o!==null);an===0&&(an=5)}function g1(i,o){do{var u=QE(i.alternate,i);if(u!==null){u.flags&=32767,dt=u;return}if(u=i.return,u!==null&&(u.flags|=32768,u.subtreeFlags=0,u.deletions=null),!o&&(i=i.sibling,i!==null)){dt=i;return}dt=i=u}while(i!==null);an=6,dt=null}function x1(i,o,u,p,v,w,A,R,J){i.cancelPendingCommit=null;do Lu();while(Gn!==0);if((At&6)!==0)throw Error(r(327));if(o!==null){if(o===i.current)throw Error(r(177));if(w=o.lanes|o.childLanes,w|=E0,Rr(i,u,w,A,R,J),i===$t&&(dt=$t=null,pt=0),ro=o,yi=i,ao=u,Nd=w,Md=v,o1=p,(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?(i.callbackNode=null,i.callbackPriority=0,fC($n,function(){return w1(),null})):(i.callbackNode=null,i.callbackPriority=0),p=(o.flags&13878)!==0,(o.subtreeFlags&13878)!==0||p){p=ee.T,ee.T=null,v=me.p,me.p=2,A=At,At|=4;try{eC(i,o,u)}finally{At=A,me.p=v,ee.T=p}}Gn=1,v1(),y1(),_1()}}function v1(){if(Gn===1){Gn=0;var i=yi,o=ro,u=(o.flags&13878)!==0;if((o.subtreeFlags&13878)!==0||u){u=ee.T,ee.T=null;var p=me.p;me.p=2;var v=At;At|=4;try{e1(o,i);var w=$d,A=sg(i.containerInfo),R=w.focusedElem,J=w.selectionRange;if(A!==R&&R&&R.ownerDocument&&ig(R.ownerDocument.documentElement,R)){if(J!==null&&y0(R)){var oe=J.start,ve=J.end;if(ve===void 0&&(ve=oe),"selectionStart"in R)R.selectionStart=oe,R.selectionEnd=Math.min(ve,R.value.length);else{var we=R.ownerDocument||document,fe=we&&we.defaultView||window;if(fe.getSelection){var he=fe.getSelection(),Ke=R.textContent.length,je=Math.min(J.start,Ke),Ut=J.end===void 0?je:Math.min(J.end,Ke);!he.extend&&je>Ut&&(A=Ut,Ut=je,je=A);var ne=ag(R,je),Q=ag(R,Ut);if(ne&&Q&&(he.rangeCount!==1||he.anchorNode!==ne.node||he.anchorOffset!==ne.offset||he.focusNode!==Q.node||he.focusOffset!==Q.offset)){var se=we.createRange();se.setStart(ne.node,ne.offset),he.removeAllRanges(),je>Ut?(he.addRange(se),he.extend(Q.node,Q.offset)):(se.setEnd(Q.node,Q.offset),he.addRange(se))}}}}for(we=[],he=R;he=he.parentNode;)he.nodeType===1&&we.push({element:he,left:he.scrollLeft,top:he.scrollTop});for(typeof R.focus=="function"&&R.focus(),R=0;R<we.length;R++){var _e=we[R];_e.element.scrollLeft=_e.left,_e.element.scrollTop=_e.top}}Yu=!!jd,$d=jd=null}finally{At=v,me.p=p,ee.T=u}}i.current=o,Gn=2}}function y1(){if(Gn===2){Gn=0;var i=yi,o=ro,u=(o.flags&8772)!==0;if((o.subtreeFlags&8772)!==0||u){u=ee.T,ee.T=null;var p=me.p;me.p=2;var v=At;At|=4;try{Xx(i,o.alternate,o)}finally{At=v,me.p=p,ee.T=u}}Gn=3}}function _1(){if(Gn===4||Gn===3){Gn=0,qe();var i=yi,o=ro,u=ao,p=o1;(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?Gn=5:(Gn=0,ro=yi=null,T1(i,i.pendingLanes));var v=i.pendingLanes;if(v===0&&(vi=null),Qo(u),o=o.stateNode,cn&&typeof cn.onCommitFiberRoot=="function")try{cn.onCommitFiberRoot(Bn,o,void 0,(o.current.flags&128)===128)}catch{}if(p!==null){o=ee.T,v=me.p,me.p=2,ee.T=null;try{for(var w=i.onRecoverableError,A=0;A<p.length;A++){var R=p[A];w(R.value,{componentStack:R.stack})}}finally{ee.T=o,me.p=v}}(ao&3)!==0&&Lu(),_a(i),v=i.pendingLanes,(u&4194090)!==0&&(v&42)!==0?i===Dd?Il++:(Il=0,Dd=i):Il=0,Pl(0)}}function T1(i,o){(i.pooledCacheLanes&=o)===0&&(o=i.pooledCache,o!=null&&(i.pooledCache=null,ml(o)))}function Lu(i){return v1(),y1(),_1(),w1()}function w1(){if(Gn!==5)return!1;var i=yi,o=Nd;Nd=0;var u=Qo(ao),p=ee.T,v=me.p;try{me.p=32>u?32:u,ee.T=null,u=Md,Md=null;var w=yi,A=ao;if(Gn=0,ro=yi=null,ao=0,(At&6)!==0)throw Error(r(331));var R=At;if(At|=4,i1(w.current),n1(w,w.current,A,u),At=R,Pl(0,!1),cn&&typeof cn.onPostCommitFiberRoot=="function")try{cn.onPostCommitFiberRoot(Bn,w)}catch{}return!0}finally{me.p=v,ee.T=p,T1(i,o)}}function S1(i,o,u){o=Lr(u,o),o=cd(i.stateNode,o,2),i=ci(i,o,2),i!==null&&(Qr(i,2),_a(i))}function Gt(i,o,u){if(i.tag===3)S1(i,i,u);else for(;o!==null;){if(o.tag===3){S1(o,i,u);break}else if(o.tag===1){var p=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof p.componentDidCatch=="function"&&(vi===null||!vi.has(p))){i=Lr(u,i),u=Ax(2),p=ci(o,u,2),p!==null&&(kx(u,p,o,i),Qr(p,2),_a(p));break}}o=o.return}}function Pd(i,o,u){var p=i.pingCache;if(p===null){p=i.pingCache=new rC;var v=new Set;p.set(o,v)}else v=p.get(o),v===void 0&&(v=new Set,p.set(o,v));v.has(u)||(Cd=!0,v.add(u),i=lC.bind(null,i,o,u),o.then(i,i))}function lC(i,o,u){var p=i.pingCache;p!==null&&p.delete(o),i.pingedLanes|=i.suspendedLanes&u,i.warmLanes&=~u,$t===i&&(pt&u)===u&&(an===4||an===3&&(pt&62914560)===pt&&300>Ne()-kd?(At&2)===0&&io(i,0):bd|=u,no===pt&&(no=0)),_a(i)}function E1(i,o){o===0&&(o=ma()),i=Gs(i,o),i!==null&&(Qr(i,o),_a(i))}function cC(i){var o=i.memoizedState,u=0;o!==null&&(u=o.retryLane),E1(i,u)}function uC(i,o){var u=0;switch(i.tag){case 13:var p=i.stateNode,v=i.memoizedState;v!==null&&(u=v.retryLane);break;case 19:p=i.stateNode;break;case 22:p=i.stateNode._retryCache;break;default:throw Error(r(314))}p!==null&&p.delete(o),E1(i,u)}function fC(i,o){return yt(i,o)}var Ou=null,oo=null,Ld=!1,Uu=!1,Od=!1,is=0;function _a(i){i!==oo&&i.next===null&&(oo===null?Ou=oo=i:oo=oo.next=i),Uu=!0,Ld||(Ld=!0,hC())}function Pl(i,o){if(!Od&&Uu){Od=!0;do for(var u=!1,p=Ou;p!==null;){if(i!==0){var v=p.pendingLanes;if(v===0)var w=0;else{var A=p.suspendedLanes,R=p.pingedLanes;w=(1<<31-zt(42|i)+1)-1,w&=v&~(A&~R),w=w&201326741?w&201326741|1:w?w|2:0}w!==0&&(u=!0,k1(p,w))}else w=pt,w=St(p,p===$t?w:0,p.cancelPendingCommit!==null||p.timeoutHandle!==-1),(w&3)===0||Be(p,w)||(u=!0,k1(p,w));p=p.next}while(u);Od=!1}}function dC(){C1()}function C1(){Uu=Ld=!1;var i=0;is!==0&&(TC()&&(i=is),is=0);for(var o=Ne(),u=null,p=Ou;p!==null;){var v=p.next,w=b1(p,o);w===0?(p.next=null,u===null?Ou=v:u.next=v,v===null&&(oo=u)):(u=p,(i!==0||(w&3)!==0)&&(Uu=!0)),p=v}Pl(i)}function b1(i,o){for(var u=i.suspendedLanes,p=i.pingedLanes,v=i.expirationTimes,w=i.pendingLanes&-62914561;0<w;){var A=31-zt(w),R=1<<A,J=v[A];J===-1?((R&u)===0||(R&p)!==0)&&(v[A]=Zt(R,o)):J<=o&&(i.expiredLanes|=R),w&=~R}if(o=$t,u=pt,u=St(i,i===o?u:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),p=i.callbackNode,u===0||i===o&&(kt===2||kt===9)||i.cancelPendingCommit!==null)return p!==null&&p!==null&&st(p),i.callbackNode=null,i.callbackPriority=0;if((u&3)===0||Be(i,u)){if(o=u&-u,o===i.callbackPriority)return o;switch(p!==null&&st(p),Qo(u)){case 2:case 8:u=On;break;case 32:u=$n;break;case 268435456:u=Un;break;default:u=$n}return p=A1.bind(null,i),u=yt(u,p),i.callbackPriority=o,i.callbackNode=u,o}return p!==null&&p!==null&&st(p),i.callbackPriority=2,i.callbackNode=null,2}function A1(i,o){if(Gn!==0&&Gn!==5)return i.callbackNode=null,i.callbackPriority=0,null;var u=i.callbackNode;if(Lu()&&i.callbackNode!==u)return null;var p=pt;return p=St(i,i===$t?p:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),p===0?null:(c1(i,p,o),b1(i,Ne()),i.callbackNode!=null&&i.callbackNode===u?A1.bind(null,i):null)}function k1(i,o){if(Lu())return null;c1(i,o,!0)}function hC(){SC(function(){(At&6)!==0?yt(Ln,dC):C1()})}function Ud(){return is===0&&(is=Et()),is}function N1(i){return i==null||typeof i=="symbol"||typeof i=="boolean"?null:typeof i=="function"?i:Jc(""+i)}function M1(i,o){var u=o.ownerDocument.createElement("input");return u.name=o.name,u.value=o.value,i.id&&u.setAttribute("form",i.id),o.parentNode.insertBefore(u,o),i=new FormData(i),u.parentNode.removeChild(u),i}function mC(i,o,u,p,v){if(o==="submit"&&u&&u.stateNode===v){var w=N1((v[An]||null).action),A=p.submitter;A&&(o=(o=A[An]||null)?N1(o.formAction):A.getAttribute("formAction"),o!==null&&(w=o,A=null));var R=new Qc("action","action",null,p,v);i.push({event:R,listeners:[{instance:null,listener:function(){if(p.defaultPrevented){if(is!==0){var J=A?M1(v,A):new FormData(v);ad(u,{pending:!0,data:J,method:v.method,action:w},null,J)}}else typeof w=="function"&&(R.preventDefault(),J=A?M1(v,A):new FormData(v),ad(u,{pending:!0,data:J,method:v.method,action:w},w,J))},currentTarget:v}]})}}for(var Bd=0;Bd<S0.length;Bd++){var Vd=S0[Bd],pC=Vd.toLowerCase(),gC=Vd[0].toUpperCase()+Vd.slice(1);na(pC,"on"+gC)}na(cg,"onAnimationEnd"),na(ug,"onAnimationIteration"),na(fg,"onAnimationStart"),na("dblclick","onDoubleClick"),na("focusin","onFocus"),na("focusout","onBlur"),na(FE,"onTransitionRun"),na(IE,"onTransitionStart"),na(PE,"onTransitionCancel"),na(dg,"onTransitionEnd"),Re("onMouseEnter",["mouseout","mouseover"]),Re("onMouseLeave",["mouseout","mouseover"]),Re("onPointerEnter",["pointerout","pointerover"]),Re("onPointerLeave",["pointerout","pointerover"]),ke("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),ke("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),ke("onBeforeInput",["compositionend","keypress","textInput","paste"]),ke("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),ke("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),ke("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ll="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),xC=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Ll));function D1(i,o){o=(o&4)!==0;for(var u=0;u<i.length;u++){var p=i[u],v=p.event;p=p.listeners;e:{var w=void 0;if(o)for(var A=p.length-1;0<=A;A--){var R=p[A],J=R.instance,oe=R.currentTarget;if(R=R.listener,J!==w&&v.isPropagationStopped())break e;w=R,v.currentTarget=oe;try{w(v)}catch(ve){Cu(ve)}v.currentTarget=null,w=J}else for(A=0;A<p.length;A++){if(R=p[A],J=R.instance,oe=R.currentTarget,R=R.listener,J!==w&&v.isPropagationStopped())break e;w=R,v.currentTarget=oe;try{w(v)}catch(ve){Cu(ve)}v.currentTarget=null,w=J}}}}function ht(i,o){var u=o[el];u===void 0&&(u=o[el]=new Set);var p=i+"__bubble";u.has(p)||(R1(o,i,2,!1),u.add(p))}function Gd(i,o,u){var p=0;o&&(p|=4),R1(u,i,p,o)}var Bu="_reactListening"+Math.random().toString(36).slice(2);function Hd(i){if(!i[Bu]){i[Bu]=!0,ue.forEach(function(u){u!=="selectionchange"&&(xC.has(u)||Gd(u,!1,i),Gd(u,!0,i))});var o=i.nodeType===9?i:i.ownerDocument;o===null||o[Bu]||(o[Bu]=!0,Gd("selectionchange",!1,o))}}function R1(i,o,u,p){switch(nv(o)){case 2:var v=qC;break;case 8:v=jC;break;default:v=nh}u=v.bind(null,o,u,i),v=void 0,!u0||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(v=!0),p?v!==void 0?i.addEventListener(o,u,{capture:!0,passive:v}):i.addEventListener(o,u,!0):v!==void 0?i.addEventListener(o,u,{passive:v}):i.addEventListener(o,u,!1)}function zd(i,o,u,p,v){var w=p;if((o&1)===0&&(o&2)===0&&p!==null)e:for(;;){if(p===null)return;var A=p.tag;if(A===3||A===4){var R=p.stateNode.containerInfo;if(R===v)break;if(A===4)for(A=p.return;A!==null;){var J=A.tag;if((J===3||J===4)&&A.stateNode.containerInfo===v)return;A=A.return}for(;R!==null;){if(A=V(R),A===null)return;if(J=A.tag,J===5||J===6||J===26||J===27){p=w=A;continue e}R=R.parentNode}}p=p.return}Bp(function(){var oe=w,ve=l0(u),we=[];e:{var fe=hg.get(i);if(fe!==void 0){var he=Qc,Ke=i;switch(i){case"keypress":if(Kc(u)===0)break e;case"keydown":case"keyup":he=fE;break;case"focusin":Ke="focus",he=m0;break;case"focusout":Ke="blur",he=m0;break;case"beforeblur":case"afterblur":he=m0;break;case"click":if(u.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":he=Hp;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":he=QS;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":he=mE;break;case cg:case ug:case fg:he=nE;break;case dg:he=gE;break;case"scroll":case"scrollend":he=KS;break;case"wheel":he=vE;break;case"copy":case"cut":case"paste":he=aE;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":he=qp;break;case"toggle":case"beforetoggle":he=_E}var je=(o&4)!==0,Ut=!je&&(i==="scroll"||i==="scrollend"),ne=je?fe!==null?fe+"Capture":null:fe;je=[];for(var Q=oe,se;Q!==null;){var _e=Q;if(se=_e.stateNode,_e=_e.tag,_e!==5&&_e!==26&&_e!==27||se===null||ne===null||(_e=tl(Q,ne),_e!=null&&je.push(Ol(Q,_e,se))),Ut)break;Q=Q.return}0<je.length&&(fe=new he(fe,Ke,null,u,ve),we.push({event:fe,listeners:je}))}}if((o&7)===0){e:{if(fe=i==="mouseover"||i==="pointerover",he=i==="mouseout"||i==="pointerout",fe&&u!==o0&&(Ke=u.relatedTarget||u.fromElement)&&(V(Ke)||Ke[ri]))break e;if((he||fe)&&(fe=ve.window===ve?ve:(fe=ve.ownerDocument)?fe.defaultView||fe.parentWindow:window,he?(Ke=u.relatedTarget||u.toElement,he=oe,Ke=Ke?V(Ke):null,Ke!==null&&(Ut=s(Ke),je=Ke.tag,Ke!==Ut||je!==5&&je!==27&&je!==6)&&(Ke=null)):(he=null,Ke=oe),he!==Ke)){if(je=Hp,_e="onMouseLeave",ne="onMouseEnter",Q="mouse",(i==="pointerout"||i==="pointerover")&&(je=qp,_e="onPointerLeave",ne="onPointerEnter",Q="pointer"),Ut=he==null?fe:le(he),se=Ke==null?fe:le(Ke),fe=new je(_e,Q+"leave",he,u,ve),fe.target=Ut,fe.relatedTarget=se,_e=null,V(ve)===oe&&(je=new je(ne,Q+"enter",Ke,u,ve),je.target=se,je.relatedTarget=Ut,_e=je),Ut=_e,he&&Ke)t:{for(je=he,ne=Ke,Q=0,se=je;se;se=lo(se))Q++;for(se=0,_e=ne;_e;_e=lo(_e))se++;for(;0<Q-se;)je=lo(je),Q--;for(;0<se-Q;)ne=lo(ne),se--;for(;Q--;){if(je===ne||ne!==null&&je===ne.alternate)break t;je=lo(je),ne=lo(ne)}je=null}else je=null;he!==null&&F1(we,fe,he,je,!1),Ke!==null&&Ut!==null&&F1(we,Ut,Ke,je,!0)}}e:{if(fe=oe?le(oe):window,he=fe.nodeName&&fe.nodeName.toLowerCase(),he==="select"||he==="input"&&fe.type==="file")var Ve=Zp;else if(Xp(fe))if(Qp)Ve=ME;else{Ve=kE;var ct=AE}else he=fe.nodeName,!he||he.toLowerCase()!=="input"||fe.type!=="checkbox"&&fe.type!=="radio"?oe&&s0(oe.elementType)&&(Ve=Zp):Ve=NE;if(Ve&&(Ve=Ve(i,oe))){Kp(we,Ve,u,ve);break e}ct&&ct(i,fe,oe),i==="focusout"&&oe&&fe.type==="number"&&oe.memoizedProps.value!=null&&i0(fe,"number",fe.value)}switch(ct=oe?le(oe):window,i){case"focusin":(Xp(ct)||ct.contentEditable==="true")&&(Us=ct,_0=oe,cl=null);break;case"focusout":cl=_0=Us=null;break;case"mousedown":T0=!0;break;case"contextmenu":case"mouseup":case"dragend":T0=!1,og(we,u,ve);break;case"selectionchange":if(RE)break;case"keydown":case"keyup":og(we,u,ve)}var He;if(g0)e:{switch(i){case"compositionstart":var We="onCompositionStart";break e;case"compositionend":We="onCompositionEnd";break e;case"compositionupdate":We="onCompositionUpdate";break e}We=void 0}else Os?Yp(i,u)&&(We="onCompositionEnd"):i==="keydown"&&u.keyCode===229&&(We="onCompositionStart");We&&(jp&&u.locale!=="ko"&&(Os||We!=="onCompositionStart"?We==="onCompositionEnd"&&Os&&(He=Vp()):(ii=ve,f0="value"in ii?ii.value:ii.textContent,Os=!0)),ct=Vu(oe,We),0<ct.length&&(We=new zp(We,i,null,u,ve),we.push({event:We,listeners:ct}),He?We.data=He:(He=Jp(u),He!==null&&(We.data=He)))),(He=wE?SE(i,u):EE(i,u))&&(We=Vu(oe,"onBeforeInput"),0<We.length&&(ct=new zp("onBeforeInput","beforeinput",null,u,ve),we.push({event:ct,listeners:We}),ct.data=He)),mC(we,i,oe,u,ve)}D1(we,o)})}function Ol(i,o,u){return{instance:i,listener:o,currentTarget:u}}function Vu(i,o){for(var u=o+"Capture",p=[];i!==null;){var v=i,w=v.stateNode;if(v=v.tag,v!==5&&v!==26&&v!==27||w===null||(v=tl(i,u),v!=null&&p.unshift(Ol(i,v,w)),v=tl(i,o),v!=null&&p.push(Ol(i,v,w))),i.tag===3)return p;i=i.return}return[]}function lo(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5&&i.tag!==27);return i||null}function F1(i,o,u,p,v){for(var w=o._reactName,A=[];u!==null&&u!==p;){var R=u,J=R.alternate,oe=R.stateNode;if(R=R.tag,J!==null&&J===p)break;R!==5&&R!==26&&R!==27||oe===null||(J=oe,v?(oe=tl(u,w),oe!=null&&A.unshift(Ol(u,oe,J))):v||(oe=tl(u,w),oe!=null&&A.push(Ol(u,oe,J)))),u=u.return}A.length!==0&&i.push({event:o,listeners:A})}var vC=/\r\n?/g,yC=/\u0000|\uFFFD/g;function I1(i){return(typeof i=="string"?i:""+i).replace(vC,`
`).replace(yC,"")}function P1(i,o){return o=I1(o),I1(i)===o}function Gu(){}function Ot(i,o,u,p,v,w){switch(u){case"children":typeof p=="string"?o==="body"||o==="textarea"&&p===""||Is(i,p):(typeof p=="number"||typeof p=="bigint")&&o!=="body"&&Is(i,""+p);break;case"className":Pt(i,"class",p);break;case"tabIndex":Pt(i,"tabindex",p);break;case"dir":case"role":case"viewBox":case"width":case"height":Pt(i,u,p);break;case"style":Op(i,p,w);break;case"data":if(o!=="object"){Pt(i,"data",p);break}case"src":case"href":if(p===""&&(o!=="a"||u!=="href")){i.removeAttribute(u);break}if(p==null||typeof p=="function"||typeof p=="symbol"||typeof p=="boolean"){i.removeAttribute(u);break}p=Jc(""+p),i.setAttribute(u,p);break;case"action":case"formAction":if(typeof p=="function"){i.setAttribute(u,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof w=="function"&&(u==="formAction"?(o!=="input"&&Ot(i,o,"name",v.name,v,null),Ot(i,o,"formEncType",v.formEncType,v,null),Ot(i,o,"formMethod",v.formMethod,v,null),Ot(i,o,"formTarget",v.formTarget,v,null)):(Ot(i,o,"encType",v.encType,v,null),Ot(i,o,"method",v.method,v,null),Ot(i,o,"target",v.target,v,null)));if(p==null||typeof p=="symbol"||typeof p=="boolean"){i.removeAttribute(u);break}p=Jc(""+p),i.setAttribute(u,p);break;case"onClick":p!=null&&(i.onclick=Gu);break;case"onScroll":p!=null&&ht("scroll",i);break;case"onScrollEnd":p!=null&&ht("scrollend",i);break;case"dangerouslySetInnerHTML":if(p!=null){if(typeof p!="object"||!("__html"in p))throw Error(r(61));if(u=p.__html,u!=null){if(v.children!=null)throw Error(r(60));i.innerHTML=u}}break;case"multiple":i.multiple=p&&typeof p!="function"&&typeof p!="symbol";break;case"muted":i.muted=p&&typeof p!="function"&&typeof p!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(p==null||typeof p=="function"||typeof p=="boolean"||typeof p=="symbol"){i.removeAttribute("xlink:href");break}u=Jc(""+p),i.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",u);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":p!=null&&typeof p!="function"&&typeof p!="symbol"?i.setAttribute(u,""+p):i.removeAttribute(u);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":p&&typeof p!="function"&&typeof p!="symbol"?i.setAttribute(u,""):i.removeAttribute(u);break;case"capture":case"download":p===!0?i.setAttribute(u,""):p!==!1&&p!=null&&typeof p!="function"&&typeof p!="symbol"?i.setAttribute(u,p):i.removeAttribute(u);break;case"cols":case"rows":case"size":case"span":p!=null&&typeof p!="function"&&typeof p!="symbol"&&!isNaN(p)&&1<=p?i.setAttribute(u,p):i.removeAttribute(u);break;case"rowSpan":case"start":p==null||typeof p=="function"||typeof p=="symbol"||isNaN(p)?i.removeAttribute(u):i.setAttribute(u,p);break;case"popover":ht("beforetoggle",i),ht("toggle",i),It(i,"popover",p);break;case"xlinkActuate":jt(i,"http://www.w3.org/1999/xlink","xlink:actuate",p);break;case"xlinkArcrole":jt(i,"http://www.w3.org/1999/xlink","xlink:arcrole",p);break;case"xlinkRole":jt(i,"http://www.w3.org/1999/xlink","xlink:role",p);break;case"xlinkShow":jt(i,"http://www.w3.org/1999/xlink","xlink:show",p);break;case"xlinkTitle":jt(i,"http://www.w3.org/1999/xlink","xlink:title",p);break;case"xlinkType":jt(i,"http://www.w3.org/1999/xlink","xlink:type",p);break;case"xmlBase":jt(i,"http://www.w3.org/XML/1998/namespace","xml:base",p);break;case"xmlLang":jt(i,"http://www.w3.org/XML/1998/namespace","xml:lang",p);break;case"xmlSpace":jt(i,"http://www.w3.org/XML/1998/namespace","xml:space",p);break;case"is":It(i,"is",p);break;case"innerText":case"textContent":break;default:(!(2<u.length)||u[0]!=="o"&&u[0]!=="O"||u[1]!=="n"&&u[1]!=="N")&&(u=JS.get(u)||u,It(i,u,p))}}function qd(i,o,u,p,v,w){switch(u){case"style":Op(i,p,w);break;case"dangerouslySetInnerHTML":if(p!=null){if(typeof p!="object"||!("__html"in p))throw Error(r(61));if(u=p.__html,u!=null){if(v.children!=null)throw Error(r(60));i.innerHTML=u}}break;case"children":typeof p=="string"?Is(i,p):(typeof p=="number"||typeof p=="bigint")&&Is(i,""+p);break;case"onScroll":p!=null&&ht("scroll",i);break;case"onScrollEnd":p!=null&&ht("scrollend",i);break;case"onClick":p!=null&&(i.onclick=Gu);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!de.hasOwnProperty(u))e:{if(u[0]==="o"&&u[1]==="n"&&(v=u.endsWith("Capture"),o=u.slice(2,v?u.length-7:void 0),w=i[An]||null,w=w!=null?w[u]:null,typeof w=="function"&&i.removeEventListener(o,w,v),typeof p=="function")){typeof w!="function"&&w!==null&&(u in i?i[u]=null:i.hasAttribute(u)&&i.removeAttribute(u)),i.addEventListener(o,p,v);break e}u in i?i[u]=p:p===!0?i.setAttribute(u,""):It(i,u,p)}}}function Hn(i,o,u){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":ht("error",i),ht("load",i);var p=!1,v=!1,w;for(w in u)if(u.hasOwnProperty(w)){var A=u[w];if(A!=null)switch(w){case"src":p=!0;break;case"srcSet":v=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,o));default:Ot(i,o,w,A,u,null)}}v&&Ot(i,o,"srcSet",u.srcSet,u,null),p&&Ot(i,o,"src",u.src,u,null);return;case"input":ht("invalid",i);var R=w=A=v=null,J=null,oe=null;for(p in u)if(u.hasOwnProperty(p)){var ve=u[p];if(ve!=null)switch(p){case"name":v=ve;break;case"type":A=ve;break;case"checked":J=ve;break;case"defaultChecked":oe=ve;break;case"value":w=ve;break;case"defaultValue":R=ve;break;case"children":case"dangerouslySetInnerHTML":if(ve!=null)throw Error(r(137,o));break;default:Ot(i,o,p,ve,u,null)}}Fp(i,w,R,J,oe,A,v,!1),Wc(i);return;case"select":ht("invalid",i),p=A=w=null;for(v in u)if(u.hasOwnProperty(v)&&(R=u[v],R!=null))switch(v){case"value":w=R;break;case"defaultValue":A=R;break;case"multiple":p=R;default:Ot(i,o,v,R,u,null)}o=w,u=A,i.multiple=!!p,o!=null?Fs(i,!!p,o,!1):u!=null&&Fs(i,!!p,u,!0);return;case"textarea":ht("invalid",i),w=v=p=null;for(A in u)if(u.hasOwnProperty(A)&&(R=u[A],R!=null))switch(A){case"value":p=R;break;case"defaultValue":v=R;break;case"children":w=R;break;case"dangerouslySetInnerHTML":if(R!=null)throw Error(r(91));break;default:Ot(i,o,A,R,u,null)}Pp(i,p,v,w),Wc(i);return;case"option":for(J in u)if(u.hasOwnProperty(J)&&(p=u[J],p!=null))switch(J){case"selected":i.selected=p&&typeof p!="function"&&typeof p!="symbol";break;default:Ot(i,o,J,p,u,null)}return;case"dialog":ht("beforetoggle",i),ht("toggle",i),ht("cancel",i),ht("close",i);break;case"iframe":case"object":ht("load",i);break;case"video":case"audio":for(p=0;p<Ll.length;p++)ht(Ll[p],i);break;case"image":ht("error",i),ht("load",i);break;case"details":ht("toggle",i);break;case"embed":case"source":case"link":ht("error",i),ht("load",i);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(oe in u)if(u.hasOwnProperty(oe)&&(p=u[oe],p!=null))switch(oe){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,o));default:Ot(i,o,oe,p,u,null)}return;default:if(s0(o)){for(ve in u)u.hasOwnProperty(ve)&&(p=u[ve],p!==void 0&&qd(i,o,ve,p,u,void 0));return}}for(R in u)u.hasOwnProperty(R)&&(p=u[R],p!=null&&Ot(i,o,R,p,u,null))}function _C(i,o,u,p){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var v=null,w=null,A=null,R=null,J=null,oe=null,ve=null;for(he in u){var we=u[he];if(u.hasOwnProperty(he)&&we!=null)switch(he){case"checked":break;case"value":break;case"defaultValue":J=we;default:p.hasOwnProperty(he)||Ot(i,o,he,null,p,we)}}for(var fe in p){var he=p[fe];if(we=u[fe],p.hasOwnProperty(fe)&&(he!=null||we!=null))switch(fe){case"type":w=he;break;case"name":v=he;break;case"checked":oe=he;break;case"defaultChecked":ve=he;break;case"value":A=he;break;case"defaultValue":R=he;break;case"children":case"dangerouslySetInnerHTML":if(he!=null)throw Error(r(137,o));break;default:he!==we&&Ot(i,o,fe,he,p,we)}}a0(i,A,R,J,oe,ve,w,v);return;case"select":he=A=R=fe=null;for(w in u)if(J=u[w],u.hasOwnProperty(w)&&J!=null)switch(w){case"value":break;case"multiple":he=J;default:p.hasOwnProperty(w)||Ot(i,o,w,null,p,J)}for(v in p)if(w=p[v],J=u[v],p.hasOwnProperty(v)&&(w!=null||J!=null))switch(v){case"value":fe=w;break;case"defaultValue":R=w;break;case"multiple":A=w;default:w!==J&&Ot(i,o,v,w,p,J)}o=R,u=A,p=he,fe!=null?Fs(i,!!u,fe,!1):!!p!=!!u&&(o!=null?Fs(i,!!u,o,!0):Fs(i,!!u,u?[]:"",!1));return;case"textarea":he=fe=null;for(R in u)if(v=u[R],u.hasOwnProperty(R)&&v!=null&&!p.hasOwnProperty(R))switch(R){case"value":break;case"children":break;default:Ot(i,o,R,null,p,v)}for(A in p)if(v=p[A],w=u[A],p.hasOwnProperty(A)&&(v!=null||w!=null))switch(A){case"value":fe=v;break;case"defaultValue":he=v;break;case"children":break;case"dangerouslySetInnerHTML":if(v!=null)throw Error(r(91));break;default:v!==w&&Ot(i,o,A,v,p,w)}Ip(i,fe,he);return;case"option":for(var Ke in u)if(fe=u[Ke],u.hasOwnProperty(Ke)&&fe!=null&&!p.hasOwnProperty(Ke))switch(Ke){case"selected":i.selected=!1;break;default:Ot(i,o,Ke,null,p,fe)}for(J in p)if(fe=p[J],he=u[J],p.hasOwnProperty(J)&&fe!==he&&(fe!=null||he!=null))switch(J){case"selected":i.selected=fe&&typeof fe!="function"&&typeof fe!="symbol";break;default:Ot(i,o,J,fe,p,he)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var je in u)fe=u[je],u.hasOwnProperty(je)&&fe!=null&&!p.hasOwnProperty(je)&&Ot(i,o,je,null,p,fe);for(oe in p)if(fe=p[oe],he=u[oe],p.hasOwnProperty(oe)&&fe!==he&&(fe!=null||he!=null))switch(oe){case"children":case"dangerouslySetInnerHTML":if(fe!=null)throw Error(r(137,o));break;default:Ot(i,o,oe,fe,p,he)}return;default:if(s0(o)){for(var Ut in u)fe=u[Ut],u.hasOwnProperty(Ut)&&fe!==void 0&&!p.hasOwnProperty(Ut)&&qd(i,o,Ut,void 0,p,fe);for(ve in p)fe=p[ve],he=u[ve],!p.hasOwnProperty(ve)||fe===he||fe===void 0&&he===void 0||qd(i,o,ve,fe,p,he);return}}for(var ne in u)fe=u[ne],u.hasOwnProperty(ne)&&fe!=null&&!p.hasOwnProperty(ne)&&Ot(i,o,ne,null,p,fe);for(we in p)fe=p[we],he=u[we],!p.hasOwnProperty(we)||fe===he||fe==null&&he==null||Ot(i,o,we,fe,p,he)}var jd=null,$d=null;function Hu(i){return i.nodeType===9?i:i.ownerDocument}function L1(i){switch(i){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function O1(i,o){if(i===0)switch(o){case"svg":return 1;case"math":return 2;default:return 0}return i===1&&o==="foreignObject"?0:i}function Wd(i,o){return i==="textarea"||i==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.children=="bigint"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var Yd=null;function TC(){var i=window.event;return i&&i.type==="popstate"?i===Yd?!1:(Yd=i,!0):(Yd=null,!1)}var U1=typeof setTimeout=="function"?setTimeout:void 0,wC=typeof clearTimeout=="function"?clearTimeout:void 0,B1=typeof Promise=="function"?Promise:void 0,SC=typeof queueMicrotask=="function"?queueMicrotask:typeof B1<"u"?function(i){return B1.resolve(null).then(i).catch(EC)}:U1;function EC(i){setTimeout(function(){throw i})}function Ti(i){return i==="head"}function V1(i,o){var u=o,p=0,v=0;do{var w=u.nextSibling;if(i.removeChild(u),w&&w.nodeType===8)if(u=w.data,u==="/$"){if(0<p&&8>p){u=p;var A=i.ownerDocument;if(u&1&&Ul(A.documentElement),u&2&&Ul(A.body),u&4)for(u=A.head,Ul(u),A=u.firstChild;A;){var R=A.nextSibling,J=A.nodeName;A[O]||J==="SCRIPT"||J==="STYLE"||J==="LINK"&&A.rel.toLowerCase()==="stylesheet"||u.removeChild(A),A=R}}if(v===0){i.removeChild(w),$l(o);return}v--}else u==="$"||u==="$?"||u==="$!"?v++:p=u.charCodeAt(0)-48;else p=0;u=w}while(u);$l(o)}function Jd(i){var o=i.firstChild;for(o&&o.nodeType===10&&(o=o.nextSibling);o;){var u=o;switch(o=o.nextSibling,u.nodeName){case"HTML":case"HEAD":case"BODY":Jd(u),U(u);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(u.rel.toLowerCase()==="stylesheet")continue}i.removeChild(u)}}function CC(i,o,u,p){for(;i.nodeType===1;){var v=u;if(i.nodeName.toLowerCase()!==o.toLowerCase()){if(!p&&(i.nodeName!=="INPUT"||i.type!=="hidden"))break}else if(p){if(!i[O])switch(o){case"meta":if(!i.hasAttribute("itemprop"))break;return i;case"link":if(w=i.getAttribute("rel"),w==="stylesheet"&&i.hasAttribute("data-precedence"))break;if(w!==v.rel||i.getAttribute("href")!==(v.href==null||v.href===""?null:v.href)||i.getAttribute("crossorigin")!==(v.crossOrigin==null?null:v.crossOrigin)||i.getAttribute("title")!==(v.title==null?null:v.title))break;return i;case"style":if(i.hasAttribute("data-precedence"))break;return i;case"script":if(w=i.getAttribute("src"),(w!==(v.src==null?null:v.src)||i.getAttribute("type")!==(v.type==null?null:v.type)||i.getAttribute("crossorigin")!==(v.crossOrigin==null?null:v.crossOrigin))&&w&&i.hasAttribute("async")&&!i.hasAttribute("itemprop"))break;return i;default:return i}}else if(o==="input"&&i.type==="hidden"){var w=v.name==null?null:""+v.name;if(v.type==="hidden"&&i.getAttribute("name")===w)return i}else return i;if(i=aa(i.nextSibling),i===null)break}return null}function bC(i,o,u){if(o==="")return null;for(;i.nodeType!==3;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!u||(i=aa(i.nextSibling),i===null))return null;return i}function Xd(i){return i.data==="$!"||i.data==="$?"&&i.ownerDocument.readyState==="complete"}function AC(i,o){var u=i.ownerDocument;if(i.data!=="$?"||u.readyState==="complete")o();else{var p=function(){o(),u.removeEventListener("DOMContentLoaded",p)};u.addEventListener("DOMContentLoaded",p),i._reactRetry=p}}function aa(i){for(;i!=null;i=i.nextSibling){var o=i.nodeType;if(o===1||o===3)break;if(o===8){if(o=i.data,o==="$"||o==="$!"||o==="$?"||o==="F!"||o==="F")break;if(o==="/$")return null}}return i}var Kd=null;function G1(i){i=i.previousSibling;for(var o=0;i;){if(i.nodeType===8){var u=i.data;if(u==="$"||u==="$!"||u==="$?"){if(o===0)return i;o--}else u==="/$"&&o++}i=i.previousSibling}return null}function H1(i,o,u){switch(o=Hu(u),i){case"html":if(i=o.documentElement,!i)throw Error(r(452));return i;case"head":if(i=o.head,!i)throw Error(r(453));return i;case"body":if(i=o.body,!i)throw Error(r(454));return i;default:throw Error(r(451))}}function Ul(i){for(var o=i.attributes;o.length;)i.removeAttributeNode(o[0]);U(i)}var Hr=new Map,z1=new Set;function zu(i){return typeof i.getRootNode=="function"?i.getRootNode():i.nodeType===9?i:i.ownerDocument}var Ha=me.d;me.d={f:kC,r:NC,D:MC,C:DC,L:RC,m:FC,X:PC,S:IC,M:LC};function kC(){var i=Ha.f(),o=Iu();return i||o}function NC(i){var o=H(i);o!==null&&o.tag===5&&o.type==="form"?cx(o):Ha.r(i)}var co=typeof document>"u"?null:document;function q1(i,o,u){var p=co;if(p&&typeof o=="string"&&o){var v=Pr(o);v='link[rel="'+i+'"][href="'+v+'"]',typeof u=="string"&&(v+='[crossorigin="'+u+'"]'),z1.has(v)||(z1.add(v),i={rel:i,crossOrigin:u,href:o},p.querySelector(v)===null&&(o=p.createElement("link"),Hn(o,"link",i),ae(o),p.head.appendChild(o)))}}function MC(i){Ha.D(i),q1("dns-prefetch",i,null)}function DC(i,o){Ha.C(i,o),q1("preconnect",i,o)}function RC(i,o,u){Ha.L(i,o,u);var p=co;if(p&&i&&o){var v='link[rel="preload"][as="'+Pr(o)+'"]';o==="image"&&u&&u.imageSrcSet?(v+='[imagesrcset="'+Pr(u.imageSrcSet)+'"]',typeof u.imageSizes=="string"&&(v+='[imagesizes="'+Pr(u.imageSizes)+'"]')):v+='[href="'+Pr(i)+'"]';var w=v;switch(o){case"style":w=uo(i);break;case"script":w=fo(i)}Hr.has(w)||(i=g({rel:"preload",href:o==="image"&&u&&u.imageSrcSet?void 0:i,as:o},u),Hr.set(w,i),p.querySelector(v)!==null||o==="style"&&p.querySelector(Bl(w))||o==="script"&&p.querySelector(Vl(w))||(o=p.createElement("link"),Hn(o,"link",i),ae(o),p.head.appendChild(o)))}}function FC(i,o){Ha.m(i,o);var u=co;if(u&&i){var p=o&&typeof o.as=="string"?o.as:"script",v='link[rel="modulepreload"][as="'+Pr(p)+'"][href="'+Pr(i)+'"]',w=v;switch(p){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":w=fo(i)}if(!Hr.has(w)&&(i=g({rel:"modulepreload",href:i},o),Hr.set(w,i),u.querySelector(v)===null)){switch(p){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(u.querySelector(Vl(w)))return}p=u.createElement("link"),Hn(p,"link",i),ae(p),u.head.appendChild(p)}}}function IC(i,o,u){Ha.S(i,o,u);var p=co;if(p&&i){var v=ge(p).hoistableStyles,w=uo(i);o=o||"default";var A=v.get(w);if(!A){var R={loading:0,preload:null};if(A=p.querySelector(Bl(w)))R.loading=5;else{i=g({rel:"stylesheet",href:i,"data-precedence":o},u),(u=Hr.get(w))&&Zd(i,u);var J=A=p.createElement("link");ae(J),Hn(J,"link",i),J._p=new Promise(function(oe,ve){J.onload=oe,J.onerror=ve}),J.addEventListener("load",function(){R.loading|=1}),J.addEventListener("error",function(){R.loading|=2}),R.loading|=4,qu(A,o,p)}A={type:"stylesheet",instance:A,count:1,state:R},v.set(w,A)}}}function PC(i,o){Ha.X(i,o);var u=co;if(u&&i){var p=ge(u).hoistableScripts,v=fo(i),w=p.get(v);w||(w=u.querySelector(Vl(v)),w||(i=g({src:i,async:!0},o),(o=Hr.get(v))&&Qd(i,o),w=u.createElement("script"),ae(w),Hn(w,"link",i),u.head.appendChild(w)),w={type:"script",instance:w,count:1,state:null},p.set(v,w))}}function LC(i,o){Ha.M(i,o);var u=co;if(u&&i){var p=ge(u).hoistableScripts,v=fo(i),w=p.get(v);w||(w=u.querySelector(Vl(v)),w||(i=g({src:i,async:!0,type:"module"},o),(o=Hr.get(v))&&Qd(i,o),w=u.createElement("script"),ae(w),Hn(w,"link",i),u.head.appendChild(w)),w={type:"script",instance:w,count:1,state:null},p.set(v,w))}}function j1(i,o,u,p){var v=(v=ie.current)?zu(v):null;if(!v)throw Error(r(446));switch(i){case"meta":case"title":return null;case"style":return typeof u.precedence=="string"&&typeof u.href=="string"?(o=uo(u.href),u=ge(v).hoistableStyles,p=u.get(o),p||(p={type:"style",instance:null,count:0,state:null},u.set(o,p)),p):{type:"void",instance:null,count:0,state:null};case"link":if(u.rel==="stylesheet"&&typeof u.href=="string"&&typeof u.precedence=="string"){i=uo(u.href);var w=ge(v).hoistableStyles,A=w.get(i);if(A||(v=v.ownerDocument||v,A={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},w.set(i,A),(w=v.querySelector(Bl(i)))&&!w._p&&(A.instance=w,A.state.loading=5),Hr.has(i)||(u={rel:"preload",as:"style",href:u.href,crossOrigin:u.crossOrigin,integrity:u.integrity,media:u.media,hrefLang:u.hrefLang,referrerPolicy:u.referrerPolicy},Hr.set(i,u),w||OC(v,i,u,A.state))),o&&p===null)throw Error(r(528,""));return A}if(o&&p!==null)throw Error(r(529,""));return null;case"script":return o=u.async,u=u.src,typeof u=="string"&&o&&typeof o!="function"&&typeof o!="symbol"?(o=fo(u),u=ge(v).hoistableScripts,p=u.get(o),p||(p={type:"script",instance:null,count:0,state:null},u.set(o,p)),p):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,i))}}function uo(i){return'href="'+Pr(i)+'"'}function Bl(i){return'link[rel="stylesheet"]['+i+"]"}function $1(i){return g({},i,{"data-precedence":i.precedence,precedence:null})}function OC(i,o,u,p){i.querySelector('link[rel="preload"][as="style"]['+o+"]")?p.loading=1:(o=i.createElement("link"),p.preload=o,o.addEventListener("load",function(){return p.loading|=1}),o.addEventListener("error",function(){return p.loading|=2}),Hn(o,"link",u),ae(o),i.head.appendChild(o))}function fo(i){return'[src="'+Pr(i)+'"]'}function Vl(i){return"script[async]"+i}function W1(i,o,u){if(o.count++,o.instance===null)switch(o.type){case"style":var p=i.querySelector('style[data-href~="'+Pr(u.href)+'"]');if(p)return o.instance=p,ae(p),p;var v=g({},u,{"data-href":u.href,"data-precedence":u.precedence,href:null,precedence:null});return p=(i.ownerDocument||i).createElement("style"),ae(p),Hn(p,"style",v),qu(p,u.precedence,i),o.instance=p;case"stylesheet":v=uo(u.href);var w=i.querySelector(Bl(v));if(w)return o.state.loading|=4,o.instance=w,ae(w),w;p=$1(u),(v=Hr.get(v))&&Zd(p,v),w=(i.ownerDocument||i).createElement("link"),ae(w);var A=w;return A._p=new Promise(function(R,J){A.onload=R,A.onerror=J}),Hn(w,"link",p),o.state.loading|=4,qu(w,u.precedence,i),o.instance=w;case"script":return w=fo(u.src),(v=i.querySelector(Vl(w)))?(o.instance=v,ae(v),v):(p=u,(v=Hr.get(w))&&(p=g({},u),Qd(p,v)),i=i.ownerDocument||i,v=i.createElement("script"),ae(v),Hn(v,"link",p),i.head.appendChild(v),o.instance=v);case"void":return null;default:throw Error(r(443,o.type))}else o.type==="stylesheet"&&(o.state.loading&4)===0&&(p=o.instance,o.state.loading|=4,qu(p,u.precedence,i));return o.instance}function qu(i,o,u){for(var p=u.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),v=p.length?p[p.length-1]:null,w=v,A=0;A<p.length;A++){var R=p[A];if(R.dataset.precedence===o)w=R;else if(w!==v)break}w?w.parentNode.insertBefore(i,w.nextSibling):(o=u.nodeType===9?u.head:u,o.insertBefore(i,o.firstChild))}function Zd(i,o){i.crossOrigin==null&&(i.crossOrigin=o.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=o.referrerPolicy),i.title==null&&(i.title=o.title)}function Qd(i,o){i.crossOrigin==null&&(i.crossOrigin=o.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=o.referrerPolicy),i.integrity==null&&(i.integrity=o.integrity)}var ju=null;function Y1(i,o,u){if(ju===null){var p=new Map,v=ju=new Map;v.set(u,p)}else v=ju,p=v.get(u),p||(p=new Map,v.set(u,p));if(p.has(i))return p;for(p.set(i,null),u=u.getElementsByTagName(i),v=0;v<u.length;v++){var w=u[v];if(!(w[O]||w[bn]||i==="link"&&w.getAttribute("rel")==="stylesheet")&&w.namespaceURI!=="http://www.w3.org/2000/svg"){var A=w.getAttribute(o)||"";A=i+A;var R=p.get(A);R?R.push(w):p.set(A,[w])}}return p}function J1(i,o,u){i=i.ownerDocument||i,i.head.insertBefore(u,o==="title"?i.querySelector("head > title"):null)}function UC(i,o,u){if(u===1||o.itemProp!=null)return!1;switch(i){case"meta":case"title":return!0;case"style":if(typeof o.precedence!="string"||typeof o.href!="string"||o.href==="")break;return!0;case"link":if(typeof o.rel!="string"||typeof o.href!="string"||o.href===""||o.onLoad||o.onError)break;switch(o.rel){case"stylesheet":return i=o.disabled,typeof o.precedence=="string"&&i==null;default:return!0}case"script":if(o.async&&typeof o.async!="function"&&typeof o.async!="symbol"&&!o.onLoad&&!o.onError&&o.src&&typeof o.src=="string")return!0}return!1}function X1(i){return!(i.type==="stylesheet"&&(i.state.loading&3)===0)}var Gl=null;function BC(){}function VC(i,o,u){if(Gl===null)throw Error(r(475));var p=Gl;if(o.type==="stylesheet"&&(typeof u.media!="string"||matchMedia(u.media).matches!==!1)&&(o.state.loading&4)===0){if(o.instance===null){var v=uo(u.href),w=i.querySelector(Bl(v));if(w){i=w._p,i!==null&&typeof i=="object"&&typeof i.then=="function"&&(p.count++,p=$u.bind(p),i.then(p,p)),o.state.loading|=4,o.instance=w,ae(w);return}w=i.ownerDocument||i,u=$1(u),(v=Hr.get(v))&&Zd(u,v),w=w.createElement("link"),ae(w);var A=w;A._p=new Promise(function(R,J){A.onload=R,A.onerror=J}),Hn(w,"link",u),o.instance=w}p.stylesheets===null&&(p.stylesheets=new Map),p.stylesheets.set(o,i),(i=o.state.preload)&&(o.state.loading&3)===0&&(p.count++,o=$u.bind(p),i.addEventListener("load",o),i.addEventListener("error",o))}}function GC(){if(Gl===null)throw Error(r(475));var i=Gl;return i.stylesheets&&i.count===0&&eh(i,i.stylesheets),0<i.count?function(o){var u=setTimeout(function(){if(i.stylesheets&&eh(i,i.stylesheets),i.unsuspend){var p=i.unsuspend;i.unsuspend=null,p()}},6e4);return i.unsuspend=o,function(){i.unsuspend=null,clearTimeout(u)}}:null}function $u(){if(this.count--,this.count===0){if(this.stylesheets)eh(this,this.stylesheets);else if(this.unsuspend){var i=this.unsuspend;this.unsuspend=null,i()}}}var Wu=null;function eh(i,o){i.stylesheets=null,i.unsuspend!==null&&(i.count++,Wu=new Map,o.forEach(HC,i),Wu=null,$u.call(i))}function HC(i,o){if(!(o.state.loading&4)){var u=Wu.get(i);if(u)var p=u.get(null);else{u=new Map,Wu.set(i,u);for(var v=i.querySelectorAll("link[data-precedence],style[data-precedence]"),w=0;w<v.length;w++){var A=v[w];(A.nodeName==="LINK"||A.getAttribute("media")!=="not all")&&(u.set(A.dataset.precedence,A),p=A)}p&&u.set(null,p)}v=o.instance,A=v.getAttribute("data-precedence"),w=u.get(A)||p,w===p&&u.set(null,v),u.set(A,v),this.count++,p=$u.bind(this),v.addEventListener("load",p),v.addEventListener("error",p),w?w.parentNode.insertBefore(v,w.nextSibling):(i=i.nodeType===9?i.head:i,i.insertBefore(v,i.firstChild)),o.state.loading|=4}}var Hl={$$typeof:b,Provider:null,Consumer:null,_currentValue:Pe,_currentValue2:Pe,_threadCount:0};function zC(i,o,u,p,v,w,A,R){this.tag=1,this.containerInfo=i,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Aa(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Aa(0),this.hiddenUpdates=Aa(null),this.identifierPrefix=p,this.onUncaughtError=v,this.onCaughtError=w,this.onRecoverableError=A,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=R,this.incompleteTransitions=new Map}function K1(i,o,u,p,v,w,A,R,J,oe,ve,we){return i=new zC(i,o,u,A,R,J,oe,we),o=1,w===!0&&(o|=24),w=Tr(3,null,null,o),i.current=w,w.stateNode=i,o=P0(),o.refCount++,i.pooledCache=o,o.refCount++,w.memoizedState={element:p,isDehydrated:u,cache:o},B0(w),i}function Z1(i){return i?(i=Hs,i):Hs}function Q1(i,o,u,p,v,w){v=Z1(v),p.context===null?p.context=v:p.pendingContext=v,p=li(o),p.payload={element:u},w=w===void 0?null:w,w!==null&&(p.callback=w),u=ci(i,p,o),u!==null&&(br(u,i,o),vl(u,i,o))}function ev(i,o){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var u=i.retryLane;i.retryLane=u!==0&&u<o?u:o}}function th(i,o){ev(i,o),(i=i.alternate)&&ev(i,o)}function tv(i){if(i.tag===13){var o=Gs(i,67108864);o!==null&&br(o,i,67108864),th(i,67108864)}}var Yu=!0;function qC(i,o,u,p){var v=ee.T;ee.T=null;var w=me.p;try{me.p=2,nh(i,o,u,p)}finally{me.p=w,ee.T=v}}function jC(i,o,u,p){var v=ee.T;ee.T=null;var w=me.p;try{me.p=8,nh(i,o,u,p)}finally{me.p=w,ee.T=v}}function nh(i,o,u,p){if(Yu){var v=rh(p);if(v===null)zd(i,o,p,Ju,u),rv(i,p);else if(WC(v,i,o,u,p))p.stopPropagation();else if(rv(i,p),o&4&&-1<$C.indexOf(i)){for(;v!==null;){var w=H(v);if(w!==null)switch(w.tag){case 3:if(w=w.stateNode,w.current.memoizedState.isDehydrated){var A=Oe(w.pendingLanes);if(A!==0){var R=w;for(R.pendingLanes|=2,R.entangledLanes|=2;A;){var J=1<<31-zt(A);R.entanglements[1]|=J,A&=~J}_a(w),(At&6)===0&&(Ru=Ne()+500,Pl(0))}}break;case 13:R=Gs(w,2),R!==null&&br(R,w,2),Iu(),th(w,2)}if(w=rh(p),w===null&&zd(i,o,p,Ju,u),w===v)break;v=w}v!==null&&p.stopPropagation()}else zd(i,o,p,null,u)}}function rh(i){return i=l0(i),ah(i)}var Ju=null;function ah(i){if(Ju=null,i=V(i),i!==null){var o=s(i);if(o===null)i=null;else{var u=o.tag;if(u===13){if(i=l(o),i!==null)return i;i=null}else if(u===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;i=null}else o!==i&&(i=null)}}return Ju=i,null}function nv(i){switch(i){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(bt()){case Ln:return 2;case On:return 8;case $n:case ha:return 32;case Un:return 268435456;default:return 32}default:return 32}}var ih=!1,wi=null,Si=null,Ei=null,zl=new Map,ql=new Map,Ci=[],$C="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function rv(i,o){switch(i){case"focusin":case"focusout":wi=null;break;case"dragenter":case"dragleave":Si=null;break;case"mouseover":case"mouseout":Ei=null;break;case"pointerover":case"pointerout":zl.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":ql.delete(o.pointerId)}}function jl(i,o,u,p,v,w){return i===null||i.nativeEvent!==w?(i={blockedOn:o,domEventName:u,eventSystemFlags:p,nativeEvent:w,targetContainers:[v]},o!==null&&(o=H(o),o!==null&&tv(o)),i):(i.eventSystemFlags|=p,o=i.targetContainers,v!==null&&o.indexOf(v)===-1&&o.push(v),i)}function WC(i,o,u,p,v){switch(o){case"focusin":return wi=jl(wi,i,o,u,p,v),!0;case"dragenter":return Si=jl(Si,i,o,u,p,v),!0;case"mouseover":return Ei=jl(Ei,i,o,u,p,v),!0;case"pointerover":var w=v.pointerId;return zl.set(w,jl(zl.get(w)||null,i,o,u,p,v)),!0;case"gotpointercapture":return w=v.pointerId,ql.set(w,jl(ql.get(w)||null,i,o,u,p,v)),!0}return!1}function av(i){var o=V(i.target);if(o!==null){var u=s(o);if(u!==null){if(o=u.tag,o===13){if(o=l(u),o!==null){i.blockedOn=o,n0(i.priority,function(){if(u.tag===13){var p=Cr();p=Hi(p);var v=Gs(u,p);v!==null&&br(v,u,p),th(u,p)}});return}}else if(o===3&&u.stateNode.current.memoizedState.isDehydrated){i.blockedOn=u.tag===3?u.stateNode.containerInfo:null;return}}}i.blockedOn=null}function Xu(i){if(i.blockedOn!==null)return!1;for(var o=i.targetContainers;0<o.length;){var u=rh(i.nativeEvent);if(u===null){u=i.nativeEvent;var p=new u.constructor(u.type,u);o0=p,u.target.dispatchEvent(p),o0=null}else return o=H(u),o!==null&&tv(o),i.blockedOn=u,!1;o.shift()}return!0}function iv(i,o,u){Xu(i)&&u.delete(o)}function YC(){ih=!1,wi!==null&&Xu(wi)&&(wi=null),Si!==null&&Xu(Si)&&(Si=null),Ei!==null&&Xu(Ei)&&(Ei=null),zl.forEach(iv),ql.forEach(iv)}function Ku(i,o){i.blockedOn===o&&(i.blockedOn=null,ih||(ih=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,YC)))}var Zu=null;function sv(i){Zu!==i&&(Zu=i,t.unstable_scheduleCallback(t.unstable_NormalPriority,function(){Zu===i&&(Zu=null);for(var o=0;o<i.length;o+=3){var u=i[o],p=i[o+1],v=i[o+2];if(typeof p!="function"){if(ah(p||u)===null)continue;break}var w=H(u);w!==null&&(i.splice(o,3),o-=3,ad(w,{pending:!0,data:v,method:u.method,action:p},p,v))}}))}function $l(i){function o(J){return Ku(J,i)}wi!==null&&Ku(wi,i),Si!==null&&Ku(Si,i),Ei!==null&&Ku(Ei,i),zl.forEach(o),ql.forEach(o);for(var u=0;u<Ci.length;u++){var p=Ci[u];p.blockedOn===i&&(p.blockedOn=null)}for(;0<Ci.length&&(u=Ci[0],u.blockedOn===null);)av(u),u.blockedOn===null&&Ci.shift();if(u=(i.ownerDocument||i).$$reactFormReplay,u!=null)for(p=0;p<u.length;p+=3){var v=u[p],w=u[p+1],A=v[An]||null;if(typeof w=="function")A||sv(u);else if(A){var R=null;if(w&&w.hasAttribute("formAction")){if(v=w,A=w[An]||null)R=A.formAction;else if(ah(v)!==null)continue}else R=A.action;typeof R=="function"?u[p+1]=R:(u.splice(p,3),p-=3),sv(u)}}}function sh(i){this._internalRoot=i}Qu.prototype.render=sh.prototype.render=function(i){var o=this._internalRoot;if(o===null)throw Error(r(409));var u=o.current,p=Cr();Q1(u,p,i,o,null,null)},Qu.prototype.unmount=sh.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var o=i.containerInfo;Q1(i.current,2,null,i,null,null),Iu(),o[ri]=null}};function Qu(i){this._internalRoot=i}Qu.prototype.unstable_scheduleHydration=function(i){if(i){var o=$c();i={blockedOn:null,target:i,priority:o};for(var u=0;u<Ci.length&&o!==0&&o<Ci[u].priority;u++);Ci.splice(u,0,i),u===0&&av(i)}};var ov=e.version;if(ov!=="19.1.0")throw Error(r(527,ov,"19.1.0"));me.findDOMNode=function(i){var o=i._reactInternals;if(o===void 0)throw typeof i.render=="function"?Error(r(188)):(i=Object.keys(i).join(","),Error(r(268,i)));return i=f(o),i=i!==null?d(i):null,i=i===null?null:i.stateNode,i};var JC={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:ee,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ef=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ef.isDisabled&&ef.supportsFiber)try{Bn=ef.inject(JC),cn=ef}catch{}}return Yl.createRoot=function(i,o){if(!a(i))throw Error(r(299));var u=!1,p="",v=Sx,w=Ex,A=Cx,R=null;return o!=null&&(o.unstable_strictMode===!0&&(u=!0),o.identifierPrefix!==void 0&&(p=o.identifierPrefix),o.onUncaughtError!==void 0&&(v=o.onUncaughtError),o.onCaughtError!==void 0&&(w=o.onCaughtError),o.onRecoverableError!==void 0&&(A=o.onRecoverableError),o.unstable_transitionCallbacks!==void 0&&(R=o.unstable_transitionCallbacks)),o=K1(i,1,!1,null,null,u,p,v,w,A,R,null),i[ri]=o.current,Hd(i),new sh(o)},Yl.hydrateRoot=function(i,o,u){if(!a(i))throw Error(r(299));var p=!1,v="",w=Sx,A=Ex,R=Cx,J=null,oe=null;return u!=null&&(u.unstable_strictMode===!0&&(p=!0),u.identifierPrefix!==void 0&&(v=u.identifierPrefix),u.onUncaughtError!==void 0&&(w=u.onUncaughtError),u.onCaughtError!==void 0&&(A=u.onCaughtError),u.onRecoverableError!==void 0&&(R=u.onRecoverableError),u.unstable_transitionCallbacks!==void 0&&(J=u.unstable_transitionCallbacks),u.formState!==void 0&&(oe=u.formState)),o=K1(i,1,!0,o,u??null,p,v,w,A,R,J,oe),o.context=Z1(null),u=o.current,p=Cr(),p=Hi(p),v=li(p),v.callback=null,ci(u,v,p),u=p,o.current.lanes=u,Qr(o,u),_a(o),i[ri]=o.current,Hd(i),new Qu(o)},Yl.version="19.1.0",Yl}var xv;function sb(){if(xv)return ch.exports;xv=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),ch.exports=ib(),ch.exports}var ob=sb();const lb=mm(ob);/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let cb,ub;function fb(){return{geminiUrl:cb,vertexUrl:ub}}function db(t,e,n){var r,a,s;if(!(!((r=t.httpOptions)===null||r===void 0)&&r.baseUrl)){const l=fb();return t.vertexai?(a=l.vertexUrl)!==null&&a!==void 0?a:e:(s=l.geminiUrl)!==null&&s!==void 0?s:n}return t.httpOptions.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Es{}function Ge(t,e){const n=/\{([^}]+)\}/g;return t.replace(n,(r,a)=>{if(Object.prototype.hasOwnProperty.call(e,a)){const s=e[a];return s!=null?String(s):""}else throw new Error(`Key '${a}' not found in valueMap.`)})}function m(t,e,n){for(let s=0;s<e.length-1;s++){const l=e[s];if(l.endsWith("[]")){const c=l.slice(0,-2);if(!(c in t))if(Array.isArray(n))t[c]=Array.from({length:n.length},()=>({}));else throw new Error(`Value must be a list given an array path ${l}`);if(Array.isArray(t[c])){const f=t[c];if(Array.isArray(n))for(let d=0;d<f.length;d++){const g=f[d];m(g,e.slice(s+1),n[d])}else for(const d of f)m(d,e.slice(s+1),n)}return}else if(l.endsWith("[0]")){const c=l.slice(0,-3);c in t||(t[c]=[{}]);const f=t[c];m(f[0],e.slice(s+1),n);return}(!t[l]||typeof t[l]!="object")&&(t[l]={}),t=t[l]}const r=e[e.length-1],a=t[r];if(a!==void 0){if(!n||typeof n=="object"&&Object.keys(n).length===0||n===a)return;if(typeof a=="object"&&typeof n=="object"&&a!==null&&n!==null)Object.assign(a,n);else throw new Error(`Cannot set value for an existing key. Key: ${r}`)}else t[r]=n}function h(t,e){try{if(e.length===1&&e[0]==="_self")return t;for(let n=0;n<e.length;n++){if(typeof t!="object"||t===null)return;const r=e[n];if(r.endsWith("[]")){const a=r.slice(0,-2);if(a in t){const s=t[a];return Array.isArray(s)?s.map(l=>h(l,e.slice(n+1))):void 0}else return}else t=t[r]}return t}catch(n){if(n instanceof TypeError)return;throw n}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var vv;(function(t){t.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",t.OUTCOME_OK="OUTCOME_OK",t.OUTCOME_FAILED="OUTCOME_FAILED",t.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(vv||(vv={}));var yv;(function(t){t.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",t.PYTHON="PYTHON"})(yv||(yv={}));var $e;(function(t){t.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",t.STRING="STRING",t.NUMBER="NUMBER",t.INTEGER="INTEGER",t.BOOLEAN="BOOLEAN",t.ARRAY="ARRAY",t.OBJECT="OBJECT",t.NULL="NULL"})($e||($e={}));var _v;(function(t){t.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",t.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",t.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",t.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",t.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",t.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",t.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",t.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",t.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",t.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT"})(_v||(_v={}));var Tv;(function(t){t.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",t.SEVERITY="SEVERITY",t.PROBABILITY="PROBABILITY"})(Tv||(Tv={}));var wv;(function(t){t.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",t.BLOCK_NONE="BLOCK_NONE",t.OFF="OFF"})(wv||(wv={}));var Sv;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.MODE_DYNAMIC="MODE_DYNAMIC"})(Sv||(Sv={}));var Ev;(function(t){t.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",t.NO_AUTH="NO_AUTH",t.API_KEY_AUTH="API_KEY_AUTH",t.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",t.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",t.OAUTH="OAUTH",t.OIDC_AUTH="OIDC_AUTH"})(Ev||(Ev={}));var Cv;(function(t){t.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",t.SIMPLE_SEARCH="SIMPLE_SEARCH",t.ELASTIC_SEARCH="ELASTIC_SEARCH"})(Cv||(Cv={}));var bv;(function(t){t.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",t.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(bv||(bv={}));var Av;(function(t){t.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",t.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",t.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR"})(Av||(Av={}));var kv;(function(t){t.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",t.STOP="STOP",t.MAX_TOKENS="MAX_TOKENS",t.SAFETY="SAFETY",t.RECITATION="RECITATION",t.LANGUAGE="LANGUAGE",t.OTHER="OTHER",t.BLOCKLIST="BLOCKLIST",t.PROHIBITED_CONTENT="PROHIBITED_CONTENT",t.SPII="SPII",t.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",t.IMAGE_SAFETY="IMAGE_SAFETY",t.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL"})(kv||(kv={}));var Nv;(function(t){t.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",t.NEGLIGIBLE="NEGLIGIBLE",t.LOW="LOW",t.MEDIUM="MEDIUM",t.HIGH="HIGH"})(Nv||(Nv={}));var Mv;(function(t){t.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",t.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",t.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",t.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",t.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(Mv||(Mv={}));var Dv;(function(t){t.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",t.SAFETY="SAFETY",t.OTHER="OTHER",t.BLOCKLIST="BLOCKLIST",t.PROHIBITED_CONTENT="PROHIBITED_CONTENT",t.IMAGE_SAFETY="IMAGE_SAFETY"})(Dv||(Dv={}));var Rv;(function(t){t.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",t.ON_DEMAND="ON_DEMAND",t.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(Rv||(Rv={}));var Sf;(function(t){t.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",t.TEXT="TEXT",t.IMAGE="IMAGE",t.AUDIO="AUDIO"})(Sf||(Sf={}));var Fv;(function(t){t.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",t.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",t.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",t.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(Fv||(Fv={}));var Ph;(function(t){t.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",t.JOB_STATE_QUEUED="JOB_STATE_QUEUED",t.JOB_STATE_PENDING="JOB_STATE_PENDING",t.JOB_STATE_RUNNING="JOB_STATE_RUNNING",t.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",t.JOB_STATE_FAILED="JOB_STATE_FAILED",t.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",t.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",t.JOB_STATE_PAUSED="JOB_STATE_PAUSED",t.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",t.JOB_STATE_UPDATING="JOB_STATE_UPDATING",t.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(Ph||(Ph={}));var Iv;(function(t){t.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",t.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",t.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",t.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",t.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",t.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",t.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(Iv||(Iv={}));var Pv;(function(t){t.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",t.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",t.BALANCED="BALANCED",t.PRIORITIZE_COST="PRIORITIZE_COST"})(Pv||(Pv={}));var Lv;(function(t){t.UNSPECIFIED="UNSPECIFIED",t.BLOCKING="BLOCKING",t.NON_BLOCKING="NON_BLOCKING"})(Lv||(Lv={}));var Ov;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.MODE_DYNAMIC="MODE_DYNAMIC"})(Ov||(Ov={}));var Uv;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.AUTO="AUTO",t.ANY="ANY",t.NONE="NONE"})(Uv||(Uv={}));var Bv;(function(t){t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",t.BLOCK_NONE="BLOCK_NONE"})(Bv||(Bv={}));var Vv;(function(t){t.DONT_ALLOW="DONT_ALLOW",t.ALLOW_ADULT="ALLOW_ADULT",t.ALLOW_ALL="ALLOW_ALL"})(Vv||(Vv={}));var Gv;(function(t){t.auto="auto",t.en="en",t.ja="ja",t.ko="ko",t.hi="hi",t.zh="zh",t.pt="pt",t.es="es"})(Gv||(Gv={}));var Hv;(function(t){t.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",t.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",t.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",t.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",t.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(Hv||(Hv={}));var zv;(function(t){t.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",t.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",t.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",t.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(zv||(zv={}));var qv;(function(t){t.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",t.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",t.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",t.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(qv||(qv={}));var jv;(function(t){t.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",t.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",t.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",t.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",t.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",t.EDIT_MODE_STYLE="EDIT_MODE_STYLE",t.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",t.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(jv||(jv={}));var $v;(function(t){t.OPTIMIZED="OPTIMIZED",t.LOSSLESS="LOSSLESS"})($v||($v={}));var Wv;(function(t){t.STATE_UNSPECIFIED="STATE_UNSPECIFIED",t.PROCESSING="PROCESSING",t.ACTIVE="ACTIVE",t.FAILED="FAILED"})(Wv||(Wv={}));var Yv;(function(t){t.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",t.UPLOADED="UPLOADED",t.GENERATED="GENERATED"})(Yv||(Yv={}));var Jv;(function(t){t.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",t.TEXT="TEXT",t.IMAGE="IMAGE",t.VIDEO="VIDEO",t.AUDIO="AUDIO",t.DOCUMENT="DOCUMENT"})(Jv||(Jv={}));var Xv;(function(t){t.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",t.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",t.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(Xv||(Xv={}));var Kv;(function(t){t.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",t.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",t.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(Kv||(Kv={}));var Zv;(function(t){t.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",t.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",t.NO_INTERRUPTION="NO_INTERRUPTION"})(Zv||(Zv={}));var Qv;(function(t){t.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",t.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",t.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(Qv||(Qv={}));var ey;(function(t){t.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",t.SILENT="SILENT",t.WHEN_IDLE="WHEN_IDLE",t.INTERRUPT="INTERRUPT"})(ey||(ey={}));var ty;(function(t){t.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",t.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",t.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",t.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",t.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",t.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",t.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",t.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",t.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",t.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",t.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",t.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",t.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(ty||(ty={}));var Mo;(function(t){t.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",t.PLAY="PLAY",t.PAUSE="PAUSE",t.STOP="STOP",t.RESET_CONTEXT="RESET_CONTEXT"})(Mo||(Mo={}));class Lh{constructor(e){const n={};for(const r of e.headers.entries())n[r[0]]=r[1];this.headers=n,this.responseInternal=e}json(){return this.responseInternal.json()}}class Jl{get text(){var e,n,r,a,s,l,c,f;if(((a=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let d="",g=!1;const x=[];for(const _ of(f=(c=(l=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||l===void 0?void 0:l.content)===null||c===void 0?void 0:c.parts)!==null&&f!==void 0?f:[]){for(const[T,E]of Object.entries(_))T!=="text"&&T!=="thought"&&(E!==null||E!==void 0)&&x.push(T);if(typeof _.text=="string"){if(typeof _.thought=="boolean"&&_.thought)continue;g=!0,d+=_.text}}return x.length>0&&console.warn(`there are non-text parts ${x} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),g?d:void 0}get data(){var e,n,r,a,s,l,c,f;if(((a=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let d="";const g=[];for(const x of(f=(c=(l=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||l===void 0?void 0:l.content)===null||c===void 0?void 0:c.parts)!==null&&f!==void 0?f:[]){for(const[_,T]of Object.entries(x))_!=="inlineData"&&(T!==null||T!==void 0)&&g.push(_);x.inlineData&&typeof x.inlineData.data=="string"&&(d+=atob(x.inlineData.data))}return g.length>0&&console.warn(`there are non-data parts ${g} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),d.length>0?btoa(d):void 0}get functionCalls(){var e,n,r,a,s,l,c,f;if(((a=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const d=(f=(c=(l=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||l===void 0?void 0:l.content)===null||c===void 0?void 0:c.parts)===null||f===void 0?void 0:f.filter(g=>g.functionCall).map(g=>g.functionCall).filter(g=>g!==void 0);if((d==null?void 0:d.length)!==0)return d}get executableCode(){var e,n,r,a,s,l,c,f,d;if(((a=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const g=(f=(c=(l=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||l===void 0?void 0:l.content)===null||c===void 0?void 0:c.parts)===null||f===void 0?void 0:f.filter(x=>x.executableCode).map(x=>x.executableCode).filter(x=>x!==void 0);if((g==null?void 0:g.length)!==0)return(d=g==null?void 0:g[0])===null||d===void 0?void 0:d.code}get codeExecutionResult(){var e,n,r,a,s,l,c,f,d;if(((a=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const g=(f=(c=(l=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||l===void 0?void 0:l.content)===null||c===void 0?void 0:c.parts)===null||f===void 0?void 0:f.filter(x=>x.codeExecutionResult).map(x=>x.codeExecutionResult).filter(x=>x!==void 0);if((g==null?void 0:g.length)!==0)return(d=g==null?void 0:g[0])===null||d===void 0?void 0:d.output}}class ny{}class ry{}class hb{}class mb{}class ay{}class iy{}class sy{}class pb{}class oy{}class ly{}class cy{}class gb{}class xb{}class vb{}class uy{}class yb{get text(){var e,n,r;let a="",s=!1;const l=[];for(const c of(r=(n=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&r!==void 0?r:[]){for(const[f,d]of Object.entries(c))f!=="text"&&f!=="thought"&&d!==null&&l.push(f);if(typeof c.text=="string"){if(typeof c.thought=="boolean"&&c.thought)continue;s=!0,a+=c.text}}return l.length>0&&console.warn(`there are non-text parts ${l} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),s?a:void 0}get data(){var e,n,r;let a="";const s=[];for(const l of(r=(n=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&r!==void 0?r:[]){for(const[c,f]of Object.entries(l))c!=="inlineData"&&f!==null&&s.push(c);l.inlineData&&typeof l.inlineData.data=="string"&&(a+=atob(l.inlineData.data))}return s.length>0&&console.warn(`there are non-data parts ${s} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),a.length>0?btoa(a):void 0}}class _b{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Rt(t,e){if(!e||typeof e!="string")throw new Error("model is required and must be a string");if(t.isVertexAI()){if(e.startsWith("publishers/")||e.startsWith("projects/")||e.startsWith("models/"))return e;if(e.indexOf("/")>=0){const n=e.split("/",2);return`publishers/${n[0]}/models/${n[1]}`}else return`publishers/google/models/${e}`}else return e.startsWith("models/")||e.startsWith("tunedModels/")?e:`models/${e}`}function w2(t,e){const n=Rt(t,e);return n?n.startsWith("publishers/")&&t.isVertexAI()?`projects/${t.getProject()}/locations/${t.getLocation()}/${n}`:n.startsWith("models/")&&t.isVertexAI()?`projects/${t.getProject()}/locations/${t.getLocation()}/publishers/google/${n}`:n:""}function S2(t){return Array.isArray(t)?t.map(e=>Ef(e)):[Ef(t)]}function Ef(t){if(typeof t=="object"&&t!==null)return t;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof t}`)}function E2(t){const e=Ef(t);if(e.mimeType&&e.mimeType.startsWith("image/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function C2(t){const e=Ef(t);if(e.mimeType&&e.mimeType.startsWith("audio/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function fy(t){if(t==null)throw new Error("PartUnion is required");if(typeof t=="object")return t;if(typeof t=="string")return{text:t};throw new Error(`Unsupported part type: ${typeof t}`)}function b2(t){if(t==null||Array.isArray(t)&&t.length===0)throw new Error("PartListUnion is required");return Array.isArray(t)?t.map(e=>fy(e)):[fy(t)]}function Oh(t){return t!=null&&typeof t=="object"&&"parts"in t&&Array.isArray(t.parts)}function dy(t){return t!=null&&typeof t=="object"&&"functionCall"in t}function hy(t){return t!=null&&typeof t=="object"&&"functionResponse"in t}function tr(t){if(t==null)throw new Error("ContentUnion is required");return Oh(t)?t:{role:"user",parts:b2(t)}}function A2(t,e){if(!e)return[];if(t.isVertexAI()&&Array.isArray(e))return e.flatMap(n=>{const r=tr(n);return r.parts&&r.parts.length>0&&r.parts[0].text!==void 0?[r.parts[0].text]:[]});if(t.isVertexAI()){const n=tr(e);return n.parts&&n.parts.length>0&&n.parts[0].text!==void 0?[n.parts[0].text]:[]}return Array.isArray(e)?e.map(n=>tr(n)):[tr(e)]}function Jr(t){if(t==null||Array.isArray(t)&&t.length===0)throw new Error("contents are required");if(!Array.isArray(t)){if(dy(t)||hy(t))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[tr(t)]}const e=[],n=[],r=Oh(t[0]);for(const a of t){const s=Oh(a);if(s!=r)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(s)e.push(a);else{if(dy(a)||hy(a))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");n.push(a)}}return r||e.push({role:"user",parts:b2(n)}),e}function Tb(t,e){t.includes("null")&&(e.nullable=!0);const n=t.filter(r=>r!=="null");if(n.length===1)e.type=Object.values($e).includes(n[0].toUpperCase())?n[0].toUpperCase():$e.TYPE_UNSPECIFIED;else{e.anyOf=[];for(const r of n)e.anyOf.push({type:Object.values($e).includes(r.toUpperCase())?r.toUpperCase():$e.TYPE_UNSPECIFIED})}}function Ro(t){const e={},n=["items"],r=["anyOf"],a=["properties"];if(t.type&&t.anyOf)throw new Error("type and anyOf cannot be both populated.");const s=t.anyOf;s!=null&&s.length==2&&(s[0].type==="null"?(e.nullable=!0,t=s[1]):s[1].type==="null"&&(e.nullable=!0,t=s[0])),t.type instanceof Array&&Tb(t.type,e);for(const[l,c]of Object.entries(t))if(c!=null)if(l=="type"){if(c==="null")throw new Error("type: null can not be the only possible type for the field.");if(c instanceof Array)continue;e.type=Object.values($e).includes(c.toUpperCase())?c.toUpperCase():$e.TYPE_UNSPECIFIED}else if(n.includes(l))e[l]=Ro(c);else if(r.includes(l)){const f=[];for(const d of c){if(d.type=="null"){e.nullable=!0;continue}f.push(Ro(d))}e[l]=f}else if(a.includes(l)){const f={};for(const[d,g]of Object.entries(c))f[d]=Ro(g);e[l]=f}else{if(l==="additionalProperties")continue;e[l]=c}return e}function gm(t){return Ro(t)}function xm(t){if(typeof t=="object")return t;if(typeof t=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:t}}};throw new Error(`Unsupported speechConfig type: ${typeof t}`)}function vm(t){if("multiSpeakerVoiceConfig"in t)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return t}function Ho(t){if(t.functionDeclarations)for(const e of t.functionDeclarations)e.parameters&&(Object.keys(e.parameters).includes("$schema")?e.parametersJsonSchema||(e.parametersJsonSchema=e.parameters,delete e.parameters):e.parameters=Ro(e.parameters)),e.response&&(Object.keys(e.response).includes("$schema")?e.responseJsonSchema||(e.responseJsonSchema=e.response,delete e.response):e.response=Ro(e.response));return t}function zo(t){if(t==null)throw new Error("tools is required");if(!Array.isArray(t))throw new Error("tools is required and must be an array of Tools");const e=[];for(const n of t)e.push(n);return e}function wb(t,e,n,r=1){const a=!e.startsWith(`${n}/`)&&e.split("/").length===r;return t.isVertexAI()?e.startsWith("projects/")?e:e.startsWith("locations/")?`projects/${t.getProject()}/${e}`:e.startsWith(`${n}/`)?`projects/${t.getProject()}/locations/${t.getLocation()}/${e}`:a?`projects/${t.getProject()}/locations/${t.getLocation()}/${n}/${e}`:e:a?`${n}/${e}`:e}function Ka(t,e){if(typeof e!="string")throw new Error("name must be a string");return wb(t,e,"cachedContents")}function k2(t){switch(t){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return t}}function Za(t){if(typeof t!="string")throw new Error("fromImageBytes must be a string");return t}function Sb(t){return t!=null&&typeof t=="object"&&"name"in t}function Eb(t){return t!=null&&typeof t=="object"&&"video"in t}function Cb(t){return t!=null&&typeof t=="object"&&"uri"in t}function N2(t){var e;let n;if(Sb(t)&&(n=t.name),!(Cb(t)&&(n=t.uri,n===void 0))&&!(Eb(t)&&(n=(e=t.video)===null||e===void 0?void 0:e.uri,n===void 0))){if(typeof t=="string"&&(n=t),n===void 0)throw new Error("Could not extract file name from the provided input.");if(n.startsWith("https://")){const a=n.split("files/")[1].match(/[a-z0-9]+/);if(a===null)throw new Error(`Could not extract file name from URI ${n}`);n=a[0]}else n.startsWith("files/")&&(n=n.split("files/")[1]);return n}}function M2(t,e){let n;return t.isVertexAI()?n=e?"publishers/google/models":"models":n=e?"models":"tunedModels",n}function D2(t){for(const e of["models","tunedModels","publisherModels"])if(bb(t,e))return t[e];return[]}function bb(t,e){return t!==null&&typeof t=="object"&&e in t}function Ab(t,e={}){const n=t,r={name:n.name,description:n.description,parametersJsonSchema:n.inputSchema};return e.behavior&&(r.behavior=e.behavior),{functionDeclarations:[r]}}function kb(t,e={}){const n=[],r=new Set;for(const a of t){const s=a.name;if(r.has(s))throw new Error(`Duplicate function name ${s} found in MCP tools. Please ensure function names are unique.`);r.add(s);const l=Ab(a,e);l.functionDeclarations&&n.push(...l.functionDeclarations)}return{functionDeclarations:n}}function R2(t,e){if(typeof e!="string"&&!Array.isArray(e)){if(t&&t.isVertexAI()){if(e.gcsUri&&e.bigqueryUri)throw new Error("Only one of `gcsUri` or `bigqueryUri` can be set.");if(!e.gcsUri&&!e.bigqueryUri)throw new Error("One of `gcsUri` or `bigqueryUri` must be set.")}else{if(e.inlinedRequests&&e.fileName)throw new Error("Only one of `inlinedRequests` or `fileName` can be set.");if(!e.inlinedRequests&&!e.fileName)throw new Error("One of `inlinedRequests` or `fileName` must be set.")}return e}else{if(Array.isArray(e))return{inlinedRequests:e};if(typeof e=="string"){if(e.startsWith("gs://"))return{format:"jsonl",gcsUri:[e]};if(e.startsWith("bq://"))return{format:"bigquery",bigqueryUri:e};if(e.startsWith("files/"))return{fileName:e}}}throw new Error(`Unsupported source: ${e}`)}function Nb(t){const e=t;if(e.startsWith("gs://"))return{format:"jsonl",gcsUri:e};if(e.startsWith("bq://"))return{format:"bigquery",bigqueryUri:e};throw new Error(`Unsupported destination: ${e}`)}function qo(t,e){const n=e;if(!t.isVertexAI()){if(/batches\/[^/]+$/.test(n))return n.split("/").pop();throw new Error(`Invalid batch job name: ${n}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(n))return n.split("/").pop();if(/^\d+$/.test(n))return n;throw new Error(`Invalid batch job name: ${n}.`)}function F2(t){const e=t;return e==="BATCH_STATE_UNSPECIFIED"?"JOB_STATE_UNSPECIFIED":e==="BATCH_STATE_PENDING"?"JOB_STATE_PENDING":e==="BATCH_STATE_SUCCEEDED"?"JOB_STATE_SUCCEEDED":e==="BATCH_STATE_FAILED"?"JOB_STATE_FAILED":e==="BATCH_STATE_CANCELLED"?"JOB_STATE_CANCELLED":e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Mb(t){const e={},n=h(t,["fps"]);n!=null&&m(e,["fps"],n);const r=h(t,["endOffset"]);r!=null&&m(e,["endOffset"],r);const a=h(t,["startOffset"]);return a!=null&&m(e,["startOffset"],a),e}function Db(t){const e={};if(h(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=h(t,["data"]);n!=null&&m(e,["data"],n);const r=h(t,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function Rb(t){const e={};if(h(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=h(t,["fileUri"]);n!=null&&m(e,["fileUri"],n);const r=h(t,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function Fb(t){const e={},n=h(t,["videoMetadata"]);n!=null&&m(e,["videoMetadata"],Mb(n));const r=h(t,["thought"]);r!=null&&m(e,["thought"],r);const a=h(t,["inlineData"]);a!=null&&m(e,["inlineData"],Db(a));const s=h(t,["fileData"]);s!=null&&m(e,["fileData"],Rb(s));const l=h(t,["thoughtSignature"]);l!=null&&m(e,["thoughtSignature"],l);const c=h(t,["codeExecutionResult"]);c!=null&&m(e,["codeExecutionResult"],c);const f=h(t,["executableCode"]);f!=null&&m(e,["executableCode"],f);const d=h(t,["functionCall"]);d!=null&&m(e,["functionCall"],d);const g=h(t,["functionResponse"]);g!=null&&m(e,["functionResponse"],g);const x=h(t,["text"]);return x!=null&&m(e,["text"],x),e}function I2(t){const e={},n=h(t,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(s=>Fb(s))),m(e,["parts"],a)}const r=h(t,["role"]);return r!=null&&m(e,["role"],r),e}function Ib(t){const e={},n=h(t,["anyOf"]);n!=null&&m(e,["anyOf"],n);const r=h(t,["default"]);r!=null&&m(e,["default"],r);const a=h(t,["description"]);a!=null&&m(e,["description"],a);const s=h(t,["enum"]);s!=null&&m(e,["enum"],s);const l=h(t,["example"]);l!=null&&m(e,["example"],l);const c=h(t,["format"]);c!=null&&m(e,["format"],c);const f=h(t,["items"]);f!=null&&m(e,["items"],f);const d=h(t,["maxItems"]);d!=null&&m(e,["maxItems"],d);const g=h(t,["maxLength"]);g!=null&&m(e,["maxLength"],g);const x=h(t,["maxProperties"]);x!=null&&m(e,["maxProperties"],x);const _=h(t,["maximum"]);_!=null&&m(e,["maximum"],_);const T=h(t,["minItems"]);T!=null&&m(e,["minItems"],T);const E=h(t,["minLength"]);E!=null&&m(e,["minLength"],E);const S=h(t,["minProperties"]);S!=null&&m(e,["minProperties"],S);const C=h(t,["minimum"]);C!=null&&m(e,["minimum"],C);const k=h(t,["nullable"]);k!=null&&m(e,["nullable"],k);const N=h(t,["pattern"]);N!=null&&m(e,["pattern"],N);const b=h(t,["properties"]);b!=null&&m(e,["properties"],b);const I=h(t,["propertyOrdering"]);I!=null&&m(e,["propertyOrdering"],I);const F=h(t,["required"]);F!=null&&m(e,["required"],F);const P=h(t,["title"]);P!=null&&m(e,["title"],P);const D=h(t,["type"]);return D!=null&&m(e,["type"],D),e}function Pb(t){const e={};if(h(t,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const n=h(t,["category"]);n!=null&&m(e,["category"],n);const r=h(t,["threshold"]);return r!=null&&m(e,["threshold"],r),e}function Lb(t){const e={},n=h(t,["behavior"]);n!=null&&m(e,["behavior"],n);const r=h(t,["description"]);r!=null&&m(e,["description"],r);const a=h(t,["name"]);a!=null&&m(e,["name"],a);const s=h(t,["parameters"]);s!=null&&m(e,["parameters"],s);const l=h(t,["parametersJsonSchema"]);l!=null&&m(e,["parametersJsonSchema"],l);const c=h(t,["response"]);c!=null&&m(e,["response"],c);const f=h(t,["responseJsonSchema"]);return f!=null&&m(e,["responseJsonSchema"],f),e}function Ob(t){const e={},n=h(t,["startTime"]);n!=null&&m(e,["startTime"],n);const r=h(t,["endTime"]);return r!=null&&m(e,["endTime"],r),e}function Ub(t){const e={},n=h(t,["timeRangeFilter"]);return n!=null&&m(e,["timeRangeFilter"],Ob(n)),e}function Bb(t){const e={},n=h(t,["mode"]);n!=null&&m(e,["mode"],n);const r=h(t,["dynamicThreshold"]);return r!=null&&m(e,["dynamicThreshold"],r),e}function Vb(t){const e={},n=h(t,["dynamicRetrievalConfig"]);return n!=null&&m(e,["dynamicRetrievalConfig"],Bb(n)),e}function Gb(){return{}}function Hb(t){const e={},n=h(t,["functionDeclarations"]);if(n!=null){let f=n;Array.isArray(f)&&(f=f.map(d=>Lb(d))),m(e,["functionDeclarations"],f)}if(h(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=h(t,["googleSearch"]);r!=null&&m(e,["googleSearch"],Ub(r));const a=h(t,["googleSearchRetrieval"]);if(a!=null&&m(e,["googleSearchRetrieval"],Vb(a)),h(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(h(t,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");h(t,["urlContext"])!=null&&m(e,["urlContext"],Gb());const l=h(t,["codeExecution"]);l!=null&&m(e,["codeExecution"],l);const c=h(t,["computerUse"]);return c!=null&&m(e,["computerUse"],c),e}function zb(t){const e={},n=h(t,["mode"]);n!=null&&m(e,["mode"],n);const r=h(t,["allowedFunctionNames"]);return r!=null&&m(e,["allowedFunctionNames"],r),e}function qb(t){const e={},n=h(t,["latitude"]);n!=null&&m(e,["latitude"],n);const r=h(t,["longitude"]);return r!=null&&m(e,["longitude"],r),e}function jb(t){const e={},n=h(t,["latLng"]);n!=null&&m(e,["latLng"],qb(n));const r=h(t,["languageCode"]);return r!=null&&m(e,["languageCode"],r),e}function $b(t){const e={},n=h(t,["functionCallingConfig"]);n!=null&&m(e,["functionCallingConfig"],zb(n));const r=h(t,["retrievalConfig"]);return r!=null&&m(e,["retrievalConfig"],jb(r)),e}function Wb(t){const e={},n=h(t,["voiceName"]);return n!=null&&m(e,["voiceName"],n),e}function P2(t){const e={},n=h(t,["prebuiltVoiceConfig"]);return n!=null&&m(e,["prebuiltVoiceConfig"],Wb(n)),e}function Yb(t){const e={},n=h(t,["speaker"]);n!=null&&m(e,["speaker"],n);const r=h(t,["voiceConfig"]);return r!=null&&m(e,["voiceConfig"],P2(r)),e}function Jb(t){const e={},n=h(t,["speakerVoiceConfigs"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>Yb(a))),m(e,["speakerVoiceConfigs"],r)}return e}function Xb(t){const e={},n=h(t,["voiceConfig"]);n!=null&&m(e,["voiceConfig"],P2(n));const r=h(t,["multiSpeakerVoiceConfig"]);r!=null&&m(e,["multiSpeakerVoiceConfig"],Jb(r));const a=h(t,["languageCode"]);return a!=null&&m(e,["languageCode"],a),e}function Kb(t){const e={},n=h(t,["includeThoughts"]);n!=null&&m(e,["includeThoughts"],n);const r=h(t,["thinkingBudget"]);return r!=null&&m(e,["thinkingBudget"],r),e}function Zb(t,e,n){const r={},a=h(e,["systemInstruction"]);n!==void 0&&a!=null&&m(n,["systemInstruction"],I2(tr(a)));const s=h(e,["temperature"]);s!=null&&m(r,["temperature"],s);const l=h(e,["topP"]);l!=null&&m(r,["topP"],l);const c=h(e,["topK"]);c!=null&&m(r,["topK"],c);const f=h(e,["candidateCount"]);f!=null&&m(r,["candidateCount"],f);const d=h(e,["maxOutputTokens"]);d!=null&&m(r,["maxOutputTokens"],d);const g=h(e,["stopSequences"]);g!=null&&m(r,["stopSequences"],g);const x=h(e,["responseLogprobs"]);x!=null&&m(r,["responseLogprobs"],x);const _=h(e,["logprobs"]);_!=null&&m(r,["logprobs"],_);const T=h(e,["presencePenalty"]);T!=null&&m(r,["presencePenalty"],T);const E=h(e,["frequencyPenalty"]);E!=null&&m(r,["frequencyPenalty"],E);const S=h(e,["seed"]);S!=null&&m(r,["seed"],S);const C=h(e,["responseMimeType"]);C!=null&&m(r,["responseMimeType"],C);const k=h(e,["responseSchema"]);k!=null&&m(r,["responseSchema"],Ib(gm(k)));const N=h(e,["responseJsonSchema"]);if(N!=null&&m(r,["responseJsonSchema"],N),h(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(h(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const b=h(e,["safetySettings"]);if(n!==void 0&&b!=null){let X=b;Array.isArray(X)&&(X=X.map(Z=>Pb(Z))),m(n,["safetySettings"],X)}const I=h(e,["tools"]);if(n!==void 0&&I!=null){let X=zo(I);Array.isArray(X)&&(X=X.map(Z=>Hb(Ho(Z)))),m(n,["tools"],X)}const F=h(e,["toolConfig"]);if(n!==void 0&&F!=null&&m(n,["toolConfig"],$b(F)),h(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const P=h(e,["cachedContent"]);n!==void 0&&P!=null&&m(n,["cachedContent"],Ka(t,P));const D=h(e,["responseModalities"]);D!=null&&m(r,["responseModalities"],D);const j=h(e,["mediaResolution"]);j!=null&&m(r,["mediaResolution"],j);const B=h(e,["speechConfig"]);if(B!=null&&m(r,["speechConfig"],Xb(xm(B))),h(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const te=h(e,["thinkingConfig"]);return te!=null&&m(r,["thinkingConfig"],Kb(te)),r}function Qb(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["request","model"],Rt(t,r));const a=h(e,["contents"]);if(a!=null){let l=Jr(a);Array.isArray(l)&&(l=l.map(c=>I2(c))),m(n,["request","contents"],l)}const s=h(e,["config"]);return s!=null&&m(n,["request","generationConfig"],Zb(t,s,n)),n}function eA(t,e){const n={};if(h(e,["format"])!==void 0)throw new Error("format parameter is not supported in Gemini API.");if(h(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(h(e,["bigqueryUri"])!==void 0)throw new Error("bigqueryUri parameter is not supported in Gemini API.");const r=h(e,["fileName"]);r!=null&&m(n,["fileName"],r);const a=h(e,["inlinedRequests"]);if(a!=null){let s=a;Array.isArray(s)&&(s=s.map(l=>Qb(t,l))),m(n,["requests","requests"],s)}return n}function tA(t,e){const n={},r=h(t,["displayName"]);if(e!==void 0&&r!=null&&m(e,["batch","displayName"],r),h(t,["dest"])!==void 0)throw new Error("dest parameter is not supported in Gemini API.");return n}function nA(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","model"],Rt(t,r));const a=h(e,["src"]);a!=null&&m(n,["batch","inputConfig"],eA(t,R2(t,a)));const s=h(e,["config"]);return s!=null&&m(n,["config"],tA(s,n)),n}function rA(t,e){const n={},r=h(e,["name"]);r!=null&&m(n,["_url","name"],qo(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],a),n}function aA(t,e){const n={},r=h(e,["name"]);r!=null&&m(n,["_url","name"],qo(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],a),n}function iA(t,e){const n={},r=h(t,["pageSize"]);e!==void 0&&r!=null&&m(e,["_query","pageSize"],r);const a=h(t,["pageToken"]);if(e!==void 0&&a!=null&&m(e,["_query","pageToken"],a),h(t,["filter"])!==void 0)throw new Error("filter parameter is not supported in Gemini API.");return n}function sA(t){const e={},n=h(t,["config"]);return n!=null&&m(e,["config"],iA(n,e)),e}function oA(t,e){const n={},r=h(e,["name"]);r!=null&&m(n,["_url","name"],qo(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],a),n}function lA(t){const e={},n=h(t,["format"]);n!=null&&m(e,["instancesFormat"],n);const r=h(t,["gcsUri"]);r!=null&&m(e,["gcsSource","uris"],r);const a=h(t,["bigqueryUri"]);if(a!=null&&m(e,["bigquerySource","inputUri"],a),h(t,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(h(t,["inlinedRequests"])!==void 0)throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return e}function cA(t){const e={},n=h(t,["format"]);n!=null&&m(e,["predictionsFormat"],n);const r=h(t,["gcsUri"]);r!=null&&m(e,["gcsDestination","outputUriPrefix"],r);const a=h(t,["bigqueryUri"]);if(a!=null&&m(e,["bigqueryDestination","outputUri"],a),h(t,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(h(t,["inlinedResponses"])!==void 0)throw new Error("inlinedResponses parameter is not supported in Vertex AI.");return e}function uA(t,e){const n={},r=h(t,["displayName"]);e!==void 0&&r!=null&&m(e,["displayName"],r);const a=h(t,["dest"]);return e!==void 0&&a!=null&&m(e,["outputConfig"],cA(Nb(a))),n}function fA(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["model"],Rt(t,r));const a=h(e,["src"]);a!=null&&m(n,["inputConfig"],lA(R2(t,a)));const s=h(e,["config"]);return s!=null&&m(n,["config"],uA(s,n)),n}function dA(t,e){const n={},r=h(e,["name"]);r!=null&&m(n,["_url","name"],qo(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],a),n}function hA(t,e){const n={},r=h(e,["name"]);r!=null&&m(n,["_url","name"],qo(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],a),n}function mA(t,e){const n={},r=h(t,["pageSize"]);e!==void 0&&r!=null&&m(e,["_query","pageSize"],r);const a=h(t,["pageToken"]);e!==void 0&&a!=null&&m(e,["_query","pageToken"],a);const s=h(t,["filter"]);return e!==void 0&&s!=null&&m(e,["_query","filter"],s),n}function pA(t){const e={},n=h(t,["config"]);return n!=null&&m(e,["config"],mA(n,e)),e}function gA(t,e){const n={},r=h(e,["name"]);r!=null&&m(n,["_url","name"],qo(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],a),n}function L2(){return{}}function xA(t){const e={},n=h(t,["fps"]);n!=null&&m(e,["fps"],n);const r=h(t,["endOffset"]);r!=null&&m(e,["endOffset"],r);const a=h(t,["startOffset"]);return a!=null&&m(e,["startOffset"],a),e}function vA(t){const e={},n=h(t,["data"]);n!=null&&m(e,["data"],n);const r=h(t,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function yA(t){const e={},n=h(t,["fileUri"]);n!=null&&m(e,["fileUri"],n);const r=h(t,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function _A(t){const e={},n=h(t,["videoMetadata"]);n!=null&&m(e,["videoMetadata"],xA(n));const r=h(t,["thought"]);r!=null&&m(e,["thought"],r);const a=h(t,["inlineData"]);a!=null&&m(e,["inlineData"],vA(a));const s=h(t,["fileData"]);s!=null&&m(e,["fileData"],yA(s));const l=h(t,["thoughtSignature"]);l!=null&&m(e,["thoughtSignature"],l);const c=h(t,["codeExecutionResult"]);c!=null&&m(e,["codeExecutionResult"],c);const f=h(t,["executableCode"]);f!=null&&m(e,["executableCode"],f);const d=h(t,["functionCall"]);d!=null&&m(e,["functionCall"],d);const g=h(t,["functionResponse"]);g!=null&&m(e,["functionResponse"],g);const x=h(t,["text"]);return x!=null&&m(e,["text"],x),e}function TA(t){const e={},n=h(t,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(s=>_A(s))),m(e,["parts"],a)}const r=h(t,["role"]);return r!=null&&m(e,["role"],r),e}function wA(t){const e={},n=h(t,["citationSources"]);return n!=null&&m(e,["citations"],n),e}function SA(t){const e={},n=h(t,["retrievedUrl"]);n!=null&&m(e,["retrievedUrl"],n);const r=h(t,["urlRetrievalStatus"]);return r!=null&&m(e,["urlRetrievalStatus"],r),e}function EA(t){const e={},n=h(t,["urlMetadata"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>SA(a))),m(e,["urlMetadata"],r)}return e}function CA(t){const e={},n=h(t,["content"]);n!=null&&m(e,["content"],TA(n));const r=h(t,["citationMetadata"]);r!=null&&m(e,["citationMetadata"],wA(r));const a=h(t,["tokenCount"]);a!=null&&m(e,["tokenCount"],a);const s=h(t,["finishReason"]);s!=null&&m(e,["finishReason"],s);const l=h(t,["urlContextMetadata"]);l!=null&&m(e,["urlContextMetadata"],EA(l));const c=h(t,["avgLogprobs"]);c!=null&&m(e,["avgLogprobs"],c);const f=h(t,["groundingMetadata"]);f!=null&&m(e,["groundingMetadata"],f);const d=h(t,["index"]);d!=null&&m(e,["index"],d);const g=h(t,["logprobsResult"]);g!=null&&m(e,["logprobsResult"],g);const x=h(t,["safetyRatings"]);return x!=null&&m(e,["safetyRatings"],x),e}function bA(t){const e={},n=h(t,["candidates"]);if(n!=null){let l=n;Array.isArray(l)&&(l=l.map(c=>CA(c))),m(e,["candidates"],l)}const r=h(t,["modelVersion"]);r!=null&&m(e,["modelVersion"],r);const a=h(t,["promptFeedback"]);a!=null&&m(e,["promptFeedback"],a);const s=h(t,["usageMetadata"]);return s!=null&&m(e,["usageMetadata"],s),e}function AA(t){const e={},n=h(t,["response"]);return n!=null&&m(e,["response"],bA(n)),h(t,["error"])!=null&&m(e,["error"],L2()),e}function kA(t){const e={},n=h(t,["responsesFile"]);n!=null&&m(e,["fileName"],n);const r=h(t,["inlinedResponses","inlinedResponses"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(s=>AA(s))),m(e,["inlinedResponses"],a)}return e}function Uh(t){const e={},n=h(t,["name"]);n!=null&&m(e,["name"],n);const r=h(t,["metadata","displayName"]);r!=null&&m(e,["displayName"],r);const a=h(t,["metadata","state"]);a!=null&&m(e,["state"],F2(a));const s=h(t,["metadata","createTime"]);s!=null&&m(e,["createTime"],s);const l=h(t,["metadata","endTime"]);l!=null&&m(e,["endTime"],l);const c=h(t,["metadata","updateTime"]);c!=null&&m(e,["updateTime"],c);const f=h(t,["metadata","model"]);f!=null&&m(e,["model"],f);const d=h(t,["metadata","output"]);return d!=null&&m(e,["dest"],kA(d)),e}function NA(t){const e={},n=h(t,["nextPageToken"]);n!=null&&m(e,["nextPageToken"],n);const r=h(t,["operations"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(s=>Uh(s))),m(e,["batchJobs"],a)}return e}function MA(t){const e={},n=h(t,["name"]);n!=null&&m(e,["name"],n);const r=h(t,["done"]);return r!=null&&m(e,["done"],r),h(t,["error"])!=null&&m(e,["error"],L2()),e}function O2(t){const e={},n=h(t,["details"]);n!=null&&m(e,["details"],n);const r=h(t,["code"]);r!=null&&m(e,["code"],r);const a=h(t,["message"]);return a!=null&&m(e,["message"],a),e}function DA(t){const e={},n=h(t,["instancesFormat"]);n!=null&&m(e,["format"],n);const r=h(t,["gcsSource","uris"]);r!=null&&m(e,["gcsUri"],r);const a=h(t,["bigquerySource","inputUri"]);return a!=null&&m(e,["bigqueryUri"],a),e}function RA(t){const e={},n=h(t,["predictionsFormat"]);n!=null&&m(e,["format"],n);const r=h(t,["gcsDestination","outputUriPrefix"]);r!=null&&m(e,["gcsUri"],r);const a=h(t,["bigqueryDestination","outputUri"]);return a!=null&&m(e,["bigqueryUri"],a),e}function Bh(t){const e={},n=h(t,["name"]);n!=null&&m(e,["name"],n);const r=h(t,["displayName"]);r!=null&&m(e,["displayName"],r);const a=h(t,["state"]);a!=null&&m(e,["state"],F2(a));const s=h(t,["error"]);s!=null&&m(e,["error"],O2(s));const l=h(t,["createTime"]);l!=null&&m(e,["createTime"],l);const c=h(t,["startTime"]);c!=null&&m(e,["startTime"],c);const f=h(t,["endTime"]);f!=null&&m(e,["endTime"],f);const d=h(t,["updateTime"]);d!=null&&m(e,["updateTime"],d);const g=h(t,["model"]);g!=null&&m(e,["model"],g);const x=h(t,["inputConfig"]);x!=null&&m(e,["src"],DA(x));const _=h(t,["outputConfig"]);return _!=null&&m(e,["dest"],RA(_)),e}function FA(t){const e={},n=h(t,["nextPageToken"]);n!=null&&m(e,["nextPageToken"],n);const r=h(t,["batchPredictionJobs"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(s=>Bh(s))),m(e,["batchJobs"],a)}return e}function IA(t){const e={},n=h(t,["name"]);n!=null&&m(e,["name"],n);const r=h(t,["done"]);r!=null&&m(e,["done"],r);const a=h(t,["error"]);return a!=null&&m(e,["error"],O2(a)),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var gs;(function(t){t.PAGED_ITEM_BATCH_JOBS="batchJobs",t.PAGED_ITEM_MODELS="models",t.PAGED_ITEM_TUNING_JOBS="tuningJobs",t.PAGED_ITEM_FILES="files",t.PAGED_ITEM_CACHED_CONTENTS="cachedContents"})(gs||(gs={}));class Fc{constructor(e,n,r,a){this.pageInternal=[],this.paramsInternal={},this.requestInternal=n,this.init(e,r,a)}init(e,n,r){var a,s;this.nameInternal=e,this.pageInternal=n[this.nameInternal]||[],this.idxInternal=0;let l={config:{}};r?typeof r=="object"?l=Object.assign({},r):l=r:l={config:{}},l.config&&(l.config.pageToken=n.nextPageToken),this.paramsInternal=l,this.pageInternalSize=(s=(a=l.config)===null||a===void 0?void 0:a.pageSize)!==null&&s!==void 0?s:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return((e=this.params.config)===null||e===void 0?void 0:e.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class PA extends Es{constructor(e){super(),this.apiClient=e,this.create=async n=>{if(this.apiClient.isVertexAI()){const a=Date.now().toString();if(Array.isArray(n.src))throw new Error("InlinedRequest[] is not supported in Vertex AI. Please use Google Cloud Storage URI or BigQuery URI instead.");if(n.config=n.config||{},n.config.displayName===void 0&&(n.config.displayName="genaiBatchJob_${timestampStr}"),n.config.dest===void 0&&typeof n.src=="string")if(n.src.startsWith("gs://")&&n.src.endsWith(".jsonl"))n.config.dest=`${n.src.slice(0,-6)}/dest`;else if(n.src.startsWith("bq://"))n.config.dest=`${n.src}_dest_${a}`;else throw new Error("Unsupported source:"+n.src)}return await this.createInternal(n)},this.list=async(n={})=>new Fc(gs.PAGED_ITEM_BATCH_JOBS,r=>this.listInternal(r),await this.listInternal(n),n)}async createInternal(e){var n,r,a,s;let l,c="",f={};if(this.apiClient.isVertexAI()){const d=fA(this.apiClient,e);return c=Ge("batchPredictionJobs",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>Bh(g))}else{const d=nA(this.apiClient,e);return c=Ge("{model}:batchGenerateContent",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(g=>g.json()),l.then(g=>Uh(g))}}async get(e){var n,r,a,s;let l,c="",f={};if(this.apiClient.isVertexAI()){const d=dA(this.apiClient,e);return c=Ge("batchPredictionJobs/{name}",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>Bh(g))}else{const d=rA(this.apiClient,e);return c=Ge("batches/{name}",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(g=>g.json()),l.then(g=>Uh(g))}}async cancel(e){var n,r,a,s;let l="",c={};if(this.apiClient.isVertexAI()){const f=hA(this.apiClient,e);l=Ge("batchPredictionJobs/{name}:cancel",f._url),c=f._query,delete f.config,delete f._url,delete f._query,await this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal})}else{const f=aA(this.apiClient,e);l=Ge("batches/{name}:cancel",f._url),c=f._query,delete f.config,delete f._url,delete f._query,await this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal})}}async listInternal(e){var n,r,a,s;let l,c="",f={};if(this.apiClient.isVertexAI()){const d=pA(e);return c=Ge("batchPredictionJobs",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>{const x=FA(g),_=new uy;return Object.assign(_,x),_})}else{const d=sA(e);return c=Ge("batches",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(g=>g.json()),l.then(g=>{const x=NA(g),_=new uy;return Object.assign(_,x),_})}}async delete(e){var n,r,a,s;let l,c="",f={};if(this.apiClient.isVertexAI()){const d=gA(this.apiClient,e);return c=Ge("batchPredictionJobs/{name}",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>IA(g))}else{const d=oA(this.apiClient,e);return c=Ge("batches/{name}",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(g=>g.json()),l.then(g=>MA(g))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function LA(t){const e={},n=h(t,["fps"]);n!=null&&m(e,["fps"],n);const r=h(t,["endOffset"]);r!=null&&m(e,["endOffset"],r);const a=h(t,["startOffset"]);return a!=null&&m(e,["startOffset"],a),e}function OA(t){const e={};if(h(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=h(t,["data"]);n!=null&&m(e,["data"],n);const r=h(t,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function UA(t){const e={};if(h(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=h(t,["fileUri"]);n!=null&&m(e,["fileUri"],n);const r=h(t,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function BA(t){const e={},n=h(t,["videoMetadata"]);n!=null&&m(e,["videoMetadata"],LA(n));const r=h(t,["thought"]);r!=null&&m(e,["thought"],r);const a=h(t,["inlineData"]);a!=null&&m(e,["inlineData"],OA(a));const s=h(t,["fileData"]);s!=null&&m(e,["fileData"],UA(s));const l=h(t,["thoughtSignature"]);l!=null&&m(e,["thoughtSignature"],l);const c=h(t,["codeExecutionResult"]);c!=null&&m(e,["codeExecutionResult"],c);const f=h(t,["executableCode"]);f!=null&&m(e,["executableCode"],f);const d=h(t,["functionCall"]);d!=null&&m(e,["functionCall"],d);const g=h(t,["functionResponse"]);g!=null&&m(e,["functionResponse"],g);const x=h(t,["text"]);return x!=null&&m(e,["text"],x),e}function my(t){const e={},n=h(t,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(s=>BA(s))),m(e,["parts"],a)}const r=h(t,["role"]);return r!=null&&m(e,["role"],r),e}function VA(t){const e={},n=h(t,["behavior"]);n!=null&&m(e,["behavior"],n);const r=h(t,["description"]);r!=null&&m(e,["description"],r);const a=h(t,["name"]);a!=null&&m(e,["name"],a);const s=h(t,["parameters"]);s!=null&&m(e,["parameters"],s);const l=h(t,["parametersJsonSchema"]);l!=null&&m(e,["parametersJsonSchema"],l);const c=h(t,["response"]);c!=null&&m(e,["response"],c);const f=h(t,["responseJsonSchema"]);return f!=null&&m(e,["responseJsonSchema"],f),e}function GA(t){const e={},n=h(t,["startTime"]);n!=null&&m(e,["startTime"],n);const r=h(t,["endTime"]);return r!=null&&m(e,["endTime"],r),e}function HA(t){const e={},n=h(t,["timeRangeFilter"]);return n!=null&&m(e,["timeRangeFilter"],GA(n)),e}function zA(t){const e={},n=h(t,["mode"]);n!=null&&m(e,["mode"],n);const r=h(t,["dynamicThreshold"]);return r!=null&&m(e,["dynamicThreshold"],r),e}function qA(t){const e={},n=h(t,["dynamicRetrievalConfig"]);return n!=null&&m(e,["dynamicRetrievalConfig"],zA(n)),e}function jA(){return{}}function $A(t){const e={},n=h(t,["functionDeclarations"]);if(n!=null){let f=n;Array.isArray(f)&&(f=f.map(d=>VA(d))),m(e,["functionDeclarations"],f)}if(h(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=h(t,["googleSearch"]);r!=null&&m(e,["googleSearch"],HA(r));const a=h(t,["googleSearchRetrieval"]);if(a!=null&&m(e,["googleSearchRetrieval"],qA(a)),h(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(h(t,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");h(t,["urlContext"])!=null&&m(e,["urlContext"],jA());const l=h(t,["codeExecution"]);l!=null&&m(e,["codeExecution"],l);const c=h(t,["computerUse"]);return c!=null&&m(e,["computerUse"],c),e}function WA(t){const e={},n=h(t,["mode"]);n!=null&&m(e,["mode"],n);const r=h(t,["allowedFunctionNames"]);return r!=null&&m(e,["allowedFunctionNames"],r),e}function YA(t){const e={},n=h(t,["latitude"]);n!=null&&m(e,["latitude"],n);const r=h(t,["longitude"]);return r!=null&&m(e,["longitude"],r),e}function JA(t){const e={},n=h(t,["latLng"]);n!=null&&m(e,["latLng"],YA(n));const r=h(t,["languageCode"]);return r!=null&&m(e,["languageCode"],r),e}function XA(t){const e={},n=h(t,["functionCallingConfig"]);n!=null&&m(e,["functionCallingConfig"],WA(n));const r=h(t,["retrievalConfig"]);return r!=null&&m(e,["retrievalConfig"],JA(r)),e}function KA(t,e){const n={},r=h(t,["ttl"]);e!==void 0&&r!=null&&m(e,["ttl"],r);const a=h(t,["expireTime"]);e!==void 0&&a!=null&&m(e,["expireTime"],a);const s=h(t,["displayName"]);e!==void 0&&s!=null&&m(e,["displayName"],s);const l=h(t,["contents"]);if(e!==void 0&&l!=null){let g=Jr(l);Array.isArray(g)&&(g=g.map(x=>my(x))),m(e,["contents"],g)}const c=h(t,["systemInstruction"]);e!==void 0&&c!=null&&m(e,["systemInstruction"],my(tr(c)));const f=h(t,["tools"]);if(e!==void 0&&f!=null){let g=f;Array.isArray(g)&&(g=g.map(x=>$A(x))),m(e,["tools"],g)}const d=h(t,["toolConfig"]);if(e!==void 0&&d!=null&&m(e,["toolConfig"],XA(d)),h(t,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return n}function ZA(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["model"],w2(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],KA(a,n)),n}function QA(t,e){const n={},r=h(e,["name"]);r!=null&&m(n,["_url","name"],Ka(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],a),n}function ek(t,e){const n={},r=h(e,["name"]);r!=null&&m(n,["_url","name"],Ka(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],a),n}function tk(t,e){const n={},r=h(t,["ttl"]);e!==void 0&&r!=null&&m(e,["ttl"],r);const a=h(t,["expireTime"]);return e!==void 0&&a!=null&&m(e,["expireTime"],a),n}function nk(t,e){const n={},r=h(e,["name"]);r!=null&&m(n,["_url","name"],Ka(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],tk(a,n)),n}function rk(t,e){const n={},r=h(t,["pageSize"]);e!==void 0&&r!=null&&m(e,["_query","pageSize"],r);const a=h(t,["pageToken"]);return e!==void 0&&a!=null&&m(e,["_query","pageToken"],a),n}function ak(t){const e={},n=h(t,["config"]);return n!=null&&m(e,["config"],rk(n,e)),e}function ik(t){const e={},n=h(t,["fps"]);n!=null&&m(e,["fps"],n);const r=h(t,["endOffset"]);r!=null&&m(e,["endOffset"],r);const a=h(t,["startOffset"]);return a!=null&&m(e,["startOffset"],a),e}function sk(t){const e={},n=h(t,["displayName"]);n!=null&&m(e,["displayName"],n);const r=h(t,["data"]);r!=null&&m(e,["data"],r);const a=h(t,["mimeType"]);return a!=null&&m(e,["mimeType"],a),e}function ok(t){const e={},n=h(t,["displayName"]);n!=null&&m(e,["displayName"],n);const r=h(t,["fileUri"]);r!=null&&m(e,["fileUri"],r);const a=h(t,["mimeType"]);return a!=null&&m(e,["mimeType"],a),e}function lk(t){const e={},n=h(t,["videoMetadata"]);n!=null&&m(e,["videoMetadata"],ik(n));const r=h(t,["thought"]);r!=null&&m(e,["thought"],r);const a=h(t,["inlineData"]);a!=null&&m(e,["inlineData"],sk(a));const s=h(t,["fileData"]);s!=null&&m(e,["fileData"],ok(s));const l=h(t,["thoughtSignature"]);l!=null&&m(e,["thoughtSignature"],l);const c=h(t,["codeExecutionResult"]);c!=null&&m(e,["codeExecutionResult"],c);const f=h(t,["executableCode"]);f!=null&&m(e,["executableCode"],f);const d=h(t,["functionCall"]);d!=null&&m(e,["functionCall"],d);const g=h(t,["functionResponse"]);g!=null&&m(e,["functionResponse"],g);const x=h(t,["text"]);return x!=null&&m(e,["text"],x),e}function py(t){const e={},n=h(t,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(s=>lk(s))),m(e,["parts"],a)}const r=h(t,["role"]);return r!=null&&m(e,["role"],r),e}function ck(t){const e={};if(h(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=h(t,["description"]);n!=null&&m(e,["description"],n);const r=h(t,["name"]);r!=null&&m(e,["name"],r);const a=h(t,["parameters"]);a!=null&&m(e,["parameters"],a);const s=h(t,["parametersJsonSchema"]);s!=null&&m(e,["parametersJsonSchema"],s);const l=h(t,["response"]);l!=null&&m(e,["response"],l);const c=h(t,["responseJsonSchema"]);return c!=null&&m(e,["responseJsonSchema"],c),e}function uk(t){const e={},n=h(t,["startTime"]);n!=null&&m(e,["startTime"],n);const r=h(t,["endTime"]);return r!=null&&m(e,["endTime"],r),e}function fk(t){const e={},n=h(t,["timeRangeFilter"]);return n!=null&&m(e,["timeRangeFilter"],uk(n)),e}function dk(t){const e={},n=h(t,["mode"]);n!=null&&m(e,["mode"],n);const r=h(t,["dynamicThreshold"]);return r!=null&&m(e,["dynamicThreshold"],r),e}function hk(t){const e={},n=h(t,["dynamicRetrievalConfig"]);return n!=null&&m(e,["dynamicRetrievalConfig"],dk(n)),e}function mk(){return{}}function pk(t){const e={},n=h(t,["apiKeyString"]);return n!=null&&m(e,["apiKeyString"],n),e}function gk(t){const e={},n=h(t,["apiKeyConfig"]);n!=null&&m(e,["apiKeyConfig"],pk(n));const r=h(t,["authType"]);r!=null&&m(e,["authType"],r);const a=h(t,["googleServiceAccountConfig"]);a!=null&&m(e,["googleServiceAccountConfig"],a);const s=h(t,["httpBasicAuthConfig"]);s!=null&&m(e,["httpBasicAuthConfig"],s);const l=h(t,["oauthConfig"]);l!=null&&m(e,["oauthConfig"],l);const c=h(t,["oidcConfig"]);return c!=null&&m(e,["oidcConfig"],c),e}function xk(t){const e={},n=h(t,["authConfig"]);return n!=null&&m(e,["authConfig"],gk(n)),e}function vk(){return{}}function yk(t){const e={},n=h(t,["functionDeclarations"]);if(n!=null){let x=n;Array.isArray(x)&&(x=x.map(_=>ck(_))),m(e,["functionDeclarations"],x)}const r=h(t,["retrieval"]);r!=null&&m(e,["retrieval"],r);const a=h(t,["googleSearch"]);a!=null&&m(e,["googleSearch"],fk(a));const s=h(t,["googleSearchRetrieval"]);s!=null&&m(e,["googleSearchRetrieval"],hk(s)),h(t,["enterpriseWebSearch"])!=null&&m(e,["enterpriseWebSearch"],mk());const c=h(t,["googleMaps"]);c!=null&&m(e,["googleMaps"],xk(c)),h(t,["urlContext"])!=null&&m(e,["urlContext"],vk());const d=h(t,["codeExecution"]);d!=null&&m(e,["codeExecution"],d);const g=h(t,["computerUse"]);return g!=null&&m(e,["computerUse"],g),e}function _k(t){const e={},n=h(t,["mode"]);n!=null&&m(e,["mode"],n);const r=h(t,["allowedFunctionNames"]);return r!=null&&m(e,["allowedFunctionNames"],r),e}function Tk(t){const e={},n=h(t,["latitude"]);n!=null&&m(e,["latitude"],n);const r=h(t,["longitude"]);return r!=null&&m(e,["longitude"],r),e}function wk(t){const e={},n=h(t,["latLng"]);n!=null&&m(e,["latLng"],Tk(n));const r=h(t,["languageCode"]);return r!=null&&m(e,["languageCode"],r),e}function Sk(t){const e={},n=h(t,["functionCallingConfig"]);n!=null&&m(e,["functionCallingConfig"],_k(n));const r=h(t,["retrievalConfig"]);return r!=null&&m(e,["retrievalConfig"],wk(r)),e}function Ek(t,e){const n={},r=h(t,["ttl"]);e!==void 0&&r!=null&&m(e,["ttl"],r);const a=h(t,["expireTime"]);e!==void 0&&a!=null&&m(e,["expireTime"],a);const s=h(t,["displayName"]);e!==void 0&&s!=null&&m(e,["displayName"],s);const l=h(t,["contents"]);if(e!==void 0&&l!=null){let x=Jr(l);Array.isArray(x)&&(x=x.map(_=>py(_))),m(e,["contents"],x)}const c=h(t,["systemInstruction"]);e!==void 0&&c!=null&&m(e,["systemInstruction"],py(tr(c)));const f=h(t,["tools"]);if(e!==void 0&&f!=null){let x=f;Array.isArray(x)&&(x=x.map(_=>yk(_))),m(e,["tools"],x)}const d=h(t,["toolConfig"]);e!==void 0&&d!=null&&m(e,["toolConfig"],Sk(d));const g=h(t,["kmsKeyName"]);return e!==void 0&&g!=null&&m(e,["encryption_spec","kmsKeyName"],g),n}function Ck(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["model"],w2(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],Ek(a,n)),n}function bk(t,e){const n={},r=h(e,["name"]);r!=null&&m(n,["_url","name"],Ka(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],a),n}function Ak(t,e){const n={},r=h(e,["name"]);r!=null&&m(n,["_url","name"],Ka(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],a),n}function kk(t,e){const n={},r=h(t,["ttl"]);e!==void 0&&r!=null&&m(e,["ttl"],r);const a=h(t,["expireTime"]);return e!==void 0&&a!=null&&m(e,["expireTime"],a),n}function Nk(t,e){const n={},r=h(e,["name"]);r!=null&&m(n,["_url","name"],Ka(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],kk(a,n)),n}function Mk(t,e){const n={},r=h(t,["pageSize"]);e!==void 0&&r!=null&&m(e,["_query","pageSize"],r);const a=h(t,["pageToken"]);return e!==void 0&&a!=null&&m(e,["_query","pageToken"],a),n}function Dk(t){const e={},n=h(t,["config"]);return n!=null&&m(e,["config"],Mk(n,e)),e}function _f(t){const e={},n=h(t,["name"]);n!=null&&m(e,["name"],n);const r=h(t,["displayName"]);r!=null&&m(e,["displayName"],r);const a=h(t,["model"]);a!=null&&m(e,["model"],a);const s=h(t,["createTime"]);s!=null&&m(e,["createTime"],s);const l=h(t,["updateTime"]);l!=null&&m(e,["updateTime"],l);const c=h(t,["expireTime"]);c!=null&&m(e,["expireTime"],c);const f=h(t,["usageMetadata"]);return f!=null&&m(e,["usageMetadata"],f),e}function Rk(){return{}}function Fk(t){const e={},n=h(t,["nextPageToken"]);n!=null&&m(e,["nextPageToken"],n);const r=h(t,["cachedContents"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(s=>_f(s))),m(e,["cachedContents"],a)}return e}function Tf(t){const e={},n=h(t,["name"]);n!=null&&m(e,["name"],n);const r=h(t,["displayName"]);r!=null&&m(e,["displayName"],r);const a=h(t,["model"]);a!=null&&m(e,["model"],a);const s=h(t,["createTime"]);s!=null&&m(e,["createTime"],s);const l=h(t,["updateTime"]);l!=null&&m(e,["updateTime"],l);const c=h(t,["expireTime"]);c!=null&&m(e,["expireTime"],c);const f=h(t,["usageMetadata"]);return f!=null&&m(e,["usageMetadata"],f),e}function Ik(){return{}}function Pk(t){const e={},n=h(t,["nextPageToken"]);n!=null&&m(e,["nextPageToken"],n);const r=h(t,["cachedContents"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(s=>Tf(s))),m(e,["cachedContents"],a)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Lk extends Es{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new Fc(gs.PAGED_ITEM_CACHED_CONTENTS,r=>this.listInternal(r),await this.listInternal(n),n)}async create(e){var n,r,a,s;let l,c="",f={};if(this.apiClient.isVertexAI()){const d=Ck(this.apiClient,e);return c=Ge("cachedContents",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>Tf(g))}else{const d=ZA(this.apiClient,e);return c=Ge("cachedContents",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(g=>g.json()),l.then(g=>_f(g))}}async get(e){var n,r,a,s;let l,c="",f={};if(this.apiClient.isVertexAI()){const d=bk(this.apiClient,e);return c=Ge("{name}",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>Tf(g))}else{const d=QA(this.apiClient,e);return c=Ge("{name}",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(g=>g.json()),l.then(g=>_f(g))}}async delete(e){var n,r,a,s;let l,c="",f={};if(this.apiClient.isVertexAI()){const d=Ak(this.apiClient,e);return c=Ge("{name}",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(()=>{const g=Ik(),x=new ly;return Object.assign(x,g),x})}else{const d=ek(this.apiClient,e);return c=Ge("{name}",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(g=>g.json()),l.then(()=>{const g=Rk(),x=new ly;return Object.assign(x,g),x})}}async update(e){var n,r,a,s;let l,c="",f={};if(this.apiClient.isVertexAI()){const d=Nk(this.apiClient,e);return c=Ge("{name}",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>Tf(g))}else{const d=nk(this.apiClient,e);return c=Ge("{name}",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(g=>g.json()),l.then(g=>_f(g))}}async listInternal(e){var n,r,a,s;let l,c="",f={};if(this.apiClient.isVertexAI()){const d=Dk(e);return c=Ge("cachedContents",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>{const x=Pk(g),_=new cy;return Object.assign(_,x),_})}else{const d=ak(e);return c=Ge("cachedContents",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(g=>g.json()),l.then(g=>{const x=Fk(g),_=new cy;return Object.assign(_,x),_})}}}function gy(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Yt(t){return this instanceof Yt?(this.v=t,this):new Yt(t)}function Fo(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(t,e||[]),a,s=[];return a=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),c("next"),c("throw"),c("return",l),a[Symbol.asyncIterator]=function(){return this},a;function l(T){return function(E){return Promise.resolve(E).then(T,x)}}function c(T,E){r[T]&&(a[T]=function(S){return new Promise(function(C,k){s.push([T,S,C,k])>1||f(T,S)})},E&&(a[T]=E(a[T])))}function f(T,E){try{d(r[T](E))}catch(S){_(s[0][3],S)}}function d(T){T.value instanceof Yt?Promise.resolve(T.value.v).then(g,x):_(s[0][2],T)}function g(T){f("next",T)}function x(T){f("throw",T)}function _(T,E){T(E),s.shift(),s.length&&f(s[0][0],s[0][1])}}function ic(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof gy=="function"?gy(t):t[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(s){n[s]=t[s]&&function(l){return new Promise(function(c,f){l=t[s](l),a(c,f,l.done,l.value)})}}function a(s,l,c,f){Promise.resolve(f).then(function(d){s({value:d,done:c})},l)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Ok(t){var e;if(t.candidates==null||t.candidates.length===0)return!1;const n=(e=t.candidates[0])===null||e===void 0?void 0:e.content;return n===void 0?!1:U2(n)}function U2(t){if(t.parts===void 0||t.parts.length===0)return!1;for(const e of t.parts)if(e===void 0||Object.keys(e).length===0||!e.thought&&e.text!==void 0&&e.text==="")return!1;return!0}function Uk(t){if(t.length!==0){for(const e of t)if(e.role!=="user"&&e.role!=="model")throw new Error(`Role must be user or model, but got ${e.role}.`)}}function xy(t){if(t===void 0||t.length===0)return[];const e=[],n=t.length;let r=0;for(;r<n;)if(t[r].role==="user")e.push(t[r]),r++;else{const a=[];let s=!0;for(;r<n&&t[r].role==="model";)a.push(t[r]),s&&!U2(t[r])&&(s=!1),r++;s?e.push(...a):e.pop()}return e}class Bk{constructor(e,n){this.modelsModule=e,this.apiClient=n}create(e){return new Vk(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}}class Vk{constructor(e,n,r,a={},s=[]){this.apiClient=e,this.modelsModule=n,this.model=r,this.config=a,this.history=s,this.sendPromise=Promise.resolve(),Uk(s)}async sendMessage(e){var n;await this.sendPromise;const r=tr(e.message),a=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(r),config:(n=e.config)!==null&&n!==void 0?n:this.config});return this.sendPromise=(async()=>{var s,l,c;const f=await a,d=(l=(s=f.candidates)===null||s===void 0?void 0:s[0])===null||l===void 0?void 0:l.content,g=f.automaticFunctionCallingHistory,x=this.getHistory(!0).length;let _=[];g!=null&&(_=(c=g.slice(x))!==null&&c!==void 0?c:[]);const T=d?[d]:[];this.recordHistory(r,T,_)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),a}async sendMessageStream(e){var n;await this.sendPromise;const r=tr(e.message),a=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(r),config:(n=e.config)!==null&&n!==void 0?n:this.config});this.sendPromise=a.then(()=>{}).catch(()=>{});const s=await a;return this.processStreamResponse(s,r)}getHistory(e=!1){const n=e?xy(this.history):this.history;return structuredClone(n)}processStreamResponse(e,n){var r,a;return Fo(this,arguments,function*(){var l,c,f,d;const g=[];try{for(var x=!0,_=ic(e),T;T=yield Yt(_.next()),l=T.done,!l;x=!0){d=T.value,x=!1;const E=d;if(Ok(E)){const S=(a=(r=E.candidates)===null||r===void 0?void 0:r[0])===null||a===void 0?void 0:a.content;S!==void 0&&g.push(S)}yield yield Yt(E)}}catch(E){c={error:E}}finally{try{!x&&!l&&(f=_.return)&&(yield Yt(f.call(_)))}finally{if(c)throw c.error}}this.recordHistory(n,g)})}recordHistory(e,n,r){let a=[];n.length>0&&n.every(s=>s.role!==void 0)?a=n:a.push({role:"model",parts:[]}),r&&r.length>0?this.history.push(...xy(r)):this.history.push(e),this.history.push(...a)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Gf extends Error{constructor(e){super(e.message),this.name="ApiError",this.status=e.status,Object.setPrototypeOf(this,Gf.prototype)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Gk(t,e){const n={},r=h(t,["pageSize"]);e!==void 0&&r!=null&&m(e,["_query","pageSize"],r);const a=h(t,["pageToken"]);return e!==void 0&&a!=null&&m(e,["_query","pageToken"],a),n}function Hk(t){const e={},n=h(t,["config"]);return n!=null&&m(e,["config"],Gk(n,e)),e}function zk(t){const e={},n=h(t,["details"]);n!=null&&m(e,["details"],n);const r=h(t,["message"]);r!=null&&m(e,["message"],r);const a=h(t,["code"]);return a!=null&&m(e,["code"],a),e}function qk(t){const e={},n=h(t,["name"]);n!=null&&m(e,["name"],n);const r=h(t,["displayName"]);r!=null&&m(e,["displayName"],r);const a=h(t,["mimeType"]);a!=null&&m(e,["mimeType"],a);const s=h(t,["sizeBytes"]);s!=null&&m(e,["sizeBytes"],s);const l=h(t,["createTime"]);l!=null&&m(e,["createTime"],l);const c=h(t,["expirationTime"]);c!=null&&m(e,["expirationTime"],c);const f=h(t,["updateTime"]);f!=null&&m(e,["updateTime"],f);const d=h(t,["sha256Hash"]);d!=null&&m(e,["sha256Hash"],d);const g=h(t,["uri"]);g!=null&&m(e,["uri"],g);const x=h(t,["downloadUri"]);x!=null&&m(e,["downloadUri"],x);const _=h(t,["state"]);_!=null&&m(e,["state"],_);const T=h(t,["source"]);T!=null&&m(e,["source"],T);const E=h(t,["videoMetadata"]);E!=null&&m(e,["videoMetadata"],E);const S=h(t,["error"]);return S!=null&&m(e,["error"],zk(S)),e}function jk(t){const e={},n=h(t,["file"]);n!=null&&m(e,["file"],qk(n));const r=h(t,["config"]);return r!=null&&m(e,["config"],r),e}function $k(t){const e={},n=h(t,["name"]);n!=null&&m(e,["_url","file"],N2(n));const r=h(t,["config"]);return r!=null&&m(e,["config"],r),e}function Wk(t){const e={},n=h(t,["name"]);n!=null&&m(e,["_url","file"],N2(n));const r=h(t,["config"]);return r!=null&&m(e,["config"],r),e}function Yk(t){const e={},n=h(t,["details"]);n!=null&&m(e,["details"],n);const r=h(t,["message"]);r!=null&&m(e,["message"],r);const a=h(t,["code"]);return a!=null&&m(e,["code"],a),e}function Vh(t){const e={},n=h(t,["name"]);n!=null&&m(e,["name"],n);const r=h(t,["displayName"]);r!=null&&m(e,["displayName"],r);const a=h(t,["mimeType"]);a!=null&&m(e,["mimeType"],a);const s=h(t,["sizeBytes"]);s!=null&&m(e,["sizeBytes"],s);const l=h(t,["createTime"]);l!=null&&m(e,["createTime"],l);const c=h(t,["expirationTime"]);c!=null&&m(e,["expirationTime"],c);const f=h(t,["updateTime"]);f!=null&&m(e,["updateTime"],f);const d=h(t,["sha256Hash"]);d!=null&&m(e,["sha256Hash"],d);const g=h(t,["uri"]);g!=null&&m(e,["uri"],g);const x=h(t,["downloadUri"]);x!=null&&m(e,["downloadUri"],x);const _=h(t,["state"]);_!=null&&m(e,["state"],_);const T=h(t,["source"]);T!=null&&m(e,["source"],T);const E=h(t,["videoMetadata"]);E!=null&&m(e,["videoMetadata"],E);const S=h(t,["error"]);return S!=null&&m(e,["error"],Yk(S)),e}function Jk(t){const e={},n=h(t,["nextPageToken"]);n!=null&&m(e,["nextPageToken"],n);const r=h(t,["files"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(s=>Vh(s))),m(e,["files"],a)}return e}function Xk(){return{}}function Kk(){return{}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Zk extends Es{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new Fc(gs.PAGED_ITEM_FILES,r=>this.listInternal(r),await this.listInternal(n),n)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(n=>Vh(n))}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var n,r;let a,s="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=Hk(e);return s=Ge("files",c._url),l=c._query,delete c.config,delete c._url,delete c._query,a=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),a.then(f=>{const d=Jk(f),g=new gb;return Object.assign(g,d),g})}}async createInternal(e){var n,r;let a,s="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=jk(e);return s=Ge("upload/v1beta/files",c._url),l=c._query,delete c.config,delete c._url,delete c._query,a=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),a.then(()=>{const f=Xk(),d=new xb;return Object.assign(d,f),d})}}async get(e){var n,r;let a,s="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=$k(e);return s=Ge("files/{file}",c._url),l=c._query,delete c.config,delete c._url,delete c._query,a=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),a.then(f=>Vh(f))}}async delete(e){var n,r;let a,s="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=Wk(e);return s=Ge("files/{file}",c._url),l=c._query,delete c.config,delete c._url,delete c._query,a=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),a.then(()=>{const f=Kk(),d=new vb;return Object.assign(d,f),d})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Qk(t){const e={},n=h(t,["voiceName"]);return n!=null&&m(e,["voiceName"],n),e}function e4(t){const e={},n=h(t,["voiceName"]);return n!=null&&m(e,["voiceName"],n),e}function B2(t){const e={},n=h(t,["prebuiltVoiceConfig"]);return n!=null&&m(e,["prebuiltVoiceConfig"],Qk(n)),e}function t4(t){const e={},n=h(t,["prebuiltVoiceConfig"]);return n!=null&&m(e,["prebuiltVoiceConfig"],e4(n)),e}function n4(t){const e={},n=h(t,["speaker"]);n!=null&&m(e,["speaker"],n);const r=h(t,["voiceConfig"]);return r!=null&&m(e,["voiceConfig"],B2(r)),e}function r4(t){const e={},n=h(t,["speakerVoiceConfigs"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>n4(a))),m(e,["speakerVoiceConfigs"],r)}return e}function a4(t){const e={},n=h(t,["voiceConfig"]);n!=null&&m(e,["voiceConfig"],B2(n));const r=h(t,["multiSpeakerVoiceConfig"]);r!=null&&m(e,["multiSpeakerVoiceConfig"],r4(r));const a=h(t,["languageCode"]);return a!=null&&m(e,["languageCode"],a),e}function i4(t){const e={},n=h(t,["voiceConfig"]);if(n!=null&&m(e,["voiceConfig"],t4(n)),h(t,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const r=h(t,["languageCode"]);return r!=null&&m(e,["languageCode"],r),e}function s4(t){const e={},n=h(t,["fps"]);n!=null&&m(e,["fps"],n);const r=h(t,["endOffset"]);r!=null&&m(e,["endOffset"],r);const a=h(t,["startOffset"]);return a!=null&&m(e,["startOffset"],a),e}function o4(t){const e={},n=h(t,["fps"]);n!=null&&m(e,["fps"],n);const r=h(t,["endOffset"]);r!=null&&m(e,["endOffset"],r);const a=h(t,["startOffset"]);return a!=null&&m(e,["startOffset"],a),e}function l4(t){const e={};if(h(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=h(t,["data"]);n!=null&&m(e,["data"],n);const r=h(t,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function c4(t){const e={},n=h(t,["displayName"]);n!=null&&m(e,["displayName"],n);const r=h(t,["data"]);r!=null&&m(e,["data"],r);const a=h(t,["mimeType"]);return a!=null&&m(e,["mimeType"],a),e}function u4(t){const e={};if(h(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=h(t,["fileUri"]);n!=null&&m(e,["fileUri"],n);const r=h(t,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function f4(t){const e={},n=h(t,["displayName"]);n!=null&&m(e,["displayName"],n);const r=h(t,["fileUri"]);r!=null&&m(e,["fileUri"],r);const a=h(t,["mimeType"]);return a!=null&&m(e,["mimeType"],a),e}function d4(t){const e={},n=h(t,["videoMetadata"]);n!=null&&m(e,["videoMetadata"],s4(n));const r=h(t,["thought"]);r!=null&&m(e,["thought"],r);const a=h(t,["inlineData"]);a!=null&&m(e,["inlineData"],l4(a));const s=h(t,["fileData"]);s!=null&&m(e,["fileData"],u4(s));const l=h(t,["thoughtSignature"]);l!=null&&m(e,["thoughtSignature"],l);const c=h(t,["codeExecutionResult"]);c!=null&&m(e,["codeExecutionResult"],c);const f=h(t,["executableCode"]);f!=null&&m(e,["executableCode"],f);const d=h(t,["functionCall"]);d!=null&&m(e,["functionCall"],d);const g=h(t,["functionResponse"]);g!=null&&m(e,["functionResponse"],g);const x=h(t,["text"]);return x!=null&&m(e,["text"],x),e}function h4(t){const e={},n=h(t,["videoMetadata"]);n!=null&&m(e,["videoMetadata"],o4(n));const r=h(t,["thought"]);r!=null&&m(e,["thought"],r);const a=h(t,["inlineData"]);a!=null&&m(e,["inlineData"],c4(a));const s=h(t,["fileData"]);s!=null&&m(e,["fileData"],f4(s));const l=h(t,["thoughtSignature"]);l!=null&&m(e,["thoughtSignature"],l);const c=h(t,["codeExecutionResult"]);c!=null&&m(e,["codeExecutionResult"],c);const f=h(t,["executableCode"]);f!=null&&m(e,["executableCode"],f);const d=h(t,["functionCall"]);d!=null&&m(e,["functionCall"],d);const g=h(t,["functionResponse"]);g!=null&&m(e,["functionResponse"],g);const x=h(t,["text"]);return x!=null&&m(e,["text"],x),e}function m4(t){const e={},n=h(t,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(s=>d4(s))),m(e,["parts"],a)}const r=h(t,["role"]);return r!=null&&m(e,["role"],r),e}function p4(t){const e={},n=h(t,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(s=>h4(s))),m(e,["parts"],a)}const r=h(t,["role"]);return r!=null&&m(e,["role"],r),e}function g4(t){const e={},n=h(t,["behavior"]);n!=null&&m(e,["behavior"],n);const r=h(t,["description"]);r!=null&&m(e,["description"],r);const a=h(t,["name"]);a!=null&&m(e,["name"],a);const s=h(t,["parameters"]);s!=null&&m(e,["parameters"],s);const l=h(t,["parametersJsonSchema"]);l!=null&&m(e,["parametersJsonSchema"],l);const c=h(t,["response"]);c!=null&&m(e,["response"],c);const f=h(t,["responseJsonSchema"]);return f!=null&&m(e,["responseJsonSchema"],f),e}function x4(t){const e={};if(h(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=h(t,["description"]);n!=null&&m(e,["description"],n);const r=h(t,["name"]);r!=null&&m(e,["name"],r);const a=h(t,["parameters"]);a!=null&&m(e,["parameters"],a);const s=h(t,["parametersJsonSchema"]);s!=null&&m(e,["parametersJsonSchema"],s);const l=h(t,["response"]);l!=null&&m(e,["response"],l);const c=h(t,["responseJsonSchema"]);return c!=null&&m(e,["responseJsonSchema"],c),e}function v4(t){const e={},n=h(t,["startTime"]);n!=null&&m(e,["startTime"],n);const r=h(t,["endTime"]);return r!=null&&m(e,["endTime"],r),e}function y4(t){const e={},n=h(t,["startTime"]);n!=null&&m(e,["startTime"],n);const r=h(t,["endTime"]);return r!=null&&m(e,["endTime"],r),e}function _4(t){const e={},n=h(t,["timeRangeFilter"]);return n!=null&&m(e,["timeRangeFilter"],v4(n)),e}function T4(t){const e={},n=h(t,["timeRangeFilter"]);return n!=null&&m(e,["timeRangeFilter"],y4(n)),e}function w4(t){const e={},n=h(t,["mode"]);n!=null&&m(e,["mode"],n);const r=h(t,["dynamicThreshold"]);return r!=null&&m(e,["dynamicThreshold"],r),e}function S4(t){const e={},n=h(t,["mode"]);n!=null&&m(e,["mode"],n);const r=h(t,["dynamicThreshold"]);return r!=null&&m(e,["dynamicThreshold"],r),e}function E4(t){const e={},n=h(t,["dynamicRetrievalConfig"]);return n!=null&&m(e,["dynamicRetrievalConfig"],w4(n)),e}function C4(t){const e={},n=h(t,["dynamicRetrievalConfig"]);return n!=null&&m(e,["dynamicRetrievalConfig"],S4(n)),e}function b4(){return{}}function A4(t){const e={},n=h(t,["apiKeyString"]);return n!=null&&m(e,["apiKeyString"],n),e}function k4(t){const e={},n=h(t,["apiKeyConfig"]);n!=null&&m(e,["apiKeyConfig"],A4(n));const r=h(t,["authType"]);r!=null&&m(e,["authType"],r);const a=h(t,["googleServiceAccountConfig"]);a!=null&&m(e,["googleServiceAccountConfig"],a);const s=h(t,["httpBasicAuthConfig"]);s!=null&&m(e,["httpBasicAuthConfig"],s);const l=h(t,["oauthConfig"]);l!=null&&m(e,["oauthConfig"],l);const c=h(t,["oidcConfig"]);return c!=null&&m(e,["oidcConfig"],c),e}function N4(t){const e={},n=h(t,["authConfig"]);return n!=null&&m(e,["authConfig"],k4(n)),e}function M4(){return{}}function D4(){return{}}function R4(t){const e={},n=h(t,["functionDeclarations"]);if(n!=null){let f=n;Array.isArray(f)&&(f=f.map(d=>g4(d))),m(e,["functionDeclarations"],f)}if(h(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=h(t,["googleSearch"]);r!=null&&m(e,["googleSearch"],_4(r));const a=h(t,["googleSearchRetrieval"]);if(a!=null&&m(e,["googleSearchRetrieval"],E4(a)),h(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(h(t,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");h(t,["urlContext"])!=null&&m(e,["urlContext"],M4());const l=h(t,["codeExecution"]);l!=null&&m(e,["codeExecution"],l);const c=h(t,["computerUse"]);return c!=null&&m(e,["computerUse"],c),e}function F4(t){const e={},n=h(t,["functionDeclarations"]);if(n!=null){let x=n;Array.isArray(x)&&(x=x.map(_=>x4(_))),m(e,["functionDeclarations"],x)}const r=h(t,["retrieval"]);r!=null&&m(e,["retrieval"],r);const a=h(t,["googleSearch"]);a!=null&&m(e,["googleSearch"],T4(a));const s=h(t,["googleSearchRetrieval"]);s!=null&&m(e,["googleSearchRetrieval"],C4(s)),h(t,["enterpriseWebSearch"])!=null&&m(e,["enterpriseWebSearch"],b4());const c=h(t,["googleMaps"]);c!=null&&m(e,["googleMaps"],N4(c)),h(t,["urlContext"])!=null&&m(e,["urlContext"],D4());const d=h(t,["codeExecution"]);d!=null&&m(e,["codeExecution"],d);const g=h(t,["computerUse"]);return g!=null&&m(e,["computerUse"],g),e}function I4(t){const e={},n=h(t,["handle"]);if(n!=null&&m(e,["handle"],n),h(t,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function P4(t){const e={},n=h(t,["handle"]);n!=null&&m(e,["handle"],n);const r=h(t,["transparent"]);return r!=null&&m(e,["transparent"],r),e}function vy(){return{}}function yy(){return{}}function L4(t){const e={},n=h(t,["disabled"]);n!=null&&m(e,["disabled"],n);const r=h(t,["startOfSpeechSensitivity"]);r!=null&&m(e,["startOfSpeechSensitivity"],r);const a=h(t,["endOfSpeechSensitivity"]);a!=null&&m(e,["endOfSpeechSensitivity"],a);const s=h(t,["prefixPaddingMs"]);s!=null&&m(e,["prefixPaddingMs"],s);const l=h(t,["silenceDurationMs"]);return l!=null&&m(e,["silenceDurationMs"],l),e}function O4(t){const e={},n=h(t,["disabled"]);n!=null&&m(e,["disabled"],n);const r=h(t,["startOfSpeechSensitivity"]);r!=null&&m(e,["startOfSpeechSensitivity"],r);const a=h(t,["endOfSpeechSensitivity"]);a!=null&&m(e,["endOfSpeechSensitivity"],a);const s=h(t,["prefixPaddingMs"]);s!=null&&m(e,["prefixPaddingMs"],s);const l=h(t,["silenceDurationMs"]);return l!=null&&m(e,["silenceDurationMs"],l),e}function U4(t){const e={},n=h(t,["automaticActivityDetection"]);n!=null&&m(e,["automaticActivityDetection"],L4(n));const r=h(t,["activityHandling"]);r!=null&&m(e,["activityHandling"],r);const a=h(t,["turnCoverage"]);return a!=null&&m(e,["turnCoverage"],a),e}function B4(t){const e={},n=h(t,["automaticActivityDetection"]);n!=null&&m(e,["automaticActivityDetection"],O4(n));const r=h(t,["activityHandling"]);r!=null&&m(e,["activityHandling"],r);const a=h(t,["turnCoverage"]);return a!=null&&m(e,["turnCoverage"],a),e}function V4(t){const e={},n=h(t,["targetTokens"]);return n!=null&&m(e,["targetTokens"],n),e}function G4(t){const e={},n=h(t,["targetTokens"]);return n!=null&&m(e,["targetTokens"],n),e}function H4(t){const e={},n=h(t,["triggerTokens"]);n!=null&&m(e,["triggerTokens"],n);const r=h(t,["slidingWindow"]);return r!=null&&m(e,["slidingWindow"],V4(r)),e}function z4(t){const e={},n=h(t,["triggerTokens"]);n!=null&&m(e,["triggerTokens"],n);const r=h(t,["slidingWindow"]);return r!=null&&m(e,["slidingWindow"],G4(r)),e}function q4(t){const e={},n=h(t,["proactiveAudio"]);return n!=null&&m(e,["proactiveAudio"],n),e}function j4(t){const e={},n=h(t,["proactiveAudio"]);return n!=null&&m(e,["proactiveAudio"],n),e}function $4(t,e){const n={},r=h(t,["generationConfig"]);e!==void 0&&r!=null&&m(e,["setup","generationConfig"],r);const a=h(t,["responseModalities"]);e!==void 0&&a!=null&&m(e,["setup","generationConfig","responseModalities"],a);const s=h(t,["temperature"]);e!==void 0&&s!=null&&m(e,["setup","generationConfig","temperature"],s);const l=h(t,["topP"]);e!==void 0&&l!=null&&m(e,["setup","generationConfig","topP"],l);const c=h(t,["topK"]);e!==void 0&&c!=null&&m(e,["setup","generationConfig","topK"],c);const f=h(t,["maxOutputTokens"]);e!==void 0&&f!=null&&m(e,["setup","generationConfig","maxOutputTokens"],f);const d=h(t,["mediaResolution"]);e!==void 0&&d!=null&&m(e,["setup","generationConfig","mediaResolution"],d);const g=h(t,["seed"]);e!==void 0&&g!=null&&m(e,["setup","generationConfig","seed"],g);const x=h(t,["speechConfig"]);e!==void 0&&x!=null&&m(e,["setup","generationConfig","speechConfig"],a4(vm(x)));const _=h(t,["enableAffectiveDialog"]);e!==void 0&&_!=null&&m(e,["setup","generationConfig","enableAffectiveDialog"],_);const T=h(t,["systemInstruction"]);e!==void 0&&T!=null&&m(e,["setup","systemInstruction"],m4(tr(T)));const E=h(t,["tools"]);if(e!==void 0&&E!=null){let F=zo(E);Array.isArray(F)&&(F=F.map(P=>R4(Ho(P)))),m(e,["setup","tools"],F)}const S=h(t,["sessionResumption"]);e!==void 0&&S!=null&&m(e,["setup","sessionResumption"],I4(S));const C=h(t,["inputAudioTranscription"]);e!==void 0&&C!=null&&m(e,["setup","inputAudioTranscription"],vy());const k=h(t,["outputAudioTranscription"]);e!==void 0&&k!=null&&m(e,["setup","outputAudioTranscription"],vy());const N=h(t,["realtimeInputConfig"]);e!==void 0&&N!=null&&m(e,["setup","realtimeInputConfig"],U4(N));const b=h(t,["contextWindowCompression"]);e!==void 0&&b!=null&&m(e,["setup","contextWindowCompression"],H4(b));const I=h(t,["proactivity"]);return e!==void 0&&I!=null&&m(e,["setup","proactivity"],q4(I)),n}function W4(t,e){const n={},r=h(t,["generationConfig"]);e!==void 0&&r!=null&&m(e,["setup","generationConfig"],r);const a=h(t,["responseModalities"]);e!==void 0&&a!=null&&m(e,["setup","generationConfig","responseModalities"],a);const s=h(t,["temperature"]);e!==void 0&&s!=null&&m(e,["setup","generationConfig","temperature"],s);const l=h(t,["topP"]);e!==void 0&&l!=null&&m(e,["setup","generationConfig","topP"],l);const c=h(t,["topK"]);e!==void 0&&c!=null&&m(e,["setup","generationConfig","topK"],c);const f=h(t,["maxOutputTokens"]);e!==void 0&&f!=null&&m(e,["setup","generationConfig","maxOutputTokens"],f);const d=h(t,["mediaResolution"]);e!==void 0&&d!=null&&m(e,["setup","generationConfig","mediaResolution"],d);const g=h(t,["seed"]);e!==void 0&&g!=null&&m(e,["setup","generationConfig","seed"],g);const x=h(t,["speechConfig"]);e!==void 0&&x!=null&&m(e,["setup","generationConfig","speechConfig"],i4(vm(x)));const _=h(t,["enableAffectiveDialog"]);e!==void 0&&_!=null&&m(e,["setup","generationConfig","enableAffectiveDialog"],_);const T=h(t,["systemInstruction"]);e!==void 0&&T!=null&&m(e,["setup","systemInstruction"],p4(tr(T)));const E=h(t,["tools"]);if(e!==void 0&&E!=null){let F=zo(E);Array.isArray(F)&&(F=F.map(P=>F4(Ho(P)))),m(e,["setup","tools"],F)}const S=h(t,["sessionResumption"]);e!==void 0&&S!=null&&m(e,["setup","sessionResumption"],P4(S));const C=h(t,["inputAudioTranscription"]);e!==void 0&&C!=null&&m(e,["setup","inputAudioTranscription"],yy());const k=h(t,["outputAudioTranscription"]);e!==void 0&&k!=null&&m(e,["setup","outputAudioTranscription"],yy());const N=h(t,["realtimeInputConfig"]);e!==void 0&&N!=null&&m(e,["setup","realtimeInputConfig"],B4(N));const b=h(t,["contextWindowCompression"]);e!==void 0&&b!=null&&m(e,["setup","contextWindowCompression"],z4(b));const I=h(t,["proactivity"]);return e!==void 0&&I!=null&&m(e,["setup","proactivity"],j4(I)),n}function Y4(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["setup","model"],Rt(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],$4(a,n)),n}function J4(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["setup","model"],Rt(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],W4(a,n)),n}function X4(){return{}}function K4(){return{}}function Z4(){return{}}function Q4(){return{}}function eN(t){const e={},n=h(t,["media"]);n!=null&&m(e,["mediaChunks"],S2(n));const r=h(t,["audio"]);r!=null&&m(e,["audio"],C2(r));const a=h(t,["audioStreamEnd"]);a!=null&&m(e,["audioStreamEnd"],a);const s=h(t,["video"]);s!=null&&m(e,["video"],E2(s));const l=h(t,["text"]);return l!=null&&m(e,["text"],l),h(t,["activityStart"])!=null&&m(e,["activityStart"],X4()),h(t,["activityEnd"])!=null&&m(e,["activityEnd"],Z4()),e}function tN(t){const e={},n=h(t,["media"]);n!=null&&m(e,["mediaChunks"],S2(n));const r=h(t,["audio"]);r!=null&&m(e,["audio"],C2(r));const a=h(t,["audioStreamEnd"]);a!=null&&m(e,["audioStreamEnd"],a);const s=h(t,["video"]);s!=null&&m(e,["video"],E2(s));const l=h(t,["text"]);return l!=null&&m(e,["text"],l),h(t,["activityStart"])!=null&&m(e,["activityStart"],K4()),h(t,["activityEnd"])!=null&&m(e,["activityEnd"],Q4()),e}function V2(t){const e={},n=h(t,["text"]);n!=null&&m(e,["text"],n);const r=h(t,["weight"]);return r!=null&&m(e,["weight"],r),e}function nN(t){const e={},n=h(t,["weightedPrompts"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>V2(a))),m(e,["weightedPrompts"],r)}return e}function G2(t){const e={},n=h(t,["temperature"]);n!=null&&m(e,["temperature"],n);const r=h(t,["topK"]);r!=null&&m(e,["topK"],r);const a=h(t,["seed"]);a!=null&&m(e,["seed"],a);const s=h(t,["guidance"]);s!=null&&m(e,["guidance"],s);const l=h(t,["bpm"]);l!=null&&m(e,["bpm"],l);const c=h(t,["density"]);c!=null&&m(e,["density"],c);const f=h(t,["brightness"]);f!=null&&m(e,["brightness"],f);const d=h(t,["scale"]);d!=null&&m(e,["scale"],d);const g=h(t,["muteBass"]);g!=null&&m(e,["muteBass"],g);const x=h(t,["muteDrums"]);x!=null&&m(e,["muteDrums"],x);const _=h(t,["onlyBassAndDrums"]);return _!=null&&m(e,["onlyBassAndDrums"],_),e}function rN(t){const e={},n=h(t,["musicGenerationConfig"]);return n!=null&&m(e,["musicGenerationConfig"],G2(n)),e}function H2(t){const e={},n=h(t,["model"]);return n!=null&&m(e,["model"],n),e}function z2(t){const e={},n=h(t,["weightedPrompts"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>V2(a))),m(e,["weightedPrompts"],r)}return e}function Gh(t){const e={},n=h(t,["setup"]);n!=null&&m(e,["setup"],H2(n));const r=h(t,["clientContent"]);r!=null&&m(e,["clientContent"],z2(r));const a=h(t,["musicGenerationConfig"]);a!=null&&m(e,["musicGenerationConfig"],G2(a));const s=h(t,["playbackControl"]);return s!=null&&m(e,["playbackControl"],s),e}function aN(){return{}}function iN(t){const e={},n=h(t,["sessionId"]);return n!=null&&m(e,["sessionId"],n),e}function sN(t){const e={},n=h(t,["fps"]);n!=null&&m(e,["fps"],n);const r=h(t,["endOffset"]);r!=null&&m(e,["endOffset"],r);const a=h(t,["startOffset"]);return a!=null&&m(e,["startOffset"],a),e}function oN(t){const e={},n=h(t,["fps"]);n!=null&&m(e,["fps"],n);const r=h(t,["endOffset"]);r!=null&&m(e,["endOffset"],r);const a=h(t,["startOffset"]);return a!=null&&m(e,["startOffset"],a),e}function lN(t){const e={},n=h(t,["data"]);n!=null&&m(e,["data"],n);const r=h(t,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function cN(t){const e={},n=h(t,["displayName"]);n!=null&&m(e,["displayName"],n);const r=h(t,["data"]);r!=null&&m(e,["data"],r);const a=h(t,["mimeType"]);return a!=null&&m(e,["mimeType"],a),e}function uN(t){const e={},n=h(t,["fileUri"]);n!=null&&m(e,["fileUri"],n);const r=h(t,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function fN(t){const e={},n=h(t,["displayName"]);n!=null&&m(e,["displayName"],n);const r=h(t,["fileUri"]);r!=null&&m(e,["fileUri"],r);const a=h(t,["mimeType"]);return a!=null&&m(e,["mimeType"],a),e}function dN(t){const e={},n=h(t,["videoMetadata"]);n!=null&&m(e,["videoMetadata"],sN(n));const r=h(t,["thought"]);r!=null&&m(e,["thought"],r);const a=h(t,["inlineData"]);a!=null&&m(e,["inlineData"],lN(a));const s=h(t,["fileData"]);s!=null&&m(e,["fileData"],uN(s));const l=h(t,["thoughtSignature"]);l!=null&&m(e,["thoughtSignature"],l);const c=h(t,["codeExecutionResult"]);c!=null&&m(e,["codeExecutionResult"],c);const f=h(t,["executableCode"]);f!=null&&m(e,["executableCode"],f);const d=h(t,["functionCall"]);d!=null&&m(e,["functionCall"],d);const g=h(t,["functionResponse"]);g!=null&&m(e,["functionResponse"],g);const x=h(t,["text"]);return x!=null&&m(e,["text"],x),e}function hN(t){const e={},n=h(t,["videoMetadata"]);n!=null&&m(e,["videoMetadata"],oN(n));const r=h(t,["thought"]);r!=null&&m(e,["thought"],r);const a=h(t,["inlineData"]);a!=null&&m(e,["inlineData"],cN(a));const s=h(t,["fileData"]);s!=null&&m(e,["fileData"],fN(s));const l=h(t,["thoughtSignature"]);l!=null&&m(e,["thoughtSignature"],l);const c=h(t,["codeExecutionResult"]);c!=null&&m(e,["codeExecutionResult"],c);const f=h(t,["executableCode"]);f!=null&&m(e,["executableCode"],f);const d=h(t,["functionCall"]);d!=null&&m(e,["functionCall"],d);const g=h(t,["functionResponse"]);g!=null&&m(e,["functionResponse"],g);const x=h(t,["text"]);return x!=null&&m(e,["text"],x),e}function mN(t){const e={},n=h(t,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(s=>dN(s))),m(e,["parts"],a)}const r=h(t,["role"]);return r!=null&&m(e,["role"],r),e}function pN(t){const e={},n=h(t,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(s=>hN(s))),m(e,["parts"],a)}const r=h(t,["role"]);return r!=null&&m(e,["role"],r),e}function _y(t){const e={},n=h(t,["text"]);n!=null&&m(e,["text"],n);const r=h(t,["finished"]);return r!=null&&m(e,["finished"],r),e}function Ty(t){const e={},n=h(t,["text"]);n!=null&&m(e,["text"],n);const r=h(t,["finished"]);return r!=null&&m(e,["finished"],r),e}function gN(t){const e={},n=h(t,["retrievedUrl"]);n!=null&&m(e,["retrievedUrl"],n);const r=h(t,["urlRetrievalStatus"]);return r!=null&&m(e,["urlRetrievalStatus"],r),e}function xN(t){const e={},n=h(t,["urlMetadata"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>gN(a))),m(e,["urlMetadata"],r)}return e}function vN(t){const e={},n=h(t,["modelTurn"]);n!=null&&m(e,["modelTurn"],mN(n));const r=h(t,["turnComplete"]);r!=null&&m(e,["turnComplete"],r);const a=h(t,["interrupted"]);a!=null&&m(e,["interrupted"],a);const s=h(t,["groundingMetadata"]);s!=null&&m(e,["groundingMetadata"],s);const l=h(t,["generationComplete"]);l!=null&&m(e,["generationComplete"],l);const c=h(t,["inputTranscription"]);c!=null&&m(e,["inputTranscription"],_y(c));const f=h(t,["outputTranscription"]);f!=null&&m(e,["outputTranscription"],_y(f));const d=h(t,["urlContextMetadata"]);return d!=null&&m(e,["urlContextMetadata"],xN(d)),e}function yN(t){const e={},n=h(t,["modelTurn"]);n!=null&&m(e,["modelTurn"],pN(n));const r=h(t,["turnComplete"]);r!=null&&m(e,["turnComplete"],r);const a=h(t,["interrupted"]);a!=null&&m(e,["interrupted"],a);const s=h(t,["groundingMetadata"]);s!=null&&m(e,["groundingMetadata"],s);const l=h(t,["generationComplete"]);l!=null&&m(e,["generationComplete"],l);const c=h(t,["inputTranscription"]);c!=null&&m(e,["inputTranscription"],Ty(c));const f=h(t,["outputTranscription"]);return f!=null&&m(e,["outputTranscription"],Ty(f)),e}function _N(t){const e={},n=h(t,["id"]);n!=null&&m(e,["id"],n);const r=h(t,["args"]);r!=null&&m(e,["args"],r);const a=h(t,["name"]);return a!=null&&m(e,["name"],a),e}function TN(t){const e={},n=h(t,["args"]);n!=null&&m(e,["args"],n);const r=h(t,["name"]);return r!=null&&m(e,["name"],r),e}function wN(t){const e={},n=h(t,["functionCalls"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>_N(a))),m(e,["functionCalls"],r)}return e}function SN(t){const e={},n=h(t,["functionCalls"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>TN(a))),m(e,["functionCalls"],r)}return e}function EN(t){const e={},n=h(t,["ids"]);return n!=null&&m(e,["ids"],n),e}function CN(t){const e={},n=h(t,["ids"]);return n!=null&&m(e,["ids"],n),e}function tf(t){const e={},n=h(t,["modality"]);n!=null&&m(e,["modality"],n);const r=h(t,["tokenCount"]);return r!=null&&m(e,["tokenCount"],r),e}function nf(t){const e={},n=h(t,["modality"]);n!=null&&m(e,["modality"],n);const r=h(t,["tokenCount"]);return r!=null&&m(e,["tokenCount"],r),e}function bN(t){const e={},n=h(t,["promptTokenCount"]);n!=null&&m(e,["promptTokenCount"],n);const r=h(t,["cachedContentTokenCount"]);r!=null&&m(e,["cachedContentTokenCount"],r);const a=h(t,["responseTokenCount"]);a!=null&&m(e,["responseTokenCount"],a);const s=h(t,["toolUsePromptTokenCount"]);s!=null&&m(e,["toolUsePromptTokenCount"],s);const l=h(t,["thoughtsTokenCount"]);l!=null&&m(e,["thoughtsTokenCount"],l);const c=h(t,["totalTokenCount"]);c!=null&&m(e,["totalTokenCount"],c);const f=h(t,["promptTokensDetails"]);if(f!=null){let _=f;Array.isArray(_)&&(_=_.map(T=>tf(T))),m(e,["promptTokensDetails"],_)}const d=h(t,["cacheTokensDetails"]);if(d!=null){let _=d;Array.isArray(_)&&(_=_.map(T=>tf(T))),m(e,["cacheTokensDetails"],_)}const g=h(t,["responseTokensDetails"]);if(g!=null){let _=g;Array.isArray(_)&&(_=_.map(T=>tf(T))),m(e,["responseTokensDetails"],_)}const x=h(t,["toolUsePromptTokensDetails"]);if(x!=null){let _=x;Array.isArray(_)&&(_=_.map(T=>tf(T))),m(e,["toolUsePromptTokensDetails"],_)}return e}function AN(t){const e={},n=h(t,["promptTokenCount"]);n!=null&&m(e,["promptTokenCount"],n);const r=h(t,["cachedContentTokenCount"]);r!=null&&m(e,["cachedContentTokenCount"],r);const a=h(t,["candidatesTokenCount"]);a!=null&&m(e,["responseTokenCount"],a);const s=h(t,["toolUsePromptTokenCount"]);s!=null&&m(e,["toolUsePromptTokenCount"],s);const l=h(t,["thoughtsTokenCount"]);l!=null&&m(e,["thoughtsTokenCount"],l);const c=h(t,["totalTokenCount"]);c!=null&&m(e,["totalTokenCount"],c);const f=h(t,["promptTokensDetails"]);if(f!=null){let T=f;Array.isArray(T)&&(T=T.map(E=>nf(E))),m(e,["promptTokensDetails"],T)}const d=h(t,["cacheTokensDetails"]);if(d!=null){let T=d;Array.isArray(T)&&(T=T.map(E=>nf(E))),m(e,["cacheTokensDetails"],T)}const g=h(t,["candidatesTokensDetails"]);if(g!=null){let T=g;Array.isArray(T)&&(T=T.map(E=>nf(E))),m(e,["responseTokensDetails"],T)}const x=h(t,["toolUsePromptTokensDetails"]);if(x!=null){let T=x;Array.isArray(T)&&(T=T.map(E=>nf(E))),m(e,["toolUsePromptTokensDetails"],T)}const _=h(t,["trafficType"]);return _!=null&&m(e,["trafficType"],_),e}function kN(t){const e={},n=h(t,["timeLeft"]);return n!=null&&m(e,["timeLeft"],n),e}function NN(t){const e={},n=h(t,["timeLeft"]);return n!=null&&m(e,["timeLeft"],n),e}function MN(t){const e={},n=h(t,["newHandle"]);n!=null&&m(e,["newHandle"],n);const r=h(t,["resumable"]);r!=null&&m(e,["resumable"],r);const a=h(t,["lastConsumedClientMessageIndex"]);return a!=null&&m(e,["lastConsumedClientMessageIndex"],a),e}function DN(t){const e={},n=h(t,["newHandle"]);n!=null&&m(e,["newHandle"],n);const r=h(t,["resumable"]);r!=null&&m(e,["resumable"],r);const a=h(t,["lastConsumedClientMessageIndex"]);return a!=null&&m(e,["lastConsumedClientMessageIndex"],a),e}function RN(t){const e={};h(t,["setupComplete"])!=null&&m(e,["setupComplete"],aN());const r=h(t,["serverContent"]);r!=null&&m(e,["serverContent"],vN(r));const a=h(t,["toolCall"]);a!=null&&m(e,["toolCall"],wN(a));const s=h(t,["toolCallCancellation"]);s!=null&&m(e,["toolCallCancellation"],EN(s));const l=h(t,["usageMetadata"]);l!=null&&m(e,["usageMetadata"],bN(l));const c=h(t,["goAway"]);c!=null&&m(e,["goAway"],kN(c));const f=h(t,["sessionResumptionUpdate"]);return f!=null&&m(e,["sessionResumptionUpdate"],MN(f)),e}function FN(t){const e={},n=h(t,["setupComplete"]);n!=null&&m(e,["setupComplete"],iN(n));const r=h(t,["serverContent"]);r!=null&&m(e,["serverContent"],yN(r));const a=h(t,["toolCall"]);a!=null&&m(e,["toolCall"],SN(a));const s=h(t,["toolCallCancellation"]);s!=null&&m(e,["toolCallCancellation"],CN(s));const l=h(t,["usageMetadata"]);l!=null&&m(e,["usageMetadata"],AN(l));const c=h(t,["goAway"]);c!=null&&m(e,["goAway"],NN(c));const f=h(t,["sessionResumptionUpdate"]);return f!=null&&m(e,["sessionResumptionUpdate"],DN(f)),e}function IN(){return{}}function PN(t){const e={},n=h(t,["text"]);n!=null&&m(e,["text"],n);const r=h(t,["weight"]);return r!=null&&m(e,["weight"],r),e}function LN(t){const e={},n=h(t,["weightedPrompts"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>PN(a))),m(e,["weightedPrompts"],r)}return e}function ON(t){const e={},n=h(t,["temperature"]);n!=null&&m(e,["temperature"],n);const r=h(t,["topK"]);r!=null&&m(e,["topK"],r);const a=h(t,["seed"]);a!=null&&m(e,["seed"],a);const s=h(t,["guidance"]);s!=null&&m(e,["guidance"],s);const l=h(t,["bpm"]);l!=null&&m(e,["bpm"],l);const c=h(t,["density"]);c!=null&&m(e,["density"],c);const f=h(t,["brightness"]);f!=null&&m(e,["brightness"],f);const d=h(t,["scale"]);d!=null&&m(e,["scale"],d);const g=h(t,["muteBass"]);g!=null&&m(e,["muteBass"],g);const x=h(t,["muteDrums"]);x!=null&&m(e,["muteDrums"],x);const _=h(t,["onlyBassAndDrums"]);return _!=null&&m(e,["onlyBassAndDrums"],_),e}function UN(t){const e={},n=h(t,["clientContent"]);n!=null&&m(e,["clientContent"],LN(n));const r=h(t,["musicGenerationConfig"]);return r!=null&&m(e,["musicGenerationConfig"],ON(r)),e}function BN(t){const e={},n=h(t,["data"]);n!=null&&m(e,["data"],n);const r=h(t,["mimeType"]);r!=null&&m(e,["mimeType"],r);const a=h(t,["sourceMetadata"]);return a!=null&&m(e,["sourceMetadata"],UN(a)),e}function VN(t){const e={},n=h(t,["audioChunks"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>BN(a))),m(e,["audioChunks"],r)}return e}function GN(t){const e={},n=h(t,["text"]);n!=null&&m(e,["text"],n);const r=h(t,["filteredReason"]);return r!=null&&m(e,["filteredReason"],r),e}function HN(t){const e={};h(t,["setupComplete"])!=null&&m(e,["setupComplete"],IN());const r=h(t,["serverContent"]);r!=null&&m(e,["serverContent"],VN(r));const a=h(t,["filteredPrompt"]);return a!=null&&m(e,["filteredPrompt"],GN(a)),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function zN(t){const e={},n=h(t,["fps"]);n!=null&&m(e,["fps"],n);const r=h(t,["endOffset"]);r!=null&&m(e,["endOffset"],r);const a=h(t,["startOffset"]);return a!=null&&m(e,["startOffset"],a),e}function qN(t){const e={};if(h(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=h(t,["data"]);n!=null&&m(e,["data"],n);const r=h(t,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function jN(t){const e={};if(h(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=h(t,["fileUri"]);n!=null&&m(e,["fileUri"],n);const r=h(t,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function $N(t){const e={},n=h(t,["videoMetadata"]);n!=null&&m(e,["videoMetadata"],zN(n));const r=h(t,["thought"]);r!=null&&m(e,["thought"],r);const a=h(t,["inlineData"]);a!=null&&m(e,["inlineData"],qN(a));const s=h(t,["fileData"]);s!=null&&m(e,["fileData"],jN(s));const l=h(t,["thoughtSignature"]);l!=null&&m(e,["thoughtSignature"],l);const c=h(t,["codeExecutionResult"]);c!=null&&m(e,["codeExecutionResult"],c);const f=h(t,["executableCode"]);f!=null&&m(e,["executableCode"],f);const d=h(t,["functionCall"]);d!=null&&m(e,["functionCall"],d);const g=h(t,["functionResponse"]);g!=null&&m(e,["functionResponse"],g);const x=h(t,["text"]);return x!=null&&m(e,["text"],x),e}function Hf(t){const e={},n=h(t,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(s=>$N(s))),m(e,["parts"],a)}const r=h(t,["role"]);return r!=null&&m(e,["role"],r),e}function WN(t){const e={},n=h(t,["anyOf"]);n!=null&&m(e,["anyOf"],n);const r=h(t,["default"]);r!=null&&m(e,["default"],r);const a=h(t,["description"]);a!=null&&m(e,["description"],a);const s=h(t,["enum"]);s!=null&&m(e,["enum"],s);const l=h(t,["example"]);l!=null&&m(e,["example"],l);const c=h(t,["format"]);c!=null&&m(e,["format"],c);const f=h(t,["items"]);f!=null&&m(e,["items"],f);const d=h(t,["maxItems"]);d!=null&&m(e,["maxItems"],d);const g=h(t,["maxLength"]);g!=null&&m(e,["maxLength"],g);const x=h(t,["maxProperties"]);x!=null&&m(e,["maxProperties"],x);const _=h(t,["maximum"]);_!=null&&m(e,["maximum"],_);const T=h(t,["minItems"]);T!=null&&m(e,["minItems"],T);const E=h(t,["minLength"]);E!=null&&m(e,["minLength"],E);const S=h(t,["minProperties"]);S!=null&&m(e,["minProperties"],S);const C=h(t,["minimum"]);C!=null&&m(e,["minimum"],C);const k=h(t,["nullable"]);k!=null&&m(e,["nullable"],k);const N=h(t,["pattern"]);N!=null&&m(e,["pattern"],N);const b=h(t,["properties"]);b!=null&&m(e,["properties"],b);const I=h(t,["propertyOrdering"]);I!=null&&m(e,["propertyOrdering"],I);const F=h(t,["required"]);F!=null&&m(e,["required"],F);const P=h(t,["title"]);P!=null&&m(e,["title"],P);const D=h(t,["type"]);return D!=null&&m(e,["type"],D),e}function YN(t){const e={};if(h(t,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const n=h(t,["category"]);n!=null&&m(e,["category"],n);const r=h(t,["threshold"]);return r!=null&&m(e,["threshold"],r),e}function JN(t){const e={},n=h(t,["behavior"]);n!=null&&m(e,["behavior"],n);const r=h(t,["description"]);r!=null&&m(e,["description"],r);const a=h(t,["name"]);a!=null&&m(e,["name"],a);const s=h(t,["parameters"]);s!=null&&m(e,["parameters"],s);const l=h(t,["parametersJsonSchema"]);l!=null&&m(e,["parametersJsonSchema"],l);const c=h(t,["response"]);c!=null&&m(e,["response"],c);const f=h(t,["responseJsonSchema"]);return f!=null&&m(e,["responseJsonSchema"],f),e}function XN(t){const e={},n=h(t,["startTime"]);n!=null&&m(e,["startTime"],n);const r=h(t,["endTime"]);return r!=null&&m(e,["endTime"],r),e}function KN(t){const e={},n=h(t,["timeRangeFilter"]);return n!=null&&m(e,["timeRangeFilter"],XN(n)),e}function ZN(t){const e={},n=h(t,["mode"]);n!=null&&m(e,["mode"],n);const r=h(t,["dynamicThreshold"]);return r!=null&&m(e,["dynamicThreshold"],r),e}function QN(t){const e={},n=h(t,["dynamicRetrievalConfig"]);return n!=null&&m(e,["dynamicRetrievalConfig"],ZN(n)),e}function e3(){return{}}function t3(t){const e={},n=h(t,["functionDeclarations"]);if(n!=null){let f=n;Array.isArray(f)&&(f=f.map(d=>JN(d))),m(e,["functionDeclarations"],f)}if(h(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=h(t,["googleSearch"]);r!=null&&m(e,["googleSearch"],KN(r));const a=h(t,["googleSearchRetrieval"]);if(a!=null&&m(e,["googleSearchRetrieval"],QN(a)),h(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(h(t,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");h(t,["urlContext"])!=null&&m(e,["urlContext"],e3());const l=h(t,["codeExecution"]);l!=null&&m(e,["codeExecution"],l);const c=h(t,["computerUse"]);return c!=null&&m(e,["computerUse"],c),e}function n3(t){const e={},n=h(t,["mode"]);n!=null&&m(e,["mode"],n);const r=h(t,["allowedFunctionNames"]);return r!=null&&m(e,["allowedFunctionNames"],r),e}function r3(t){const e={},n=h(t,["latitude"]);n!=null&&m(e,["latitude"],n);const r=h(t,["longitude"]);return r!=null&&m(e,["longitude"],r),e}function a3(t){const e={},n=h(t,["latLng"]);n!=null&&m(e,["latLng"],r3(n));const r=h(t,["languageCode"]);return r!=null&&m(e,["languageCode"],r),e}function i3(t){const e={},n=h(t,["functionCallingConfig"]);n!=null&&m(e,["functionCallingConfig"],n3(n));const r=h(t,["retrievalConfig"]);return r!=null&&m(e,["retrievalConfig"],a3(r)),e}function s3(t){const e={},n=h(t,["voiceName"]);return n!=null&&m(e,["voiceName"],n),e}function q2(t){const e={},n=h(t,["prebuiltVoiceConfig"]);return n!=null&&m(e,["prebuiltVoiceConfig"],s3(n)),e}function o3(t){const e={},n=h(t,["speaker"]);n!=null&&m(e,["speaker"],n);const r=h(t,["voiceConfig"]);return r!=null&&m(e,["voiceConfig"],q2(r)),e}function l3(t){const e={},n=h(t,["speakerVoiceConfigs"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>o3(a))),m(e,["speakerVoiceConfigs"],r)}return e}function c3(t){const e={},n=h(t,["voiceConfig"]);n!=null&&m(e,["voiceConfig"],q2(n));const r=h(t,["multiSpeakerVoiceConfig"]);r!=null&&m(e,["multiSpeakerVoiceConfig"],l3(r));const a=h(t,["languageCode"]);return a!=null&&m(e,["languageCode"],a),e}function u3(t){const e={},n=h(t,["includeThoughts"]);n!=null&&m(e,["includeThoughts"],n);const r=h(t,["thinkingBudget"]);return r!=null&&m(e,["thinkingBudget"],r),e}function f3(t,e,n){const r={},a=h(e,["systemInstruction"]);n!==void 0&&a!=null&&m(n,["systemInstruction"],Hf(tr(a)));const s=h(e,["temperature"]);s!=null&&m(r,["temperature"],s);const l=h(e,["topP"]);l!=null&&m(r,["topP"],l);const c=h(e,["topK"]);c!=null&&m(r,["topK"],c);const f=h(e,["candidateCount"]);f!=null&&m(r,["candidateCount"],f);const d=h(e,["maxOutputTokens"]);d!=null&&m(r,["maxOutputTokens"],d);const g=h(e,["stopSequences"]);g!=null&&m(r,["stopSequences"],g);const x=h(e,["responseLogprobs"]);x!=null&&m(r,["responseLogprobs"],x);const _=h(e,["logprobs"]);_!=null&&m(r,["logprobs"],_);const T=h(e,["presencePenalty"]);T!=null&&m(r,["presencePenalty"],T);const E=h(e,["frequencyPenalty"]);E!=null&&m(r,["frequencyPenalty"],E);const S=h(e,["seed"]);S!=null&&m(r,["seed"],S);const C=h(e,["responseMimeType"]);C!=null&&m(r,["responseMimeType"],C);const k=h(e,["responseSchema"]);k!=null&&m(r,["responseSchema"],WN(gm(k)));const N=h(e,["responseJsonSchema"]);if(N!=null&&m(r,["responseJsonSchema"],N),h(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(h(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const b=h(e,["safetySettings"]);if(n!==void 0&&b!=null){let X=b;Array.isArray(X)&&(X=X.map(Z=>YN(Z))),m(n,["safetySettings"],X)}const I=h(e,["tools"]);if(n!==void 0&&I!=null){let X=zo(I);Array.isArray(X)&&(X=X.map(Z=>t3(Ho(Z)))),m(n,["tools"],X)}const F=h(e,["toolConfig"]);if(n!==void 0&&F!=null&&m(n,["toolConfig"],i3(F)),h(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const P=h(e,["cachedContent"]);n!==void 0&&P!=null&&m(n,["cachedContent"],Ka(t,P));const D=h(e,["responseModalities"]);D!=null&&m(r,["responseModalities"],D);const j=h(e,["mediaResolution"]);j!=null&&m(r,["mediaResolution"],j);const B=h(e,["speechConfig"]);if(B!=null&&m(r,["speechConfig"],c3(xm(B))),h(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const te=h(e,["thinkingConfig"]);return te!=null&&m(r,["thinkingConfig"],u3(te)),r}function wy(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","model"],Rt(t,r));const a=h(e,["contents"]);if(a!=null){let l=Jr(a);Array.isArray(l)&&(l=l.map(c=>Hf(c))),m(n,["contents"],l)}const s=h(e,["config"]);return s!=null&&m(n,["generationConfig"],f3(t,s,n)),n}function d3(t,e){const n={},r=h(t,["taskType"]);e!==void 0&&r!=null&&m(e,["requests[]","taskType"],r);const a=h(t,["title"]);e!==void 0&&a!=null&&m(e,["requests[]","title"],a);const s=h(t,["outputDimensionality"]);if(e!==void 0&&s!=null&&m(e,["requests[]","outputDimensionality"],s),h(t,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(h(t,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return n}function h3(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","model"],Rt(t,r));const a=h(e,["contents"]);a!=null&&m(n,["requests[]","content"],A2(t,a));const s=h(e,["config"]);s!=null&&m(n,["config"],d3(s,n));const l=h(e,["model"]);return l!==void 0&&m(n,["requests[]","model"],Rt(t,l)),n}function m3(t,e){const n={};if(h(t,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(h(t,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const r=h(t,["numberOfImages"]);e!==void 0&&r!=null&&m(e,["parameters","sampleCount"],r);const a=h(t,["aspectRatio"]);e!==void 0&&a!=null&&m(e,["parameters","aspectRatio"],a);const s=h(t,["guidanceScale"]);if(e!==void 0&&s!=null&&m(e,["parameters","guidanceScale"],s),h(t,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const l=h(t,["safetyFilterLevel"]);e!==void 0&&l!=null&&m(e,["parameters","safetySetting"],l);const c=h(t,["personGeneration"]);e!==void 0&&c!=null&&m(e,["parameters","personGeneration"],c);const f=h(t,["includeSafetyAttributes"]);e!==void 0&&f!=null&&m(e,["parameters","includeSafetyAttributes"],f);const d=h(t,["includeRaiReason"]);e!==void 0&&d!=null&&m(e,["parameters","includeRaiReason"],d);const g=h(t,["language"]);e!==void 0&&g!=null&&m(e,["parameters","language"],g);const x=h(t,["outputMimeType"]);e!==void 0&&x!=null&&m(e,["parameters","outputOptions","mimeType"],x);const _=h(t,["outputCompressionQuality"]);if(e!==void 0&&_!=null&&m(e,["parameters","outputOptions","compressionQuality"],_),h(t,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(h(t,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return n}function p3(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","model"],Rt(t,r));const a=h(e,["prompt"]);a!=null&&m(n,["instances[0]","prompt"],a);const s=h(e,["config"]);return s!=null&&m(n,["config"],m3(s,n)),n}function g3(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","name"],Rt(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],a),n}function x3(t,e,n){const r={},a=h(e,["pageSize"]);n!==void 0&&a!=null&&m(n,["_query","pageSize"],a);const s=h(e,["pageToken"]);n!==void 0&&s!=null&&m(n,["_query","pageToken"],s);const l=h(e,["filter"]);n!==void 0&&l!=null&&m(n,["_query","filter"],l);const c=h(e,["queryBase"]);return n!==void 0&&c!=null&&m(n,["_url","models_url"],M2(t,c)),r}function v3(t,e){const n={},r=h(e,["config"]);return r!=null&&m(n,["config"],x3(t,r,n)),n}function y3(t,e){const n={},r=h(t,["displayName"]);e!==void 0&&r!=null&&m(e,["displayName"],r);const a=h(t,["description"]);e!==void 0&&a!=null&&m(e,["description"],a);const s=h(t,["defaultCheckpointId"]);return e!==void 0&&s!=null&&m(e,["defaultCheckpointId"],s),n}function _3(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","name"],Rt(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],y3(a,n)),n}function T3(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","name"],Rt(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],a),n}function w3(t){const e={};if(h(t,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(h(t,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(h(t,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return e}function S3(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","model"],Rt(t,r));const a=h(e,["contents"]);if(a!=null){let l=Jr(a);Array.isArray(l)&&(l=l.map(c=>Hf(c))),m(n,["contents"],l)}const s=h(e,["config"]);return s!=null&&m(n,["config"],w3(s)),n}function E3(t){const e={};if(h(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const n=h(t,["imageBytes"]);n!=null&&m(e,["bytesBase64Encoded"],Za(n));const r=h(t,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function C3(t,e){const n={},r=h(t,["numberOfVideos"]);if(e!==void 0&&r!=null&&m(e,["parameters","sampleCount"],r),h(t,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(h(t,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const a=h(t,["durationSeconds"]);if(e!==void 0&&a!=null&&m(e,["parameters","durationSeconds"],a),h(t,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const s=h(t,["aspectRatio"]);if(e!==void 0&&s!=null&&m(e,["parameters","aspectRatio"],s),h(t,["resolution"])!==void 0)throw new Error("resolution parameter is not supported in Gemini API.");const l=h(t,["personGeneration"]);if(e!==void 0&&l!=null&&m(e,["parameters","personGeneration"],l),h(t,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const c=h(t,["negativePrompt"]);e!==void 0&&c!=null&&m(e,["parameters","negativePrompt"],c);const f=h(t,["enhancePrompt"]);if(e!==void 0&&f!=null&&m(e,["parameters","enhancePrompt"],f),h(t,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");if(h(t,["lastFrame"])!==void 0)throw new Error("lastFrame parameter is not supported in Gemini API.");if(h(t,["compressionQuality"])!==void 0)throw new Error("compressionQuality parameter is not supported in Gemini API.");return n}function b3(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","model"],Rt(t,r));const a=h(e,["prompt"]);a!=null&&m(n,["instances[0]","prompt"],a);const s=h(e,["image"]);if(s!=null&&m(n,["instances[0]","image"],E3(s)),h(e,["video"])!==void 0)throw new Error("video parameter is not supported in Gemini API.");const l=h(e,["config"]);return l!=null&&m(n,["config"],C3(l,n)),n}function A3(t){const e={},n=h(t,["fps"]);n!=null&&m(e,["fps"],n);const r=h(t,["endOffset"]);r!=null&&m(e,["endOffset"],r);const a=h(t,["startOffset"]);return a!=null&&m(e,["startOffset"],a),e}function k3(t){const e={},n=h(t,["displayName"]);n!=null&&m(e,["displayName"],n);const r=h(t,["data"]);r!=null&&m(e,["data"],r);const a=h(t,["mimeType"]);return a!=null&&m(e,["mimeType"],a),e}function N3(t){const e={},n=h(t,["displayName"]);n!=null&&m(e,["displayName"],n);const r=h(t,["fileUri"]);r!=null&&m(e,["fileUri"],r);const a=h(t,["mimeType"]);return a!=null&&m(e,["mimeType"],a),e}function M3(t){const e={},n=h(t,["videoMetadata"]);n!=null&&m(e,["videoMetadata"],A3(n));const r=h(t,["thought"]);r!=null&&m(e,["thought"],r);const a=h(t,["inlineData"]);a!=null&&m(e,["inlineData"],k3(a));const s=h(t,["fileData"]);s!=null&&m(e,["fileData"],N3(s));const l=h(t,["thoughtSignature"]);l!=null&&m(e,["thoughtSignature"],l);const c=h(t,["codeExecutionResult"]);c!=null&&m(e,["codeExecutionResult"],c);const f=h(t,["executableCode"]);f!=null&&m(e,["executableCode"],f);const d=h(t,["functionCall"]);d!=null&&m(e,["functionCall"],d);const g=h(t,["functionResponse"]);g!=null&&m(e,["functionResponse"],g);const x=h(t,["text"]);return x!=null&&m(e,["text"],x),e}function jo(t){const e={},n=h(t,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(s=>M3(s))),m(e,["parts"],a)}const r=h(t,["role"]);return r!=null&&m(e,["role"],r),e}function D3(t){const e={},n=h(t,["anyOf"]);n!=null&&m(e,["anyOf"],n);const r=h(t,["default"]);r!=null&&m(e,["default"],r);const a=h(t,["description"]);a!=null&&m(e,["description"],a);const s=h(t,["enum"]);s!=null&&m(e,["enum"],s);const l=h(t,["example"]);l!=null&&m(e,["example"],l);const c=h(t,["format"]);c!=null&&m(e,["format"],c);const f=h(t,["items"]);f!=null&&m(e,["items"],f);const d=h(t,["maxItems"]);d!=null&&m(e,["maxItems"],d);const g=h(t,["maxLength"]);g!=null&&m(e,["maxLength"],g);const x=h(t,["maxProperties"]);x!=null&&m(e,["maxProperties"],x);const _=h(t,["maximum"]);_!=null&&m(e,["maximum"],_);const T=h(t,["minItems"]);T!=null&&m(e,["minItems"],T);const E=h(t,["minLength"]);E!=null&&m(e,["minLength"],E);const S=h(t,["minProperties"]);S!=null&&m(e,["minProperties"],S);const C=h(t,["minimum"]);C!=null&&m(e,["minimum"],C);const k=h(t,["nullable"]);k!=null&&m(e,["nullable"],k);const N=h(t,["pattern"]);N!=null&&m(e,["pattern"],N);const b=h(t,["properties"]);b!=null&&m(e,["properties"],b);const I=h(t,["propertyOrdering"]);I!=null&&m(e,["propertyOrdering"],I);const F=h(t,["required"]);F!=null&&m(e,["required"],F);const P=h(t,["title"]);P!=null&&m(e,["title"],P);const D=h(t,["type"]);return D!=null&&m(e,["type"],D),e}function R3(t){const e={},n=h(t,["featureSelectionPreference"]);return n!=null&&m(e,["featureSelectionPreference"],n),e}function F3(t){const e={},n=h(t,["method"]);n!=null&&m(e,["method"],n);const r=h(t,["category"]);r!=null&&m(e,["category"],r);const a=h(t,["threshold"]);return a!=null&&m(e,["threshold"],a),e}function I3(t){const e={};if(h(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=h(t,["description"]);n!=null&&m(e,["description"],n);const r=h(t,["name"]);r!=null&&m(e,["name"],r);const a=h(t,["parameters"]);a!=null&&m(e,["parameters"],a);const s=h(t,["parametersJsonSchema"]);s!=null&&m(e,["parametersJsonSchema"],s);const l=h(t,["response"]);l!=null&&m(e,["response"],l);const c=h(t,["responseJsonSchema"]);return c!=null&&m(e,["responseJsonSchema"],c),e}function P3(t){const e={},n=h(t,["startTime"]);n!=null&&m(e,["startTime"],n);const r=h(t,["endTime"]);return r!=null&&m(e,["endTime"],r),e}function L3(t){const e={},n=h(t,["timeRangeFilter"]);return n!=null&&m(e,["timeRangeFilter"],P3(n)),e}function O3(t){const e={},n=h(t,["mode"]);n!=null&&m(e,["mode"],n);const r=h(t,["dynamicThreshold"]);return r!=null&&m(e,["dynamicThreshold"],r),e}function U3(t){const e={},n=h(t,["dynamicRetrievalConfig"]);return n!=null&&m(e,["dynamicRetrievalConfig"],O3(n)),e}function B3(){return{}}function V3(t){const e={},n=h(t,["apiKeyString"]);return n!=null&&m(e,["apiKeyString"],n),e}function G3(t){const e={},n=h(t,["apiKeyConfig"]);n!=null&&m(e,["apiKeyConfig"],V3(n));const r=h(t,["authType"]);r!=null&&m(e,["authType"],r);const a=h(t,["googleServiceAccountConfig"]);a!=null&&m(e,["googleServiceAccountConfig"],a);const s=h(t,["httpBasicAuthConfig"]);s!=null&&m(e,["httpBasicAuthConfig"],s);const l=h(t,["oauthConfig"]);l!=null&&m(e,["oauthConfig"],l);const c=h(t,["oidcConfig"]);return c!=null&&m(e,["oidcConfig"],c),e}function H3(t){const e={},n=h(t,["authConfig"]);return n!=null&&m(e,["authConfig"],G3(n)),e}function z3(){return{}}function j2(t){const e={},n=h(t,["functionDeclarations"]);if(n!=null){let x=n;Array.isArray(x)&&(x=x.map(_=>I3(_))),m(e,["functionDeclarations"],x)}const r=h(t,["retrieval"]);r!=null&&m(e,["retrieval"],r);const a=h(t,["googleSearch"]);a!=null&&m(e,["googleSearch"],L3(a));const s=h(t,["googleSearchRetrieval"]);s!=null&&m(e,["googleSearchRetrieval"],U3(s)),h(t,["enterpriseWebSearch"])!=null&&m(e,["enterpriseWebSearch"],B3());const c=h(t,["googleMaps"]);c!=null&&m(e,["googleMaps"],H3(c)),h(t,["urlContext"])!=null&&m(e,["urlContext"],z3());const d=h(t,["codeExecution"]);d!=null&&m(e,["codeExecution"],d);const g=h(t,["computerUse"]);return g!=null&&m(e,["computerUse"],g),e}function q3(t){const e={},n=h(t,["mode"]);n!=null&&m(e,["mode"],n);const r=h(t,["allowedFunctionNames"]);return r!=null&&m(e,["allowedFunctionNames"],r),e}function j3(t){const e={},n=h(t,["latitude"]);n!=null&&m(e,["latitude"],n);const r=h(t,["longitude"]);return r!=null&&m(e,["longitude"],r),e}function $3(t){const e={},n=h(t,["latLng"]);n!=null&&m(e,["latLng"],j3(n));const r=h(t,["languageCode"]);return r!=null&&m(e,["languageCode"],r),e}function W3(t){const e={},n=h(t,["functionCallingConfig"]);n!=null&&m(e,["functionCallingConfig"],q3(n));const r=h(t,["retrievalConfig"]);return r!=null&&m(e,["retrievalConfig"],$3(r)),e}function Y3(t){const e={},n=h(t,["voiceName"]);return n!=null&&m(e,["voiceName"],n),e}function J3(t){const e={},n=h(t,["prebuiltVoiceConfig"]);return n!=null&&m(e,["prebuiltVoiceConfig"],Y3(n)),e}function X3(t){const e={},n=h(t,["voiceConfig"]);if(n!=null&&m(e,["voiceConfig"],J3(n)),h(t,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const r=h(t,["languageCode"]);return r!=null&&m(e,["languageCode"],r),e}function K3(t){const e={},n=h(t,["includeThoughts"]);n!=null&&m(e,["includeThoughts"],n);const r=h(t,["thinkingBudget"]);return r!=null&&m(e,["thinkingBudget"],r),e}function Z3(t,e,n){const r={},a=h(e,["systemInstruction"]);n!==void 0&&a!=null&&m(n,["systemInstruction"],jo(tr(a)));const s=h(e,["temperature"]);s!=null&&m(r,["temperature"],s);const l=h(e,["topP"]);l!=null&&m(r,["topP"],l);const c=h(e,["topK"]);c!=null&&m(r,["topK"],c);const f=h(e,["candidateCount"]);f!=null&&m(r,["candidateCount"],f);const d=h(e,["maxOutputTokens"]);d!=null&&m(r,["maxOutputTokens"],d);const g=h(e,["stopSequences"]);g!=null&&m(r,["stopSequences"],g);const x=h(e,["responseLogprobs"]);x!=null&&m(r,["responseLogprobs"],x);const _=h(e,["logprobs"]);_!=null&&m(r,["logprobs"],_);const T=h(e,["presencePenalty"]);T!=null&&m(r,["presencePenalty"],T);const E=h(e,["frequencyPenalty"]);E!=null&&m(r,["frequencyPenalty"],E);const S=h(e,["seed"]);S!=null&&m(r,["seed"],S);const C=h(e,["responseMimeType"]);C!=null&&m(r,["responseMimeType"],C);const k=h(e,["responseSchema"]);k!=null&&m(r,["responseSchema"],D3(gm(k)));const N=h(e,["responseJsonSchema"]);N!=null&&m(r,["responseJsonSchema"],N);const b=h(e,["routingConfig"]);b!=null&&m(r,["routingConfig"],b);const I=h(e,["modelSelectionConfig"]);I!=null&&m(r,["modelConfig"],R3(I));const F=h(e,["safetySettings"]);if(n!==void 0&&F!=null){let Se=F;Array.isArray(Se)&&(Se=Se.map(ee=>F3(ee))),m(n,["safetySettings"],Se)}const P=h(e,["tools"]);if(n!==void 0&&P!=null){let Se=zo(P);Array.isArray(Se)&&(Se=Se.map(ee=>j2(Ho(ee)))),m(n,["tools"],Se)}const D=h(e,["toolConfig"]);n!==void 0&&D!=null&&m(n,["toolConfig"],W3(D));const j=h(e,["labels"]);n!==void 0&&j!=null&&m(n,["labels"],j);const B=h(e,["cachedContent"]);n!==void 0&&B!=null&&m(n,["cachedContent"],Ka(t,B));const te=h(e,["responseModalities"]);te!=null&&m(r,["responseModalities"],te);const X=h(e,["mediaResolution"]);X!=null&&m(r,["mediaResolution"],X);const Z=h(e,["speechConfig"]);Z!=null&&m(r,["speechConfig"],X3(xm(Z)));const ye=h(e,["audioTimestamp"]);ye!=null&&m(r,["audioTimestamp"],ye);const Me=h(e,["thinkingConfig"]);return Me!=null&&m(r,["thinkingConfig"],K3(Me)),r}function Sy(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","model"],Rt(t,r));const a=h(e,["contents"]);if(a!=null){let l=Jr(a);Array.isArray(l)&&(l=l.map(c=>jo(c))),m(n,["contents"],l)}const s=h(e,["config"]);return s!=null&&m(n,["generationConfig"],Z3(t,s,n)),n}function Q3(t,e){const n={},r=h(t,["taskType"]);e!==void 0&&r!=null&&m(e,["instances[]","task_type"],r);const a=h(t,["title"]);e!==void 0&&a!=null&&m(e,["instances[]","title"],a);const s=h(t,["outputDimensionality"]);e!==void 0&&s!=null&&m(e,["parameters","outputDimensionality"],s);const l=h(t,["mimeType"]);e!==void 0&&l!=null&&m(e,["instances[]","mimeType"],l);const c=h(t,["autoTruncate"]);return e!==void 0&&c!=null&&m(e,["parameters","autoTruncate"],c),n}function eM(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","model"],Rt(t,r));const a=h(e,["contents"]);a!=null&&m(n,["instances[]","content"],A2(t,a));const s=h(e,["config"]);return s!=null&&m(n,["config"],Q3(s,n)),n}function tM(t,e){const n={},r=h(t,["outputGcsUri"]);e!==void 0&&r!=null&&m(e,["parameters","storageUri"],r);const a=h(t,["negativePrompt"]);e!==void 0&&a!=null&&m(e,["parameters","negativePrompt"],a);const s=h(t,["numberOfImages"]);e!==void 0&&s!=null&&m(e,["parameters","sampleCount"],s);const l=h(t,["aspectRatio"]);e!==void 0&&l!=null&&m(e,["parameters","aspectRatio"],l);const c=h(t,["guidanceScale"]);e!==void 0&&c!=null&&m(e,["parameters","guidanceScale"],c);const f=h(t,["seed"]);e!==void 0&&f!=null&&m(e,["parameters","seed"],f);const d=h(t,["safetyFilterLevel"]);e!==void 0&&d!=null&&m(e,["parameters","safetySetting"],d);const g=h(t,["personGeneration"]);e!==void 0&&g!=null&&m(e,["parameters","personGeneration"],g);const x=h(t,["includeSafetyAttributes"]);e!==void 0&&x!=null&&m(e,["parameters","includeSafetyAttributes"],x);const _=h(t,["includeRaiReason"]);e!==void 0&&_!=null&&m(e,["parameters","includeRaiReason"],_);const T=h(t,["language"]);e!==void 0&&T!=null&&m(e,["parameters","language"],T);const E=h(t,["outputMimeType"]);e!==void 0&&E!=null&&m(e,["parameters","outputOptions","mimeType"],E);const S=h(t,["outputCompressionQuality"]);e!==void 0&&S!=null&&m(e,["parameters","outputOptions","compressionQuality"],S);const C=h(t,["addWatermark"]);e!==void 0&&C!=null&&m(e,["parameters","addWatermark"],C);const k=h(t,["enhancePrompt"]);return e!==void 0&&k!=null&&m(e,["parameters","enhancePrompt"],k),n}function nM(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","model"],Rt(t,r));const a=h(e,["prompt"]);a!=null&&m(n,["instances[0]","prompt"],a);const s=h(e,["config"]);return s!=null&&m(n,["config"],tM(s,n)),n}function zf(t){const e={},n=h(t,["gcsUri"]);n!=null&&m(e,["gcsUri"],n);const r=h(t,["imageBytes"]);r!=null&&m(e,["bytesBase64Encoded"],Za(r));const a=h(t,["mimeType"]);return a!=null&&m(e,["mimeType"],a),e}function rM(t){const e={},n=h(t,["maskMode"]);n!=null&&m(e,["maskMode"],n);const r=h(t,["segmentationClasses"]);r!=null&&m(e,["maskClasses"],r);const a=h(t,["maskDilation"]);return a!=null&&m(e,["dilation"],a),e}function aM(t){const e={},n=h(t,["controlType"]);n!=null&&m(e,["controlType"],n);const r=h(t,["enableControlImageComputation"]);return r!=null&&m(e,["computeControl"],r),e}function iM(t){const e={},n=h(t,["styleDescription"]);return n!=null&&m(e,["styleDescription"],n),e}function sM(t){const e={},n=h(t,["subjectType"]);n!=null&&m(e,["subjectType"],n);const r=h(t,["subjectDescription"]);return r!=null&&m(e,["subjectDescription"],r),e}function oM(t){const e={},n=h(t,["referenceImage"]);n!=null&&m(e,["referenceImage"],zf(n));const r=h(t,["referenceId"]);r!=null&&m(e,["referenceId"],r);const a=h(t,["referenceType"]);a!=null&&m(e,["referenceType"],a);const s=h(t,["maskImageConfig"]);s!=null&&m(e,["maskImageConfig"],rM(s));const l=h(t,["controlImageConfig"]);l!=null&&m(e,["controlImageConfig"],aM(l));const c=h(t,["styleImageConfig"]);c!=null&&m(e,["styleImageConfig"],iM(c));const f=h(t,["subjectImageConfig"]);return f!=null&&m(e,["subjectImageConfig"],sM(f)),e}function lM(t,e){const n={},r=h(t,["outputGcsUri"]);e!==void 0&&r!=null&&m(e,["parameters","storageUri"],r);const a=h(t,["negativePrompt"]);e!==void 0&&a!=null&&m(e,["parameters","negativePrompt"],a);const s=h(t,["numberOfImages"]);e!==void 0&&s!=null&&m(e,["parameters","sampleCount"],s);const l=h(t,["aspectRatio"]);e!==void 0&&l!=null&&m(e,["parameters","aspectRatio"],l);const c=h(t,["guidanceScale"]);e!==void 0&&c!=null&&m(e,["parameters","guidanceScale"],c);const f=h(t,["seed"]);e!==void 0&&f!=null&&m(e,["parameters","seed"],f);const d=h(t,["safetyFilterLevel"]);e!==void 0&&d!=null&&m(e,["parameters","safetySetting"],d);const g=h(t,["personGeneration"]);e!==void 0&&g!=null&&m(e,["parameters","personGeneration"],g);const x=h(t,["includeSafetyAttributes"]);e!==void 0&&x!=null&&m(e,["parameters","includeSafetyAttributes"],x);const _=h(t,["includeRaiReason"]);e!==void 0&&_!=null&&m(e,["parameters","includeRaiReason"],_);const T=h(t,["language"]);e!==void 0&&T!=null&&m(e,["parameters","language"],T);const E=h(t,["outputMimeType"]);e!==void 0&&E!=null&&m(e,["parameters","outputOptions","mimeType"],E);const S=h(t,["outputCompressionQuality"]);e!==void 0&&S!=null&&m(e,["parameters","outputOptions","compressionQuality"],S);const C=h(t,["editMode"]);e!==void 0&&C!=null&&m(e,["parameters","editMode"],C);const k=h(t,["baseSteps"]);return e!==void 0&&k!=null&&m(e,["parameters","editConfig","baseSteps"],k),n}function cM(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","model"],Rt(t,r));const a=h(e,["prompt"]);a!=null&&m(n,["instances[0]","prompt"],a);const s=h(e,["referenceImages"]);if(s!=null){let c=s;Array.isArray(c)&&(c=c.map(f=>oM(f))),m(n,["instances[0]","referenceImages"],c)}const l=h(e,["config"]);return l!=null&&m(n,["config"],lM(l,n)),n}function uM(t,e){const n={},r=h(t,["includeRaiReason"]);e!==void 0&&r!=null&&m(e,["parameters","includeRaiReason"],r);const a=h(t,["outputMimeType"]);e!==void 0&&a!=null&&m(e,["parameters","outputOptions","mimeType"],a);const s=h(t,["outputCompressionQuality"]);e!==void 0&&s!=null&&m(e,["parameters","outputOptions","compressionQuality"],s);const l=h(t,["enhanceInputImage"]);e!==void 0&&l!=null&&m(e,["parameters","upscaleConfig","enhanceInputImage"],l);const c=h(t,["imagePreservationFactor"]);e!==void 0&&c!=null&&m(e,["parameters","upscaleConfig","imagePreservationFactor"],c);const f=h(t,["numberOfImages"]);e!==void 0&&f!=null&&m(e,["parameters","sampleCount"],f);const d=h(t,["mode"]);return e!==void 0&&d!=null&&m(e,["parameters","mode"],d),n}function fM(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","model"],Rt(t,r));const a=h(e,["image"]);a!=null&&m(n,["instances[0]","image"],zf(a));const s=h(e,["upscaleFactor"]);s!=null&&m(n,["parameters","upscaleConfig","upscaleFactor"],s);const l=h(e,["config"]);return l!=null&&m(n,["config"],uM(l,n)),n}function dM(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","name"],Rt(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],a),n}function hM(t,e,n){const r={},a=h(e,["pageSize"]);n!==void 0&&a!=null&&m(n,["_query","pageSize"],a);const s=h(e,["pageToken"]);n!==void 0&&s!=null&&m(n,["_query","pageToken"],s);const l=h(e,["filter"]);n!==void 0&&l!=null&&m(n,["_query","filter"],l);const c=h(e,["queryBase"]);return n!==void 0&&c!=null&&m(n,["_url","models_url"],M2(t,c)),r}function mM(t,e){const n={},r=h(e,["config"]);return r!=null&&m(n,["config"],hM(t,r,n)),n}function pM(t,e){const n={},r=h(t,["displayName"]);e!==void 0&&r!=null&&m(e,["displayName"],r);const a=h(t,["description"]);e!==void 0&&a!=null&&m(e,["description"],a);const s=h(t,["defaultCheckpointId"]);return e!==void 0&&s!=null&&m(e,["defaultCheckpointId"],s),n}function gM(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","model"],Rt(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],pM(a,n)),n}function xM(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","name"],Rt(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],a),n}function vM(t,e){const n={},r=h(t,["systemInstruction"]);e!==void 0&&r!=null&&m(e,["systemInstruction"],jo(tr(r)));const a=h(t,["tools"]);if(e!==void 0&&a!=null){let l=a;Array.isArray(l)&&(l=l.map(c=>j2(c))),m(e,["tools"],l)}const s=h(t,["generationConfig"]);return e!==void 0&&s!=null&&m(e,["generationConfig"],s),n}function yM(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","model"],Rt(t,r));const a=h(e,["contents"]);if(a!=null){let l=Jr(a);Array.isArray(l)&&(l=l.map(c=>jo(c))),m(n,["contents"],l)}const s=h(e,["config"]);return s!=null&&m(n,["config"],vM(s,n)),n}function _M(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","model"],Rt(t,r));const a=h(e,["contents"]);if(a!=null){let l=Jr(a);Array.isArray(l)&&(l=l.map(c=>jo(c))),m(n,["contents"],l)}const s=h(e,["config"]);return s!=null&&m(n,["config"],s),n}function TM(t){const e={},n=h(t,["uri"]);n!=null&&m(e,["gcsUri"],n);const r=h(t,["videoBytes"]);r!=null&&m(e,["bytesBase64Encoded"],Za(r));const a=h(t,["mimeType"]);return a!=null&&m(e,["mimeType"],a),e}function wM(t,e){const n={},r=h(t,["numberOfVideos"]);e!==void 0&&r!=null&&m(e,["parameters","sampleCount"],r);const a=h(t,["outputGcsUri"]);e!==void 0&&a!=null&&m(e,["parameters","storageUri"],a);const s=h(t,["fps"]);e!==void 0&&s!=null&&m(e,["parameters","fps"],s);const l=h(t,["durationSeconds"]);e!==void 0&&l!=null&&m(e,["parameters","durationSeconds"],l);const c=h(t,["seed"]);e!==void 0&&c!=null&&m(e,["parameters","seed"],c);const f=h(t,["aspectRatio"]);e!==void 0&&f!=null&&m(e,["parameters","aspectRatio"],f);const d=h(t,["resolution"]);e!==void 0&&d!=null&&m(e,["parameters","resolution"],d);const g=h(t,["personGeneration"]);e!==void 0&&g!=null&&m(e,["parameters","personGeneration"],g);const x=h(t,["pubsubTopic"]);e!==void 0&&x!=null&&m(e,["parameters","pubsubTopic"],x);const _=h(t,["negativePrompt"]);e!==void 0&&_!=null&&m(e,["parameters","negativePrompt"],_);const T=h(t,["enhancePrompt"]);e!==void 0&&T!=null&&m(e,["parameters","enhancePrompt"],T);const E=h(t,["generateAudio"]);e!==void 0&&E!=null&&m(e,["parameters","generateAudio"],E);const S=h(t,["lastFrame"]);e!==void 0&&S!=null&&m(e,["instances[0]","lastFrame"],zf(S));const C=h(t,["compressionQuality"]);return e!==void 0&&C!=null&&m(e,["parameters","compressionQuality"],C),n}function SM(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","model"],Rt(t,r));const a=h(e,["prompt"]);a!=null&&m(n,["instances[0]","prompt"],a);const s=h(e,["image"]);s!=null&&m(n,["instances[0]","image"],zf(s));const l=h(e,["video"]);l!=null&&m(n,["instances[0]","video"],TM(l));const c=h(e,["config"]);return c!=null&&m(n,["config"],wM(c,n)),n}function EM(t){const e={},n=h(t,["fps"]);n!=null&&m(e,["fps"],n);const r=h(t,["endOffset"]);r!=null&&m(e,["endOffset"],r);const a=h(t,["startOffset"]);return a!=null&&m(e,["startOffset"],a),e}function CM(t){const e={},n=h(t,["data"]);n!=null&&m(e,["data"],n);const r=h(t,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function bM(t){const e={},n=h(t,["fileUri"]);n!=null&&m(e,["fileUri"],n);const r=h(t,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function AM(t){const e={},n=h(t,["videoMetadata"]);n!=null&&m(e,["videoMetadata"],EM(n));const r=h(t,["thought"]);r!=null&&m(e,["thought"],r);const a=h(t,["inlineData"]);a!=null&&m(e,["inlineData"],CM(a));const s=h(t,["fileData"]);s!=null&&m(e,["fileData"],bM(s));const l=h(t,["thoughtSignature"]);l!=null&&m(e,["thoughtSignature"],l);const c=h(t,["codeExecutionResult"]);c!=null&&m(e,["codeExecutionResult"],c);const f=h(t,["executableCode"]);f!=null&&m(e,["executableCode"],f);const d=h(t,["functionCall"]);d!=null&&m(e,["functionCall"],d);const g=h(t,["functionResponse"]);g!=null&&m(e,["functionResponse"],g);const x=h(t,["text"]);return x!=null&&m(e,["text"],x),e}function kM(t){const e={},n=h(t,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(s=>AM(s))),m(e,["parts"],a)}const r=h(t,["role"]);return r!=null&&m(e,["role"],r),e}function NM(t){const e={},n=h(t,["citationSources"]);return n!=null&&m(e,["citations"],n),e}function MM(t){const e={},n=h(t,["retrievedUrl"]);n!=null&&m(e,["retrievedUrl"],n);const r=h(t,["urlRetrievalStatus"]);return r!=null&&m(e,["urlRetrievalStatus"],r),e}function DM(t){const e={},n=h(t,["urlMetadata"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>MM(a))),m(e,["urlMetadata"],r)}return e}function RM(t){const e={},n=h(t,["content"]);n!=null&&m(e,["content"],kM(n));const r=h(t,["citationMetadata"]);r!=null&&m(e,["citationMetadata"],NM(r));const a=h(t,["tokenCount"]);a!=null&&m(e,["tokenCount"],a);const s=h(t,["finishReason"]);s!=null&&m(e,["finishReason"],s);const l=h(t,["urlContextMetadata"]);l!=null&&m(e,["urlContextMetadata"],DM(l));const c=h(t,["avgLogprobs"]);c!=null&&m(e,["avgLogprobs"],c);const f=h(t,["groundingMetadata"]);f!=null&&m(e,["groundingMetadata"],f);const d=h(t,["index"]);d!=null&&m(e,["index"],d);const g=h(t,["logprobsResult"]);g!=null&&m(e,["logprobsResult"],g);const x=h(t,["safetyRatings"]);return x!=null&&m(e,["safetyRatings"],x),e}function Ey(t){const e={},n=h(t,["candidates"]);if(n!=null){let l=n;Array.isArray(l)&&(l=l.map(c=>RM(c))),m(e,["candidates"],l)}const r=h(t,["modelVersion"]);r!=null&&m(e,["modelVersion"],r);const a=h(t,["promptFeedback"]);a!=null&&m(e,["promptFeedback"],a);const s=h(t,["usageMetadata"]);return s!=null&&m(e,["usageMetadata"],s),e}function FM(t){const e={},n=h(t,["values"]);return n!=null&&m(e,["values"],n),e}function IM(){return{}}function PM(t){const e={},n=h(t,["embeddings"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(s=>FM(s))),m(e,["embeddings"],a)}return h(t,["metadata"])!=null&&m(e,["metadata"],IM()),e}function LM(t){const e={},n=h(t,["bytesBase64Encoded"]);n!=null&&m(e,["imageBytes"],Za(n));const r=h(t,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function $2(t){const e={},n=h(t,["safetyAttributes","categories"]);n!=null&&m(e,["categories"],n);const r=h(t,["safetyAttributes","scores"]);r!=null&&m(e,["scores"],r);const a=h(t,["contentType"]);return a!=null&&m(e,["contentType"],a),e}function OM(t){const e={},n=h(t,["_self"]);n!=null&&m(e,["image"],LM(n));const r=h(t,["raiFilteredReason"]);r!=null&&m(e,["raiFilteredReason"],r);const a=h(t,["_self"]);return a!=null&&m(e,["safetyAttributes"],$2(a)),e}function UM(t){const e={},n=h(t,["predictions"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(s=>OM(s))),m(e,["generatedImages"],a)}const r=h(t,["positivePromptSafetyAttributes"]);return r!=null&&m(e,["positivePromptSafetyAttributes"],$2(r)),e}function BM(t){const e={},n=h(t,["baseModel"]);n!=null&&m(e,["baseModel"],n);const r=h(t,["createTime"]);r!=null&&m(e,["createTime"],r);const a=h(t,["updateTime"]);return a!=null&&m(e,["updateTime"],a),e}function Hh(t){const e={},n=h(t,["name"]);n!=null&&m(e,["name"],n);const r=h(t,["displayName"]);r!=null&&m(e,["displayName"],r);const a=h(t,["description"]);a!=null&&m(e,["description"],a);const s=h(t,["version"]);s!=null&&m(e,["version"],s);const l=h(t,["_self"]);l!=null&&m(e,["tunedModelInfo"],BM(l));const c=h(t,["inputTokenLimit"]);c!=null&&m(e,["inputTokenLimit"],c);const f=h(t,["outputTokenLimit"]);f!=null&&m(e,["outputTokenLimit"],f);const d=h(t,["supportedGenerationMethods"]);return d!=null&&m(e,["supportedActions"],d),e}function VM(t){const e={},n=h(t,["nextPageToken"]);n!=null&&m(e,["nextPageToken"],n);const r=h(t,["_self"]);if(r!=null){let a=D2(r);Array.isArray(a)&&(a=a.map(s=>Hh(s))),m(e,["models"],a)}return e}function GM(){return{}}function HM(t){const e={},n=h(t,["totalTokens"]);n!=null&&m(e,["totalTokens"],n);const r=h(t,["cachedContentTokenCount"]);return r!=null&&m(e,["cachedContentTokenCount"],r),e}function zM(t){const e={},n=h(t,["video","uri"]);n!=null&&m(e,["uri"],n);const r=h(t,["video","encodedVideo"]);r!=null&&m(e,["videoBytes"],Za(r));const a=h(t,["encoding"]);return a!=null&&m(e,["mimeType"],a),e}function qM(t){const e={},n=h(t,["_self"]);return n!=null&&m(e,["video"],zM(n)),e}function jM(t){const e={},n=h(t,["generatedSamples"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(l=>qM(l))),m(e,["generatedVideos"],s)}const r=h(t,["raiMediaFilteredCount"]);r!=null&&m(e,["raiMediaFilteredCount"],r);const a=h(t,["raiMediaFilteredReasons"]);return a!=null&&m(e,["raiMediaFilteredReasons"],a),e}function $M(t){const e={},n=h(t,["name"]);n!=null&&m(e,["name"],n);const r=h(t,["metadata"]);r!=null&&m(e,["metadata"],r);const a=h(t,["done"]);a!=null&&m(e,["done"],a);const s=h(t,["error"]);s!=null&&m(e,["error"],s);const l=h(t,["response","generateVideoResponse"]);return l!=null&&m(e,["response"],jM(l)),e}function WM(t){const e={},n=h(t,["fps"]);n!=null&&m(e,["fps"],n);const r=h(t,["endOffset"]);r!=null&&m(e,["endOffset"],r);const a=h(t,["startOffset"]);return a!=null&&m(e,["startOffset"],a),e}function YM(t){const e={},n=h(t,["displayName"]);n!=null&&m(e,["displayName"],n);const r=h(t,["data"]);r!=null&&m(e,["data"],r);const a=h(t,["mimeType"]);return a!=null&&m(e,["mimeType"],a),e}function JM(t){const e={},n=h(t,["displayName"]);n!=null&&m(e,["displayName"],n);const r=h(t,["fileUri"]);r!=null&&m(e,["fileUri"],r);const a=h(t,["mimeType"]);return a!=null&&m(e,["mimeType"],a),e}function XM(t){const e={},n=h(t,["videoMetadata"]);n!=null&&m(e,["videoMetadata"],WM(n));const r=h(t,["thought"]);r!=null&&m(e,["thought"],r);const a=h(t,["inlineData"]);a!=null&&m(e,["inlineData"],YM(a));const s=h(t,["fileData"]);s!=null&&m(e,["fileData"],JM(s));const l=h(t,["thoughtSignature"]);l!=null&&m(e,["thoughtSignature"],l);const c=h(t,["codeExecutionResult"]);c!=null&&m(e,["codeExecutionResult"],c);const f=h(t,["executableCode"]);f!=null&&m(e,["executableCode"],f);const d=h(t,["functionCall"]);d!=null&&m(e,["functionCall"],d);const g=h(t,["functionResponse"]);g!=null&&m(e,["functionResponse"],g);const x=h(t,["text"]);return x!=null&&m(e,["text"],x),e}function KM(t){const e={},n=h(t,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(s=>XM(s))),m(e,["parts"],a)}const r=h(t,["role"]);return r!=null&&m(e,["role"],r),e}function ZM(t){const e={},n=h(t,["citations"]);return n!=null&&m(e,["citations"],n),e}function QM(t){const e={},n=h(t,["retrievedUrl"]);n!=null&&m(e,["retrievedUrl"],n);const r=h(t,["urlRetrievalStatus"]);return r!=null&&m(e,["urlRetrievalStatus"],r),e}function eD(t){const e={},n=h(t,["urlMetadata"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>QM(a))),m(e,["urlMetadata"],r)}return e}function tD(t){const e={},n=h(t,["content"]);n!=null&&m(e,["content"],KM(n));const r=h(t,["citationMetadata"]);r!=null&&m(e,["citationMetadata"],ZM(r));const a=h(t,["finishMessage"]);a!=null&&m(e,["finishMessage"],a);const s=h(t,["finishReason"]);s!=null&&m(e,["finishReason"],s);const l=h(t,["urlContextMetadata"]);l!=null&&m(e,["urlContextMetadata"],eD(l));const c=h(t,["avgLogprobs"]);c!=null&&m(e,["avgLogprobs"],c);const f=h(t,["groundingMetadata"]);f!=null&&m(e,["groundingMetadata"],f);const d=h(t,["index"]);d!=null&&m(e,["index"],d);const g=h(t,["logprobsResult"]);g!=null&&m(e,["logprobsResult"],g);const x=h(t,["safetyRatings"]);return x!=null&&m(e,["safetyRatings"],x),e}function Cy(t){const e={},n=h(t,["candidates"]);if(n!=null){let f=n;Array.isArray(f)&&(f=f.map(d=>tD(d))),m(e,["candidates"],f)}const r=h(t,["createTime"]);r!=null&&m(e,["createTime"],r);const a=h(t,["responseId"]);a!=null&&m(e,["responseId"],a);const s=h(t,["modelVersion"]);s!=null&&m(e,["modelVersion"],s);const l=h(t,["promptFeedback"]);l!=null&&m(e,["promptFeedback"],l);const c=h(t,["usageMetadata"]);return c!=null&&m(e,["usageMetadata"],c),e}function nD(t){const e={},n=h(t,["truncated"]);n!=null&&m(e,["truncated"],n);const r=h(t,["token_count"]);return r!=null&&m(e,["tokenCount"],r),e}function rD(t){const e={},n=h(t,["values"]);n!=null&&m(e,["values"],n);const r=h(t,["statistics"]);return r!=null&&m(e,["statistics"],nD(r)),e}function aD(t){const e={},n=h(t,["billableCharacterCount"]);return n!=null&&m(e,["billableCharacterCount"],n),e}function iD(t){const e={},n=h(t,["predictions[]","embeddings"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(s=>rD(s))),m(e,["embeddings"],a)}const r=h(t,["metadata"]);return r!=null&&m(e,["metadata"],aD(r)),e}function sD(t){const e={},n=h(t,["gcsUri"]);n!=null&&m(e,["gcsUri"],n);const r=h(t,["bytesBase64Encoded"]);r!=null&&m(e,["imageBytes"],Za(r));const a=h(t,["mimeType"]);return a!=null&&m(e,["mimeType"],a),e}function W2(t){const e={},n=h(t,["safetyAttributes","categories"]);n!=null&&m(e,["categories"],n);const r=h(t,["safetyAttributes","scores"]);r!=null&&m(e,["scores"],r);const a=h(t,["contentType"]);return a!=null&&m(e,["contentType"],a),e}function ym(t){const e={},n=h(t,["_self"]);n!=null&&m(e,["image"],sD(n));const r=h(t,["raiFilteredReason"]);r!=null&&m(e,["raiFilteredReason"],r);const a=h(t,["_self"]);a!=null&&m(e,["safetyAttributes"],W2(a));const s=h(t,["prompt"]);return s!=null&&m(e,["enhancedPrompt"],s),e}function oD(t){const e={},n=h(t,["predictions"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(s=>ym(s))),m(e,["generatedImages"],a)}const r=h(t,["positivePromptSafetyAttributes"]);return r!=null&&m(e,["positivePromptSafetyAttributes"],W2(r)),e}function lD(t){const e={},n=h(t,["predictions"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>ym(a))),m(e,["generatedImages"],r)}return e}function cD(t){const e={},n=h(t,["predictions"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>ym(a))),m(e,["generatedImages"],r)}return e}function uD(t){const e={},n=h(t,["endpoint"]);n!=null&&m(e,["name"],n);const r=h(t,["deployedModelId"]);return r!=null&&m(e,["deployedModelId"],r),e}function fD(t){const e={},n=h(t,["labels","google-vertex-llm-tuning-base-model-id"]);n!=null&&m(e,["baseModel"],n);const r=h(t,["createTime"]);r!=null&&m(e,["createTime"],r);const a=h(t,["updateTime"]);return a!=null&&m(e,["updateTime"],a),e}function dD(t){const e={},n=h(t,["checkpointId"]);n!=null&&m(e,["checkpointId"],n);const r=h(t,["epoch"]);r!=null&&m(e,["epoch"],r);const a=h(t,["step"]);return a!=null&&m(e,["step"],a),e}function zh(t){const e={},n=h(t,["name"]);n!=null&&m(e,["name"],n);const r=h(t,["displayName"]);r!=null&&m(e,["displayName"],r);const a=h(t,["description"]);a!=null&&m(e,["description"],a);const s=h(t,["versionId"]);s!=null&&m(e,["version"],s);const l=h(t,["deployedModels"]);if(l!=null){let x=l;Array.isArray(x)&&(x=x.map(_=>uD(_))),m(e,["endpoints"],x)}const c=h(t,["labels"]);c!=null&&m(e,["labels"],c);const f=h(t,["_self"]);f!=null&&m(e,["tunedModelInfo"],fD(f));const d=h(t,["defaultCheckpointId"]);d!=null&&m(e,["defaultCheckpointId"],d);const g=h(t,["checkpoints"]);if(g!=null){let x=g;Array.isArray(x)&&(x=x.map(_=>dD(_))),m(e,["checkpoints"],x)}return e}function hD(t){const e={},n=h(t,["nextPageToken"]);n!=null&&m(e,["nextPageToken"],n);const r=h(t,["_self"]);if(r!=null){let a=D2(r);Array.isArray(a)&&(a=a.map(s=>zh(s))),m(e,["models"],a)}return e}function mD(){return{}}function pD(t){const e={},n=h(t,["totalTokens"]);return n!=null&&m(e,["totalTokens"],n),e}function gD(t){const e={},n=h(t,["tokensInfo"]);return n!=null&&m(e,["tokensInfo"],n),e}function xD(t){const e={},n=h(t,["gcsUri"]);n!=null&&m(e,["uri"],n);const r=h(t,["bytesBase64Encoded"]);r!=null&&m(e,["videoBytes"],Za(r));const a=h(t,["mimeType"]);return a!=null&&m(e,["mimeType"],a),e}function vD(t){const e={},n=h(t,["_self"]);return n!=null&&m(e,["video"],xD(n)),e}function yD(t){const e={},n=h(t,["videos"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(l=>vD(l))),m(e,["generatedVideos"],s)}const r=h(t,["raiMediaFilteredCount"]);r!=null&&m(e,["raiMediaFilteredCount"],r);const a=h(t,["raiMediaFilteredReasons"]);return a!=null&&m(e,["raiMediaFilteredReasons"],a),e}function _D(t){const e={},n=h(t,["name"]);n!=null&&m(e,["name"],n);const r=h(t,["metadata"]);r!=null&&m(e,["metadata"],r);const a=h(t,["done"]);a!=null&&m(e,["done"],a);const s=h(t,["error"]);s!=null&&m(e,["error"],s);const l=h(t,["response"]);return l!=null&&m(e,["response"],yD(l)),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const TD="Content-Type",wD="X-Server-Timeout",SD="User-Agent",qh="x-goog-api-client",ED="1.9.0",CD=`google-genai-sdk/${ED}`,bD="v1beta1",AD="v1beta",by=/^data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class kD{constructor(e){var n,r;this.clientOptions=Object.assign(Object.assign({},e),{project:e.project,location:e.location,apiKey:e.apiKey,vertexai:e.vertexai});const a={};this.clientOptions.vertexai?(a.apiVersion=(n=this.clientOptions.apiVersion)!==null&&n!==void 0?n:bD,a.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(a.apiVersion=(r=this.clientOptions.apiVersion)!==null&&r!==void 0?r:AD,a.baseUrl="https://generativelanguage.googleapis.com/"),a.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=a,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(a,e.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var e;return(e=this.clientOptions.vertexai)!==null&&e!==void 0?e:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||e.baseUrl===void 0||e.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const r=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&e.apiVersion!==""&&r.push(e.apiVersion),r.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),n=new URL(e);return n.protocol=n.protocol=="http:"?"ws":"wss",n.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw new Error("HTTP options are not correctly set.")}constructUrl(e,n,r){const a=[this.getRequestUrlInternal(n)];return r&&a.push(this.getBaseResourcePath()),e!==""&&a.push(e),new URL(`${a.join("/")}`)}shouldPrependVertexProjectPath(e){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||e.httpMethod==="GET"&&e.path.startsWith("publishers/google/models"))}async request(e){let n=this.clientOptions.httpOptions;e.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const r=this.shouldPrependVertexProjectPath(e),a=this.constructUrl(e.path,n,r);if(e.queryParams)for(const[l,c]of Object.entries(e.queryParams))a.searchParams.append(l,String(c));let s={};if(e.httpMethod==="GET"){if(e.body&&e.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else s.body=e.body;return s=await this.includeExtraHttpOptionsToRequestInit(s,n,e.abortSignal),this.unaryApiCall(a,s,e.httpMethod)}patchHttpOptions(e,n){const r=JSON.parse(JSON.stringify(e));for(const[a,s]of Object.entries(n))typeof s=="object"?r[a]=Object.assign(Object.assign({},r[a]),s):s!==void 0&&(r[a]=s);return r}async requestStream(e){let n=this.clientOptions.httpOptions;e.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const r=this.shouldPrependVertexProjectPath(e),a=this.constructUrl(e.path,n,r);(!a.searchParams.has("alt")||a.searchParams.get("alt")!=="sse")&&a.searchParams.set("alt","sse");let s={};return s.body=e.body,s=await this.includeExtraHttpOptionsToRequestInit(s,n,e.abortSignal),this.streamApiCall(a,s,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,n,r){if(n&&n.timeout||r){const a=new AbortController,s=a.signal;if(n.timeout&&(n==null?void 0:n.timeout)>0){const l=setTimeout(()=>a.abort(),n.timeout);l&&typeof l.unref=="function"&&l.unref()}r&&r.addEventListener("abort",()=>{a.abort()}),e.signal=s}return n&&n.extraBody!==null&&ND(e,n.extraBody),e.headers=await this.getHeadersInternal(n),e}async unaryApiCall(e,n,r){return this.apiCall(e.toString(),Object.assign(Object.assign({},n),{method:r})).then(async a=>(await Ay(a),new Lh(a))).catch(a=>{throw a instanceof Error?a:new Error(JSON.stringify(a))})}async streamApiCall(e,n,r){return this.apiCall(e.toString(),Object.assign(Object.assign({},n),{method:r})).then(async a=>(await Ay(a),this.processStreamResponse(a))).catch(a=>{throw a instanceof Error?a:new Error(JSON.stringify(a))})}processStreamResponse(e){var n;return Fo(this,arguments,function*(){const a=(n=e==null?void 0:e.body)===null||n===void 0?void 0:n.getReader(),s=new TextDecoder("utf-8");if(!a)throw new Error("Response body is empty");try{let l="";for(;;){const{done:c,value:f}=yield Yt(a.read());if(c){if(l.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const d=s.decode(f,{stream:!0});try{const x=JSON.parse(d);if("error"in x){const _=JSON.parse(JSON.stringify(x.error)),T=_.status,E=_.code,S=`got status: ${T}. ${JSON.stringify(x)}`;if(E>=400&&E<600)throw new Gf({message:S,status:E})}}catch(x){if(x.name==="ApiError")throw x}l+=d;let g=l.match(by);for(;g;){const x=g[1];try{const _=new Response(x,{headers:e==null?void 0:e.headers,status:e==null?void 0:e.status,statusText:e==null?void 0:e.statusText});yield yield Yt(new Lh(_)),l=l.slice(g[0].length),g=l.match(by)}catch(_){throw new Error(`exception parsing stream chunk ${x}. ${_}`)}}}}finally{a.releaseLock()}})}async apiCall(e,n){return fetch(e,n).catch(r=>{throw new Error(`exception ${r} sending request`)})}getDefaultHeaders(){const e={},n=CD+" "+this.clientOptions.userAgentExtra;return e[SD]=n,e[qh]=n,e[TD]="application/json",e}async getHeadersInternal(e){const n=new Headers;if(e&&e.headers){for(const[r,a]of Object.entries(e.headers))n.append(r,a);e.timeout&&e.timeout>0&&n.append(wD,String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(n),n}async uploadFile(e,n){var r;const a={};n!=null&&(a.mimeType=n.mimeType,a.name=n.name,a.displayName=n.displayName),a.name&&!a.name.startsWith("files/")&&(a.name=`files/${a.name}`);const s=this.clientOptions.uploader,l=await s.stat(e);a.sizeBytes=String(l.size);const c=(r=n==null?void 0:n.mimeType)!==null&&r!==void 0?r:l.type;if(c===void 0||c==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");a.mimeType=c;const f=await this.fetchUploadUrl(a,n);return s.upload(e,f,this)}async downloadFile(e){await this.clientOptions.downloader.download(e,this)}async fetchUploadUrl(e,n){var r;let a={};n!=null&&n.httpOptions?a=n.httpOptions:a={apiVersion:"",headers:{"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${e.sizeBytes}`,"X-Goog-Upload-Header-Content-Type":`${e.mimeType}`}};const s={file:e},l=await this.request({path:Ge("upload/v1beta/files",s._url),body:JSON.stringify(s),httpMethod:"POST",httpOptions:a});if(!l||!(l!=null&&l.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const c=(r=l==null?void 0:l.headers)===null||r===void 0?void 0:r["x-goog-upload-url"];if(c===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return c}}async function Ay(t){var e;if(t===void 0)throw new Error("response is undefined");if(!t.ok){const n=t.status;let r;!((e=t.headers.get("content-type"))===null||e===void 0)&&e.includes("application/json")?r=await t.json():r={error:{message:await t.text(),code:t.status,status:t.statusText}};const a=JSON.stringify(r);throw n>=400&&n<600?new Gf({message:a,status:n}):new Error(a)}}function ND(t,e){if(!e||Object.keys(e).length===0)return;if(t.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let n={};if(typeof t.body=="string"&&t.body.length>0)try{const s=JSON.parse(t.body);if(typeof s=="object"&&s!==null&&!Array.isArray(s))n=s;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function r(s,l){const c=Object.assign({},s);for(const f in l)if(Object.prototype.hasOwnProperty.call(l,f)){const d=l[f],g=c[f];d&&typeof d=="object"&&!Array.isArray(d)&&g&&typeof g=="object"&&!Array.isArray(g)?c[f]=r(g,d):(g&&d&&typeof g!=typeof d&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${f}". Original type: ${typeof g}, New type: ${typeof d}. Overwriting.`),c[f]=d)}return c}const a=r(n,e);t.body=JSON.stringify(a)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const MD="mcp_used/unknown";function Y2(t){for(const e of t)if(_m(e)||typeof e=="object"&&"inputSchema"in e)return!0;return!1}function J2(t){var e;const n=(e=t[qh])!==null&&e!==void 0?e:"";t[qh]=(n+` ${MD}`).trimStart()}function DD(t){var e,n,r;return(r=(n=(e=t.config)===null||e===void 0?void 0:e.tools)===null||n===void 0?void 0:n.some(a=>_m(a)))!==null&&r!==void 0?r:!1}function RD(t){var e,n,r;return(r=(n=(e=t.config)===null||e===void 0?void 0:e.tools)===null||n===void 0?void 0:n.some(a=>!_m(a)))!==null&&r!==void 0?r:!1}function _m(t){return t!==null&&typeof t=="object"&&t instanceof Tm}function FD(t,e=100){return Fo(this,arguments,function*(){let r,a=0;for(;a<e;){const s=yield Yt(t.listTools({cursor:r}));for(const l of s.tools)yield yield Yt(l),a++;if(!s.nextCursor)break;r=s.nextCursor}})}class Tm{constructor(e=[],n){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=e,this.config=n}static create(e,n){return new Tm(e,n)}async initialize(){var e,n,r,a;if(this.mcpTools.length>0)return;const s={},l=[];for(const g of this.mcpClients)try{for(var c=!0,f=(n=void 0,ic(FD(g))),d;d=await f.next(),e=d.done,!e;c=!0){a=d.value,c=!1;const x=a;l.push(x);const _=x.name;if(s[_])throw new Error(`Duplicate function name ${_} found in MCP tools. Please ensure function names are unique.`);s[_]=g}}catch(x){n={error:x}}finally{try{!c&&!e&&(r=f.return)&&await r.call(f)}finally{if(n)throw n.error}}this.mcpTools=l,this.functionNameToMcpClient=s}async tool(){return await this.initialize(),kb(this.mcpTools,this.config)}async callTool(e){await this.initialize();const n=[];for(const r of e)if(r.name in this.functionNameToMcpClient){const a=this.functionNameToMcpClient[r.name];let s;this.config.timeout&&(s={timeout:this.config.timeout});const l=await a.callTool({name:r.name,arguments:r.args},void 0,s);n.push({functionResponse:{name:r.name,response:l.isError?{error:l}:l}})}return n}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function ID(t,e,n){const r=new _b;let a;n.data instanceof Blob?a=JSON.parse(await n.data.text()):a=JSON.parse(n.data);const s=HN(a);Object.assign(r,s),e(r)}class PD{constructor(e,n,r){this.apiClient=e,this.auth=n,this.webSocketFactory=r}async connect(e){var n,r;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const a=this.apiClient.getWebsocketBaseUrl(),s=this.apiClient.getApiVersion(),l=UD(this.apiClient.getDefaultHeaders()),c=this.apiClient.getApiKey(),f=`${a}/ws/google.ai.generativelanguage.${s}.GenerativeService.BidiGenerateMusic?key=${c}`;let d=()=>{};const g=new Promise(b=>{d=b}),x=e.callbacks,_=function(){d({})},T=this.apiClient,E={onopen:_,onmessage:b=>{ID(T,x.onmessage,b)},onerror:(n=x==null?void 0:x.onerror)!==null&&n!==void 0?n:function(b){},onclose:(r=x==null?void 0:x.onclose)!==null&&r!==void 0?r:function(b){}},S=this.webSocketFactory.create(f,OD(l),E);S.connect(),await g;const C=Rt(this.apiClient,e.model),k=H2({model:C}),N=Gh({setup:k});return S.send(JSON.stringify(N)),new LD(S,this.apiClient)}}class LD{constructor(e,n){this.conn=e,this.apiClient=n}async setWeightedPrompts(e){if(!e.weightedPrompts||Object.keys(e.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const n=nN(e),r=z2(n);this.conn.send(JSON.stringify({clientContent:r}))}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});const n=rN(e),r=Gh(n);this.conn.send(JSON.stringify(r))}sendPlaybackControl(e){const n=Gh({playbackControl:e});this.conn.send(JSON.stringify(n))}play(){this.sendPlaybackControl(Mo.PLAY)}pause(){this.sendPlaybackControl(Mo.PAUSE)}stop(){this.sendPlaybackControl(Mo.STOP)}resetContext(){this.sendPlaybackControl(Mo.RESET_CONTEXT)}close(){this.conn.close()}}function OD(t){const e={};return t.forEach((n,r)=>{e[r]=n}),e}function UD(t){const e=new Headers;for(const[n,r]of Object.entries(t))e.append(n,r);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const BD="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function VD(t,e,n){const r=new yb;let a;n.data instanceof Blob?a=await n.data.text():n.data instanceof ArrayBuffer?a=new TextDecoder().decode(n.data):a=n.data;const s=JSON.parse(a);if(t.isVertexAI()){const l=FN(s);Object.assign(r,l)}else{const l=RN(s);Object.assign(r,l)}e(r)}class GD{constructor(e,n,r){this.apiClient=e,this.auth=n,this.webSocketFactory=r,this.music=new PD(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var n,r,a,s,l,c;const f=this.apiClient.getWebsocketBaseUrl(),d=this.apiClient.getApiVersion();let g;const x=this.apiClient.getDefaultHeaders();e.config&&e.config.tools&&Y2(e.config.tools)&&J2(x);const _=jD(x);if(this.apiClient.isVertexAI())g=`${f}/ws/google.cloud.aiplatform.${d}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(_);else{const B=this.apiClient.getApiKey();let te="BidiGenerateContent",X="key";B!=null&&B.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),d!=="v1alpha"&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),te="BidiGenerateContentConstrained",X="access_token"),g=`${f}/ws/google.ai.generativelanguage.${d}.GenerativeService.${te}?${X}=${B}`}let T=()=>{};const E=new Promise(B=>{T=B}),S=e.callbacks,C=function(){var B;(B=S==null?void 0:S.onopen)===null||B===void 0||B.call(S),T({})},k=this.apiClient,N={onopen:C,onmessage:B=>{VD(k,S.onmessage,B)},onerror:(n=S==null?void 0:S.onerror)!==null&&n!==void 0?n:function(B){},onclose:(r=S==null?void 0:S.onclose)!==null&&r!==void 0?r:function(B){}},b=this.webSocketFactory.create(g,qD(_),N);b.connect(),await E;let I=Rt(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&I.startsWith("publishers/")){const B=this.apiClient.getProject(),te=this.apiClient.getLocation();I=`projects/${B}/locations/${te}/`+I}let F={};this.apiClient.isVertexAI()&&((a=e.config)===null||a===void 0?void 0:a.responseModalities)===void 0&&(e.config===void 0?e.config={responseModalities:[Sf.AUDIO]}:e.config.responseModalities=[Sf.AUDIO]),!((s=e.config)===null||s===void 0)&&s.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const P=(c=(l=e.config)===null||l===void 0?void 0:l.tools)!==null&&c!==void 0?c:[],D=[];for(const B of P)if(this.isCallableTool(B)){const te=B;D.push(await te.tool())}else D.push(B);D.length>0&&(e.config.tools=D);const j={model:I,config:e.config,callbacks:e.callbacks};return this.apiClient.isVertexAI()?F=J4(this.apiClient,j):F=Y4(this.apiClient,j),delete F.config,b.send(JSON.stringify(F)),new zD(b,this.apiClient)}isCallableTool(e){return"callTool"in e&&typeof e.callTool=="function"}}const HD={turnComplete:!0};class zD{constructor(e,n){this.conn=e,this.apiClient=n}tLiveClientContent(e,n){if(n.turns!==null&&n.turns!==void 0){let r=[];try{r=Jr(n.turns),e.isVertexAI()?r=r.map(a=>jo(a)):r=r.map(a=>Hf(a))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof n.turns}'`)}return{clientContent:{turns:r,turnComplete:n.turnComplete}}}return{clientContent:{turnComplete:n.turnComplete}}}tLiveClienttToolResponse(e,n){let r=[];if(n.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(n.functionResponses)?r=n.functionResponses:r=[n.functionResponses],r.length===0)throw new Error("functionResponses is required.");for(const s of r){if(typeof s!="object"||s===null||!("name"in s)||!("response"in s))throw new Error(`Could not parse function response, type '${typeof s}'.`);if(!e.isVertexAI()&&!("id"in s))throw new Error(BD)}return{toolResponse:{functionResponses:r}}}sendClientContent(e){e=Object.assign(Object.assign({},HD),e);const n=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(n))}sendRealtimeInput(e){let n={};this.apiClient.isVertexAI()?n={realtimeInput:tN(e)}:n={realtimeInput:eN(e)},this.conn.send(JSON.stringify(n))}sendToolResponse(e){if(e.functionResponses==null)throw new Error("Tool response parameters are required.");const n=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(n))}close(){this.conn.close()}}function qD(t){const e={};return t.forEach((n,r)=>{e[r]=n}),e}function jD(t){const e=new Headers;for(const[n,r]of Object.entries(t))e.append(n,r);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const ky=10;function Ny(t){var e,n,r;if(!((e=t==null?void 0:t.automaticFunctionCalling)===null||e===void 0)&&e.disable)return!0;let a=!1;for(const l of(n=t==null?void 0:t.tools)!==null&&n!==void 0?n:[])if(wf(l)){a=!0;break}if(!a)return!0;const s=(r=t==null?void 0:t.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls;return s&&(s<0||!Number.isInteger(s))||s==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",s),!0):!1}function wf(t){return"callTool"in t&&typeof t.callTool=="function"}function My(t){var e;return!(!((e=t==null?void 0:t.automaticFunctionCalling)===null||e===void 0)&&e.ignoreCallHistory)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class $D extends Es{constructor(e){super(),this.apiClient=e,this.generateContent=async n=>{var r,a,s,l,c;const f=await this.processParamsForMcpUsage(n);if(this.maybeMoveToResponseJsonSchem(n),!DD(n)||Ny(n.config))return await this.generateContentInternal(f);if(RD(n))throw new Error("Automatic function calling with CallableTools and Tools is not yet supported.");let d,g;const x=Jr(f.contents),_=(s=(a=(r=f.config)===null||r===void 0?void 0:r.automaticFunctionCalling)===null||a===void 0?void 0:a.maximumRemoteCalls)!==null&&s!==void 0?s:ky;let T=0;for(;T<_&&(d=await this.generateContentInternal(f),!(!d.functionCalls||d.functionCalls.length===0));){const E=d.candidates[0].content,S=[];for(const C of(c=(l=n.config)===null||l===void 0?void 0:l.tools)!==null&&c!==void 0?c:[])if(wf(C)){const N=await C.callTool(d.functionCalls);S.push(...N)}T++,g={role:"user",parts:S},f.contents=Jr(f.contents),f.contents.push(E),f.contents.push(g),My(f.config)&&(x.push(E),x.push(g))}return My(f.config)&&(d.automaticFunctionCallingHistory=x),d},this.generateContentStream=async n=>{if(this.maybeMoveToResponseJsonSchem(n),Ny(n.config)){const r=await this.processParamsForMcpUsage(n);return await this.generateContentStreamInternal(r)}else return await this.processAfcStream(n)},this.generateImages=async n=>await this.generateImagesInternal(n).then(r=>{var a;let s;const l=[];if(r!=null&&r.generatedImages)for(const f of r.generatedImages)f&&(f!=null&&f.safetyAttributes)&&((a=f==null?void 0:f.safetyAttributes)===null||a===void 0?void 0:a.contentType)==="Positive Prompt"?s=f==null?void 0:f.safetyAttributes:l.push(f);let c;return s?c={generatedImages:l,positivePromptSafetyAttributes:s}:c={generatedImages:l},c}),this.list=async n=>{var r;const l={config:Object.assign(Object.assign({},{queryBase:!0}),n==null?void 0:n.config)};if(this.apiClient.isVertexAI()&&!l.config.queryBase){if(!((r=l.config)===null||r===void 0)&&r.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");l.config.filter="labels.tune-type:*"}return new Fc(gs.PAGED_ITEM_MODELS,c=>this.listInternal(c),await this.listInternal(l),l)},this.editImage=async n=>{const r={model:n.model,prompt:n.prompt,referenceImages:[],config:n.config};return n.referenceImages&&n.referenceImages&&(r.referenceImages=n.referenceImages.map(a=>a.toReferenceImageAPI())),await this.editImageInternal(r)},this.upscaleImage=async n=>{let r={numberOfImages:1,mode:"upscale"};n.config&&(r=Object.assign(Object.assign({},r),n.config));const a={model:n.model,image:n.image,upscaleFactor:n.upscaleFactor,config:r};return await this.upscaleImageInternal(a)}}maybeMoveToResponseJsonSchem(e){e.config&&e.config.responseSchema&&(e.config.responseJsonSchema||Object.keys(e.config.responseSchema).includes("$schema")&&(e.config.responseJsonSchema=e.config.responseSchema,delete e.config.responseSchema))}async processParamsForMcpUsage(e){var n,r,a;const s=(n=e.config)===null||n===void 0?void 0:n.tools;if(!s)return e;const l=await Promise.all(s.map(async f=>wf(f)?await f.tool():f)),c={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:l})};if(c.config.tools=l,e.config&&e.config.tools&&Y2(e.config.tools)){const f=(a=(r=e.config.httpOptions)===null||r===void 0?void 0:r.headers)!==null&&a!==void 0?a:{};let d=Object.assign({},f);Object.keys(d).length===0&&(d=this.apiClient.getDefaultHeaders()),J2(d),c.config.httpOptions=Object.assign(Object.assign({},e.config.httpOptions),{headers:d})}return c}async initAfcToolsMap(e){var n,r,a;const s=new Map;for(const l of(r=(n=e.config)===null||n===void 0?void 0:n.tools)!==null&&r!==void 0?r:[])if(wf(l)){const c=l,f=await c.tool();for(const d of(a=f.functionDeclarations)!==null&&a!==void 0?a:[]){if(!d.name)throw new Error("Function declaration name is required.");if(s.has(d.name))throw new Error(`Duplicate tool declaration name: ${d.name}`);s.set(d.name,c)}}return s}async processAfcStream(e){var n,r,a;const s=(a=(r=(n=e.config)===null||n===void 0?void 0:n.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls)!==null&&a!==void 0?a:ky;let l=!1,c=0;const f=await this.initAfcToolsMap(e);return function(d,g,x){var _,T;return Fo(this,arguments,function*(){for(var E,S,C,k;c<s;){l&&(c++,l=!1);const F=yield Yt(d.processParamsForMcpUsage(x)),P=yield Yt(d.generateContentStreamInternal(F)),D=[],j=[];try{for(var N=!0,b=(S=void 0,ic(P)),I;I=yield Yt(b.next()),E=I.done,!E;N=!0){k=I.value,N=!1;const B=k;if(yield yield Yt(B),B.candidates&&(!((_=B.candidates[0])===null||_===void 0)&&_.content)){j.push(B.candidates[0].content);for(const te of(T=B.candidates[0].content.parts)!==null&&T!==void 0?T:[])if(c<s&&te.functionCall){if(!te.functionCall.name)throw new Error("Function call name was not returned by the model.");if(g.has(te.functionCall.name)){const X=yield Yt(g.get(te.functionCall.name).callTool([te.functionCall]));D.push(...X)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${g.keys()}, mising tool: ${te.functionCall.name}`)}}}}catch(B){S={error:B}}finally{try{!N&&!E&&(C=b.return)&&(yield Yt(C.call(b)))}finally{if(S)throw S.error}}if(D.length>0){l=!0;const B=new Jl;B.candidates=[{content:{role:"user",parts:D}}],yield yield Yt(B);const te=[];te.push(...j),te.push({role:"user",parts:D});const X=Jr(x.contents).concat(te);x.contents=X}else break}})}(this,f,e)}async generateContentInternal(e){var n,r,a,s;let l,c="",f={};if(this.apiClient.isVertexAI()){const d=Sy(this.apiClient,e);return c=Ge("{model}:generateContent",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>{const x=Cy(g),_=new Jl;return Object.assign(_,x),_})}else{const d=wy(this.apiClient,e);return c=Ge("{model}:generateContent",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(g=>g.json()),l.then(g=>{const x=Ey(g),_=new Jl;return Object.assign(_,x),_})}}async generateContentStreamInternal(e){var n,r,a,s;let l,c="",f={};if(this.apiClient.isVertexAI()){const d=Sy(this.apiClient,e);return c=Ge("{model}:streamGenerateContent?alt=sse",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.requestStream({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}),l.then(function(x){return Fo(this,arguments,function*(){var _,T,E,S;try{for(var C=!0,k=ic(x),N;N=yield Yt(k.next()),_=N.done,!_;C=!0){S=N.value,C=!1;const I=Cy(yield Yt(S.json())),F=new Jl;Object.assign(F,I),yield yield Yt(F)}}catch(b){T={error:b}}finally{try{!C&&!_&&(E=k.return)&&(yield Yt(E.call(k)))}finally{if(T)throw T.error}}})})}else{const d=wy(this.apiClient,e);return c=Ge("{model}:streamGenerateContent?alt=sse",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.requestStream({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}),l.then(function(x){return Fo(this,arguments,function*(){var _,T,E,S;try{for(var C=!0,k=ic(x),N;N=yield Yt(k.next()),_=N.done,!_;C=!0){S=N.value,C=!1;const I=Ey(yield Yt(S.json())),F=new Jl;Object.assign(F,I),yield yield Yt(F)}}catch(b){T={error:b}}finally{try{!C&&!_&&(E=k.return)&&(yield Yt(E.call(k)))}finally{if(T)throw T.error}}})})}}async embedContent(e){var n,r,a,s;let l,c="",f={};if(this.apiClient.isVertexAI()){const d=eM(this.apiClient,e);return c=Ge("{model}:predict",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>{const x=iD(g),_=new ny;return Object.assign(_,x),_})}else{const d=h3(this.apiClient,e);return c=Ge("{model}:batchEmbedContents",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(g=>g.json()),l.then(g=>{const x=PM(g),_=new ny;return Object.assign(_,x),_})}}async generateImagesInternal(e){var n,r,a,s;let l,c="",f={};if(this.apiClient.isVertexAI()){const d=nM(this.apiClient,e);return c=Ge("{model}:predict",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>{const x=oD(g),_=new ry;return Object.assign(_,x),_})}else{const d=p3(this.apiClient,e);return c=Ge("{model}:predict",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(g=>g.json()),l.then(g=>{const x=UM(g),_=new ry;return Object.assign(_,x),_})}}async editImageInternal(e){var n,r;let a,s="",l={};if(this.apiClient.isVertexAI()){const c=cM(this.apiClient,e);return s=Ge("{model}:predict",c._url),l=c._query,delete c.config,delete c._url,delete c._query,a=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),a.then(f=>{const d=lD(f),g=new hb;return Object.assign(g,d),g})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var n,r;let a,s="",l={};if(this.apiClient.isVertexAI()){const c=fM(this.apiClient,e);return s=Ge("{model}:predict",c._url),l=c._query,delete c.config,delete c._url,delete c._query,a=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),a.then(f=>{const d=cD(f),g=new mb;return Object.assign(g,d),g})}else throw new Error("This method is only supported by the Vertex AI.")}async get(e){var n,r,a,s;let l,c="",f={};if(this.apiClient.isVertexAI()){const d=dM(this.apiClient,e);return c=Ge("{name}",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>zh(g))}else{const d=g3(this.apiClient,e);return c=Ge("{name}",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(g=>g.json()),l.then(g=>Hh(g))}}async listInternal(e){var n,r,a,s;let l,c="",f={};if(this.apiClient.isVertexAI()){const d=mM(this.apiClient,e);return c=Ge("{models_url}",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>{const x=hD(g),_=new ay;return Object.assign(_,x),_})}else{const d=v3(this.apiClient,e);return c=Ge("{models_url}",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(g=>g.json()),l.then(g=>{const x=VM(g),_=new ay;return Object.assign(_,x),_})}}async update(e){var n,r,a,s;let l,c="",f={};if(this.apiClient.isVertexAI()){const d=gM(this.apiClient,e);return c=Ge("{model}",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>zh(g))}else{const d=_3(this.apiClient,e);return c=Ge("{name}",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(g=>g.json()),l.then(g=>Hh(g))}}async delete(e){var n,r,a,s;let l,c="",f={};if(this.apiClient.isVertexAI()){const d=xM(this.apiClient,e);return c=Ge("{name}",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(()=>{const g=mD(),x=new iy;return Object.assign(x,g),x})}else{const d=T3(this.apiClient,e);return c=Ge("{name}",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(g=>g.json()),l.then(()=>{const g=GM(),x=new iy;return Object.assign(x,g),x})}}async countTokens(e){var n,r,a,s;let l,c="",f={};if(this.apiClient.isVertexAI()){const d=yM(this.apiClient,e);return c=Ge("{model}:countTokens",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>{const x=pD(g),_=new sy;return Object.assign(_,x),_})}else{const d=S3(this.apiClient,e);return c=Ge("{model}:countTokens",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(g=>g.json()),l.then(g=>{const x=HM(g),_=new sy;return Object.assign(_,x),_})}}async computeTokens(e){var n,r;let a,s="",l={};if(this.apiClient.isVertexAI()){const c=_M(this.apiClient,e);return s=Ge("{model}:computeTokens",c._url),l=c._query,delete c.config,delete c._url,delete c._query,a=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),a.then(f=>{const d=gD(f),g=new pb;return Object.assign(g,d),g})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideos(e){var n,r,a,s;let l,c="",f={};if(this.apiClient.isVertexAI()){const d=SM(this.apiClient,e);return c=Ge("{model}:predictLongRunning",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>_D(g))}else{const d=b3(this.apiClient,e);return c=Ge("{model}:predictLongRunning",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(g=>g.json()),l.then(g=>$M(g))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function WD(t){const e={},n=h(t,["operationName"]);n!=null&&m(e,["_url","operationName"],n);const r=h(t,["config"]);return r!=null&&m(e,["config"],r),e}function YD(t){const e={},n=h(t,["operationName"]);n!=null&&m(e,["_url","operationName"],n);const r=h(t,["config"]);return r!=null&&m(e,["config"],r),e}function JD(t){const e={},n=h(t,["operationName"]);n!=null&&m(e,["operationName"],n);const r=h(t,["resourceName"]);r!=null&&m(e,["_url","resourceName"],r);const a=h(t,["config"]);return a!=null&&m(e,["config"],a),e}function XD(t){const e={},n=h(t,["video","uri"]);n!=null&&m(e,["uri"],n);const r=h(t,["video","encodedVideo"]);r!=null&&m(e,["videoBytes"],Za(r));const a=h(t,["encoding"]);return a!=null&&m(e,["mimeType"],a),e}function KD(t){const e={},n=h(t,["_self"]);return n!=null&&m(e,["video"],XD(n)),e}function ZD(t){const e={},n=h(t,["generatedSamples"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(l=>KD(l))),m(e,["generatedVideos"],s)}const r=h(t,["raiMediaFilteredCount"]);r!=null&&m(e,["raiMediaFilteredCount"],r);const a=h(t,["raiMediaFilteredReasons"]);return a!=null&&m(e,["raiMediaFilteredReasons"],a),e}function QD(t){const e={},n=h(t,["name"]);n!=null&&m(e,["name"],n);const r=h(t,["metadata"]);r!=null&&m(e,["metadata"],r);const a=h(t,["done"]);a!=null&&m(e,["done"],a);const s=h(t,["error"]);s!=null&&m(e,["error"],s);const l=h(t,["response","generateVideoResponse"]);return l!=null&&m(e,["response"],ZD(l)),e}function eR(t){const e={},n=h(t,["gcsUri"]);n!=null&&m(e,["uri"],n);const r=h(t,["bytesBase64Encoded"]);r!=null&&m(e,["videoBytes"],Za(r));const a=h(t,["mimeType"]);return a!=null&&m(e,["mimeType"],a),e}function tR(t){const e={},n=h(t,["_self"]);return n!=null&&m(e,["video"],eR(n)),e}function nR(t){const e={},n=h(t,["videos"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(l=>tR(l))),m(e,["generatedVideos"],s)}const r=h(t,["raiMediaFilteredCount"]);r!=null&&m(e,["raiMediaFilteredCount"],r);const a=h(t,["raiMediaFilteredReasons"]);return a!=null&&m(e,["raiMediaFilteredReasons"],a),e}function Dy(t){const e={},n=h(t,["name"]);n!=null&&m(e,["name"],n);const r=h(t,["metadata"]);r!=null&&m(e,["metadata"],r);const a=h(t,["done"]);a!=null&&m(e,["done"],a);const s=h(t,["error"]);s!=null&&m(e,["error"],s);const l=h(t,["response"]);return l!=null&&m(e,["response"],nR(l)),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class rR extends Es{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){const n=e.operation,r=e.config;if(n.name===void 0||n.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const a=n.name.split("/operations/")[0];let s;return r&&"httpOptions"in r&&(s=r.httpOptions),this.fetchPredictVideosOperationInternal({operationName:n.name,resourceName:a,config:{httpOptions:s}})}else return this.getVideosOperationInternal({operationName:n.name,config:r})}async getVideosOperationInternal(e){var n,r,a,s;let l,c="",f={};if(this.apiClient.isVertexAI()){const d=YD(e);return c=Ge("{operationName}",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>Dy(g))}else{const d=WD(e);return c=Ge("{operationName}",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(g=>g.json()),l.then(g=>QD(g))}}async fetchPredictVideosOperationInternal(e){var n,r;let a,s="",l={};if(this.apiClient.isVertexAI()){const c=JD(e);return s=Ge("{resourceName}:fetchPredictOperation",c._url),l=c._query,delete c.config,delete c._url,delete c._query,a=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),a.then(f=>Dy(f))}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function aR(t){const e={},n=h(t,["voiceName"]);return n!=null&&m(e,["voiceName"],n),e}function X2(t){const e={},n=h(t,["prebuiltVoiceConfig"]);return n!=null&&m(e,["prebuiltVoiceConfig"],aR(n)),e}function iR(t){const e={},n=h(t,["speaker"]);n!=null&&m(e,["speaker"],n);const r=h(t,["voiceConfig"]);return r!=null&&m(e,["voiceConfig"],X2(r)),e}function sR(t){const e={},n=h(t,["speakerVoiceConfigs"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>iR(a))),m(e,["speakerVoiceConfigs"],r)}return e}function oR(t){const e={},n=h(t,["voiceConfig"]);n!=null&&m(e,["voiceConfig"],X2(n));const r=h(t,["multiSpeakerVoiceConfig"]);r!=null&&m(e,["multiSpeakerVoiceConfig"],sR(r));const a=h(t,["languageCode"]);return a!=null&&m(e,["languageCode"],a),e}function lR(t){const e={},n=h(t,["fps"]);n!=null&&m(e,["fps"],n);const r=h(t,["endOffset"]);r!=null&&m(e,["endOffset"],r);const a=h(t,["startOffset"]);return a!=null&&m(e,["startOffset"],a),e}function cR(t){const e={};if(h(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=h(t,["data"]);n!=null&&m(e,["data"],n);const r=h(t,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function uR(t){const e={};if(h(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=h(t,["fileUri"]);n!=null&&m(e,["fileUri"],n);const r=h(t,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function fR(t){const e={},n=h(t,["videoMetadata"]);n!=null&&m(e,["videoMetadata"],lR(n));const r=h(t,["thought"]);r!=null&&m(e,["thought"],r);const a=h(t,["inlineData"]);a!=null&&m(e,["inlineData"],cR(a));const s=h(t,["fileData"]);s!=null&&m(e,["fileData"],uR(s));const l=h(t,["thoughtSignature"]);l!=null&&m(e,["thoughtSignature"],l);const c=h(t,["codeExecutionResult"]);c!=null&&m(e,["codeExecutionResult"],c);const f=h(t,["executableCode"]);f!=null&&m(e,["executableCode"],f);const d=h(t,["functionCall"]);d!=null&&m(e,["functionCall"],d);const g=h(t,["functionResponse"]);g!=null&&m(e,["functionResponse"],g);const x=h(t,["text"]);return x!=null&&m(e,["text"],x),e}function dR(t){const e={},n=h(t,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(s=>fR(s))),m(e,["parts"],a)}const r=h(t,["role"]);return r!=null&&m(e,["role"],r),e}function hR(t){const e={},n=h(t,["behavior"]);n!=null&&m(e,["behavior"],n);const r=h(t,["description"]);r!=null&&m(e,["description"],r);const a=h(t,["name"]);a!=null&&m(e,["name"],a);const s=h(t,["parameters"]);s!=null&&m(e,["parameters"],s);const l=h(t,["parametersJsonSchema"]);l!=null&&m(e,["parametersJsonSchema"],l);const c=h(t,["response"]);c!=null&&m(e,["response"],c);const f=h(t,["responseJsonSchema"]);return f!=null&&m(e,["responseJsonSchema"],f),e}function mR(t){const e={},n=h(t,["startTime"]);n!=null&&m(e,["startTime"],n);const r=h(t,["endTime"]);return r!=null&&m(e,["endTime"],r),e}function pR(t){const e={},n=h(t,["timeRangeFilter"]);return n!=null&&m(e,["timeRangeFilter"],mR(n)),e}function gR(t){const e={},n=h(t,["mode"]);n!=null&&m(e,["mode"],n);const r=h(t,["dynamicThreshold"]);return r!=null&&m(e,["dynamicThreshold"],r),e}function xR(t){const e={},n=h(t,["dynamicRetrievalConfig"]);return n!=null&&m(e,["dynamicRetrievalConfig"],gR(n)),e}function vR(){return{}}function yR(t){const e={},n=h(t,["functionDeclarations"]);if(n!=null){let f=n;Array.isArray(f)&&(f=f.map(d=>hR(d))),m(e,["functionDeclarations"],f)}if(h(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=h(t,["googleSearch"]);r!=null&&m(e,["googleSearch"],pR(r));const a=h(t,["googleSearchRetrieval"]);if(a!=null&&m(e,["googleSearchRetrieval"],xR(a)),h(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(h(t,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");h(t,["urlContext"])!=null&&m(e,["urlContext"],vR());const l=h(t,["codeExecution"]);l!=null&&m(e,["codeExecution"],l);const c=h(t,["computerUse"]);return c!=null&&m(e,["computerUse"],c),e}function _R(t){const e={},n=h(t,["handle"]);if(n!=null&&m(e,["handle"],n),h(t,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function Ry(){return{}}function TR(t){const e={},n=h(t,["disabled"]);n!=null&&m(e,["disabled"],n);const r=h(t,["startOfSpeechSensitivity"]);r!=null&&m(e,["startOfSpeechSensitivity"],r);const a=h(t,["endOfSpeechSensitivity"]);a!=null&&m(e,["endOfSpeechSensitivity"],a);const s=h(t,["prefixPaddingMs"]);s!=null&&m(e,["prefixPaddingMs"],s);const l=h(t,["silenceDurationMs"]);return l!=null&&m(e,["silenceDurationMs"],l),e}function wR(t){const e={},n=h(t,["automaticActivityDetection"]);n!=null&&m(e,["automaticActivityDetection"],TR(n));const r=h(t,["activityHandling"]);r!=null&&m(e,["activityHandling"],r);const a=h(t,["turnCoverage"]);return a!=null&&m(e,["turnCoverage"],a),e}function SR(t){const e={},n=h(t,["targetTokens"]);return n!=null&&m(e,["targetTokens"],n),e}function ER(t){const e={},n=h(t,["triggerTokens"]);n!=null&&m(e,["triggerTokens"],n);const r=h(t,["slidingWindow"]);return r!=null&&m(e,["slidingWindow"],SR(r)),e}function CR(t){const e={},n=h(t,["proactiveAudio"]);return n!=null&&m(e,["proactiveAudio"],n),e}function bR(t,e){const n={},r=h(t,["generationConfig"]);e!==void 0&&r!=null&&m(e,["setup","generationConfig"],r);const a=h(t,["responseModalities"]);e!==void 0&&a!=null&&m(e,["setup","generationConfig","responseModalities"],a);const s=h(t,["temperature"]);e!==void 0&&s!=null&&m(e,["setup","generationConfig","temperature"],s);const l=h(t,["topP"]);e!==void 0&&l!=null&&m(e,["setup","generationConfig","topP"],l);const c=h(t,["topK"]);e!==void 0&&c!=null&&m(e,["setup","generationConfig","topK"],c);const f=h(t,["maxOutputTokens"]);e!==void 0&&f!=null&&m(e,["setup","generationConfig","maxOutputTokens"],f);const d=h(t,["mediaResolution"]);e!==void 0&&d!=null&&m(e,["setup","generationConfig","mediaResolution"],d);const g=h(t,["seed"]);e!==void 0&&g!=null&&m(e,["setup","generationConfig","seed"],g);const x=h(t,["speechConfig"]);e!==void 0&&x!=null&&m(e,["setup","generationConfig","speechConfig"],oR(vm(x)));const _=h(t,["enableAffectiveDialog"]);e!==void 0&&_!=null&&m(e,["setup","generationConfig","enableAffectiveDialog"],_);const T=h(t,["systemInstruction"]);e!==void 0&&T!=null&&m(e,["setup","systemInstruction"],dR(tr(T)));const E=h(t,["tools"]);if(e!==void 0&&E!=null){let F=zo(E);Array.isArray(F)&&(F=F.map(P=>yR(Ho(P)))),m(e,["setup","tools"],F)}const S=h(t,["sessionResumption"]);e!==void 0&&S!=null&&m(e,["setup","sessionResumption"],_R(S));const C=h(t,["inputAudioTranscription"]);e!==void 0&&C!=null&&m(e,["setup","inputAudioTranscription"],Ry());const k=h(t,["outputAudioTranscription"]);e!==void 0&&k!=null&&m(e,["setup","outputAudioTranscription"],Ry());const N=h(t,["realtimeInputConfig"]);e!==void 0&&N!=null&&m(e,["setup","realtimeInputConfig"],wR(N));const b=h(t,["contextWindowCompression"]);e!==void 0&&b!=null&&m(e,["setup","contextWindowCompression"],ER(b));const I=h(t,["proactivity"]);return e!==void 0&&I!=null&&m(e,["setup","proactivity"],CR(I)),n}function AR(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["setup","model"],Rt(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],bR(a,n)),n}function kR(t,e,n){const r={},a=h(e,["expireTime"]);n!==void 0&&a!=null&&m(n,["expireTime"],a);const s=h(e,["newSessionExpireTime"]);n!==void 0&&s!=null&&m(n,["newSessionExpireTime"],s);const l=h(e,["uses"]);n!==void 0&&l!=null&&m(n,["uses"],l);const c=h(e,["liveConnectConstraints"]);n!==void 0&&c!=null&&m(n,["bidiGenerateContentSetup"],AR(t,c));const f=h(e,["lockAdditionalFields"]);return n!==void 0&&f!=null&&m(n,["fieldMask"],f),r}function NR(t,e){const n={},r=h(e,["config"]);return r!=null&&m(n,["config"],kR(t,r,n)),n}function MR(t){const e={},n=h(t,["name"]);return n!=null&&m(e,["name"],n),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function DR(t){const e=[];for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)){const r=t[n];if(typeof r=="object"&&r!=null&&Object.keys(r).length>0){const a=Object.keys(r).map(s=>`${n}.${s}`);e.push(...a)}else e.push(n)}return e.join(",")}function RR(t,e){let n=null;const r=t.bidiGenerateContentSetup;if(typeof r=="object"&&r!==null&&"setup"in r){const s=r.setup;typeof s=="object"&&s!==null?(t.bidiGenerateContentSetup=s,n=s):delete t.bidiGenerateContentSetup}else r!==void 0&&delete t.bidiGenerateContentSetup;const a=t.fieldMask;if(n){const s=DR(n);if(Array.isArray(e==null?void 0:e.lockAdditionalFields)&&(e==null?void 0:e.lockAdditionalFields.length)===0)s?t.fieldMask=s:delete t.fieldMask;else if(e!=null&&e.lockAdditionalFields&&e.lockAdditionalFields.length>0&&a!==null&&Array.isArray(a)&&a.length>0){const l=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let c=[];a.length>0&&(c=a.map(d=>l.includes(d)?`generationConfig.${d}`:d));const f=[];s&&f.push(s),c.length>0&&f.push(...c),f.length>0?t.fieldMask=f.join(","):delete t.fieldMask}else delete t.fieldMask}else a!==null&&Array.isArray(a)&&a.length>0?t.fieldMask=a.join(","):delete t.fieldMask;return t}class FR extends Es{constructor(e){super(),this.apiClient=e}async create(e){var n,r;let a,s="",l={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const c=NR(this.apiClient,e);s=Ge("auth_tokens",c._url),l=c._query,delete c.config,delete c._url,delete c._query;const f=RR(c,e.config);return a=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),a.then(d=>MR(d))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function IR(t){const e={},n=h(t,["name"]);n!=null&&m(e,["_url","name"],n);const r=h(t,["config"]);return r!=null&&m(e,["config"],r),e}function PR(t,e){const n={},r=h(t,["pageSize"]);e!==void 0&&r!=null&&m(e,["_query","pageSize"],r);const a=h(t,["pageToken"]);e!==void 0&&a!=null&&m(e,["_query","pageToken"],a);const s=h(t,["filter"]);return e!==void 0&&s!=null&&m(e,["_query","filter"],s),n}function LR(t){const e={},n=h(t,["config"]);return n!=null&&m(e,["config"],PR(n,e)),e}function OR(t){const e={},n=h(t,["textInput"]);n!=null&&m(e,["textInput"],n);const r=h(t,["output"]);return r!=null&&m(e,["output"],r),e}function UR(t){const e={};if(h(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(h(t,["vertexDatasetResource"])!==void 0)throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const n=h(t,["examples"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>OR(a))),m(e,["examples","examples"],r)}return e}function BR(t,e){const n={};if(h(t,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const r=h(t,["tunedModelDisplayName"]);if(e!==void 0&&r!=null&&m(e,["displayName"],r),h(t,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const a=h(t,["epochCount"]);e!==void 0&&a!=null&&m(e,["tuningTask","hyperparameters","epochCount"],a);const s=h(t,["learningRateMultiplier"]);if(s!=null&&m(n,["tuningTask","hyperparameters","learningRateMultiplier"],s),h(t,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(h(t,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const l=h(t,["batchSize"]);e!==void 0&&l!=null&&m(e,["tuningTask","hyperparameters","batchSize"],l);const c=h(t,["learningRate"]);return e!==void 0&&c!=null&&m(e,["tuningTask","hyperparameters","learningRate"],c),n}function VR(t){const e={},n=h(t,["baseModel"]);n!=null&&m(e,["baseModel"],n);const r=h(t,["trainingDataset"]);r!=null&&m(e,["tuningTask","trainingData"],UR(r));const a=h(t,["config"]);return a!=null&&m(e,["config"],BR(a,e)),e}function GR(t){const e={},n=h(t,["name"]);n!=null&&m(e,["_url","name"],n);const r=h(t,["config"]);return r!=null&&m(e,["config"],r),e}function HR(t,e){const n={},r=h(t,["pageSize"]);e!==void 0&&r!=null&&m(e,["_query","pageSize"],r);const a=h(t,["pageToken"]);e!==void 0&&a!=null&&m(e,["_query","pageToken"],a);const s=h(t,["filter"]);return e!==void 0&&s!=null&&m(e,["_query","filter"],s),n}function zR(t){const e={},n=h(t,["config"]);return n!=null&&m(e,["config"],HR(n,e)),e}function qR(t,e){const n={},r=h(t,["gcsUri"]);e!==void 0&&r!=null&&m(e,["supervisedTuningSpec","trainingDatasetUri"],r);const a=h(t,["vertexDatasetResource"]);if(e!==void 0&&a!=null&&m(e,["supervisedTuningSpec","trainingDatasetUri"],a),h(t,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return n}function jR(t,e){const n={},r=h(t,["gcsUri"]);r!=null&&m(n,["validationDatasetUri"],r);const a=h(t,["vertexDatasetResource"]);return e!==void 0&&a!=null&&m(e,["supervisedTuningSpec","trainingDatasetUri"],a),n}function $R(t,e){const n={},r=h(t,["validationDataset"]);e!==void 0&&r!=null&&m(e,["supervisedTuningSpec"],jR(r,n));const a=h(t,["tunedModelDisplayName"]);e!==void 0&&a!=null&&m(e,["tunedModelDisplayName"],a);const s=h(t,["description"]);e!==void 0&&s!=null&&m(e,["description"],s);const l=h(t,["epochCount"]);e!==void 0&&l!=null&&m(e,["supervisedTuningSpec","hyperParameters","epochCount"],l);const c=h(t,["learningRateMultiplier"]);e!==void 0&&c!=null&&m(e,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],c);const f=h(t,["exportLastCheckpointOnly"]);e!==void 0&&f!=null&&m(e,["supervisedTuningSpec","exportLastCheckpointOnly"],f);const d=h(t,["adapterSize"]);if(e!==void 0&&d!=null&&m(e,["supervisedTuningSpec","hyperParameters","adapterSize"],d),h(t,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(h(t,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");return n}function WR(t){const e={},n=h(t,["baseModel"]);n!=null&&m(e,["baseModel"],n);const r=h(t,["trainingDataset"]);r!=null&&m(e,["supervisedTuningSpec","trainingDatasetUri"],qR(r,e));const a=h(t,["config"]);return a!=null&&m(e,["config"],$R(a,e)),e}function YR(t){const e={},n=h(t,["name"]);n!=null&&m(e,["model"],n);const r=h(t,["name"]);return r!=null&&m(e,["endpoint"],r),e}function K2(t){const e={},n=h(t,["name"]);n!=null&&m(e,["name"],n);const r=h(t,["state"]);r!=null&&m(e,["state"],k2(r));const a=h(t,["createTime"]);a!=null&&m(e,["createTime"],a);const s=h(t,["tuningTask","startTime"]);s!=null&&m(e,["startTime"],s);const l=h(t,["tuningTask","completeTime"]);l!=null&&m(e,["endTime"],l);const c=h(t,["updateTime"]);c!=null&&m(e,["updateTime"],c);const f=h(t,["description"]);f!=null&&m(e,["description"],f);const d=h(t,["baseModel"]);d!=null&&m(e,["baseModel"],d);const g=h(t,["_self"]);g!=null&&m(e,["tunedModel"],YR(g));const x=h(t,["distillationSpec"]);x!=null&&m(e,["distillationSpec"],x);const _=h(t,["experiment"]);_!=null&&m(e,["experiment"],_);const T=h(t,["labels"]);T!=null&&m(e,["labels"],T);const E=h(t,["pipelineJob"]);E!=null&&m(e,["pipelineJob"],E);const S=h(t,["satisfiesPzi"]);S!=null&&m(e,["satisfiesPzi"],S);const C=h(t,["satisfiesPzs"]);C!=null&&m(e,["satisfiesPzs"],C);const k=h(t,["serviceAccount"]);k!=null&&m(e,["serviceAccount"],k);const N=h(t,["tunedModelDisplayName"]);return N!=null&&m(e,["tunedModelDisplayName"],N),e}function JR(t){const e={},n=h(t,["nextPageToken"]);n!=null&&m(e,["nextPageToken"],n);const r=h(t,["tunedModels"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(s=>K2(s))),m(e,["tuningJobs"],a)}return e}function XR(t){const e={},n=h(t,["name"]);n!=null&&m(e,["name"],n);const r=h(t,["metadata"]);r!=null&&m(e,["metadata"],r);const a=h(t,["done"]);a!=null&&m(e,["done"],a);const s=h(t,["error"]);return s!=null&&m(e,["error"],s),e}function KR(t){const e={},n=h(t,["checkpointId"]);n!=null&&m(e,["checkpointId"],n);const r=h(t,["epoch"]);r!=null&&m(e,["epoch"],r);const a=h(t,["step"]);a!=null&&m(e,["step"],a);const s=h(t,["endpoint"]);return s!=null&&m(e,["endpoint"],s),e}function ZR(t){const e={},n=h(t,["model"]);n!=null&&m(e,["model"],n);const r=h(t,["endpoint"]);r!=null&&m(e,["endpoint"],r);const a=h(t,["checkpoints"]);if(a!=null){let s=a;Array.isArray(s)&&(s=s.map(l=>KR(l))),m(e,["checkpoints"],s)}return e}function jh(t){const e={},n=h(t,["name"]);n!=null&&m(e,["name"],n);const r=h(t,["state"]);r!=null&&m(e,["state"],k2(r));const a=h(t,["createTime"]);a!=null&&m(e,["createTime"],a);const s=h(t,["startTime"]);s!=null&&m(e,["startTime"],s);const l=h(t,["endTime"]);l!=null&&m(e,["endTime"],l);const c=h(t,["updateTime"]);c!=null&&m(e,["updateTime"],c);const f=h(t,["error"]);f!=null&&m(e,["error"],f);const d=h(t,["description"]);d!=null&&m(e,["description"],d);const g=h(t,["baseModel"]);g!=null&&m(e,["baseModel"],g);const x=h(t,["tunedModel"]);x!=null&&m(e,["tunedModel"],ZR(x));const _=h(t,["supervisedTuningSpec"]);_!=null&&m(e,["supervisedTuningSpec"],_);const T=h(t,["tuningDataStats"]);T!=null&&m(e,["tuningDataStats"],T);const E=h(t,["encryptionSpec"]);E!=null&&m(e,["encryptionSpec"],E);const S=h(t,["partnerModelTuningSpec"]);S!=null&&m(e,["partnerModelTuningSpec"],S);const C=h(t,["distillationSpec"]);C!=null&&m(e,["distillationSpec"],C);const k=h(t,["experiment"]);k!=null&&m(e,["experiment"],k);const N=h(t,["labels"]);N!=null&&m(e,["labels"],N);const b=h(t,["pipelineJob"]);b!=null&&m(e,["pipelineJob"],b);const I=h(t,["satisfiesPzi"]);I!=null&&m(e,["satisfiesPzi"],I);const F=h(t,["satisfiesPzs"]);F!=null&&m(e,["satisfiesPzs"],F);const P=h(t,["serviceAccount"]);P!=null&&m(e,["serviceAccount"],P);const D=h(t,["tunedModelDisplayName"]);return D!=null&&m(e,["tunedModelDisplayName"],D),e}function QR(t){const e={},n=h(t,["nextPageToken"]);n!=null&&m(e,["nextPageToken"],n);const r=h(t,["tuningJobs"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(s=>jh(s))),m(e,["tuningJobs"],a)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class eF extends Es{constructor(e){super(),this.apiClient=e,this.get=async n=>await this.getInternal(n),this.list=async(n={})=>new Fc(gs.PAGED_ITEM_TUNING_JOBS,r=>this.listInternal(r),await this.listInternal(n),n),this.tune=async n=>{if(this.apiClient.isVertexAI())return await this.tuneInternal(n);{const r=await this.tuneMldevInternal(n);let a="";return r.metadata!==void 0&&r.metadata.tunedModel!==void 0?a=r.metadata.tunedModel:r.name!==void 0&&r.name.includes("/operations/")&&(a=r.name.split("/operations/")[0]),{name:a,state:Ph.JOB_STATE_QUEUED}}}}async getInternal(e){var n,r,a,s;let l,c="",f={};if(this.apiClient.isVertexAI()){const d=GR(e);return c=Ge("{name}",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>jh(g))}else{const d=IR(e);return c=Ge("{name}",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(g=>g.json()),l.then(g=>K2(g))}}async listInternal(e){var n,r,a,s;let l,c="",f={};if(this.apiClient.isVertexAI()){const d=zR(e);return c=Ge("tuningJobs",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>{const x=QR(g),_=new oy;return Object.assign(_,x),_})}else{const d=LR(e);return c=Ge("tunedModels",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(g=>g.json()),l.then(g=>{const x=JR(g),_=new oy;return Object.assign(_,x),_})}}async tuneInternal(e){var n,r;let a,s="",l={};if(this.apiClient.isVertexAI()){const c=WR(e);return s=Ge("tuningJobs",c._url),l=c._query,delete c.config,delete c._url,delete c._query,a=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),a.then(f=>jh(f))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var n,r;let a,s="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=VR(e);return s=Ge("tunedModels",c._url),l=c._query,delete c.config,delete c._url,delete c._query,a=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),a.then(f=>XR(f))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class tF{async download(e,n){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const nF=1024*1024*8,rF=3,aF=1e3,iF=2,hh="x-goog-upload-status";async function sF(t,e,n){var r,a,s;let l=0,c=0,f=new Lh(new Response),d="upload";for(l=t.size;c<l;){const x=Math.min(nF,l-c),_=t.slice(c,c+x);c+x>=l&&(d+=", finalize");let T=0,E=aF;for(;T<rF&&(f=await n.request({path:"",body:_,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:e,headers:{"X-Goog-Upload-Command":d,"X-Goog-Upload-Offset":String(c),"Content-Length":String(x)}}}),!(!((r=f==null?void 0:f.headers)===null||r===void 0)&&r[hh]));)T++,await lF(E),E=E*iF;if(c+=x,((a=f==null?void 0:f.headers)===null||a===void 0?void 0:a[hh])!=="active")break;if(l<=c)throw new Error("All content has been uploaded, but the upload status is not finalized.")}const g=await(f==null?void 0:f.json());if(((s=f==null?void 0:f.headers)===null||s===void 0?void 0:s[hh])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return g.file}async function oF(t){return{size:t.size,type:t.type}}function lF(t){return new Promise(e=>setTimeout(e,t))}class cF{async upload(e,n,r){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await sF(e,n,r)}async stat(e){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await oF(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class uF{create(e,n,r){return new fF(e,n,r)}}class fF{constructor(e,n,r){this.url=e,this.headers=n,this.callbacks=r}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Fy="x-goog-api-key";class dF{constructor(e){this.apiKey=e}async addAuthHeaders(e){if(e.get(Fy)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");e.append(Fy,this.apiKey)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const hF="gl-node/";class mF{constructor(e){var n;if(e.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(n=e.vertexai)!==null&&n!==void 0?n:!1,this.apiKey=e.apiKey;const r=db(e,void 0,void 0);r&&(e.httpOptions?e.httpOptions.baseUrl=r:e.httpOptions={baseUrl:r}),this.apiVersion=e.apiVersion;const a=new dF(this.apiKey);this.apiClient=new kD({auth:a,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:e.httpOptions,userAgentExtra:hF+"web",uploader:new cF,downloader:new tF}),this.models=new $D(this.apiClient),this.live=new GD(this.apiClient,a,new uF),this.batches=new PA(this.apiClient),this.chats=new Bk(this.models,this.apiClient),this.caches=new Lk(this.apiClient),this.files=new Zk(this.apiClient),this.operations=new rR(this.apiClient),this.authTokens=new FR(this.apiClient),this.tunings=new eF(this.apiClient)}}const $o=new mF({apiKey:"AIzaSyDJ_VnpI4FKrUd1DPanMEPkx-_8Z0qYgYY"}),pF={type:$e.OBJECT,nullable:!0,properties:{ironMg:{type:$e.NUMBER,nullable:!0},calciumMg:{type:$e.NUMBER,nullable:!0},potassiumMg:{type:$e.NUMBER,nullable:!0},vitaminAIU:{type:$e.NUMBER,nullable:!0},vitaminCMg:{type:$e.NUMBER,nullable:!0},vitaminDIU:{type:$e.NUMBER,nullable:!0}}},gF={type:$e.OBJECT,properties:{calories:{type:$e.NUMBER},proteinGrams:{type:$e.NUMBER},fatGrams:{type:$e.NUMBER},carbohydratesGrams:{type:$e.NUMBER},sugarGrams:{type:$e.NUMBER},sodiumMilligrams:{type:$e.NUMBER},micronutrients:pF},required:["calories","proteinGrams","fatGrams","carbohydratesGrams","sugarGrams","sodiumMilligrams"]},xF={type:$e.OBJECT,description:"A verdict on whether the food is safe for the user based on their profile.",properties:{isSafe:{type:$e.BOOLEAN,description:"True if the food is safe, false if it's risky."},reason:{type:$e.STRING,description:"A brief, one-sentence explanation for the verdict."}},required:["isSafe","reason"]},Z2={type:$e.OBJECT,properties:{type:{type:$e.STRING,enum:["food","label"]},foodName:{type:$e.STRING,nullable:!0},estimatedWeightGrams:{type:$e.NUMBER,nullable:!0},productName:{type:$e.STRING,nullable:!0},servingSizeGrams:{type:$e.NUMBER,nullable:!0},healthStars:{type:$e.NUMBER,nullable:!0},healthSummary:{type:$e.STRING,nullable:!0},expiryDate:{type:$e.STRING,nullable:!0,description:"Format YYYY-MM-DD"},dietaryWarnings:{type:$e.ARRAY,nullable:!0,items:{type:$e.STRING}},nutrition:gF,safetyVerdict:xF},required:["type","nutrition","safetyVerdict"]};async function vF(t,e,n,r,a){const s={inlineData:{mimeType:"image/jpeg",data:t}},l=n.map(_=>`${_.food_name} (${_.brand_name||"any brand"})`).join(", "),c=r.map(_=>`${_.food_name} (${_.brand_name||"any brand"}) - Reason: ${_.reason}`).join("; "),f=`The user is ${e.age??"N/A"} years old, with a '${e.activityLevel}' activity level. Their specified medical history: "${e.medicalHistory||"None"}".`,d=`
    - Doctor-Approved Safe Foods: [${l||"None"}].
    - Doctor-Restricted (MUST NOT EAT) Foods: [${c||"None"}].
  `,g=`
    ${f}
    ${d}
    Analyze the image which is either a prepared food meal or a nutrition label. Determine the 'type' first.

    1.  **SPOILED/EXPIRED FOOD:** If food looks spoiled, set nutritional values to 0 and add a 'spoiled' warning. If a label shows an expiry date in the past, extract data normally but provide the correct 'expiryDate'.

    2.  **TYPE-SPECIFIC ANALYSIS (CRITICAL):**
        - If the image is a **'food'** meal:
          - Provide 'foodName' and 'estimatedWeightGrams'.
          - Set 'productName', 'servingSizeGrams', 'healthStars', 'healthSummary', 'expiryDate' to null.
        - If the image is a **'label'**:
          - Provide 'productName', 'servingSizeGrams', and a brief 'healthSummary'.
          - **Calculate 'healthStars' (a number from 1.0 to 5.0).** Base this score on the nutritional data. High stars for low sugar/sodium and high protein/fiber. Low stars for high sugar/sodium. **You MUST provide a numerical value for healthStars.** Estimate if necessary, do not return null.
          - Set 'foodName' and 'estimatedWeightGrams' to null.

    3.  **NUTRITION:** For both types, provide a detailed nutritional breakdown for all fields in the nutrition schema. If a value is not present, estimate it or return 0. Do not return null for top-level nutrition fields.

    4.  **SAFETY VERDICT (CRITICAL):** Based on the user's profile and doctor's lists, provide a 'safetyVerdict'.
        - **MUST BE UNSAFE**: If the food is on the "Doctor-Restricted" list, 'isSafe' MUST be false. The 'reason' must state it's doctor-restricted and mention why (e.g., "Risky because it is on your doctor's restricted list due to high sodium.").
        - Otherwise, 'isSafe' is true ONLY if the item does NOT conflict with their medical history and is generally healthy.
        - 'reason' must clearly explain the verdict in one sentence.
    
    5.  **DIETARY WARNINGS:** Separately, list allergens like "Contains meat", "Contains dairy", "Contains egg". Null if none.
    
    Respond ONLY with a valid JSON object in ${a}.`,x=await $o.models.generateContent({model:"gemini-2.5-flash",contents:{parts:[s,{text:g}]},config:{responseMimeType:"application/json",responseSchema:Z2,systemInstruction:`You are a world-class nutritionist. Adhere strictly to the JSON schema. All text must be in ${a}.`}});try{return JSON.parse(x.text.trim())}catch(_){throw console.error("Failed to parse AI response:",x.text,_),new Error("The AI returned an invalid JSON response. Please try again.")}}async function yF(t,e,n,r,a,s,l){const c={inlineData:{mimeType:"image/jpeg",data:t}},f=a.map(_=>`${_.food_name} (${_.brand_name||"any brand"})`).join(", "),d=s.map(_=>`${_.food_name} (${_.brand_name||"any brand"}) - Reason: ${_.reason}`).join("; "),g=`Refine the previous analysis based on new info.
  User Profile: Age ${e.age??"N/A"}, medical history: "${e.medicalHistory||"None"}".
  Doctor-Approved Safe Foods: [${f||"None"}].
  Doctor-Restricted (MUST NOT EAT) Foods: [${d||"None"}].
  Previous JSON: ${JSON.stringify(n)}
  User says: '${r}'
  
  Recalculate the entire analysis based on the user's feedback. If they say 'I only ate half', halve all nutritional values. If they correct the food name, update it and recalculate everything, including the safety verdict (which must check the restricted list again).
  Respond ONLY with the completely updated JSON object. All text in ${l}.`,x=await $o.models.generateContent({model:"gemini-2.5-flash",contents:{parts:[c,{text:g}]},config:{responseMimeType:"application/json",responseSchema:Z2,systemInstruction:`You are an expert nutritionist. Update analysis based on user feedback. Respond only with the updated JSON. All text in ${l}.`}});try{return JSON.parse(x.text.trim())}catch(_){throw console.error("Failed to parse refined AI response:",x.text,_),new Error("The AI returned an invalid JSON response for the refinement.")}}const _F={type:$e.OBJECT,properties:{diagnoses:{type:$e.ARRAY,description:"List of medical diagnoses found.",items:{type:$e.STRING}},medications:{type:$e.ARRAY,description:"List of medications found with their dosages.",items:{type:$e.OBJECT,properties:{name:{type:$e.STRING,description:"Name of the medication."},dosage:{type:$e.STRING,description:"Dosage instructions (e.g., '500mg, twice a day')."}},required:["name","dosage"]}}},required:["diagnoses","medications"]};async function TF(t,e,n){const a=[{text:`Extract all medical diagnoses and all medications (with their full dosage instructions) from the following prescription. If no diagnoses or medications are found, return empty arrays for the respective keys. The prescription content is: 

${e||""}`}];t&&a.unshift({inlineData:{mimeType:"image/jpeg",data:t.split(",")[1]}});const s=await $o.models.generateContent({model:"gemini-2.5-flash",contents:{parts:a},config:{responseMimeType:"application/json",responseSchema:_F,systemInstruction:`You are a medical data extraction specialist. Your task is to accurately extract diagnoses and medications from prescriptions and return them in the specified JSON format. All text must be in ${n}.`}});try{return JSON.parse(s.text.trim())}catch(l){throw console.error("Failed to parse prescription response:",s.text,l),new Error("Could not understand the prescription. Please try a clearer image or text.")}}const wF={type:$e.OBJECT,properties:{emoji:{type:$e.STRING},title:{type:$e.STRING},message:{type:$e.STRING}},required:["emoji","title","message"]};async function SF(t,e,n){const r=`A user (age ${e.age??"N/A"}) has a daily calorie goal of ${e.dailyCalorieGoal} kcal and has consumed ${t.calories} kcal so far. Their medical history is: "${e.medicalHistory||"None"}". Provide a single, brief, encouraging, and actionable health insight as a JSON object, relevant to their progress and medical history. All text in ${n}.`,a=await $o.models.generateContent({model:"gemini-2.5-flash",contents:r,config:{responseMimeType:"application/json",responseSchema:wF,systemInstruction:`You are a friendly health coach. Provide short, positive health tips. Respond only with JSON. All text must be in ${n}.`}});try{return JSON.parse(a.text.trim())}catch(s){throw console.error("Failed to parse health insight response:",s),new Error("AI returned an invalid JSON for health insight.")}}const EF={type:$e.OBJECT,properties:{mealName:{type:$e.STRING},description:{type:$e.STRING},reason:{type:$e.STRING}},required:["mealName","description","reason"]};async function CF(t,e,n){const r=`A user (age ${e.age??"N/A"}) needs a meal suggestion.
    Daily goals: Calories: ${e.dailyCalorieGoal} kcal, Protein: ${e.dailyProteinGoal}g.
    Today's intake: Calories: ${t.calories} kcal, Protein: ${t.proteinGrams}g.
    Medical history: "${e.medicalHistory||"None"}".
    Suggest a single, healthy meal appropriate for them, considering their progress and health profile. Prefer common Indian dishes. Provide the response as a JSON object. All text in ${n}.`,a=await $o.models.generateContent({model:"gemini-2.5-flash",contents:r,config:{responseMimeType:"application/json",responseSchema:EF,systemInstruction:`You are a nutritionist suggesting simple, healthy meals. Respond only with JSON. All text in ${n}.`}});try{return JSON.parse(a.text.trim())}catch(s){throw console.error("Failed to parse meal suggestion response:",s),new Error("AI returned an invalid JSON for meal suggestion.")}}function bF(t,e,n,r){const a=e.length>0?e.slice(0,5).map(f=>`${f.foodName} (${f.nutrition.calories.toFixed(0)} kcal)`).join(", "):"None logged recently.",s=n.length>0?n.flatMap(f=>{var d;return((d=f.parsed_content)==null?void 0:d.medications.map(g=>g.name))??[]}).join(", "):"None.",l=`You are MyNutriMate, a friendly and knowledgeable AI health assistant.
Your goal is to provide helpful, general health and nutrition advice based on the user's profile and data.

USER DATA:
- Profile: Age ${t.age??"N/A"}, Gender: ${t.gender}, Height: ${t.heightCm}cm, Weight: ${t.weightKg}kg, Activity: ${t.activityLevel}.
- Medical History: "${t.medicalHistory||"None"}".
- Recent Meals Logged: ${a}
- Known Medications: ${s}

RULES:
- Use simple Markdown for formatting. Use \`**bold text**\` for emphasis, \`*italic text*\` for italics, and create lists by starting lines with \`-\`, \`*\`, or \`1.\`.
- You are NOT a doctor. For any medical diagnosis, prescription changes, or serious health concerns, you MUST advise the user to consult their real-world doctor.
- Do not provide information outside the scope of health, fitness, and nutrition.
- Keep your answers concise, encouraging, and easy to understand.
- Do not mention that you are a language model.
- All text must be in ${r}.
`;return $o.chats.create({model:"gemini-2.5-flash",config:{systemInstruction:l}})}const AF="/logolight.png",kF="/logodark.png",wm=({className:t})=>y.jsxs(y.Fragment,{children:[y.jsx("img",{src:AF,alt:"MyNutriMate Logo",className:`dark:hidden ${t}`}),y.jsx("img",{src:kF,alt:"MyNutriMate Logo",className:`hidden dark:block ${t}`})]}),NF="/bannerlight.png",MF="/bannerdark.png",Q2=({className:t})=>y.jsxs(y.Fragment,{children:[y.jsx("img",{src:NF,alt:"Footer Banner",className:`dark:hidden ${t}`}),y.jsx("img",{src:MF,alt:"Footer Banner",className:`hidden dark:block ${t}`})]}),vt={xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"},eT=t=>y.jsxs("svg",{...vt,...t,children:[y.jsx("path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242"}),y.jsx("path",{d:"M12 12v9"}),y.jsx("path",{d:"m16 16-4-4-4 4"})]}),Qa=t=>y.jsxs("svg",{...vt,...t,children:[y.jsx("path",{d:"m21.73 18-8-14a2 2 0 0 0-3.46 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z"}),y.jsx("path",{d:"M12 9v4"}),y.jsx("path",{d:"M12 17h.01"})]}),tT=t=>y.jsxs("svg",{...vt,...t,children:[y.jsx("path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"}),y.jsx("path",{d:"M21 3v5h-5"}),y.jsx("path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"}),y.jsx("path",{d:"M3 21v-5h5"})]}),DF=t=>y.jsx("svg",{...vt,...t,children:y.jsx("path",{d:"M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"})}),da=({children:t,className:e,...n})=>y.jsx("svg",{...vt,className:e??"h-6 w-6",...n,children:t}),Sm=t=>y.jsxs(da,{...t,children:[y.jsx("path",{d:"M11.5 12.5c0 .55.19 1.05.53 1.47.33.42.76.76 1.25.97L12 20M12 4c-1.78 2.3-1.03 5.33.92 7.28.52.52.48 1.36-.08 1.72-.44.29-1.03.1-1.35-.31-.32-.42-.66-1.07-1.1-1.69-1.3-1.84-2.84-3.48-2.84-5.32A4.5 4.5 0 0 1 12 4Z"}),y.jsx("path",{d:"M8.27 12.15c-.29-.4-.1-1.03.31-1.35.33-.26.83-.26 1.18-.02.43.3.82.88 1.14 1.45.32.57.65 1.22 1.1 1.69.56.56 1.4.6 1.88.12.56-.56.5-1.56-.12-2.04-1.95-1.52-2.4-4.21-1.2-6.32-2.5 1-4.5 4-4.5 6.5A4.5 4.5 0 0 0 8.27 12.15Z"})]}),Em=t=>y.jsxs(da,{...t,children:[y.jsx("path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z"}),y.jsx("path",{d:"m3.3 7 8.7 5 8.7-5"}),y.jsx("path",{d:"M12 22V12"})]}),Cm=t=>y.jsxs(da,{...t,children:[y.jsx("path",{d:"M2 22v-6.17a3 3 0 0 1 .58-1.75l5.17-8.61a3 3 0 0 1 2.5-1.47h0a3 3 0 0 1 2.5 1.47l5.17 8.61a3 3 0 0 1 .58 1.75V22"}),y.jsx("path",{d:"M9 13a3 3 0 0 1 6 0"}),y.jsx("path",{d:"M9.5 7.5a3 3 0 0 1 5 0"})]}),bm=t=>y.jsx(da,{...t,children:y.jsx("path",{d:"M15.8 21.3a8 8 0 0 1-5.6-5.6C8.8 13.2 12 2 12 2s3.2 11.2 1.8 13.7a8 8 0 0 1-5.6 5.6Z"})}),Am=t=>y.jsxs(da,{...t,children:[y.jsx("path",{d:"m21.73 18-8-14a2 2 0 0 0-3.46 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z"}),y.jsx("path",{d:"M12 10.5 16 18"}),y.jsx("path",{d:"m8 18 4-7.5"})]}),km=t=>y.jsxs(da,{...t,children:[y.jsx("path",{d:"M13.5 8.5a2 2 0 1 1-4 0 2 2 0 0 1 4 0Z"}),y.jsx("path",{d:"M12.5 4.5a2 2 0 1 0-4 0 2 2 0 0 0 4 0Z"}),y.jsx("path",{d:"M10.5 12.5a2 2 0 1 1-4 0 2 2 0 0 1 4 0Z"}),y.jsx("path",{d:"M18 10a2 2 0 1 1-4 0 2 2 0 0 1 4 0Z"}),y.jsx("path",{d:"M16 6a2 2 0 1 0-4 0 2 2 0 0 0 4 0Z"}),y.jsx("path",{d:"M14 14a2 2 0 1 1-4 0 2 2 0 0 1 4 0Z"}),y.jsx("path",{d:"M15 22H9a2 2 0 0 1-2-2v-4.34a1 1 0 0 1 .29-.7l2.42-2.42a1 1 0 0 1 1.42 0l2.58 2.58a1 1 0 0 0 1.42 0l2.42-2.42a1 1 0 0 1 .29-.7V20a2 2 0 0 1-2 2Z"})]}),nT=t=>y.jsx(da,{...t,children:y.jsx("path",{d:"M11 20A7 7 0 0 1 7 6V4a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1H8a4 4 0 1 0 4 4h1a3 3 0 0 0 3-3V9a1 1 0 0 0-1-1H4"})}),rT=t=>y.jsxs(da,{...t,children:[y.jsx("path",{d:"M16.5 5c-1.38 0-2.5 1.12-2.5 2.5 0 .61.22 1.16.58 1.59L5.12 18.55c-.59.59-.59 1.54 0 2.12l.71.71c.59.59 1.54.59 2.12 0L18.41 10.92c.43.36.98.58 1.59.58 1.38 0 2.5-1.12 2.5-2.5S17.88 5 16.5 5z"}),y.jsx("path",{d:"m8.5 16c-1.38 0-2.5-1.12-2.5-2.5S7.12 11 8.5 11s2.5 1.12 2.5 2.5S9.88 16 8.5 16z"})]}),xc=t=>y.jsx(da,{...t,children:y.jsx("path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"})}),aT=({filled:t,...e})=>y.jsx("svg",{...vt,fill:t?"currentColor":"none",stroke:"currentColor",...e,children:y.jsx("polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"})}),Nm=t=>y.jsxs(da,{...t,children:[y.jsx("path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"}),y.jsx("circle",{cx:"12",cy:"12",r:"3"})]}),iT=t=>y.jsxs(da,{...t,children:[y.jsx("path",{d:"M21.66 12.58A9 9 0 1 1 11.42 2.34"}),y.jsx("path",{d:"M21.66 12.58A9 9 0 0 0 12.58 2.34"}),y.jsx("path",{d:"M2.34 11.42A9 9 0 0 0 11.42 21.66"}),y.jsx("path",{d:"M2.34 11.42A9 9 0 0 1 12.58 2.34"}),y.jsx("path",{d:"M12 12 5.23 7.66"}),y.jsx("path",{d:"M12 12 7.66 18.77"}),y.jsx("path",{d:"M12 12 16.34 5.23"}),y.jsx("path",{d:"M12 12 18.77 16.34"})]}),RF=t=>y.jsxs("svg",{...vt,...t,children:[y.jsx("path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}),y.jsx("polyline",{points:"9 22 9 12 15 12 15 22"})]}),Mm=t=>y.jsxs("svg",{...vt,...t,children:[y.jsx("path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z"}),y.jsx("circle",{cx:"12",cy:"13",r:"3"})]}),qf=t=>y.jsxs("svg",{...vt,...t,children:[y.jsx("path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"}),y.jsx("path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"})]}),xs=t=>y.jsxs("svg",{...vt,...t,children:[y.jsx("path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"}),y.jsx("circle",{cx:"12",cy:"7",r:"4"})]}),sT=t=>y.jsxs("svg",{...vt,...t,children:[y.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),y.jsx("circle",{cx:"9",cy:"7",r:"4"}),y.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),y.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),jf=t=>y.jsxs("svg",{...vt,...t,children:[y.jsx("path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"}),y.jsx("polyline",{points:"17 21 17 13 7 13 7 21"}),y.jsx("polyline",{points:"7 3 7 8 15 8"})]}),oT=t=>y.jsxs("svg",{...vt,...t,children:[y.jsx("path",{d:"m12 19-7-7 7-7"}),y.jsx("path",{d:"M19 12H5"})]}),Dm=t=>y.jsxs("svg",{...vt,...t,children:[y.jsx("circle",{cx:"12",cy:"12",r:"4"}),y.jsx("path",{d:"M12 2v2"}),y.jsx("path",{d:"M12 20v2"}),y.jsx("path",{d:"m4.93 4.93 1.41 1.41"}),y.jsx("path",{d:"m17.66 17.66 1.41 1.41"}),y.jsx("path",{d:"M2 12h2"}),y.jsx("path",{d:"M20 12h2"}),y.jsx("path",{d:"m6.34 17.66-1.41 1.41"}),y.jsx("path",{d:"m19.07 4.93-1.41 1.41"})]}),FF=t=>y.jsx("svg",{...vt,...t,children:y.jsx("path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z"})}),IF=t=>y.jsxs("svg",{...vt,...t,children:[y.jsx("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),y.jsx("polyline",{points:"16 17 21 12 16 7"}),y.jsx("line",{x1:"21",x2:"9",y1:"12",y2:"12"})]}),Wo=t=>y.jsxs("svg",{...vt,...t,children:[y.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),y.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]}),PF=t=>y.jsxs("svg",{...vt,...t,children:[y.jsx("path",{d:"M9 18h6"}),y.jsx("path",{d:"M10 22h4"}),y.jsx("path",{d:"M12 2a7 7 0 0 0-7 7c0 3.07 1.63 5.57 4 6.93V18h6v-2.07c2.37-1.36 4-3.86 4-6.93a7 7 0 0 0-7-7Z"})]}),Rm=t=>y.jsxs("svg",{...vt,...t,children:[y.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),y.jsx("polyline",{points:"22 4 12 14.01 9 11.01"})]}),sc=t=>y.jsxs("svg",{...vt,...t,strokeWidth:"1.5",children:[y.jsx("path",{d:"M12 2L14.5 9.5L22 12L14.5 14.5L12 22L9.5 14.5L2 12L9.5 9.5L12 2Z"}),y.jsx("path",{d:"M18 6L17 3L16 6L13 7L16 8L17 11L18 8L21 7L18 6Z"}),y.jsx("path",{d:"M6 18L7 21L8 18L11 17L8 16L7 13L6 18Z"})]}),LF=t=>y.jsxs("svg",{...vt,...t,children:[y.jsx("polyline",{points:"6 9 6 2 18 2 18 9"}),y.jsx("path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"}),y.jsx("rect",{x:"6",y:"14",width:"12",height:"8"})]}),lT=t=>y.jsxs("svg",{...vt,...t,children:[y.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),y.jsx("polyline",{points:"7 10 12 15 17 10"}),y.jsx("line",{x1:"12",x2:"12",y1:"15",y2:"3"})]}),cT=t=>y.jsxs("svg",{...vt,...t,children:[y.jsx("path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"}),y.jsx("rect",{x:"8",y:"2",width:"8",height:"4",rx:"1",ry:"1"})]}),Ic=t=>y.jsx("svg",{...vt,...t,children:y.jsx("polyline",{points:"20 6 9 17 4 12"})}),OF=t=>y.jsxs("svg",{...vt,...t,children:[y.jsx("path",{d:"m16 2-2.3 2.3a3 3 0 0 0 0 4.2l1.8 1.8-11.3 11.3-1.4-1.4-1.8-1.8a3 3 0 0 1 0-4.2L3.6 12l1.8 1.8a3 3 0 0 0 4.2 0L12 11.4l2.8 2.8a3 3 0 0 0 4.2 0l2.3-2.3Z"}),y.jsx("path",{d:"m22 6-2.3 2.3a3 3 0 0 1-4.2 0L14.7 7.5l-1.8-1.8a3 3 0 0 0-4.2 0L6.4 8.1 4.6 6.3a3 3 0 0 1 0-4.2L6.9 2l1.8 1.8a3 3 0 0 0 4.2 0l2.3-2.3"})]}),Pc=t=>y.jsxs("svg",{...vt,...t,children:[y.jsx("path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"}),y.jsx("polyline",{points:"14 2 14 8 20 8"}),y.jsx("line",{x1:"16",x2:"8",y1:"13",y2:"13"}),y.jsx("line",{x1:"16",x2:"8",y1:"17",y2:"17"}),y.jsx("line",{x1:"10",x2:"8",y1:"9",y2:"9"})]}),uT=t=>y.jsxs("svg",{...vt,...t,children:[y.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),y.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),UF=t=>y.jsxs("svg",{...vt,...t,children:[y.jsx("path",{d:"m22 2-7 20-4-9-9-4Z"}),y.jsx("path",{d:"M22 2 11 13"})]}),Fm=t=>y.jsxs("svg",{...vt,...t,children:[y.jsx("circle",{cx:"8",cy:"21",r:"1"}),y.jsx("circle",{cx:"19",cy:"21",r:"1"}),y.jsx("path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.16"})]}),Im=t=>y.jsxs("svg",{...vt,...t,children:[y.jsx("path",{d:"M11 20H4a2 2 0 0 1-2-2V5c0-1.1.9-2 2-2h3.93a2 2 0 0 1 1.66.9l.82 1.2a2 2 0 0 0 1.66.9H20a2 2 0 0 1 2 2v1.5"}),y.jsx("path",{d:"M21.29 14.7a2.43 2.43 0 0 0-2.65-.52c-.3.12-.57.3-.8.53l-.34.34-.35-.34a2.43 2.43 0 0 0-2.65-.52c-1.38.34-2.29 1.86-1.84 3.28.16.52.46.98.88 1.32l3.47 3.47a.5.5 0 0 0 .7 0l3.47-3.47c.42-.34.72-.8.88-1.32.45-1.42-.46-2.94-1.84-3.28Z"})]}),BF=t=>y.jsxs("svg",{...vt,...t,children:[y.jsx("polygon",{points:"11 5 6 9 2 9 2 15 6 15 11 19 11 5"}),y.jsx("path",{d:"M15.54 8.46a5 5 0 0 1 0 7.07"}),y.jsx("path",{d:"M19.07 4.93a10 10 0 0 1 0 14.14"})]}),VF=t=>y.jsxs("svg",{...vt,...t,children:[y.jsx("polygon",{points:"11 5 6 9 2 9 2 15 6 15 11 19 11 5"}),y.jsx("line",{x1:"22",y1:"9",x2:"16",y2:"15"}),y.jsx("line",{x1:"16",y1:"9",x2:"22",y2:"15"})]}),GF=t=>y.jsx("svg",{...vt,...t,children:y.jsx("path",{d:"m6 9 6 6 6-6"})}),HF={en:"English",hi:"Hindi",ml:"Malayalam"},zF={patient:{en:"Patient",hi:"",ml:""},doctor:{en:"Doctor",hi:"",ml:""},back:{en:"Back",hi:"",ml:""},save:{en:"Save",hi:"",ml:" "},saving:{en:"Saving...",hi:"   ...",ml:" ..."},saved:{en:"Saved!",hi:"  !",ml:" !"},error:{en:"Error",hi:"",ml:""},na:{en:"N/A",hi:" ",ml:""},changes:{en:"Changes",hi:"",ml:""},statusLow:{en:"Low",hi:"",ml:""},statusHigh:{en:"High",hi:"",ml:""},statusNormal:{en:"Normal",hi:"",ml:""},female:{en:"Female",hi:"",ml:""},male:{en:"Male",hi:"",ml:""},other:{en:"Other",hi:"",ml:""},sedentary:{en:"Sedentary",hi:"",ml:""},lightly_active:{en:"Lightly Active",hi:" ",ml:" "},active:{en:"Active",hi:"",ml:""},very_active:{en:"Very Active",hi:" ",ml:" "},bmiUnderweight:{en:"Underweight",hi:" ",ml:""},bmiNormal:{en:"Normal weight",hi:" ",ml:" "},bmiOverweight:{en:"Overweight",hi:" ",ml:""},bmiObesity:{en:"Obesity",hi:"",ml:""},ageYearsOld:{en:"{age} years old",hi:"{age} ",ml:"{age} "},nutrientIron:{en:"Iron",hi:"",ml:""},nutrientCalcium:{en:"Calcium",hi:"",ml:""},nutrientPotassium:{en:"Potassium",hi:"",ml:""},nutrientVitaminC:{en:"Vitamin C",hi:" ",ml:" "},nutrientVitaminA:{en:"Vitamin A",hi:" ",ml:" "},nutrientVitaminD:{en:"Vitamin D",hi:" ",ml:" "},footerCredit:{en:"MyNutriMate made with  by MynutriLog team, in connection with",hi:"MyNutriMate  MynutriLog  ,     ",ml:"MyNutriMate  MynutriLog ,   "},footerAbdm:{en:"Ayushman Bharat Digital Mission",hi:"   ",ml:"   "},footerAnd:{en:" & ",hi:"  ",ml:" & "},footerPmjay:{en:"Pradhan Mantri Jan Arogya Yojana",hi:"   ",ml:"   "},authWelcome:{en:"Welcome Back!",hi:"  !",ml:" !"},authCreatePatientAccount:{en:"Create Patient Account",hi:"  ",ml:"  "},authCreateDoctorAccount:{en:"Create Doctor Account",hi:"  ",ml:"  "},authLoginContinue:{en:"Log in to continue",hi:"      ",ml:"  "},authSignUpStart:{en:"Sign up to get started",hi:"      ",ml:"   "},authUsername:{en:"Username",hi:" ",ml:""},authUsernamePlaceholder:{en:"e.g., jane_doe",hi:"., jane_doe",ml:"., jane_doe"},authFullName:{en:"Full Name",hi:" ",ml:" "},authFullNamePlaceholder:{en:"e.g., Jane Doe",hi:"., Jane Doe",ml:"., Jane Doe"},authPhoneNumber:{en:"Phone Number",hi:" ",ml:" "},authPhoneNumberPlaceholder:{en:"e.g., 9876543210",hi:"., 9876543210",ml:"., 9876543210"},authMedicalId:{en:"Medical Registration ID",hi:"  ",ml:"  "},authMedicalIdPlaceholder:{en:"e.g., MCI/12345",hi:"., MCI/12345",ml:"., MCI/12345"},authSpecialization:{en:"Specialization",hi:"",ml:""},authSpecializationPlaceholder:{en:"e.g., Cardiologist",hi:".,   ",ml:"., "},authEmail:{en:"Email Address",hi:" ",ml:" "},authEmailPlaceholder:{en:"you@example.com",hi:"@example.com",ml:"@example.com"},authPassword:{en:"Password",hi:"",ml:""},authCheckEmail:{en:"Check your email for the confirmation link!",hi:"      !",ml:"    !"},authLogin:{en:"Log In",hi:"  ",ml:" "},authSignUp:{en:"Sign Up",hi:"  ",ml:"  "},authNeedAccount:{en:"Need an account? Sign up",hi:"  ?   ",ml:" ?   "},authHaveAccount:{en:"Already have an account? Log in",hi:"    ?   ",ml:" ?  "},authUnknownError:{en:"An unknown error occurred.",hi:"   ",ml:"   ."},navDashboard:{en:"Dashboard",hi:"",ml:""},navLogMeal:{en:"Log Meal",hi:"  ",ml:"  "},navGrocery:{en:"Grocery",hi:"",ml:""},navPrescription:{en:"Prescription",hi:"",ml:""},navHistory:{en:"History",hi:"",ml:""},navMyFiles:{en:"My Files",hi:" ",ml:" "},navProfile:{en:"Profile",hi:"",ml:""},navMyPatients:{en:"My Patients",hi:" ",ml:" "},configNeeded:{en:"Configuration Needed",hi:"  ",ml:" "},supabaseWarning:{en:"Your Supabase credentials are not configured. Please open `services/supabaseClient.ts` and add your credentials.",hi:" Supabase      `services/supabaseClient.ts`     ",ml:" Supabase   .  `services/supabaseClient.ts`    ."},analyzing:{en:"Analyzing...",hi:"   ...",ml:" ..."},scanningLabel:{en:"Scanning Label...",hi:"    ...",ml:"  ..."},viewGroceryList:{en:"View My Grocery List",hi:"   ",ml:"   "},cameraError:{en:"Could not access the camera. Please ensure permissions are granted and try again.",hi:"                ",ml:"   .     ."},cameraClose:{en:"Close camera",hi:"  ",ml:" "},cameraCapture:{en:"Capture photo",hi:" ",ml:" "},chatbotTitle:{en:"AI Health Bot",hi:"  ",ml:"AI  "},chatbotGreeting:{en:"Hi! I'm MyNutriMate, your AI health assistant. How can I help you today?",hi:"!  MyNutriMate,  AI           ?",ml:"!  MyNutriMate,  AI  .     ?"},chatbotThinking:{en:"Thinking...",hi:"  ...",ml:"..."},chatbotPlaceholder:{en:"Ask a health question...",hi:"   ...",ml:"   ..."},chatbotError:{en:"Sorry, I encountered an error. Please try again.",hi:" ,        ",ml:",   .   ."},chatbotStopSpeaking:{en:"Stop speaking",hi:"  ",ml:" "},chatbotSpeak:{en:"Speak message",hi:" ",ml:" "},chatbotToggle:{en:"Toggle Health Bot",hi:"   ",ml:"   "},dashboardTitle:{en:"Today's Dashboard",hi:"  ",ml:" "},dashboardGreeting:{en:"Hello {name}, let's check your progress!",hi:" {name},    !",ml:" {name},   !"},dashboardScanFood:{en:"Scan Food or Label",hi:"    ",ml:"   "},dashboardAnalyzePrescription:{en:"Analyze Prescription",hi:"   ",ml:"  "},dashboardDoctorNotes:{en:"Doctor's Notes",hi:"  ",ml:" "},dashboardNoteFrom:{en:"Note from Dr. {name}",hi:". {name}  ",ml:". {name}  "},dashboardBmi:{en:"Body Mass Index (BMI)",hi:"   ()",ml:"   ()"},dashboardEnterBmi:{en:"Enter height & weight in profile.",hi:"      ",ml:"   ."},dashboardCalories:{en:"Calories",hi:"",ml:""},dashboardLoadingGoals:{en:"Loading goals...",hi:"    ...",ml:"  ..."},dashboardMacros:{en:"Macronutrients",hi:"",ml:" "},dashboardLoadingMacros:{en:"Loading your personalized macro goals...",hi:"       ...",ml:"     ..."},dashboardDailyLimits:{en:"Daily Limits",hi:" ",ml:" "},dashboardAiTip:{en:"AI Health Tip",hi:"  ",ml:"AI  "},dashboardAiMealSuggestion:{en:"AI Meal Suggestion",hi:"  ",ml:"AI  "},dashboardLogFirstMeal:{en:"Log Your First Meal!",hi:"    !",ml:"    !"},dashboardGetInsights:{en:"Add a meal to get personalized health insights from our AI.",hi:" AI           ",ml:" AI-        ."},dashboardGeneratingTip:{en:"Generating a new tip...",hi:"     ...",ml:"   ..."},dashboardThinkingMeal:{en:"Thinking of a tasty meal...",hi:"        ...",ml:"   ..."},dashboardWhyThisMeal:{en:"Why this meal?",hi:"  ?",ml:"  ?"},dashboardSuggestMeal:{en:"Suggest a Meal",hi:"  ",ml:"  "},dashboardSuggestAnother:{en:"Suggest Another Meal",hi:"  ",ml:"  "},dashboardGetSuggestion:{en:"Click the button to get an AI-powered suggestion for your next meal based on your goals and health profile.",hi:"             AI-         ",ml:"         AI-     ."},nutrientProtein:{en:"Protein",hi:"",ml:""},nutrientCarbs:{en:"Carbs",hi:"",ml:""},nutrientFat:{en:"Fat",hi:"",ml:""},nutrientSugar:{en:"Sugar",hi:"",ml:""},nutrientSodium:{en:"Sodium",hi:"",ml:""},doctorDashboardNoData:{en:"No data logged recently.",hi:"        ",ml:"   ."},doctorDashboardHintLow:{en:"Intake is significantly below goal.",hi:"     ",ml:"   ."},doctorDashboardHintHigh:{en:"Intake is significantly above goal.",hi:"     ",ml:"   ."},doctorDashboardHintNormal:{en:"Intake is near goal.",hi:"    ",ml:" ."},doctorDashboardCalorieStatus:{en:"Calorie Status",hi:" ",ml:" "},doctorDashboardInactiveHint:{en:"User has not logged in over 3 days.",hi:"  3          ",ml:" 3   ."},doctorDashboardBmiHint:{en:"BMI: {status}",hi:": {status}",ml:": {status}"},doctorDashboardUnnamed:{en:"Unnamed Client",hi:" ",ml:" "},doctorDashboardManage:{en:"Manage Patient",hi:"  ",ml:" "},doctorDashboardTitle:{en:"Doctor Dashboard",hi:" ",ml:" "},doctorDashboardSubtitle:{en:"Manage and monitor your connected patients.",hi:"        ",ml:"     ."},doctorDashboardExport:{en:"Export Patient Data",hi:"   ",ml:"   "},doctorDashboardExportEmpty:{en:"No patient data to export.",hi:"        ",ml:"   ."},doctorDashboardCodeTitle:{en:"Your Unique Doctor Code",hi:"   ",ml:"   "},doctorDashboardCodeSubtitle:{en:"Share this code with your patients to connect.",hi:"           ",ml:"     ."},doctorDashboardCopyCode:{en:"Copy code",hi:"  ",ml:" "},doctorDashboardAllPatients:{en:"All Patients ({count})",hi:"  ({count})",ml:"  ({count})"},doctorDashboardNoPatients:{en:"No patients are connected yet. Share your Doctor Code to get started.",hi:"               ",ml:"  .     ."},doctorProfileTitle:{en:"My Doctor Profile",hi:"  ",ml:"  "},doctorProfileSubtitle:{en:"View and update your professional information.",hi:"      ",ml:"   ,  ."},doctorProfilePhonePlaceholder:{en:"Your contact number",hi:"  ",ml:"  "},groceryStarsHint:{en:"{stars}/5 Health Stars",hi:"{stars}/5  ",ml:"{stars}/5  "},groceryCaloriesHint:{en:"{calories} calories",hi:"{calories} ",ml:"{calories} "},groceryTitle:{en:"My Grocery List",hi:"  ",ml:"  "},grocerySubtitle:{en:"Manage your shopping list for healthier choices.",hi:"        ",ml:"     ."},groceryBackToScanner:{en:"Back to Scanner",hi:"   ",ml:" "},groceryClearPurchased:{en:"Clear Purchased",hi:"   ",ml:" "},groceryClearConfirm:{en:"Are you sure you want to clear all purchased items from the list?",hi:"            ?",ml:"        ?"},groceryUpdateError:{en:"Failed to update item status. Please try again.",hi:"         ",ml:"    .   ."},groceryClearError:{en:"Failed to clear items. Please try again.",hi:"        ",ml:"  .   ."},groceryEmpty:{en:"Your grocery list is empty.",hi:"    ",ml:"   ."},groceryScanToStart:{en:"Scan a product to get started!",hi:"       !",ml:"    !"},uploaderDropError:{en:"Please drop an image file.",hi:"     ",ml:"     ."},uploaderClick:{en:"Click to upload",hi:"     ",ml:"  "},uploaderDrag:{en:"or drag and drop",hi:"   ",ml:" "},uploaderFormats:{en:"PNG, JPG, GIF up to 10MB",hi:", ,  10  ",ml:"PNG, JPG, GIF 10MB "},uploaderOr:{en:"OR",hi:"",ml:""},uploaderCamera:{en:"Use Camera",hi:"   ",ml:" "},labelServingSize:{en:"Serving Size: ",hi:" : ",ml:" : "},labelExpiredTitle:{en:"Product Expired",hi:"    ",ml:" "},labelExpiredMessage:{en:"This product expired on {date}. It is not recommended for consumption.",hi:"  {date}             ",ml:"  {date}- .    ."},safetyVerdictSafe:{en:"Safe For You",hi:"  ",ml:" "},safetyVerdictRisky:{en:"Risky For You",hi:"   ",ml:" "},labelAddToDiary:{en:"Add to Diary",hi:"  ",ml:" "},labelAddToGrocery:{en:"Add to Grocery List",hi:"   ",ml:"  "},labelAddSpoiledError:{en:"Cannot add spoiled food.",hi:"    ",ml:"   ."},labelAddExpiredError:{en:"Cannot add expired food.",hi:"      ",ml:"   ."},labelAnalyzeNew:{en:"Analyze New Item",hi:"    ",ml:"   "},labelHealthAssessment:{en:"General Health Assessment",hi:"  ",ml:"  "},labelStarsOutOf5:{en:"{stars} / 5.0",hi:"{stars} / 5.0",ml:"{stars} / 5.0"},labelNutritionalBreakdown:{en:"Nutritional Breakdown (Serving Size {size}g)",hi:"   (  {size} )",ml:"  (  {size}g)"},labelMicronutrients:{en:"Micronutrient Spotlight",hi:" ",ml:"  "},filesDoctorTitle:{en:"{name}'s Medical Files",hi:"{name}   ",ml:"{name}  "},filesPatientTitle:{en:"My Medical Files",hi:"  ",ml:"  "},filesSubtitle:{en:"A secure place for your important health documents.",hi:"        ",ml:"      ."},filesUploadTitle:{en:"Upload a New Document",hi:"    ",ml:"    "},filesUploading:{en:"Uploading...",hi:"   ...",ml:" ..."},filesClickToSelect:{en:"Click to select a file",hi:"      ",ml:"   "},filesFormats:{en:"PDF, PNG, JPG, XLSX, XLS up to 5MB",hi:", , , ,  5  ",ml:"PDF, PNG, JPG, XLSX, XLS 5MB "},filesInvalidType:{en:"Invalid file type. Please upload a PDF, image (PNG, JPG), or Excel file.",hi:"     ,  (, ),     ",ml:"  .   PDF,  (PNG, JPG),  Excel   ."},filesTooLarge:{en:"File is too large. Please upload files under 5MB.",hi:"     5       ",ml:"  .  5MB-    ."},filesStoredCount:{en:"Stored Documents ({count})",hi:"  ({count})",ml:"  ({count})"},filesConfigError:{en:"Configuration Error: The 'medical-documents' storage bucket is missing. A developer must create this in the Supabase project dashboard. Please see the setup instructions in README.md.",hi:" : 'medical-documents'         Supabase       README.md    ",ml:" : 'medical-documents'   .    Supabase   .  README.md-   ."},filesEmptyDoctor:{en:"This patient has not uploaded any documents.",hi:"        ",ml:"     ."},filesEmptyPatient:{en:"You have not uploaded any documents yet.",hi:"        ",ml:"     ."},filesView:{en:"View File",hi:" ",ml:" "},filesDownload:{en:"Download File",hi:"  ",ml:"  "},filesDelete:{en:"Delete File",hi:" ",ml:" "},filesDeleteConfirm:{en:"Are you sure you want to delete {fileName}? This cannot be undone.",hi:"   {fileName}    ?      ",ml:"{fileName}    ?  ."},filesPdfViewerTitle:{en:"PDF Viewer",hi:" ",ml:"PDF "},filesImageAlt:{en:"Medical document",hi:" ",ml:" "},filesCloseViewer:{en:"Close viewer",hi:"  ",ml:" "},nutritionEstWeight:{en:"Estimated Weight: ",hi:" : ",ml:" : "},nutritionAddSpoiledError:{en:"Cannot add spoiled food to diary.",hi:"      ",ml:"    ."},nutritionCancelRefine:{en:"Cancel Refinement",hi:"  ",ml:" "},nutritionRefine:{en:"Refine Analysis",hi:"  ",ml:" "},nutritionAnalyzeNew:{en:"Analyze New Meal",hi:"    ",ml:"   "},nutritionBreakdown:{en:"Nutritional Breakdown",hi:"  ",ml:" "},modalPatientNote:{en:"Patient Note",hi:" ",ml:" "},modalNotePlaceholder:{en:"Add a note for your patient... This will appear on their dashboard.",hi:"      ...      ",ml:"    ...    ."},modalSaveErrorHint:{en:"If this persists, your database may be missing required security policies. Please check the README.md file.",hi:"    ,             README.md  ",ml:" ,      .  README.md  ."},modalSafeFoods:{en:"Safe Foods",hi:"  ",ml:" "},modalFoodName:{en:"Food Name*",hi:"  *",ml:" *"},modalBrand:{en:"Brand (Optional)",hi:" ()",ml:" ()"},modalRestrictedFoods:{en:"Restricted Foods",hi:"  ",ml:" "},modalReason:{en:"Reason*",hi:"*",ml:"*"},modalTabNote:{en:"Patient Note",hi:" ",ml:" "},modalTabFood:{en:"Food Lists",hi:" ",ml:" "},modalTabHistory:{en:"History",hi:"",ml:""},modalTabFiles:{en:"Files",hi:"",ml:""},modalDisconnect:{en:"Disconnect from Patient",hi:"   ",ml:"  "},modalDisconnectConfirm:{en:"Are you sure you want to disconnect from this patient?",hi:"         ?",ml:"      ?"},prescriptionTitle:{en:"Analyze Prescription",hi:"   ",ml:"  "},prescriptionSubtitle:{en:"Upload a photo of your prescription or paste the text below. The AI will extract key information and help you update your medical profile.",hi:"                            ",ml:"         . AI          ."},prescriptionUploadOrPaste:{en:"Upload or Paste",hi:"   ",ml:"   "},prescriptionTextPlaceholder:{en:"Or, paste your prescription text here...",hi:",      ...",ml:",     ..."},prescriptionAnalyzeText:{en:"Analyze Text",hi:"   ",ml:"  "},prescriptionAiResult:{en:"AI Analysis Result",hi:"  ",ml:"AI  "},prescriptionAnalyzing:{en:"Analyzing...",hi:"   ...",ml:" ..."},prescriptionDiagnoses:{en:"Diagnoses Identified",hi:"  ",ml:" "},prescriptionMedications:{en:"Medications Identified",hi:"  ",ml:" "},prescriptionNoneFound:{en:"None found.",hi:"  ",ml:" ."},prescriptionSaveToHistory:{en:"Save to My Medical History",hi:"     ",ml:"   "},prescriptionSaveSuccess:{en:"Your medical history has been updated!",hi:"       !",ml:"    !"},prescriptionResultsPlaceholder:{en:"Your analysis results will appear here.",hi:"     ",ml:"    ."},profileWelcome:{en:"Welcome! Let's set up your profile",hi:" !     ",ml:"!   "},profileTitle:{en:"My Profile",hi:" ",ml:" "},profileWelcomeSubtitle:{en:"This information helps us personalize your health advice.",hi:"            ",ml:"       ."},profileUpdateSubtitle:{en:"Keep your information up to date for the best advice.",hi:"       ",ml:"     ."},profilePersonalDetails:{en:"Personal Details",hi:" ",ml:" "},profileFullNamePlaceholder:{en:"Your full name",hi:"  ",ml:"  "},profileUsernamePlaceholder:{en:"A unique username",hi:"   ",ml:"  "},profilePhonePlaceholder:{en:"Your 10-digit mobile number",hi:" 10-  ",ml:" 10   "},profileDob:{en:"Date of Birth",hi:"  ",ml:" "},profileGender:{en:"Gender",hi:"",ml:""},profileHealthMetrics:{en:"Health Metrics & History",hi:"   ",ml:"  "},profileHeight:{en:"Height (cm)",hi:" ()",ml:" (.)"},profileHeightPlaceholder:{en:"e.g., 165",hi:"., 165",ml:"., 165"},profileWeight:{en:"Weight (kg)",hi:" ()",ml:" (.)"},profileWeightPlaceholder:{en:"e.g., 60",hi:"., 60",ml:"., 60"},profileLiveBmi:{en:"Live BMI Calculation",hi:"  ",ml:"  "},profileEnterBmi:{en:"Enter height and weight to see BMI.",hi:"        ",ml:"    ."},profileActivityLevel:{en:"Activity Level",hi:" ",ml:" "},profileMedicalHistory:{en:"Medical History / Conditions",hi:"  / ",ml:"  / "},profileMedicalHistoryPlaceholder:{en:"e.g., Diabetes, High Blood Pressure, Allergy to peanuts.",hi:"., ,  ,   ",ml:"., ,  ,  ."},profileSaveContinue:{en:"Save and Continue",hi:"   ",ml:"  "},profileSaveChanges:{en:"Save Changes",hi:" ",ml:" "},profileDoctorConnect:{en:"Doctor Connect",hi:" ",ml:" "},profileDoctorConnectSubtitle:{en:"To get guidance from your doctor, please enter their first name and the unique code they provided to you.",hi:"       ,              ",ml:"    ,        ."},profileConnectedWith:{en:"Connected With:",hi:"    :",ml:" :"},profileConnectSuccess:{en:"Successfully connected! Your Doctor can now view your progress.",hi:"   !        ",ml:" !       ."},profileDisconnectConfirm:{en:"Are you sure you want to disconnect from this doctor?",hi:"         ?",ml:"      ?"},profileDisconnect:{en:"Disconnect",hi:"",ml:""},profileDoctorFirstName:{en:"Doctor's First Name",hi:"   ",ml:" "},profileDoctorFirstNamePlaceholder:{en:"e.g., Sunita",hi:"., ",ml:"., "},profileDoctorCode:{en:"Doctor's Unique Code",hi:"   ",ml:"  "},profileDoctorCodePlaceholder:{en:"e.g., AB12CD",hi:"., AB12CD",ml:"., AB12CD"},profileConnect:{en:"Connect",hi:" ",ml:""},profileFetchConnectionsError:{en:"Failed to fetch Doctor connections.",hi:"    ",ml:"   ."},profileConnectFormError:{en:"Doctor Code and First Name are required.",hi:"      ",ml:"   ."},profileConnectDbError:{en:"A database error occurred. Please try again later.",hi:"         ",ml:"   .    ."},profileConnectInvalidCode:{en:"Invalid Doctor Code. Please double-check the code and try again.",hi:"          ",ml:"  .      ."},profileConnectNameMismatch:{en:"The Doctor's first name does not seem to match the provided code. Please verify both details.",hi:"               ",ml:"     .    ."},profileConnectCheckError:{en:"Could not verify existing connections due to a database error.",hi:"          ",ml:"       ."},profileConnectAlreadyConnected:{en:"You are already connected with this Doctor.",hi:"         ",ml:"    ."},profileConnectInsertError:{en:"Failed to create the connection due to a database error.",hi:"       ",ml:"      ."},profileDisconnectError:{en:"Failed to disconnect.",hi:"   ",ml:" ."},profileGuidelinesTitle:{en:"Doctor's Guidelines",hi:"  ",ml:" "},profileApprovedFoods:{en:"Approved Foods",hi:"  ",ml:" "},profileNoApproved:{en:"No specific foods approved by your doctor yet.",hi:"             ",ml:"     ."},profileRestrictedFoods:{en:"Restricted Foods",hi:"  ",ml:" "},profileNoRestricted:{en:"No restricted foods from your doctor.",hi:"        ",ml:"    ."},profileReason:{en:"Reason:",hi:":",ml:":"},profileBrand:{en:"Brand:",hi:":",ml:":"},historyBackToList:{en:"Back to List",hi:"  ",ml:" "},historyPrint:{en:"Print Report",hi:"  ",ml:"  "},historyReportTitle:{en:"Nutrition History Report",hi:"  ",ml:"  "},historyReportPatient:{en:"Patient:",hi:":",ml:":"},historyReportDate:{en:"Report Date:",hi:" :",ml:" :"},historyReportGoal:{en:"Calorie Goal:",hi:" :",ml:" :"},historyPatientHistory:{en:"{name}'s History",hi:"{name}  ",ml:"{name} "},historyMyHistory:{en:"My Nutrition History",hi:"  ",ml:"  "},historySearchPlaceholder:{en:"Search in history...",hi:"  ...",ml:" ..."},historyRisky:{en:"Risky",hi:" ",ml:""},historyReason:{en:"Reason:",hi:":",ml:":"},historyNoItems:{en:'No history items yet. Use the "Log Meal" tab to get started!',hi:'           "  "    !',ml:'  .  "  "  !'},historyNoMatch:{en:"No history items match your search.",hi:"         ",ml:"    ."}},fT=pe.createContext(void 0),qF=({children:t})=>{const[e,n]=pe.useState(()=>{const c=localStorage.getItem("app-language");return c&&["en","hi","ml"].includes(c)?c:"en"}),r=c=>{localStorage.setItem("app-language",c),n(c)},a=pe.useCallback((c,f)=>{const d=zF[c];if(!d)return console.warn(`Translation key '${c}' not found.`),c;let g=d[e]||d.en;return f&&Object.keys(f).forEach(x=>{g=g.replace(`{${x}}`,String(f[x]))}),g},[e]),s=pe.useMemo(()=>HF[e],[e]),l={language:e,setLanguage:r,t:a,languageName:s};return Vf.createElement(fT.Provider,{value:l},t)},Vt=()=>{const t=pe.useContext(fT);if(t===void 0)throw new Error("useI18n must be used within an I18nProvider");return t},$h=({onFileSelect:t,disabled:e})=>{const[n,r]=pe.useState(!1),a=pe.useRef(null),{t:s}=Vt(),l=T=>{T.preventDefault(),T.stopPropagation(),e||r(!0)},c=T=>{T.preventDefault(),T.stopPropagation(),r(!1)},f=T=>{T.preventDefault(),T.stopPropagation()},d=pe.useCallback(T=>{if(T.preventDefault(),T.stopPropagation(),r(!1),!e&&T.dataTransfer.files&&T.dataTransfer.files.length>0){const E=T.dataTransfer.files[0];E.type.startsWith("image/")?t(E):alert(s("uploaderDropError")),T.dataTransfer.clearData()}},[t,e,s]),g=T=>{T.target.files&&T.target.files.length>0&&t(T.target.files[0]),T.target.value=""},x=()=>{var T;(T=a.current)==null||T.click()},_=`relative block w-full max-w-lg mx-auto rounded-lg border-2 border-dashed p-12 text-center transition-all duration-300
    ${e?"cursor-not-allowed bg-slate-100 dark:bg-slate-800/50":"hover:border-brand-primary"}
    ${n?"border-brand-primary bg-brand-accent/10":"border-ui-border dark:border-slate-600"}`;return y.jsxs("div",{className:"flex flex-col items-center gap-4",children:[y.jsxs("div",{className:_,onDragEnter:l,onDragLeave:c,onDragOver:f,onDrop:d,children:[y.jsx("input",{type:"file",id:"file-upload",className:"sr-only",accept:"image/*",onChange:g,disabled:e}),y.jsxs("label",{htmlFor:"file-upload",className:e?"cursor-not-allowed":"cursor-pointer",children:[y.jsx(eT,{className:"mx-auto h-12 w-12 text-slate-400 dark:text-slate-500"}),y.jsx("span",{className:"mt-2 block text-sm font-semibold text-brand-primary",children:s("uploaderClick")}),y.jsx("span",{className:"block text-xs text-ui-text-secondary dark:text-slate-400",children:s("uploaderDrag")}),y.jsx("p",{className:"mt-2 text-xs text-slate-500 dark:text-slate-500",children:s("uploaderFormats")})]})]}),y.jsx("input",{type:"file",accept:"image/*",capture:"environment",ref:a,onChange:g,className:"sr-only",disabled:e}),y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx("hr",{className:"w-24 border-ui-border dark:border-slate-700"}),y.jsx("span",{className:"text-ui-text-secondary dark:text-slate-400 font-semibold",children:s("uploaderOr")}),y.jsx("hr",{className:"w-24 border-ui-border dark:border-slate-700"})]}),y.jsxs("button",{onClick:x,disabled:e,className:"flex items-center justify-center gap-2 px-6 py-3 bg-brand-primary text-white font-semibold rounded-lg hover:bg-brand-secondary transition-colors disabled:bg-slate-300 dark:disabled:bg-slate-700 disabled:cursor-not-allowed",children:[y.jsx(Mm,{className:"h-5 w-5"}),s("uploaderCamera")]})]})},Iy=({icon:t,label:e,value:n,unit:r,color:a,style:s})=>y.jsxs("div",{className:"flex flex-col items-center justify-center p-2 sm:p-4 rounded-lg bg-ui-bg dark:bg-slate-800 text-center animate-slide-up transform hover:scale-105 hover:shadow-lg",style:s,children:[y.jsx("div",{className:`mb-2 ${a}`,children:t}),y.jsx("p",{className:"text-xs sm:text-sm text-ui-text-secondary dark:text-slate-400",children:e}),y.jsx("p",{className:"text-lg sm:text-xl font-bold text-ui-text dark:text-slate-50",children:n}),y.jsx("p",{className:"text-xs text-ui-text-secondary/80 dark:text-slate-500",children:r})]}),jF=({analysis:t,imagePreview:e,onAddToDiary:n,onReset:r,onRefine:a,isLoading:s})=>{const{foodName:l,estimatedWeightGrams:c,nutrition:f,dietaryWarnings:d,safetyVerdict:g}=t,[x,_]=pe.useState(!1),[T,E]=pe.useState(""),{t:S}=Vt(),C=pe.useMemo(()=>d==null?void 0:d.some(I=>I.toLowerCase().includes("spoiled")||I.toLowerCase().includes("unsafe")),[d]),k=[{icon:y.jsx(Sm,{}),label:S("dashboardCalories"),key:"calories",unit:"kcal",color:"text-orange-400"},{icon:y.jsx(Em,{}),label:S("nutrientProtein"),key:"proteinGrams",unit:"g",color:"text-red-400"},{icon:y.jsx(bm,{}),label:S("nutrientFat"),key:"fatGrams",unit:"g",color:"text-yellow-400"},{icon:y.jsx(Cm,{}),label:S("nutrientCarbs"),key:"carbohydratesGrams",unit:"g",color:"text-blue-400"},{icon:y.jsx(Am,{}),label:S("nutrientSugar"),key:"sugarGrams",unit:"g",color:"text-purple-400"},{icon:y.jsx(km,{}),label:S("nutrientSodium"),key:"sodiumMilligrams",unit:"mg",color:"text-green-400"}],N=f.micronutrients?[{icon:y.jsx(xc,{}),label:S("nutrientIron"),key:"ironMg",unit:"mg",color:"text-red-500"},{icon:y.jsx(rT,{}),label:S("nutrientCalcium"),key:"calciumMg",unit:"mg",color:"text-slate-400"},{icon:y.jsx(nT,{}),label:S("nutrientPotassium"),key:"potassiumMg",unit:"mg",color:"text-green-500"},{icon:y.jsx(iT,{}),label:S("nutrientVitaminC"),key:"vitaminCMg",unit:"mg",color:"text-orange-500"},{icon:y.jsx(Nm,{}),label:S("nutrientVitaminA"),key:"vitaminAIU",unit:"IU",color:"text-yellow-500"},{icon:y.jsx(Dm,{}),label:S("nutrientVitaminD"),key:"vitaminDIU",unit:"IU",color:"text-blue-500"}].filter(I=>{var F;return((F=f.micronutrients)==null?void 0:F[I.key])!=null}):[],b=I=>{var P;if(["ironMg","calciumMg","potassiumMg","vitaminAIU","vitaminCMg","vitaminDIU"].includes(I)){const D=(P=f.micronutrients)==null?void 0:P[I];return typeof D=="number"?D.toFixed(1):S("na")}const F=f[I];return typeof F=="number"?F.toFixed(1):S("na")};return y.jsxs("div",{className:"w-full animate-fade-in flex flex-col lg:flex-row gap-6 lg:gap-8 items-start",children:[y.jsx("div",{className:"w-full lg:w-1/3 flex-shrink-0 animate-slide-up",children:y.jsxs("div",{className:"bg-ui-card dark:bg-slate-800 p-4 rounded-xl shadow-lg border border-ui-border dark:border-slate-700",children:[y.jsx("img",{src:e,alt:"Analyzed food",className:"w-full h-auto object-cover rounded-lg mb-4"}),y.jsx("h2",{className:"text-xl sm:text-2xl font-bold text-ui-text dark:text-slate-100 capitalize",children:l}),y.jsxs("p",{className:"text-sm sm:text-base text-ui-text-secondary dark:text-slate-400",children:[S("nutritionEstWeight"),y.jsxs("span",{className:"font-semibold text-brand-primary",children:[typeof c=="number"?c.toFixed(0):S("na")," g"]})]}),g&&y.jsxs("div",{className:`p-4 my-4 rounded-lg flex items-start gap-3 border animate-fade-in ${g.isSafe?"bg-status-ok-bg dark:bg-green-900/40 text-status-ok-text dark:text-green-200 border-green-300 dark:border-green-600":"bg-status-bad-bg dark:bg-red-900/40 text-status-bad-text dark:text-red-200 border-red-300 dark:border-red-600"}`,children:[g.isSafe?y.jsx(Rm,{className:"h-8 w-8 flex-shrink-0 mt-1"}):y.jsx(Qa,{className:"h-8 w-8 flex-shrink-0 mt-1"}),y.jsxs("div",{children:[y.jsx("h4",{className:"font-bold",children:g.isSafe?S("safetyVerdictSafe"):S("safetyVerdictRisky")}),y.jsx("p",{className:"text-sm",children:g.reason})]})]}),y.jsxs("div",{className:"mt-4 flex flex-col gap-2",children:[y.jsxs("button",{onClick:n,disabled:s||C,title:C?S("nutritionAddSpoiledError"):void 0,className:"w-full flex items-center justify-center gap-2 px-4 py-2 bg-brand-primary text-white font-semibold rounded-lg hover:bg-brand-secondary disabled:bg-slate-400 disabled:cursor-not-allowed",children:[y.jsx(qf,{className:"h-4 w-4"}),S("labelAddToDiary")]}),y.jsxs("button",{onClick:()=>_(!x),className:`w-full flex items-center justify-center gap-2 px-4 py-2 font-semibold rounded-lg ${x?"bg-brand-accent text-brand-primary":"bg-slate-200 text-slate-800 dark:bg-slate-700 dark:text-slate-200 hover:bg-slate-300 dark:hover:bg-slate-600"}`,children:[y.jsx(DF,{className:"h-4 w-4"}),S(x?"nutritionCancelRefine":"nutritionRefine")]}),y.jsxs("button",{onClick:r,disabled:s,className:"w-full flex items-center justify-center gap-2 px-4 py-2 bg-slate-200 text-slate-800 dark:bg-slate-700 dark:text-slate-200 font-semibold rounded-lg hover:bg-slate-300 dark:hover:bg-slate-600 disabled:bg-slate-400",children:[y.jsx(tT,{className:"h-4 w-4"}),S("nutritionAnalyzeNew")]})]})]})}),y.jsx("div",{className:"w-full lg:w-2/3 space-y-6",children:y.jsxs("div",{className:"bg-ui-card dark:bg-slate-800 p-4 sm:p-6 rounded-xl shadow-lg border border-ui-border dark:border-slate-700 animate-slide-up",style:{animationDelay:"100ms"},children:[y.jsx("h3",{className:"text-lg sm:text-xl font-bold mb-4 text-ui-text dark:text-slate-100",children:S("nutritionBreakdown")}),y.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2 sm:gap-4",children:k.map((I,F)=>y.jsx(Iy,{icon:I.icon,label:I.label,value:b(I.key),unit:I.unit,color:I.color,style:{animationDelay:`${F*50}ms`}},I.key))}),N.length>0&&y.jsxs(y.Fragment,{children:[y.jsx("h3",{className:"text-lg sm:text-xl font-bold mt-6 sm:mt-8 mb-4 text-ui-text dark:text-slate-100",children:S("labelMicronutrients")}),y.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2 sm:gap-4",children:N.map((I,F)=>y.jsx(Iy,{icon:I.icon,label:I.label,value:b(I.key),unit:I.unit,color:I.color,style:{animationDelay:`${F*50}ms`}},I.key))})]})]})})]})},$F=({rating:t})=>{const e=typeof t=="number"?t:0,r=(a=>a<=2?"text-red-500":a<4?"text-yellow-500":"text-green-500")(e);return y.jsx("div",{className:"flex items-center",children:[...Array(5)].map((a,s)=>y.jsx(aT,{className:`h-6 w-6 sm:h-8 sm:w-8 ${r}`,filled:s<e},s))})},Py=({icon:t,label:e,value:n,unit:r,color:a,style:s})=>y.jsxs("div",{className:"flex flex-col items-center justify-center p-2 sm:p-4 rounded-lg bg-ui-bg dark:bg-slate-800/50 text-center animate-slide-up transform hover:scale-105 hover:shadow-lg",style:s,children:[y.jsx("div",{className:`mb-2 ${a}`,children:t}),y.jsx("p",{className:"text-xs sm:text-sm text-ui-text-secondary dark:text-slate-400",children:e}),y.jsx("p",{className:"text-lg sm:text-xl font-bold text-ui-text dark:text-slate-50",children:n}),y.jsx("p",{className:"text-xs text-ui-text-secondary/80 dark:text-slate-500",children:r})]}),WF=({expiryDate:t})=>{const{t:e}=Vt(),n=pe.useMemo(()=>{try{const[r,a,s]=t.split("-").map(c=>parseInt(c,10));return new Date(r,a-1,s).toLocaleDateString("en-US")}catch{return t}},[t]);return y.jsxs("div",{className:"p-4 my-4 bg-status-bad-bg dark:bg-red-900/40 text-status-bad-text dark:text-red-200 rounded-lg flex items-start gap-3 border border-red-300 dark:border-red-600 animate-fade-in",children:[y.jsx(Qa,{className:"h-8 w-8 flex-shrink-0 mt-1"}),y.jsxs("div",{children:[y.jsx("h4",{className:"font-bold",children:e("labelExpiredTitle")}),y.jsx("p",{className:"text-sm",children:e("labelExpiredMessage",{date:n})})]})]})},YF=({analysis:t,imagePreview:e,onReset:n,onRefine:r,isLoading:a,mode:s,onAddToDiary:l,onAddToGroceryList:c})=>{const{productName:f,servingSizeGrams:d,nutrition:g,healthStars:x,healthSummary:_,expiryDate:T,dietaryWarnings:E,safetyVerdict:S}=t,[C,k]=pe.useState(!1),{t:N}=Vt(),b=pe.useMemo(()=>E==null?void 0:E.some(X=>X.toLowerCase().includes("spoiled")||X.toLowerCase().includes("unsafe")),[E]),I=pe.useMemo(()=>{if(!T||!/^\d{4}-\d{2}-\d{2}$/.test(T))return!1;const X=new Date;X.setHours(0,0,0,0);const[Z,ye,Me]=T.split("-").map(ee=>parseInt(ee,10)),Se=new Date(Z,ye-1,Me);return X>Se},[T]),F=[{icon:y.jsx(Sm,{}),label:N("dashboardCalories"),key:"calories",unit:"kcal",color:"text-orange-400"},{icon:y.jsx(Em,{}),label:N("nutrientProtein"),key:"proteinGrams",unit:"g",color:"text-red-400"},{icon:y.jsx(bm,{}),label:N("nutrientFat"),key:"fatGrams",unit:"g",color:"text-yellow-400"},{icon:y.jsx(Cm,{}),label:N("nutrientCarbs"),key:"carbohydratesGrams",unit:"g",color:"text-blue-400"},{icon:y.jsx(Am,{}),label:N("nutrientSugar"),key:"sugarGrams",unit:"g",color:"text-purple-400"},{icon:y.jsx(km,{}),label:N("nutrientSodium"),key:"sodiumMilligrams",unit:"mg",color:"text-green-400"}],P=g.micronutrients?[{icon:y.jsx(xc,{}),label:N("nutrientIron"),key:"ironMg",unit:"mg",color:"text-red-500"},{icon:y.jsx(rT,{}),label:N("nutrientCalcium"),key:"calciumMg",unit:"mg",color:"text-slate-400"},{icon:y.jsx(nT,{}),label:N("nutrientPotassium"),key:"potassiumMg",unit:"mg",color:"text-green-500"},{icon:y.jsx(iT,{}),label:N("nutrientVitaminC"),key:"vitaminCMg",unit:"mg",color:"text-orange-500"},{icon:y.jsx(Nm,{}),label:N("nutrientVitaminA"),key:"vitaminAIU",unit:"IU",color:"text-yellow-500"},{icon:y.jsx(Dm,{}),label:N("nutrientVitaminD"),key:"vitaminDIU",unit:"IU",color:"text-blue-500"}].filter(X=>{var Z;return((Z=g.micronutrients)==null?void 0:Z[X.key])!=null}):[],D=()=>{s==="diary"&&l?l():s==="grocery"&&c&&c({product_name:t.productName,brand_name:null,nutrition_info:t.nutrition,health_stars:t.healthStars})},j=X=>{var ye;if(["ironMg","calciumMg","potassiumMg","vitaminAIU","vitaminCMg","vitaminDIU"].includes(X)){const Me=(ye=g.micronutrients)==null?void 0:ye[X];return typeof Me=="number"?Me.toFixed(1):N("na")}const Z=g[X];return typeof Z=="number"?Z.toFixed(1):N("na")},B=N(s==="diary"?"labelAddToDiary":"labelAddToGrocery"),te=s==="diary"?y.jsx(qf,{className:"h-4 w-4"}):y.jsx(Fm,{className:"h-4 w-4"});return y.jsxs("div",{className:"w-full animate-fade-in flex flex-col lg:flex-row gap-6 lg:gap-8 items-start",children:[y.jsx("div",{className:"w-full lg:w-1/3 flex-shrink-0 animate-slide-up",children:y.jsxs("div",{className:"bg-ui-card dark:bg-slate-800 p-4 rounded-xl shadow-lg border border-ui-border dark:border-slate-700",children:[y.jsx("img",{src:e,alt:"Analyzed nutrition label",className:"w-full h-auto object-cover rounded-lg mb-4"}),y.jsx("h2",{className:"text-xl sm:text-2xl font-bold text-ui-text dark:text-slate-100 capitalize",children:f}),y.jsxs("p",{className:"text-sm sm:text-base text-ui-text-secondary dark:text-slate-400",children:[N("labelServingSize"),y.jsxs("span",{className:"font-semibold text-brand-primary",children:[typeof d=="number"?d.toFixed(0):N("na")," g"]})]}),I&&y.jsx(WF,{expiryDate:T}),S&&y.jsxs("div",{className:`p-4 my-4 rounded-lg flex items-start gap-3 border animate-fade-in ${S.isSafe?"bg-status-ok-bg dark:bg-green-900/40 text-status-ok-text dark:text-green-200 border-green-300 dark:border-green-600":"bg-status-bad-bg dark:bg-red-900/40 text-status-bad-text dark:text-red-200 border-red-300 dark:border-red-600"}`,children:[S.isSafe?y.jsx(Rm,{className:"h-8 w-8 flex-shrink-0 mt-1"}):y.jsx(Qa,{className:"h-8 w-8 flex-shrink-0 mt-1"}),y.jsxs("div",{children:[y.jsx("h4",{className:"font-bold",children:S.isSafe?N("safetyVerdictSafe"):N("safetyVerdictRisky")}),y.jsx("p",{className:"text-sm",children:S.reason})]})]}),y.jsxs("div",{className:"mt-4 flex flex-col gap-2",children:[y.jsxs("button",{onClick:D,disabled:a||I||b,title:b?N("labelAddSpoiledError"):I?N("labelAddExpiredError"):void 0,className:"w-full flex items-center justify-center gap-2 px-4 py-2 bg-brand-primary text-white font-semibold rounded-lg hover:bg-brand-secondary disabled:bg-slate-400 disabled:cursor-not-allowed",children:[te,B]}),y.jsxs("button",{onClick:n,disabled:a,className:"w-full flex items-center justify-center gap-2 px-4 py-2 bg-slate-200 text-slate-800 dark:bg-slate-700 dark:text-slate-200 font-semibold rounded-lg hover:bg-slate-300 dark:hover:bg-slate-600 disabled:bg-slate-400",children:[y.jsx(tT,{className:"h-4 w-4"}),N("labelAnalyzeNew")]})]})]})}),y.jsxs("div",{className:"w-full lg:w-2/3 space-y-6",children:[y.jsxs("div",{className:"bg-ui-card dark:bg-slate-800 p-4 sm:p-6 rounded-xl shadow-lg border border-ui-border dark:border-slate-700 animate-slide-up",style:{animationDelay:"100ms"},children:[y.jsxs("h3",{className:"text-lg sm:text-xl font-bold mb-3 text-ui-text dark:text-slate-100 flex items-center gap-2",children:[y.jsx(xc,{className:"h-6 w-6 text-brand-primary"})," ",N("labelHealthAssessment")]}),y.jsxs("div",{className:"flex flex-wrap items-center gap-2 sm:gap-4 mb-3",children:[y.jsx($F,{rating:x}),y.jsx("span",{className:"text-xl sm:text-2xl font-bold text-ui-text dark:text-slate-200",children:typeof x=="number"?N("labelStarsOutOf5",{stars:x.toFixed(1)}):N("na")})]}),y.jsx("p",{className:"text-ui-text-secondary dark:text-slate-300 text-sm sm:text-base",children:_})]}),y.jsxs("div",{className:"bg-ui-card dark:bg-slate-800 p-4 sm:p-6 rounded-xl shadow-lg border border-ui-border dark:border-slate-700 animate-slide-up",style:{animationDelay:"200ms"},children:[y.jsx("h3",{className:"text-lg sm:text-xl font-bold mb-4 text-ui-text dark:text-slate-100",children:N("labelNutritionalBreakdown",{size:typeof d=="number"?d.toFixed(0):N("na")})}),y.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2 sm:gap-4",children:F.map((X,Z)=>y.jsx(Py,{icon:X.icon,label:X.label,value:j(X.key),unit:X.unit,color:X.color,style:{animationDelay:`${Z*50}ms`}},X.key))}),P.length>0&&y.jsxs(y.Fragment,{children:[y.jsx("h3",{className:"text-lg sm:text-xl font-bold mt-6 sm:mt-8 mb-4 text-ui-text dark:text-slate-100",children:N("labelMicronutrients")}),y.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2 sm:gap-4",children:P.map((X,Z)=>y.jsx(Py,{icon:X.icon,label:X.label,value:j(X.key),unit:X.unit,color:X.color,style:{animationDelay:`${Z*50}ms`}},X.key))})]})]})]})]})},hn=({className:t})=>y.jsxs("svg",{className:t||"animate-spin h-12 w-12 text-brand-primary",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[y.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),y.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),dT=({history:t,userProfile:e,setView:n,onBack:r,userName:a})=>{const[s,l]=pe.useState(""),{t:c}=Vt(),f=pe.useMemo(()=>t.filter(g=>g.foodName.toLowerCase().includes(s.toLowerCase())),[t,s]),d=()=>{window.print()};return y.jsxs("div",{className:"w-full max-w-4xl mx-auto animate-fade-in space-y-6",children:[y.jsxs("div",{className:"flex flex-wrap justify-between items-center gap-4 no-print",children:[r?y.jsxs("button",{onClick:r,className:"flex items-center gap-2 px-4 py-2 text-sm font-semibold rounded-lg bg-ui-card dark:bg-slate-700 hover:bg-slate-100 dark:hover:bg-slate-600 transition-colors",children:[y.jsx(oT,{className:"h-4 w-4"}),c("historyBackToList")]}):y.jsx("div",{}),y.jsxs("button",{onClick:d,className:"flex items-center gap-2 px-4 py-2 text-sm font-semibold rounded-lg bg-brand-primary text-white hover:bg-brand-secondary transition-colors ml-auto",children:[y.jsx(LF,{className:"h-4 w-4"}),c("historyPrint")]})]}),y.jsxs("div",{className:"bg-ui-card dark:bg-slate-800 p-4 sm:p-6 rounded-xl shadow-lg border border-ui-border dark:border-slate-700 printable-report",children:[y.jsxs("div",{className:"print-only-header",children:[y.jsx("h1",{className:"text-xl font-bold mb-2",children:c("historyReportTitle")}),y.jsxs("div",{className:"grid grid-cols-2 gap-x-4 text-sm",children:[y.jsxs("p",{children:[y.jsx("strong",{children:c("historyReportPatient")})," ",a||e.fullName]}),y.jsxs("p",{children:[y.jsx("strong",{children:c("historyReportDate")})," ",new Date().toLocaleDateString()]}),y.jsxs("p",{children:[y.jsx("strong",{children:c("historyReportGoal")})," ",e.dailyCalorieGoal||c("na")," kcal"]})]})]}),y.jsx("h2",{className:"text-2xl font-bold text-ui-text dark:text-slate-100 mb-4",children:a?c("historyPatientHistory",{name:a}):c("historyMyHistory")}),y.jsx("div",{className:"mb-4 no-print",children:y.jsx("input",{type:"text",placeholder:c("historySearchPlaceholder"),value:s,onChange:g=>l(g.target.value),className:"w-full px-4 py-2 bg-slate-100 dark:bg-slate-700 border border-ui-border dark:border-slate-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-brand-primary"})}),y.jsx("div",{className:"space-y-4",children:f.length>0?f.map(g=>{const x=g.safetyVerdict&&!g.safetyVerdict.isSafe;return y.jsxs("div",{className:`p-4 rounded-lg border transition-colors ${x?"bg-status-bad-bg dark:bg-red-900/40 border-red-300 dark:border-red-600":"bg-slate-100 dark:bg-slate-900/50 border-transparent"}`,children:[y.jsxs("div",{className:"flex justify-between items-start",children:[y.jsxs("div",{children:[y.jsx("p",{className:`font-bold capitalize ${x?"text-status-bad-text dark:text-red-200":"text-ui-text dark:text-slate-200"}`,children:g.foodName}),y.jsxs("p",{className:"text-sm text-ui-text-secondary dark:text-slate-400",children:[new Date(g.date).toLocaleString()," - ",g.nutrition.calories.toFixed(0)," kcal"]})]}),x&&y.jsxs("div",{className:"flex-shrink-0 flex items-center gap-2 text-status-bad-text dark:text-red-200",title:g.safetyVerdict.reason,children:[y.jsx(Qa,{className:"h-5 w-5"}),y.jsx("span",{className:"text-sm font-semibold hidden sm:inline",children:c("historyRisky")})]})]}),x&&y.jsx("div",{className:"mt-2 p-2 bg-red-100/50 dark:bg-red-800/30 rounded-md",children:y.jsxs("p",{className:"text-sm text-status-bad-text dark:text-red-200",children:[y.jsx("span",{className:"font-semibold",children:c("historyReason")})," ",g.safetyVerdict.reason]})})]},g.id)}):y.jsx("p",{className:"text-center text-ui-text-secondary dark:text-slate-400 py-8",children:t.length===0?c("historyNoItems"):c("historyNoMatch")})})]})]})},JF="modulepreload",XF=function(t){return"/"+t},Ly={},Lc=function(e,n,r){let a=Promise.resolve();if(n&&n.length>0){let l=function(d){return Promise.all(d.map(g=>Promise.resolve(g).then(x=>({status:"fulfilled",value:x}),x=>({status:"rejected",reason:x}))))};document.getElementsByTagName("link");const c=document.querySelector("meta[property=csp-nonce]"),f=(c==null?void 0:c.nonce)||(c==null?void 0:c.getAttribute("nonce"));a=l(n.map(d=>{if(d=XF(d),d in Ly)return;Ly[d]=!0;const g=d.endsWith(".css"),x=g?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${x}`))return;const _=document.createElement("link");if(_.rel=g?"stylesheet":JF,g||(_.as="script"),_.crossOrigin="",_.href=d,f&&_.setAttribute("nonce",f),document.head.appendChild(_),g)return new Promise((T,E)=>{_.addEventListener("load",T),_.addEventListener("error",()=>E(new Error(`Unable to preload CSS for ${d}`)))})}))}function s(l){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=l,window.dispatchEvent(c),!c.defaultPrevented)throw l}return a.then(l=>{for(const c of l||[])c.status==="rejected"&&s(c.reason);return e().catch(s)})},KF=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...n)=>Lc(async()=>{const{default:r}=await Promise.resolve().then(()=>Yo);return{default:r}},void 0).then(({default:r})=>r(...n)):e=fetch,(...n)=>e(...n)};class Pm extends Error{constructor(e,n="FunctionsError",r){super(e),this.name=n,this.context=r}}class ZF extends Pm{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class Oy extends Pm{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class Uy extends Pm{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var Wh;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(Wh||(Wh={}));var QF=function(t,e,n,r){function a(s){return s instanceof n?s:new n(function(l){l(s)})}return new(n||(n=Promise))(function(s,l){function c(g){try{d(r.next(g))}catch(x){l(x)}}function f(g){try{d(r.throw(g))}catch(x){l(x)}}function d(g){g.done?s(g.value):a(g.value).then(c,f)}d((r=r.apply(t,e||[])).next())})};class e6{constructor(e,{headers:n={},customFetch:r,region:a=Wh.Any}={}){this.url=e,this.headers=n,this.region=a,this.fetch=KF(r)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,n={}){var r;return QF(this,void 0,void 0,function*(){try{const{headers:a,method:s,body:l}=n;let c={},{region:f}=n;f||(f=this.region);const d=new URL(`${this.url}/${e}`);f&&f!=="any"&&(c["x-region"]=f,d.searchParams.set("forceFunctionRegion",f));let g;l&&(a&&!Object.prototype.hasOwnProperty.call(a,"Content-Type")||!a)&&(typeof Blob<"u"&&l instanceof Blob||l instanceof ArrayBuffer?(c["Content-Type"]="application/octet-stream",g=l):typeof l=="string"?(c["Content-Type"]="text/plain",g=l):typeof FormData<"u"&&l instanceof FormData?g=l:(c["Content-Type"]="application/json",g=JSON.stringify(l)));const x=yield this.fetch(d.toString(),{method:s||"POST",headers:Object.assign(Object.assign(Object.assign({},c),this.headers),a),body:g}).catch(S=>{throw new ZF(S)}),_=x.headers.get("x-relay-error");if(_&&_==="true")throw new Oy(x);if(!x.ok)throw new Uy(x);let T=((r=x.headers.get("Content-Type"))!==null&&r!==void 0?r:"text/plain").split(";")[0].trim(),E;return T==="application/json"?E=yield x.json():T==="application/octet-stream"?E=yield x.blob():T==="text/event-stream"?E=x:T==="multipart/form-data"?E=yield x.formData():E=yield x.text(),{data:E,error:null,response:x}}catch(a){return{data:null,error:a,response:a instanceof Uy||a instanceof Oy?a.context:void 0}}})}}var Dn={},ho={},mo={},po={},go={},xo={},t6=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Uo=t6();const n6=Uo.fetch,hT=Uo.fetch.bind(Uo),mT=Uo.Headers,r6=Uo.Request,a6=Uo.Response,Yo=Object.freeze(Object.defineProperty({__proto__:null,Headers:mT,Request:r6,Response:a6,default:hT,fetch:n6},Symbol.toStringTag,{value:"Module"})),i6=KC(Yo);var rf={},By;function pT(){if(By)return rf;By=1,Object.defineProperty(rf,"__esModule",{value:!0});class t extends Error{constructor(n){super(n.message),this.name="PostgrestError",this.details=n.details,this.hint=n.hint,this.code=n.code}}return rf.default=t,rf}var Vy;function gT(){if(Vy)return xo;Vy=1;var t=xo&&xo.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(xo,"__esModule",{value:!0});const e=t(i6),n=t(pT());class r{constructor(s){this.shouldThrowOnError=!1,this.method=s.method,this.url=s.url,this.headers=s.headers,this.schema=s.schema,this.body=s.body,this.shouldThrowOnError=s.shouldThrowOnError,this.signal=s.signal,this.isMaybeSingle=s.isMaybeSingle,s.fetch?this.fetch=s.fetch:typeof fetch>"u"?this.fetch=e.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(s,l){return this.headers=Object.assign({},this.headers),this.headers[s]=l,this}then(s,l){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const c=this.fetch;let f=c(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async d=>{var g,x,_;let T=null,E=null,S=null,C=d.status,k=d.statusText;if(d.ok){if(this.method!=="HEAD"){const F=await d.text();F===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?E=F:E=JSON.parse(F))}const b=(g=this.headers.Prefer)===null||g===void 0?void 0:g.match(/count=(exact|planned|estimated)/),I=(x=d.headers.get("content-range"))===null||x===void 0?void 0:x.split("/");b&&I&&I.length>1&&(S=parseInt(I[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(E)&&(E.length>1?(T={code:"PGRST116",details:`Results contain ${E.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},E=null,S=null,C=406,k="Not Acceptable"):E.length===1?E=E[0]:E=null)}else{const b=await d.text();try{T=JSON.parse(b),Array.isArray(T)&&d.status===404&&(E=[],T=null,C=200,k="OK")}catch{d.status===404&&b===""?(C=204,k="No Content"):T={message:b}}if(T&&this.isMaybeSingle&&(!((_=T==null?void 0:T.details)===null||_===void 0)&&_.includes("0 rows"))&&(T=null,C=200,k="OK"),T&&this.shouldThrowOnError)throw new n.default(T)}return{error:T,data:E,count:S,status:C,statusText:k}});return this.shouldThrowOnError||(f=f.catch(d=>{var g,x,_;return{error:{message:`${(g=d==null?void 0:d.name)!==null&&g!==void 0?g:"FetchError"}: ${d==null?void 0:d.message}`,details:`${(x=d==null?void 0:d.stack)!==null&&x!==void 0?x:""}`,hint:"",code:`${(_=d==null?void 0:d.code)!==null&&_!==void 0?_:""}`},data:null,count:null,status:0,statusText:""}})),f.then(s,l)}returns(){return this}overrideTypes(){return this}}return xo.default=r,xo}var Gy;function xT(){if(Gy)return go;Gy=1;var t=go&&go.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(go,"__esModule",{value:!0});const e=t(gT());class n extends e.default{select(a){let s=!1;const l=(a??"*").split("").map(c=>/\s/.test(c)&&!s?"":(c==='"'&&(s=!s),c)).join("");return this.url.searchParams.set("select",l),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(a,{ascending:s=!0,nullsFirst:l,foreignTable:c,referencedTable:f=c}={}){const d=f?`${f}.order`:"order",g=this.url.searchParams.get(d);return this.url.searchParams.set(d,`${g?`${g},`:""}${a}.${s?"asc":"desc"}${l===void 0?"":l?".nullsfirst":".nullslast"}`),this}limit(a,{foreignTable:s,referencedTable:l=s}={}){const c=typeof l>"u"?"limit":`${l}.limit`;return this.url.searchParams.set(c,`${a}`),this}range(a,s,{foreignTable:l,referencedTable:c=l}={}){const f=typeof c>"u"?"offset":`${c}.offset`,d=typeof c>"u"?"limit":`${c}.limit`;return this.url.searchParams.set(f,`${a}`),this.url.searchParams.set(d,`${s-a+1}`),this}abortSignal(a){return this.signal=a,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:a=!1,verbose:s=!1,settings:l=!1,buffers:c=!1,wal:f=!1,format:d="text"}={}){var g;const x=[a?"analyze":null,s?"verbose":null,l?"settings":null,c?"buffers":null,f?"wal":null].filter(Boolean).join("|"),_=(g=this.headers.Accept)!==null&&g!==void 0?g:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${d}; for="${_}"; options=${x};`,d==="json"?this:this}rollback(){var a;return((a=this.headers.Prefer)!==null&&a!==void 0?a:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}}return go.default=n,go}var Hy;function Lm(){if(Hy)return po;Hy=1;var t=po&&po.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(po,"__esModule",{value:!0});const e=t(xT());class n extends e.default{eq(a,s){return this.url.searchParams.append(a,`eq.${s}`),this}neq(a,s){return this.url.searchParams.append(a,`neq.${s}`),this}gt(a,s){return this.url.searchParams.append(a,`gt.${s}`),this}gte(a,s){return this.url.searchParams.append(a,`gte.${s}`),this}lt(a,s){return this.url.searchParams.append(a,`lt.${s}`),this}lte(a,s){return this.url.searchParams.append(a,`lte.${s}`),this}like(a,s){return this.url.searchParams.append(a,`like.${s}`),this}likeAllOf(a,s){return this.url.searchParams.append(a,`like(all).{${s.join(",")}}`),this}likeAnyOf(a,s){return this.url.searchParams.append(a,`like(any).{${s.join(",")}}`),this}ilike(a,s){return this.url.searchParams.append(a,`ilike.${s}`),this}ilikeAllOf(a,s){return this.url.searchParams.append(a,`ilike(all).{${s.join(",")}}`),this}ilikeAnyOf(a,s){return this.url.searchParams.append(a,`ilike(any).{${s.join(",")}}`),this}is(a,s){return this.url.searchParams.append(a,`is.${s}`),this}in(a,s){const l=Array.from(new Set(s)).map(c=>typeof c=="string"&&new RegExp("[,()]").test(c)?`"${c}"`:`${c}`).join(",");return this.url.searchParams.append(a,`in.(${l})`),this}contains(a,s){return typeof s=="string"?this.url.searchParams.append(a,`cs.${s}`):Array.isArray(s)?this.url.searchParams.append(a,`cs.{${s.join(",")}}`):this.url.searchParams.append(a,`cs.${JSON.stringify(s)}`),this}containedBy(a,s){return typeof s=="string"?this.url.searchParams.append(a,`cd.${s}`):Array.isArray(s)?this.url.searchParams.append(a,`cd.{${s.join(",")}}`):this.url.searchParams.append(a,`cd.${JSON.stringify(s)}`),this}rangeGt(a,s){return this.url.searchParams.append(a,`sr.${s}`),this}rangeGte(a,s){return this.url.searchParams.append(a,`nxl.${s}`),this}rangeLt(a,s){return this.url.searchParams.append(a,`sl.${s}`),this}rangeLte(a,s){return this.url.searchParams.append(a,`nxr.${s}`),this}rangeAdjacent(a,s){return this.url.searchParams.append(a,`adj.${s}`),this}overlaps(a,s){return typeof s=="string"?this.url.searchParams.append(a,`ov.${s}`):this.url.searchParams.append(a,`ov.{${s.join(",")}}`),this}textSearch(a,s,{config:l,type:c}={}){let f="";c==="plain"?f="pl":c==="phrase"?f="ph":c==="websearch"&&(f="w");const d=l===void 0?"":`(${l})`;return this.url.searchParams.append(a,`${f}fts${d}.${s}`),this}match(a){return Object.entries(a).forEach(([s,l])=>{this.url.searchParams.append(s,`eq.${l}`)}),this}not(a,s,l){return this.url.searchParams.append(a,`not.${s}.${l}`),this}or(a,{foreignTable:s,referencedTable:l=s}={}){const c=l?`${l}.or`:"or";return this.url.searchParams.append(c,`(${a})`),this}filter(a,s,l){return this.url.searchParams.append(a,`${s}.${l}`),this}}return po.default=n,po}var zy;function vT(){if(zy)return mo;zy=1;var t=mo&&mo.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(mo,"__esModule",{value:!0});const e=t(Lm());class n{constructor(a,{headers:s={},schema:l,fetch:c}){this.url=a,this.headers=s,this.schema=l,this.fetch=c}select(a,{head:s=!1,count:l}={}){const c=s?"HEAD":"GET";let f=!1;const d=(a??"*").split("").map(g=>/\s/.test(g)&&!f?"":(g==='"'&&(f=!f),g)).join("");return this.url.searchParams.set("select",d),l&&(this.headers.Prefer=`count=${l}`),new e.default({method:c,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(a,{count:s,defaultToNull:l=!0}={}){const c="POST",f=[];if(this.headers.Prefer&&f.push(this.headers.Prefer),s&&f.push(`count=${s}`),l||f.push("missing=default"),this.headers.Prefer=f.join(","),Array.isArray(a)){const d=a.reduce((g,x)=>g.concat(Object.keys(x)),[]);if(d.length>0){const g=[...new Set(d)].map(x=>`"${x}"`);this.url.searchParams.set("columns",g.join(","))}}return new e.default({method:c,url:this.url,headers:this.headers,schema:this.schema,body:a,fetch:this.fetch,allowEmpty:!1})}upsert(a,{onConflict:s,ignoreDuplicates:l=!1,count:c,defaultToNull:f=!0}={}){const d="POST",g=[`resolution=${l?"ignore":"merge"}-duplicates`];if(s!==void 0&&this.url.searchParams.set("on_conflict",s),this.headers.Prefer&&g.push(this.headers.Prefer),c&&g.push(`count=${c}`),f||g.push("missing=default"),this.headers.Prefer=g.join(","),Array.isArray(a)){const x=a.reduce((_,T)=>_.concat(Object.keys(T)),[]);if(x.length>0){const _=[...new Set(x)].map(T=>`"${T}"`);this.url.searchParams.set("columns",_.join(","))}}return new e.default({method:d,url:this.url,headers:this.headers,schema:this.schema,body:a,fetch:this.fetch,allowEmpty:!1})}update(a,{count:s}={}){const l="PATCH",c=[];return this.headers.Prefer&&c.push(this.headers.Prefer),s&&c.push(`count=${s}`),this.headers.Prefer=c.join(","),new e.default({method:l,url:this.url,headers:this.headers,schema:this.schema,body:a,fetch:this.fetch,allowEmpty:!1})}delete({count:a}={}){const s="DELETE",l=[];return a&&l.push(`count=${a}`),this.headers.Prefer&&l.unshift(this.headers.Prefer),this.headers.Prefer=l.join(","),new e.default({method:s,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}}return mo.default=n,mo}var Xl={},Kl={},qy;function s6(){return qy||(qy=1,Object.defineProperty(Kl,"__esModule",{value:!0}),Kl.version=void 0,Kl.version="0.0.0-automated"),Kl}var jy;function o6(){if(jy)return Xl;jy=1,Object.defineProperty(Xl,"__esModule",{value:!0}),Xl.DEFAULT_HEADERS=void 0;const t=s6();return Xl.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${t.version}`},Xl}var $y;function l6(){if($y)return ho;$y=1;var t=ho&&ho.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(ho,"__esModule",{value:!0});const e=t(vT()),n=t(Lm()),r=o6();class a{constructor(l,{headers:c={},schema:f,fetch:d}={}){this.url=l,this.headers=Object.assign(Object.assign({},r.DEFAULT_HEADERS),c),this.schemaName=f,this.fetch=d}from(l){const c=new URL(`${this.url}/${l}`);return new e.default(c,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(l){return new a(this.url,{headers:this.headers,schema:l,fetch:this.fetch})}rpc(l,c={},{head:f=!1,get:d=!1,count:g}={}){let x;const _=new URL(`${this.url}/rpc/${l}`);let T;f||d?(x=f?"HEAD":"GET",Object.entries(c).filter(([S,C])=>C!==void 0).map(([S,C])=>[S,Array.isArray(C)?`{${C.join(",")}}`:`${C}`]).forEach(([S,C])=>{_.searchParams.append(S,C)})):(x="POST",T=c);const E=Object.assign({},this.headers);return g&&(E.Prefer=`count=${g}`),new n.default({method:x,url:_,headers:E,schema:this.schemaName,body:T,fetch:this.fetch,allowEmpty:!1})}}return ho.default=a,ho}var Wy;function c6(){if(Wy)return Dn;Wy=1;var t=Dn&&Dn.__importDefault||function(c){return c&&c.__esModule?c:{default:c}};Object.defineProperty(Dn,"__esModule",{value:!0}),Dn.PostgrestError=Dn.PostgrestBuilder=Dn.PostgrestTransformBuilder=Dn.PostgrestFilterBuilder=Dn.PostgrestQueryBuilder=Dn.PostgrestClient=void 0;const e=t(l6());Dn.PostgrestClient=e.default;const n=t(vT());Dn.PostgrestQueryBuilder=n.default;const r=t(Lm());Dn.PostgrestFilterBuilder=r.default;const a=t(xT());Dn.PostgrestTransformBuilder=a.default;const s=t(gT());Dn.PostgrestBuilder=s.default;const l=t(pT());return Dn.PostgrestError=l.default,Dn.default={PostgrestClient:e.default,PostgrestQueryBuilder:n.default,PostgrestFilterBuilder:r.default,PostgrestTransformBuilder:a.default,PostgrestBuilder:s.default,PostgrestError:l.default},Dn}var u6=c6();const f6=mm(u6),{PostgrestClient:d6,PostgrestQueryBuilder:Mz,PostgrestFilterBuilder:Dz,PostgrestTransformBuilder:Rz,PostgrestBuilder:Fz,PostgrestError:Iz}=f6;function h6(){if(typeof WebSocket<"u")return WebSocket;if(typeof global.WebSocket<"u")return global.WebSocket;if(typeof window.WebSocket<"u")return window.WebSocket;if(typeof self.WebSocket<"u")return self.WebSocket;throw new Error("`WebSocket` is not supported in this environment")}const m6=h6(),p6="2.11.15",g6=`realtime-js/${p6}`,x6="1.0.0",yT=1e4,v6=1e3;var oc;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(oc||(oc={}));var Xn;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(Xn||(Xn={}));var oa;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(oa||(oa={}));var Yh;(function(t){t.websocket="websocket"})(Yh||(Yh={}));var cs;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(cs||(cs={}));class y6{constructor(){this.HEADER_LENGTH=1}decode(e,n){return e.constructor===ArrayBuffer?n(this._binaryDecode(e)):n(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const n=new DataView(e),r=new TextDecoder;return this._decodeBroadcast(e,n,r)}_decodeBroadcast(e,n,r){const a=n.getUint8(1),s=n.getUint8(2);let l=this.HEADER_LENGTH+2;const c=r.decode(e.slice(l,l+a));l=l+a;const f=r.decode(e.slice(l,l+s));l=l+s;const d=JSON.parse(r.decode(e.slice(l,e.byteLength)));return{ref:null,topic:c,event:f,payload:d}}}class _T{constructor(e,n){this.callback=e,this.timerCalc=n,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=n}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Wt;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(Wt||(Wt={}));const Yy=(t,e,n={})=>{var r;const a=(r=n.skipTypes)!==null&&r!==void 0?r:[];return Object.keys(e).reduce((s,l)=>(s[l]=_6(l,t,e,a),s),{})},_6=(t,e,n,r)=>{const a=e.find(c=>c.name===t),s=a==null?void 0:a.type,l=n[t];return s&&!r.includes(s)?TT(s,l):Jh(l)},TT=(t,e)=>{if(t.charAt(0)==="_"){const n=t.slice(1,t.length);return E6(e,n)}switch(t){case Wt.bool:return T6(e);case Wt.float4:case Wt.float8:case Wt.int2:case Wt.int4:case Wt.int8:case Wt.numeric:case Wt.oid:return w6(e);case Wt.json:case Wt.jsonb:return S6(e);case Wt.timestamp:return C6(e);case Wt.abstime:case Wt.date:case Wt.daterange:case Wt.int4range:case Wt.int8range:case Wt.money:case Wt.reltime:case Wt.text:case Wt.time:case Wt.timestamptz:case Wt.timetz:case Wt.tsrange:case Wt.tstzrange:return Jh(e);default:return Jh(e)}},Jh=t=>t,T6=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},w6=t=>{if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return e}return t},S6=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch(e){return console.log(`JSON parse error: ${e}`),t}return t},E6=(t,e)=>{if(typeof t!="string")return t;const n=t.length-1,r=t[n];if(t[0]==="{"&&r==="}"){let s;const l=t.slice(1,n);try{s=JSON.parse("["+l+"]")}catch{s=l?l.split(","):[]}return s.map(c=>TT(e,c))}return t},C6=t=>typeof t=="string"?t.replace(" ","T"):t,wT=t=>{let e=t;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")};class mh{constructor(e,n,r={},a=yT){this.channel=e,this.event=n,this.payload=r,this.timeout=a,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,n){var r;return this._hasReceived(e)&&n((r=this.receivedResp)===null||r===void 0?void 0:r.response),this.recHooks.push({status:e,callback:n}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=n=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=n,this._matchReceive(n)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,n){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:n})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:n}){this.recHooks.filter(r=>r.status===e).forEach(r=>r.callback(n))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var Jy;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(Jy||(Jy={}));class lc{constructor(e,n){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=(n==null?void 0:n.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},a=>{const{onJoin:s,onLeave:l,onSync:c}=this.caller;this.joinRef=this.channel._joinRef(),this.state=lc.syncState(this.state,a,s,l),this.pendingDiffs.forEach(f=>{this.state=lc.syncDiff(this.state,f,s,l)}),this.pendingDiffs=[],c()}),this.channel._on(r.diff,{},a=>{const{onJoin:s,onLeave:l,onSync:c}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(a):(this.state=lc.syncDiff(this.state,a,s,l),c())}),this.onJoin((a,s,l)=>{this.channel._trigger("presence",{event:"join",key:a,currentPresences:s,newPresences:l})}),this.onLeave((a,s,l)=>{this.channel._trigger("presence",{event:"leave",key:a,currentPresences:s,leftPresences:l})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,n,r,a){const s=this.cloneDeep(e),l=this.transformState(n),c={},f={};return this.map(s,(d,g)=>{l[d]||(f[d]=g)}),this.map(l,(d,g)=>{const x=s[d];if(x){const _=g.map(C=>C.presence_ref),T=x.map(C=>C.presence_ref),E=g.filter(C=>T.indexOf(C.presence_ref)<0),S=x.filter(C=>_.indexOf(C.presence_ref)<0);E.length>0&&(c[d]=E),S.length>0&&(f[d]=S)}else c[d]=g}),this.syncDiff(s,{joins:c,leaves:f},r,a)}static syncDiff(e,n,r,a){const{joins:s,leaves:l}={joins:this.transformState(n.joins),leaves:this.transformState(n.leaves)};return r||(r=()=>{}),a||(a=()=>{}),this.map(s,(c,f)=>{var d;const g=(d=e[c])!==null&&d!==void 0?d:[];if(e[c]=this.cloneDeep(f),g.length>0){const x=e[c].map(T=>T.presence_ref),_=g.filter(T=>x.indexOf(T.presence_ref)<0);e[c].unshift(..._)}r(c,g,f)}),this.map(l,(c,f)=>{let d=e[c];if(!d)return;const g=f.map(x=>x.presence_ref);d=d.filter(x=>g.indexOf(x.presence_ref)<0),e[c]=d,a(c,d,f),d.length===0&&delete e[c]}),e}static map(e,n){return Object.getOwnPropertyNames(e).map(r=>n(r,e[r]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((n,r)=>{const a=e[r];return"metas"in a?n[r]=a.metas.map(s=>(s.presence_ref=s.phx_ref,delete s.phx_ref,delete s.phx_ref_prev,s)):n[r]=a,n},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Xy;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(Xy||(Xy={}));var Ky;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"})(Ky||(Ky={}));var qa;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(qa||(qa={}));class Om{constructor(e,n={config:{}},r){this.topic=e,this.params=n,this.socket=r,this.bindings={},this.state=Xn.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},n.config),this.timeout=this.socket.timeout,this.joinPush=new mh(this,oa.join,this.params,this.timeout),this.rejoinTimer=new _T(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Xn.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(a=>a.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Xn.closed,this.socket._remove(this)}),this._onError(a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=Xn.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Xn.errored,this.rejoinTimer.scheduleTimeout())}),this._on(oa.reply,{},(a,s)=>{this._trigger(this._replyEventName(s),a)}),this.presence=new lc(this),this.broadcastEndpointURL=wT(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(e,n=this.timeout){var r,a;if(this.socket.isConnected()||this.socket.connect(),this.state==Xn.closed){const{config:{broadcast:s,presence:l,private:c}}=this.params;this._onError(g=>e==null?void 0:e(qa.CHANNEL_ERROR,g)),this._onClose(()=>e==null?void 0:e(qa.CLOSED));const f={},d={broadcast:s,presence:l,postgres_changes:(a=(r=this.bindings.postgres_changes)===null||r===void 0?void 0:r.map(g=>g.filter))!==null&&a!==void 0?a:[],private:c};this.socket.accessTokenValue&&(f.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:d},f)),this.joinedOnce=!0,this._rejoin(n),this.joinPush.receive("ok",async({postgres_changes:g})=>{var x;if(this.socket.setAuth(),g===void 0){e==null||e(qa.SUBSCRIBED);return}else{const _=this.bindings.postgres_changes,T=(x=_==null?void 0:_.length)!==null&&x!==void 0?x:0,E=[];for(let S=0;S<T;S++){const C=_[S],{filter:{event:k,schema:N,table:b,filter:I}}=C,F=g&&g[S];if(F&&F.event===k&&F.schema===N&&F.table===b&&F.filter===I)E.push(Object.assign(Object.assign({},C),{id:F.id}));else{this.unsubscribe(),this.state=Xn.errored,e==null||e(qa.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=E,e&&e(qa.SUBSCRIBED);return}}).receive("error",g=>{this.state=Xn.errored,e==null||e(qa.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(g).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(qa.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,n={}){return await this.send({type:"presence",event:"track",payload:e},n.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,n,r){return this._on(e,n,r)}async send(e,n={}){var r,a;if(!this._canPush()&&e.type==="broadcast"){const{event:s,payload:l}=e,f={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:s,payload:l,private:this.private}]})};try{const d=await this._fetchWithTimeout(this.broadcastEndpointURL,f,(r=n.timeout)!==null&&r!==void 0?r:this.timeout);return await((a=d.body)===null||a===void 0?void 0:a.cancel()),d.ok?"ok":"error"}catch(d){return d.name==="AbortError"?"timed out":"error"}}else return new Promise(s=>{var l,c,f;const d=this._push(e.type,e,n.timeout||this.timeout);e.type==="broadcast"&&!(!((f=(c=(l=this.params)===null||l===void 0?void 0:l.config)===null||c===void 0?void 0:c.broadcast)===null||f===void 0)&&f.ack)&&s("ok"),d.receive("ok",()=>s("ok")),d.receive("error",()=>s("error")),d.receive("timeout",()=>s("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=Xn.leaving;const n=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(oa.close,"leave",this._joinRef())};this.joinPush.destroy();let r=null;return new Promise(a=>{r=new mh(this,oa.leave,{},e),r.receive("ok",()=>{n(),a("ok")}).receive("timeout",()=>{n(),a("timed out")}).receive("error",()=>{a("error")}),r.send(),this._canPush()||r.trigger("ok",{})}).finally(()=>{r==null||r.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.rejoinTimer&&clearTimeout(this.rejoinTimer.timer),this.joinPush.destroy()}async _fetchWithTimeout(e,n,r){const a=new AbortController,s=setTimeout(()=>a.abort(),r),l=await this.socket.fetch(e,Object.assign(Object.assign({},n),{signal:a.signal}));return clearTimeout(s),l}_push(e,n,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let a=new mh(this,e,n,r);return this._canPush()?a.send():(a.startTimeout(),this.pushBuffer.push(a)),a}_onMessage(e,n,r){return n}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,n,r){var a,s;const l=e.toLocaleLowerCase(),{close:c,error:f,leave:d,join:g}=oa;if(r&&[c,f,d,g].indexOf(l)>=0&&r!==this._joinRef())return;let _=this._onMessage(l,n,r);if(n&&!_)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(l)?(a=this.bindings.postgres_changes)===null||a===void 0||a.filter(T=>{var E,S,C;return((E=T.filter)===null||E===void 0?void 0:E.event)==="*"||((C=(S=T.filter)===null||S===void 0?void 0:S.event)===null||C===void 0?void 0:C.toLocaleLowerCase())===l}).map(T=>T.callback(_,r)):(s=this.bindings[l])===null||s===void 0||s.filter(T=>{var E,S,C,k,N,b;if(["broadcast","presence","postgres_changes"].includes(l))if("id"in T){const I=T.id,F=(E=T.filter)===null||E===void 0?void 0:E.event;return I&&((S=n.ids)===null||S===void 0?void 0:S.includes(I))&&(F==="*"||(F==null?void 0:F.toLocaleLowerCase())===((C=n.data)===null||C===void 0?void 0:C.type.toLocaleLowerCase()))}else{const I=(N=(k=T==null?void 0:T.filter)===null||k===void 0?void 0:k.event)===null||N===void 0?void 0:N.toLocaleLowerCase();return I==="*"||I===((b=n==null?void 0:n.event)===null||b===void 0?void 0:b.toLocaleLowerCase())}else return T.type.toLocaleLowerCase()===l}).map(T=>{if(typeof _=="object"&&"ids"in _){const E=_.data,{schema:S,table:C,commit_timestamp:k,type:N,errors:b}=E;_=Object.assign(Object.assign({},{schema:S,table:C,commit_timestamp:k,eventType:N,new:{},old:{},errors:b}),this._getPayloadRecords(E))}T.callback(_,r)})}_isClosed(){return this.state===Xn.closed}_isJoined(){return this.state===Xn.joined}_isJoining(){return this.state===Xn.joining}_isLeaving(){return this.state===Xn.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,n,r){const a=e.toLocaleLowerCase(),s={type:a,filter:n,callback:r};return this.bindings[a]?this.bindings[a].push(s):this.bindings[a]=[s],this}_off(e,n){const r=e.toLocaleLowerCase();return this.bindings[r]=this.bindings[r].filter(a=>{var s;return!(((s=a.type)===null||s===void 0?void 0:s.toLocaleLowerCase())===r&&Om.isEqual(a.filter,n))}),this}static isEqual(e,n){if(Object.keys(e).length!==Object.keys(n).length)return!1;for(const r in e)if(e[r]!==n[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(oa.close,{},e)}_onError(e){this._on(oa.error,{},n=>e(n))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Xn.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const n={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(n.new=Yy(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(n.old=Yy(e.columns,e.old_record)),n}}const Zy=()=>{},b6=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class A6{constructor(e,n){var r;this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=yT,this.heartbeatIntervalMs=25e3,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Zy,this.ref=0,this.logger=Zy,this.conn=null,this.sendBuffer=[],this.serializer=new y6,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=s=>{let l;return s?l=s:typeof fetch>"u"?l=(...c)=>Lc(async()=>{const{default:f}=await Promise.resolve().then(()=>Yo);return{default:f}},void 0).then(({default:f})=>f(...c)):l=fetch,(...c)=>l(...c)},this.endPoint=`${e}/${Yh.websocket}`,this.httpEndpoint=wT(e),n!=null&&n.transport?this.transport=n.transport:this.transport=null,n!=null&&n.params&&(this.params=n.params),n!=null&&n.timeout&&(this.timeout=n.timeout),n!=null&&n.logger&&(this.logger=n.logger),(n!=null&&n.logLevel||n!=null&&n.log_level)&&(this.logLevel=n.logLevel||n.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),n!=null&&n.heartbeatIntervalMs&&(this.heartbeatIntervalMs=n.heartbeatIntervalMs);const a=(r=n==null?void 0:n.params)===null||r===void 0?void 0:r.apikey;if(a&&(this.accessTokenValue=a,this.apiKey=a),this.reconnectAfterMs=n!=null&&n.reconnectAfterMs?n.reconnectAfterMs:s=>[1e3,2e3,5e3,1e4][s-1]||1e4,this.encode=n!=null&&n.encode?n.encode:(s,l)=>l(JSON.stringify(s)),this.decode=n!=null&&n.decode?n.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new _T(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(n==null?void 0:n.fetch),n!=null&&n.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(n==null?void 0:n.worker)||!1,this.workerUrl=n==null?void 0:n.workerUrl}this.accessToken=(n==null?void 0:n.accessToken)||null}connect(){if(!this.conn){if(this.transport||(this.transport=m6),!this.transport)throw new Error("No transport provided");this.conn=new this.transport(this.endpointURL()),this.setupConnection()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:x6}))}disconnect(e,n){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,n??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset(),this.channels.forEach(r=>r.teardown()))}getChannels(){return this.channels}async removeChannel(e){const n=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),n}async removeAllChannels(){const e=await Promise.all(this.channels.map(n=>n.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,n,r){this.logger(e,n,r)}connectionState(){switch(this.conn&&this.conn.readyState){case oc.connecting:return cs.Connecting;case oc.open:return cs.Open;case oc.closing:return cs.Closing;default:return cs.Closed}}isConnected(){return this.connectionState()===cs.Open}channel(e,n={config:{}}){const r=`realtime:${e}`,a=this.getChannels().find(s=>s.topic===r);if(a)return a;{const s=new Om(`realtime:${e}`,n,this);return this.channels.push(s),s}}push(e){const{topic:n,event:r,payload:a,ref:s}=e,l=()=>{this.encode(e,c=>{var f;(f=this.conn)===null||f===void 0||f.send(c)})};this.log("push",`${n} ${r} (${s})`,a),this.isConnected()?l():this.sendBuffer.push(l)}async setAuth(e=null){let n=e||this.accessToken&&await this.accessToken()||this.accessTokenValue;this.accessTokenValue!=n&&(this.accessTokenValue=n,this.channels.forEach(r=>{const a={access_token:n,version:g6};n&&r.updateJoinPayload(a),r.joinedOnce&&r._isJoined()&&r._push(oa.access_token,{access_token:n})}))}async sendHeartbeat(){var e;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),(e=this.conn)===null||e===void 0||e.close(v6,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),await this.setAuth()}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let n=this.channels.find(r=>r.topic===e&&(r._isJoined()||r._isJoining()));n&&(this.log("transport",`leaving duplicate topic "${e}"`),n.unsubscribe())}_remove(e){this.channels=this.channels.filter(n=>n.topic!==e.topic)}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_onConnMessage(e){this.decode(e.data,n=>{let{topic:r,event:a,payload:s,ref:l}=n;r==="phoenix"&&a==="phx_reply"&&this.heartbeatCallback(n.payload.status=="ok"?"ok":"error"),l&&l===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${s.status||""} ${r} ${a} ${l&&"("+l+")"||""}`,s),Array.from(this.channels).filter(c=>c._isMember(r)).forEach(c=>c._trigger(a,s,l)),this.stateChangeCallbacks.message.forEach(c=>c(n))})}_onConnOpen(){this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this.stateChangeCallbacks.open.forEach(e=>e())}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=n=>{this.log("worker","worker error",n.message),this.workerRef.terminate()},this.workerRef.onmessage=n=>{n.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(n=>n(e))}_onConnError(e){this.log("transport",`${e}`),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(n=>n(e))}_triggerChanError(){this.channels.forEach(e=>e._trigger(oa.error))}_appendParams(e,n){if(Object.keys(n).length===0)return e;const r=e.match(/\?/)?"&":"?",a=new URLSearchParams(n);return`${e}${r}${a}`}_workerObjectUrl(e){let n;if(e)n=e;else{const r=new Blob([b6],{type:"application/javascript"});n=URL.createObjectURL(r)}return n}}class Um extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function Rn(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}class k6 extends Um{constructor(e,n){super(e),this.name="StorageApiError",this.status=n}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class Xh extends Um{constructor(e,n){super(e),this.name="StorageUnknownError",this.originalError=n}}var N6=function(t,e,n,r){function a(s){return s instanceof n?s:new n(function(l){l(s)})}return new(n||(n=Promise))(function(s,l){function c(g){try{d(r.next(g))}catch(x){l(x)}}function f(g){try{d(r.throw(g))}catch(x){l(x)}}function d(g){g.done?s(g.value):a(g.value).then(c,f)}d((r=r.apply(t,e||[])).next())})};const ST=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...n)=>Lc(async()=>{const{default:r}=await Promise.resolve().then(()=>Yo);return{default:r}},void 0).then(({default:r})=>r(...n)):e=fetch,(...n)=>e(...n)},M6=()=>N6(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Lc(()=>Promise.resolve().then(()=>Yo),void 0)).Response:Response}),Kh=t=>{if(Array.isArray(t))return t.map(n=>Kh(n));if(typeof t=="function"||t!==Object(t))return t;const e={};return Object.entries(t).forEach(([n,r])=>{const a=n.replace(/([-_][a-z])/gi,s=>s.toUpperCase().replace(/[-_]/g,""));e[a]=Kh(r)}),e};var Cs=function(t,e,n,r){function a(s){return s instanceof n?s:new n(function(l){l(s)})}return new(n||(n=Promise))(function(s,l){function c(g){try{d(r.next(g))}catch(x){l(x)}}function f(g){try{d(r.throw(g))}catch(x){l(x)}}function d(g){g.done?s(g.value):a(g.value).then(c,f)}d((r=r.apply(t,e||[])).next())})};const ph=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),D6=(t,e,n)=>Cs(void 0,void 0,void 0,function*(){const r=yield M6();t instanceof r&&!(n!=null&&n.noResolveJson)?t.json().then(a=>{e(new k6(ph(a),t.status||500))}).catch(a=>{e(new Xh(ph(a),a))}):e(new Xh(ph(t),t))}),R6=(t,e,n,r)=>{const a={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),r&&(a.body=JSON.stringify(r)),Object.assign(Object.assign({},a),n))};function Oc(t,e,n,r,a,s){return Cs(this,void 0,void 0,function*(){return new Promise((l,c)=>{t(n,R6(e,r,a,s)).then(f=>{if(!f.ok)throw f;return r!=null&&r.noResolveJson?f:f.json()}).then(f=>l(f)).catch(f=>D6(f,c,r))})})}function Cf(t,e,n,r){return Cs(this,void 0,void 0,function*(){return Oc(t,"GET",e,n,r)})}function Mi(t,e,n,r,a){return Cs(this,void 0,void 0,function*(){return Oc(t,"POST",e,r,a,n)})}function F6(t,e,n,r,a){return Cs(this,void 0,void 0,function*(){return Oc(t,"PUT",e,r,a,n)})}function I6(t,e,n,r){return Cs(this,void 0,void 0,function*(){return Oc(t,"HEAD",e,Object.assign(Object.assign({},n),{noResolveJson:!0}),r)})}function ET(t,e,n,r,a){return Cs(this,void 0,void 0,function*(){return Oc(t,"DELETE",e,r,a,n)})}var pr=function(t,e,n,r){function a(s){return s instanceof n?s:new n(function(l){l(s)})}return new(n||(n=Promise))(function(s,l){function c(g){try{d(r.next(g))}catch(x){l(x)}}function f(g){try{d(r.throw(g))}catch(x){l(x)}}function d(g){g.done?s(g.value):a(g.value).then(c,f)}d((r=r.apply(t,e||[])).next())})};const P6={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Qy={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class L6{constructor(e,n={},r,a){this.url=e,this.headers=n,this.bucketId=r,this.fetch=ST(a)}uploadOrUpdate(e,n,r,a){return pr(this,void 0,void 0,function*(){try{let s;const l=Object.assign(Object.assign({},Qy),a);let c=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(l.upsert)});const f=l.metadata;typeof Blob<"u"&&r instanceof Blob?(s=new FormData,s.append("cacheControl",l.cacheControl),f&&s.append("metadata",this.encodeMetadata(f)),s.append("",r)):typeof FormData<"u"&&r instanceof FormData?(s=r,s.append("cacheControl",l.cacheControl),f&&s.append("metadata",this.encodeMetadata(f))):(s=r,c["cache-control"]=`max-age=${l.cacheControl}`,c["content-type"]=l.contentType,f&&(c["x-metadata"]=this.toBase64(this.encodeMetadata(f)))),a!=null&&a.headers&&(c=Object.assign(Object.assign({},c),a.headers));const d=this._removeEmptyFolders(n),g=this._getFinalPath(d),x=yield this.fetch(`${this.url}/object/${g}`,Object.assign({method:e,body:s,headers:c},l!=null&&l.duplex?{duplex:l.duplex}:{})),_=yield x.json();return x.ok?{data:{path:d,id:_.Id,fullPath:_.Key},error:null}:{data:null,error:_}}catch(s){if(Rn(s))return{data:null,error:s};throw s}})}upload(e,n,r){return pr(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,n,r)})}uploadToSignedUrl(e,n,r,a){return pr(this,void 0,void 0,function*(){const s=this._removeEmptyFolders(e),l=this._getFinalPath(s),c=new URL(this.url+`/object/upload/sign/${l}`);c.searchParams.set("token",n);try{let f;const d=Object.assign({upsert:Qy.upsert},a),g=Object.assign(Object.assign({},this.headers),{"x-upsert":String(d.upsert)});typeof Blob<"u"&&r instanceof Blob?(f=new FormData,f.append("cacheControl",d.cacheControl),f.append("",r)):typeof FormData<"u"&&r instanceof FormData?(f=r,f.append("cacheControl",d.cacheControl)):(f=r,g["cache-control"]=`max-age=${d.cacheControl}`,g["content-type"]=d.contentType);const x=yield this.fetch(c.toString(),{method:"PUT",body:f,headers:g}),_=yield x.json();return x.ok?{data:{path:s,fullPath:_.Key},error:null}:{data:null,error:_}}catch(f){if(Rn(f))return{data:null,error:f};throw f}})}createSignedUploadUrl(e,n){return pr(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e);const a=Object.assign({},this.headers);n!=null&&n.upsert&&(a["x-upsert"]="true");const s=yield Mi(this.fetch,`${this.url}/object/upload/sign/${r}`,{},{headers:a}),l=new URL(this.url+s.url),c=l.searchParams.get("token");if(!c)throw new Um("No token returned by API");return{data:{signedUrl:l.toString(),path:e,token:c},error:null}}catch(r){if(Rn(r))return{data:null,error:r};throw r}})}update(e,n,r){return pr(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,n,r)})}move(e,n,r){return pr(this,void 0,void 0,function*(){try{return{data:yield Mi(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:n,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers}),error:null}}catch(a){if(Rn(a))return{data:null,error:a};throw a}})}copy(e,n,r){return pr(this,void 0,void 0,function*(){try{return{data:{path:(yield Mi(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:n,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers})).Key},error:null}}catch(a){if(Rn(a))return{data:null,error:a};throw a}})}createSignedUrl(e,n,r){return pr(this,void 0,void 0,function*(){try{let a=this._getFinalPath(e),s=yield Mi(this.fetch,`${this.url}/object/sign/${a}`,Object.assign({expiresIn:n},r!=null&&r.transform?{transform:r.transform}:{}),{headers:this.headers});const l=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return s={signedUrl:encodeURI(`${this.url}${s.signedURL}${l}`)},{data:s,error:null}}catch(a){if(Rn(a))return{data:null,error:a};throw a}})}createSignedUrls(e,n,r){return pr(this,void 0,void 0,function*(){try{const a=yield Mi(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:n,paths:e},{headers:this.headers}),s=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return{data:a.map(l=>Object.assign(Object.assign({},l),{signedUrl:l.signedURL?encodeURI(`${this.url}${l.signedURL}${s}`):null})),error:null}}catch(a){if(Rn(a))return{data:null,error:a};throw a}})}download(e,n){return pr(this,void 0,void 0,function*(){const a=typeof(n==null?void 0:n.transform)<"u"?"render/image/authenticated":"object",s=this.transformOptsToQueryString((n==null?void 0:n.transform)||{}),l=s?`?${s}`:"";try{const c=this._getFinalPath(e);return{data:yield(yield Cf(this.fetch,`${this.url}/${a}/${c}${l}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(c){if(Rn(c))return{data:null,error:c};throw c}})}info(e){return pr(this,void 0,void 0,function*(){const n=this._getFinalPath(e);try{const r=yield Cf(this.fetch,`${this.url}/object/info/${n}`,{headers:this.headers});return{data:Kh(r),error:null}}catch(r){if(Rn(r))return{data:null,error:r};throw r}})}exists(e){return pr(this,void 0,void 0,function*(){const n=this._getFinalPath(e);try{return yield I6(this.fetch,`${this.url}/object/${n}`,{headers:this.headers}),{data:!0,error:null}}catch(r){if(Rn(r)&&r instanceof Xh){const a=r.originalError;if([400,404].includes(a==null?void 0:a.status))return{data:!1,error:r}}throw r}})}getPublicUrl(e,n){const r=this._getFinalPath(e),a=[],s=n!=null&&n.download?`download=${n.download===!0?"":n.download}`:"";s!==""&&a.push(s);const c=typeof(n==null?void 0:n.transform)<"u"?"render/image":"object",f=this.transformOptsToQueryString((n==null?void 0:n.transform)||{});f!==""&&a.push(f);let d=a.join("&");return d!==""&&(d=`?${d}`),{data:{publicUrl:encodeURI(`${this.url}/${c}/public/${r}${d}`)}}}remove(e){return pr(this,void 0,void 0,function*(){try{return{data:yield ET(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(n){if(Rn(n))return{data:null,error:n};throw n}})}list(e,n,r){return pr(this,void 0,void 0,function*(){try{const a=Object.assign(Object.assign(Object.assign({},P6),n),{prefix:e||""});return{data:yield Mi(this.fetch,`${this.url}/object/list/${this.bucketId}`,a,{headers:this.headers},r),error:null}}catch(a){if(Rn(a))return{data:null,error:a};throw a}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const n=[];return e.width&&n.push(`width=${e.width}`),e.height&&n.push(`height=${e.height}`),e.resize&&n.push(`resize=${e.resize}`),e.format&&n.push(`format=${e.format}`),e.quality&&n.push(`quality=${e.quality}`),n.join("&")}}const O6="2.7.1",U6={"X-Client-Info":`storage-js/${O6}`};var vo=function(t,e,n,r){function a(s){return s instanceof n?s:new n(function(l){l(s)})}return new(n||(n=Promise))(function(s,l){function c(g){try{d(r.next(g))}catch(x){l(x)}}function f(g){try{d(r.throw(g))}catch(x){l(x)}}function d(g){g.done?s(g.value):a(g.value).then(c,f)}d((r=r.apply(t,e||[])).next())})};class B6{constructor(e,n={},r){this.url=e,this.headers=Object.assign(Object.assign({},U6),n),this.fetch=ST(r)}listBuckets(){return vo(this,void 0,void 0,function*(){try{return{data:yield Cf(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(Rn(e))return{data:null,error:e};throw e}})}getBucket(e){return vo(this,void 0,void 0,function*(){try{return{data:yield Cf(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(n){if(Rn(n))return{data:null,error:n};throw n}})}createBucket(e,n={public:!1}){return vo(this,void 0,void 0,function*(){try{return{data:yield Mi(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(Rn(r))return{data:null,error:r};throw r}})}updateBucket(e,n){return vo(this,void 0,void 0,function*(){try{return{data:yield F6(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(Rn(r))return{data:null,error:r};throw r}})}emptyBucket(e){return vo(this,void 0,void 0,function*(){try{return{data:yield Mi(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(n){if(Rn(n))return{data:null,error:n};throw n}})}deleteBucket(e){return vo(this,void 0,void 0,function*(){try{return{data:yield ET(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(n){if(Rn(n))return{data:null,error:n};throw n}})}}class V6 extends B6{constructor(e,n={},r){super(e,n,r)}from(e){return new L6(this.url,this.headers,e,this.fetch)}}const G6="2.51.0";let tc="";typeof Deno<"u"?tc="deno":typeof document<"u"?tc="web":typeof navigator<"u"&&navigator.product==="ReactNative"?tc="react-native":tc="node";const H6={"X-Client-Info":`supabase-js-${tc}/${G6}`},z6={headers:H6},q6={schema:"public"},j6={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},$6={};var W6=function(t,e,n,r){function a(s){return s instanceof n?s:new n(function(l){l(s)})}return new(n||(n=Promise))(function(s,l){function c(g){try{d(r.next(g))}catch(x){l(x)}}function f(g){try{d(r.throw(g))}catch(x){l(x)}}function d(g){g.done?s(g.value):a(g.value).then(c,f)}d((r=r.apply(t,e||[])).next())})};const Y6=t=>{let e;return t?e=t:typeof fetch>"u"?e=hT:e=fetch,(...n)=>e(...n)},J6=()=>typeof Headers>"u"?mT:Headers,X6=(t,e,n)=>{const r=Y6(n),a=J6();return(s,l)=>W6(void 0,void 0,void 0,function*(){var c;const f=(c=yield e())!==null&&c!==void 0?c:t;let d=new a(l==null?void 0:l.headers);return d.has("apikey")||d.set("apikey",t),d.has("Authorization")||d.set("Authorization",`Bearer ${f}`),r(s,Object.assign(Object.assign({},l),{headers:d}))})};var K6=function(t,e,n,r){function a(s){return s instanceof n?s:new n(function(l){l(s)})}return new(n||(n=Promise))(function(s,l){function c(g){try{d(r.next(g))}catch(x){l(x)}}function f(g){try{d(r.throw(g))}catch(x){l(x)}}function d(g){g.done?s(g.value):a(g.value).then(c,f)}d((r=r.apply(t,e||[])).next())})};function Z6(t){return t.endsWith("/")?t:t+"/"}function Q6(t,e){var n,r;const{db:a,auth:s,realtime:l,global:c}=t,{db:f,auth:d,realtime:g,global:x}=e,_={db:Object.assign(Object.assign({},f),a),auth:Object.assign(Object.assign({},d),s),realtime:Object.assign(Object.assign({},g),l),global:Object.assign(Object.assign(Object.assign({},x),c),{headers:Object.assign(Object.assign({},(n=x==null?void 0:x.headers)!==null&&n!==void 0?n:{}),(r=c==null?void 0:c.headers)!==null&&r!==void 0?r:{})}),accessToken:()=>K6(this,void 0,void 0,function*(){return""})};return t.accessToken?_.accessToken=t.accessToken:delete _.accessToken,_}const CT="2.71.0",bo=30*1e3,Zh=3,gh=Zh*bo,e8="http://localhost:9999",t8="supabase.auth.token",n8={"X-Client-Info":`gotrue-js/${CT}`},Qh="X-Supabase-Api-Version",bT={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},r8=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,a8=10*60*1e3;class Bm extends Error{constructor(e,n,r){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=n,this.code=r}}function tt(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class i8 extends Bm{constructor(e,n,r){super(e,n,r),this.name="AuthApiError",this.status=n,this.code=r}}function s8(t){return tt(t)&&t.name==="AuthApiError"}class AT extends Bm{constructor(e,n){super(e),this.name="AuthUnknownError",this.originalError=n}}class Ui extends Bm{constructor(e,n,r,a){super(e,r,a),this.name=n,this.status=r}}class Ni extends Ui{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function o8(t){return tt(t)&&t.name==="AuthSessionMissingError"}class af extends Ui{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class sf extends Ui{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class of extends Ui{constructor(e,n=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function l8(t){return tt(t)&&t.name==="AuthImplicitGrantRedirectError"}class e_ extends Ui{constructor(e,n=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class em extends Ui{constructor(e,n){super(e,"AuthRetryableFetchError",n,void 0)}}function xh(t){return tt(t)&&t.name==="AuthRetryableFetchError"}class t_ extends Ui{constructor(e,n,r){super(e,"AuthWeakPasswordError",n,"weak_password"),this.reasons=r}}class tm extends Ui{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const bf="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),n_=` 	
\r=`.split(""),c8=(()=>{const t=new Array(128);for(let e=0;e<t.length;e+=1)t[e]=-1;for(let e=0;e<n_.length;e+=1)t[n_[e].charCodeAt(0)]=-2;for(let e=0;e<bf.length;e+=1)t[bf[e].charCodeAt(0)]=e;return t})();function r_(t,e,n){if(t!==null)for(e.queue=e.queue<<8|t,e.queuedBits+=8;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;n(bf[r]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;n(bf[r]),e.queuedBits-=6}}function kT(t,e,n){const r=c8[t];if(r>-1)for(e.queue=e.queue<<6|r,e.queuedBits+=6;e.queuedBits>=8;)n(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(r===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(t)}"`)}}function a_(t){const e=[],n=l=>{e.push(String.fromCodePoint(l))},r={utf8seq:0,codepoint:0},a={queue:0,queuedBits:0},s=l=>{d8(l,r,n)};for(let l=0;l<t.length;l+=1)kT(t.charCodeAt(l),a,s);return e.join("")}function u8(t,e){if(t<=127){e(t);return}else if(t<=2047){e(192|t>>6),e(128|t&63);return}else if(t<=65535){e(224|t>>12),e(128|t>>6&63),e(128|t&63);return}else if(t<=1114111){e(240|t>>18),e(128|t>>12&63),e(128|t>>6&63),e(128|t&63);return}throw new Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}function f8(t,e){for(let n=0;n<t.length;n+=1){let r=t.charCodeAt(n);if(r>55295&&r<=56319){const a=(r-55296)*1024&65535;r=(t.charCodeAt(n+1)-56320&65535|a)+65536,n+=1}u8(r,e)}}function d8(t,e,n){if(e.utf8seq===0){if(t<=127){n(t);return}for(let r=1;r<6;r+=1)if((t>>7-r&1)===0){e.utf8seq=r;break}if(e.utf8seq===2)e.codepoint=t&31;else if(e.utf8seq===3)e.codepoint=t&15;else if(e.utf8seq===4)e.codepoint=t&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(t<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|t&63,e.utf8seq-=1,e.utf8seq===0&&n(e.codepoint)}}function h8(t){const e=[],n={queue:0,queuedBits:0},r=a=>{e.push(a)};for(let a=0;a<t.length;a+=1)kT(t.charCodeAt(a),n,r);return new Uint8Array(e)}function m8(t){const e=[];return f8(t,n=>e.push(n)),new Uint8Array(e)}function p8(t){const e=[],n={queue:0,queuedBits:0},r=a=>{e.push(a)};return t.forEach(a=>r_(a,n,r)),r_(null,n,r),e.join("")}function g8(t){return Math.round(Date.now()/1e3)+t}function x8(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const e=Math.random()*16|0;return(t=="x"?e:e&3|8).toString(16)})}const sa=()=>typeof window<"u"&&typeof document<"u",ss={tested:!1,writable:!1},NT=()=>{if(!sa())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(ss.tested)return ss.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),ss.tested=!0,ss.writable=!0}catch{ss.tested=!0,ss.writable=!1}return ss.writable};function v8(t){const e={},n=new URL(t);if(n.hash&&n.hash[0]==="#")try{new URLSearchParams(n.hash.substring(1)).forEach((a,s)=>{e[s]=a})}catch{}return n.searchParams.forEach((r,a)=>{e[a]=r}),e}const MT=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...n)=>Lc(async()=>{const{default:r}=await Promise.resolve().then(()=>Yo);return{default:r}},void 0).then(({default:r})=>r(...n)):e=fetch,(...n)=>e(...n)},y8=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",Ao=async(t,e,n)=>{await t.setItem(e,JSON.stringify(n))},os=async(t,e)=>{const n=await t.getItem(e);if(!n)return null;try{return JSON.parse(n)}catch{return n}},Ai=async(t,e)=>{await t.removeItem(e)};class $f{constructor(){this.promise=new $f.promiseConstructor((e,n)=>{this.resolve=e,this.reject=n})}}$f.promiseConstructor=Promise;function vh(t){const e=t.split(".");if(e.length!==3)throw new tm("Invalid JWT structure");for(let r=0;r<e.length;r++)if(!r8.test(e[r]))throw new tm("JWT not in base64url format");return{header:JSON.parse(a_(e[0])),payload:JSON.parse(a_(e[1])),signature:h8(e[2]),raw:{header:e[0],payload:e[1]}}}async function _8(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function T8(t,e){return new Promise((r,a)=>{(async()=>{for(let s=0;s<1/0;s++)try{const l=await t(s);if(!e(s,null,l)){r(l);return}}catch(l){if(!e(s,l)){a(l);return}}})()})}function w8(t){return("0"+t.toString(16)).substr(-2)}function S8(){const e=new Uint32Array(56);if(typeof crypto>"u"){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",r=n.length;let a="";for(let s=0;s<56;s++)a+=n.charAt(Math.floor(Math.random()*r));return a}return crypto.getRandomValues(e),Array.from(e,w8).join("")}async function E8(t){const n=new TextEncoder().encode(t),r=await crypto.subtle.digest("SHA-256",n),a=new Uint8Array(r);return Array.from(a).map(s=>String.fromCharCode(s)).join("")}async function C8(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const n=await E8(t);return btoa(n).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function yo(t,e,n=!1){const r=S8();let a=r;n&&(a+="/PASSWORD_RECOVERY"),await Ao(t,`${e}-code-verifier`,a);const s=await C8(r);return[s,r===s?"plain":"s256"]}const b8=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function A8(t){const e=t.headers.get(Qh);if(!e||!e.match(b8))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function k8(t){if(!t)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(t<=e)throw new Error("JWT has expired")}function N8(t){switch(t){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const M8=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function _o(t){if(!M8.test(t))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function yh(){const t={};return new Proxy(t,{get:(e,n)=>{if(n==="__isUserNotAvailableProxy")return!0;if(typeof n=="symbol"){const r=n.toString();if(r==="Symbol(Symbol.toPrimitive)"||r==="Symbol(Symbol.toStringTag)"||r==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${n}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}var D8=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,r=Object.getOwnPropertySymbols(t);a<r.length;a++)e.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(t,r[a])&&(n[r[a]]=t[r[a]]);return n};const ls=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),R8=[502,503,504];async function i_(t){var e;if(!y8(t))throw new em(ls(t),0);if(R8.includes(t.status))throw new em(ls(t),t.status);let n;try{n=await t.json()}catch(s){throw new AT(ls(s),s)}let r;const a=A8(t);if(a&&a.getTime()>=bT["2024-01-01"].timestamp&&typeof n=="object"&&n&&typeof n.code=="string"?r=n.code:typeof n=="object"&&n&&typeof n.error_code=="string"&&(r=n.error_code),r){if(r==="weak_password")throw new t_(ls(n),t.status,((e=n.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(r==="session_not_found")throw new Ni}else if(typeof n=="object"&&n&&typeof n.weak_password=="object"&&n.weak_password&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.reasons.reduce((s,l)=>s&&typeof l=="string",!0))throw new t_(ls(n),t.status,n.weak_password.reasons);throw new i8(ls(n),t.status||500,r)}const F8=(t,e,n,r)=>{const a={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),a.body=JSON.stringify(r),Object.assign(Object.assign({},a),n))};async function mt(t,e,n,r){var a;const s=Object.assign({},r==null?void 0:r.headers);s[Qh]||(s[Qh]=bT["2024-01-01"].name),r!=null&&r.jwt&&(s.Authorization=`Bearer ${r.jwt}`);const l=(a=r==null?void 0:r.query)!==null&&a!==void 0?a:{};r!=null&&r.redirectTo&&(l.redirect_to=r.redirectTo);const c=Object.keys(l).length?"?"+new URLSearchParams(l).toString():"",f=await I8(t,e,n+c,{headers:s,noResolveJson:r==null?void 0:r.noResolveJson},{},r==null?void 0:r.body);return r!=null&&r.xform?r==null?void 0:r.xform(f):{data:Object.assign({},f),error:null}}async function I8(t,e,n,r,a,s){const l=F8(e,r,a,s);let c;try{c=await t(n,Object.assign({},l))}catch(f){throw console.error(f),new em(ls(f),0)}if(c.ok||await i_(c),r!=null&&r.noResolveJson)return c;try{return await c.json()}catch(f){await i_(f)}}function za(t){var e;let n=null;U8(t)&&(n=Object.assign({},t),t.expires_at||(n.expires_at=g8(t.expires_in)));const r=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:n,user:r},error:null}}function s_(t){const e=za(t);return!e.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((n,r)=>n&&typeof r=="string",!0)&&(e.data.weak_password=t.weak_password),e}function Di(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function P8(t){return{data:t,error:null}}function L8(t){const{action_link:e,email_otp:n,hashed_token:r,redirect_to:a,verification_type:s}=t,l=D8(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),c={action_link:e,email_otp:n,hashed_token:r,redirect_to:a,verification_type:s},f=Object.assign({},l);return{data:{properties:c,user:f},error:null}}function O8(t){return t}function U8(t){return t.access_token&&t.refresh_token&&t.expires_in}const _h=["global","local","others"];var B8=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,r=Object.getOwnPropertySymbols(t);a<r.length;a++)e.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(t,r[a])&&(n[r[a]]=t[r[a]]);return n};class V8{constructor({url:e="",headers:n={},fetch:r}){this.url=e,this.headers=n,this.fetch=MT(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,n=_h[0]){if(_h.indexOf(n)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${_h.join(", ")}`);try{return await mt(this.fetch,"POST",`${this.url}/logout?scope=${n}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(r){if(tt(r))return{data:null,error:r};throw r}}async inviteUserByEmail(e,n={}){try{return await mt(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:n.data},headers:this.headers,redirectTo:n.redirectTo,xform:Di})}catch(r){if(tt(r))return{data:{user:null},error:r};throw r}}async generateLink(e){try{const{options:n}=e,r=B8(e,["options"]),a=Object.assign(Object.assign({},r),n);return"newEmail"in r&&(a.new_email=r==null?void 0:r.newEmail,delete a.newEmail),await mt(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:a,headers:this.headers,xform:L8,redirectTo:n==null?void 0:n.redirectTo})}catch(n){if(tt(n))return{data:{properties:null,user:null},error:n};throw n}}async createUser(e){try{return await mt(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Di})}catch(n){if(tt(n))return{data:{user:null},error:n};throw n}}async listUsers(e){var n,r,a,s,l,c,f;try{const d={nextPage:null,lastPage:0,total:0},g=await mt(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(n=e==null?void 0:e.page)===null||n===void 0?void 0:n.toString())!==null&&r!==void 0?r:"",per_page:(s=(a=e==null?void 0:e.perPage)===null||a===void 0?void 0:a.toString())!==null&&s!==void 0?s:""},xform:O8});if(g.error)throw g.error;const x=await g.json(),_=(l=g.headers.get("x-total-count"))!==null&&l!==void 0?l:0,T=(f=(c=g.headers.get("link"))===null||c===void 0?void 0:c.split(","))!==null&&f!==void 0?f:[];return T.length>0&&(T.forEach(E=>{const S=parseInt(E.split(";")[0].split("=")[1].substring(0,1)),C=JSON.parse(E.split(";")[1].split("=")[1]);d[`${C}Page`]=S}),d.total=parseInt(_)),{data:Object.assign(Object.assign({},x),d),error:null}}catch(d){if(tt(d))return{data:{users:[]},error:d};throw d}}async getUserById(e){_o(e);try{return await mt(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Di})}catch(n){if(tt(n))return{data:{user:null},error:n};throw n}}async updateUserById(e,n){_o(e);try{return await mt(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:n,headers:this.headers,xform:Di})}catch(r){if(tt(r))return{data:{user:null},error:r};throw r}}async deleteUser(e,n=!1){_o(e);try{return await mt(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:n},xform:Di})}catch(r){if(tt(r))return{data:{user:null},error:r};throw r}}async _listFactors(e){_o(e.userId);try{const{data:n,error:r}=await mt(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:a=>({data:{factors:a},error:null})});return{data:n,error:r}}catch(n){if(tt(n))return{data:null,error:n};throw n}}async _deleteFactor(e){_o(e.userId),_o(e.id);try{return{data:await mt(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(n){if(tt(n))return{data:null,error:n};throw n}}}function o_(t={}){return{getItem:e=>t[e]||null,setItem:(e,n)=>{t[e]=n},removeItem:e=>{delete t[e]}}}function G8(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const To={debug:!!(globalThis&&NT()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class DT extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class H8 extends DT{}async function z8(t,e,n){To.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,e);const r=new globalThis.AbortController;return e>0&&setTimeout(()=>{r.abort(),To.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},async a=>{if(a){To.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,a.name);try{return await n()}finally{To.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,a.name)}}else{if(e===0)throw To.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new H8(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(To.debug)try{const s=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(s,null,"  "))}catch(s){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",s)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await n()}}))}G8();const q8={url:e8,storageKey:t8,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:n8,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function l_(t,e,n){return await n()}const wo={};class vc{constructor(e){var n,r;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=vc.nextInstanceID,vc.nextInstanceID+=1,this.instanceID>0&&sa()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const a=Object.assign(Object.assign({},q8),e);if(this.logDebugMessages=!!a.debug,typeof a.debug=="function"&&(this.logger=a.debug),this.persistSession=a.persistSession,this.storageKey=a.storageKey,this.autoRefreshToken=a.autoRefreshToken,this.admin=new V8({url:a.url,headers:a.headers,fetch:a.fetch}),this.url=a.url,this.headers=a.headers,this.fetch=MT(a.fetch),this.lock=a.lock||l_,this.detectSessionInUrl=a.detectSessionInUrl,this.flowType=a.flowType,this.hasCustomAuthorizationHeader=a.hasCustomAuthorizationHeader,a.lock?this.lock=a.lock:sa()&&(!((n=globalThis==null?void 0:globalThis.navigator)===null||n===void 0)&&n.locks)?this.lock=z8:this.lock=l_,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(a.storage?this.storage=a.storage:NT()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=o_(this.memoryStorage)),a.userStorage&&(this.userStorage=a.userStorage)):(this.memoryStorage={},this.storage=o_(this.memoryStorage)),sa()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(s){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",s)}(r=this.broadcastChannel)===null||r===void 0||r.addEventListener("message",async s=>{this._debug("received broadcast notification from other tab or client",s),await this._notifyAllSubscribers(s.data.event,s.data.session,!1)})}this.initialize()}get jwks(){var e,n;return(n=(e=wo[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&n!==void 0?n:{keys:[]}}set jwks(e){wo[this.storageKey]=Object.assign(Object.assign({},wo[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,n;return(n=(e=wo[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&n!==void 0?n:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){wo[this.storageKey]=Object.assign(Object.assign({},wo[this.storageKey]),{cachedAt:e})}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${CT}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const n=v8(window.location.href);let r="none";if(this._isImplicitGrantCallback(n)?r="implicit":await this._isPKCECallback(n)&&(r="pkce"),sa()&&this.detectSessionInUrl&&r!=="none"){const{data:a,error:s}=await this._getSessionFromURL(n,r);if(s){if(this._debug("#_initialize()","error detecting session from URL",s),l8(s)){const f=(e=s.details)===null||e===void 0?void 0:e.code;if(f==="identity_already_exists"||f==="identity_not_found"||f==="single_identity_not_deletable")return{error:s}}return await this._removeSession(),{error:s}}const{session:l,redirectType:c}=a;return this._debug("#_initialize()","detected session in URL",l,"redirect type",c),await this._saveSession(l),setTimeout(async()=>{c==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",l):await this._notifyAllSubscribers("SIGNED_IN",l)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(n){return tt(n)?{error:n}:{error:new AT("Unexpected error during initialization",n)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var n,r,a;try{const s=await mt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(r=(n=e==null?void 0:e.options)===null||n===void 0?void 0:n.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:(a=e==null?void 0:e.options)===null||a===void 0?void 0:a.captchaToken}},xform:za}),{data:l,error:c}=s;if(c||!l)return{data:{user:null,session:null},error:c};const f=l.session,d=l.user;return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",f)),{data:{user:d,session:f},error:null}}catch(s){if(tt(s))return{data:{user:null,session:null},error:s};throw s}}async signUp(e){var n,r,a;try{let s;if("email"in e){const{email:g,password:x,options:_}=e;let T=null,E=null;this.flowType==="pkce"&&([T,E]=await yo(this.storage,this.storageKey)),s=await mt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:_==null?void 0:_.emailRedirectTo,body:{email:g,password:x,data:(n=_==null?void 0:_.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:_==null?void 0:_.captchaToken},code_challenge:T,code_challenge_method:E},xform:za})}else if("phone"in e){const{phone:g,password:x,options:_}=e;s=await mt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:g,password:x,data:(r=_==null?void 0:_.data)!==null&&r!==void 0?r:{},channel:(a=_==null?void 0:_.channel)!==null&&a!==void 0?a:"sms",gotrue_meta_security:{captcha_token:_==null?void 0:_.captchaToken}},xform:za})}else throw new sf("You must provide either an email or phone number and a password");const{data:l,error:c}=s;if(c||!l)return{data:{user:null,session:null},error:c};const f=l.session,d=l.user;return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",f)),{data:{user:d,session:f},error:null}}catch(s){if(tt(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithPassword(e){try{let n;if("email"in e){const{email:s,password:l,options:c}=e;n=await mt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:s,password:l,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken}},xform:s_})}else if("phone"in e){const{phone:s,password:l,options:c}=e;n=await mt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:s,password:l,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken}},xform:s_})}else throw new sf("You must provide either an email or phone number and a password");const{data:r,error:a}=n;return a?{data:{user:null,session:null},error:a}:!r||!r.session||!r.user?{data:{user:null,session:null},error:new af}:(r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:a})}catch(n){if(tt(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOAuth(e){var n,r,a,s;return await this._handleProviderSignIn(e.provider,{redirectTo:(n=e.options)===null||n===void 0?void 0:n.redirectTo,scopes:(r=e.options)===null||r===void 0?void 0:r.scopes,queryParams:(a=e.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:(s=e.options)===null||s===void 0?void 0:s.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:n}=e;if(n==="solana")return await this.signInWithSolana(e);throw new Error(`@supabase/auth-js: Unsupported chain "${n}"`)}async signInWithSolana(e){var n,r,a,s,l,c,f,d,g,x,_,T;let E,S;if("message"in e)E=e.message,S=e.signature;else{const{chain:C,wallet:k,statement:N,options:b}=e;let I;if(sa())if(typeof k=="object")I=k;else{const P=window;if("solana"in P&&typeof P.solana=="object"&&("signIn"in P.solana&&typeof P.solana.signIn=="function"||"signMessage"in P.solana&&typeof P.solana.signMessage=="function"))I=P.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof k!="object"||!(b!=null&&b.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");I=k}const F=new URL((n=b==null?void 0:b.url)!==null&&n!==void 0?n:window.location.href);if("signIn"in I&&I.signIn){const P=await I.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},b==null?void 0:b.signInWithSolana),{version:"1",domain:F.host,uri:F.href}),N?{statement:N}:null));let D;if(Array.isArray(P)&&P[0]&&typeof P[0]=="object")D=P[0];else if(P&&typeof P=="object"&&"signedMessage"in P&&"signature"in P)D=P;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in D&&"signature"in D&&(typeof D.signedMessage=="string"||D.signedMessage instanceof Uint8Array)&&D.signature instanceof Uint8Array)E=typeof D.signedMessage=="string"?D.signedMessage:new TextDecoder().decode(D.signedMessage),S=D.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in I)||typeof I.signMessage!="function"||!("publicKey"in I)||typeof I!="object"||!I.publicKey||!("toBase58"in I.publicKey)||typeof I.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");E=[`${F.host} wants you to sign in with your Solana account:`,I.publicKey.toBase58(),...N?["",N,""]:[""],"Version: 1",`URI: ${F.href}`,`Issued At: ${(a=(r=b==null?void 0:b.signInWithSolana)===null||r===void 0?void 0:r.issuedAt)!==null&&a!==void 0?a:new Date().toISOString()}`,...!((s=b==null?void 0:b.signInWithSolana)===null||s===void 0)&&s.notBefore?[`Not Before: ${b.signInWithSolana.notBefore}`]:[],...!((l=b==null?void 0:b.signInWithSolana)===null||l===void 0)&&l.expirationTime?[`Expiration Time: ${b.signInWithSolana.expirationTime}`]:[],...!((c=b==null?void 0:b.signInWithSolana)===null||c===void 0)&&c.chainId?[`Chain ID: ${b.signInWithSolana.chainId}`]:[],...!((f=b==null?void 0:b.signInWithSolana)===null||f===void 0)&&f.nonce?[`Nonce: ${b.signInWithSolana.nonce}`]:[],...!((d=b==null?void 0:b.signInWithSolana)===null||d===void 0)&&d.requestId?[`Request ID: ${b.signInWithSolana.requestId}`]:[],...!((x=(g=b==null?void 0:b.signInWithSolana)===null||g===void 0?void 0:g.resources)===null||x===void 0)&&x.length?["Resources",...b.signInWithSolana.resources.map(D=>`- ${D}`)]:[]].join(`
`);const P=await I.signMessage(new TextEncoder().encode(E),"utf8");if(!P||!(P instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");S=P}}try{const{data:C,error:k}=await mt(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:E,signature:p8(S)},!((_=e.options)===null||_===void 0)&&_.captchaToken?{gotrue_meta_security:{captcha_token:(T=e.options)===null||T===void 0?void 0:T.captchaToken}}:null),xform:za});if(k)throw k;return!C||!C.session||!C.user?{data:{user:null,session:null},error:new af}:(C.session&&(await this._saveSession(C.session),await this._notifyAllSubscribers("SIGNED_IN",C.session)),{data:Object.assign({},C),error:k})}catch(C){if(tt(C))return{data:{user:null,session:null},error:C};throw C}}async _exchangeCodeForSession(e){const n=await os(this.storage,`${this.storageKey}-code-verifier`),[r,a]=(n??"").split("/");try{const{data:s,error:l}=await mt(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:r},xform:za});if(await Ai(this.storage,`${this.storageKey}-code-verifier`),l)throw l;return!s||!s.session||!s.user?{data:{user:null,session:null,redirectType:null},error:new af}:(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign(Object.assign({},s),{redirectType:a??null}),error:l})}catch(s){if(tt(s))return{data:{user:null,session:null,redirectType:null},error:s};throw s}}async signInWithIdToken(e){try{const{options:n,provider:r,token:a,access_token:s,nonce:l}=e,c=await mt(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:a,access_token:s,nonce:l,gotrue_meta_security:{captcha_token:n==null?void 0:n.captchaToken}},xform:za}),{data:f,error:d}=c;return d?{data:{user:null,session:null},error:d}:!f||!f.session||!f.user?{data:{user:null,session:null},error:new af}:(f.session&&(await this._saveSession(f.session),await this._notifyAllSubscribers("SIGNED_IN",f.session)),{data:f,error:d})}catch(n){if(tt(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOtp(e){var n,r,a,s,l;try{if("email"in e){const{email:c,options:f}=e;let d=null,g=null;this.flowType==="pkce"&&([d,g]=await yo(this.storage,this.storageKey));const{error:x}=await mt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:c,data:(n=f==null?void 0:f.data)!==null&&n!==void 0?n:{},create_user:(r=f==null?void 0:f.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken},code_challenge:d,code_challenge_method:g},redirectTo:f==null?void 0:f.emailRedirectTo});return{data:{user:null,session:null},error:x}}if("phone"in e){const{phone:c,options:f}=e,{data:d,error:g}=await mt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:c,data:(a=f==null?void 0:f.data)!==null&&a!==void 0?a:{},create_user:(s=f==null?void 0:f.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken},channel:(l=f==null?void 0:f.channel)!==null&&l!==void 0?l:"sms"}});return{data:{user:null,session:null,messageId:d==null?void 0:d.message_id},error:g}}throw new sf("You must provide either an email or phone number.")}catch(c){if(tt(c))return{data:{user:null,session:null},error:c};throw c}}async verifyOtp(e){var n,r;try{let a,s;"options"in e&&(a=(n=e.options)===null||n===void 0?void 0:n.redirectTo,s=(r=e.options)===null||r===void 0?void 0:r.captchaToken);const{data:l,error:c}=await mt(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:s}}),redirectTo:a,xform:za});if(c)throw c;if(!l)throw new Error("An error occurred on token verification.");const f=l.session,d=l.user;return f!=null&&f.access_token&&(await this._saveSession(f),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",f)),{data:{user:d,session:f},error:null}}catch(a){if(tt(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithSSO(e){var n,r,a;try{let s=null,l=null;return this.flowType==="pkce"&&([s,l]=await yo(this.storage,this.storageKey)),await mt(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(r=(n=e.options)===null||n===void 0?void 0:n.redirectTo)!==null&&r!==void 0?r:void 0}),!((a=e==null?void 0:e.options)===null||a===void 0)&&a.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:s,code_challenge_method:l}),headers:this.headers,xform:P8})}catch(s){if(tt(s))return{data:null,error:s};throw s}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:n},error:r}=e;if(r)throw r;if(!n)throw new Ni;const{error:a}=await mt(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:n.access_token});return{data:{user:null,session:null},error:a}})}catch(e){if(tt(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const n=`${this.url}/resend`;if("email"in e){const{email:r,type:a,options:s}=e,{error:l}=await mt(this.fetch,"POST",n,{headers:this.headers,body:{email:r,type:a,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}},redirectTo:s==null?void 0:s.emailRedirectTo});return{data:{user:null,session:null},error:l}}else if("phone"in e){const{phone:r,type:a,options:s}=e,{data:l,error:c}=await mt(this.fetch,"POST",n,{headers:this.headers,body:{phone:r,type:a,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}}});return{data:{user:null,session:null,messageId:l==null?void 0:l.message_id},error:c}}throw new sf("You must provide either an email or phone number and a type")}catch(n){if(tt(n))return{data:{user:null,session:null},error:n};throw n}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async n=>n))}async _acquireLock(e,n){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const r=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),a=(async()=>(await r,await n()))();return this.pendingInLock.push((async()=>{try{await a}catch{}})()),a}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const r=n();for(this.pendingInLock.push((async()=>{try{await r}catch{}})()),await r;this.pendingInLock.length;){const a=[...this.pendingInLock];await Promise.all(a),this.pendingInLock.splice(0,a.length)}return await r}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const n=await this.__loadSession();return await e(n)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const n=await os(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",n),n!==null&&(this._isValidSession(n)?e=n:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const r=e.expires_at?e.expires_at*1e3-Date.now()<gh:!1;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",e.expires_at),!r){if(this.userStorage){const l=await os(this.userStorage,this.storageKey+"-user");l!=null&&l.user?e.user=l.user:e.user=yh()}if(this.storage.isServer&&e.user){let l=this.suppressGetSessionWarning;e=new Proxy(e,{get:(f,d,g)=>(!l&&d==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),l=!0,this.suppressGetSessionWarning=!0),Reflect.get(f,d,g))})}return{data:{session:e},error:null}}const{session:a,error:s}=await this._callRefreshToken(e.refresh_token);return s?{data:{session:null},error:s}:{data:{session:a},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await mt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Di}):await this._useSession(async n=>{var r,a,s;const{data:l,error:c}=n;if(c)throw c;return!(!((r=l.session)===null||r===void 0)&&r.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Ni}:await mt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(s=(a=l.session)===null||a===void 0?void 0:a.access_token)!==null&&s!==void 0?s:void 0,xform:Di})})}catch(n){if(tt(n))return o8(n)&&(await this._removeSession(),await Ai(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:n};throw n}}async updateUser(e,n={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,n))}async _updateUser(e,n={}){try{return await this._useSession(async r=>{const{data:a,error:s}=r;if(s)throw s;if(!a.session)throw new Ni;const l=a.session;let c=null,f=null;this.flowType==="pkce"&&e.email!=null&&([c,f]=await yo(this.storage,this.storageKey));const{data:d,error:g}=await mt(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:n==null?void 0:n.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:c,code_challenge_method:f}),jwt:l.access_token,xform:Di});if(g)throw g;return l.user=d.user,await this._saveSession(l),await this._notifyAllSubscribers("USER_UPDATED",l),{data:{user:l.user},error:null}})}catch(r){if(tt(r))return{data:{user:null},error:r};throw r}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Ni;const n=Date.now()/1e3;let r=n,a=!0,s=null;const{payload:l}=vh(e.access_token);if(l.exp&&(r=l.exp,a=r<=n),a){const{session:c,error:f}=await this._callRefreshToken(e.refresh_token);if(f)return{data:{user:null,session:null},error:f};if(!c)return{data:{user:null,session:null},error:null};s=c}else{const{data:c,error:f}=await this._getUser(e.access_token);if(f)throw f;s={access_token:e.access_token,refresh_token:e.refresh_token,user:c.user,token_type:"bearer",expires_in:r-n,expires_at:r},await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)}return{data:{user:s.user,session:s},error:null}}catch(n){if(tt(n))return{data:{session:null,user:null},error:n};throw n}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async n=>{var r;if(!e){const{data:l,error:c}=n;if(c)throw c;e=(r=l.session)!==null&&r!==void 0?r:void 0}if(!(e!=null&&e.refresh_token))throw new Ni;const{session:a,error:s}=await this._callRefreshToken(e.refresh_token);return s?{data:{user:null,session:null},error:s}:a?{data:{user:a.user,session:a},error:null}:{data:{user:null,session:null},error:null}})}catch(n){if(tt(n))return{data:{user:null,session:null},error:n};throw n}}async _getSessionFromURL(e,n){try{if(!sa())throw new of("No browser detected.");if(e.error||e.error_description||e.error_code)throw new of(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(n){case"implicit":if(this.flowType==="pkce")throw new e_("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new of("Not a valid implicit grant flow url.");break;default:}if(n==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new e_("No code detected.");const{data:N,error:b}=await this._exchangeCodeForSession(e.code);if(b)throw b;const I=new URL(window.location.href);return I.searchParams.delete("code"),window.history.replaceState(window.history.state,"",I.toString()),{data:{session:N.session,redirectType:null},error:null}}const{provider_token:r,provider_refresh_token:a,access_token:s,refresh_token:l,expires_in:c,expires_at:f,token_type:d}=e;if(!s||!c||!l||!d)throw new of("No session defined in URL");const g=Math.round(Date.now()/1e3),x=parseInt(c);let _=g+x;f&&(_=parseInt(f));const T=_-g;T*1e3<=bo&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${T}s, should have been closer to ${x}s`);const E=_-x;g-E>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",E,_,g):g-E<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",E,_,g);const{data:S,error:C}=await this._getUser(s);if(C)throw C;const k={provider_token:r,provider_refresh_token:a,access_token:s,expires_in:x,expires_at:_,refresh_token:l,token_type:d,user:S.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:k,redirectType:e.type},error:null}}catch(r){if(tt(r))return{data:{session:null,redirectType:null},error:r};throw r}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const n=await os(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&n)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async n=>{var r;const{data:a,error:s}=n;if(s)return{error:s};const l=(r=a.session)===null||r===void 0?void 0:r.access_token;if(l){const{error:c}=await this.admin.signOut(l,e);if(c&&!(s8(c)&&(c.status===404||c.status===401||c.status===403)))return{error:c}}return e!=="others"&&(await this._removeSession(),await Ai(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const n=x8(),r={id:n,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",n),this.stateChangeEmitters.delete(n)}};return this._debug("#onAuthStateChange()","registered callback with id",n),this.stateChangeEmitters.set(n,r),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(n)})))(),{data:{subscription:r}}}async _emitInitialSession(e){return await this._useSession(async n=>{var r,a;try{const{data:{session:s},error:l}=n;if(l)throw l;await((r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",s)),this._debug("INITIAL_SESSION","callback id",e,"session",s)}catch(s){await((a=this.stateChangeEmitters.get(e))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",s),console.error(s)}})}async resetPasswordForEmail(e,n={}){let r=null,a=null;this.flowType==="pkce"&&([r,a]=await yo(this.storage,this.storageKey,!0));try{return await mt(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:r,code_challenge_method:a,gotrue_meta_security:{captcha_token:n.captchaToken}},headers:this.headers,redirectTo:n.redirectTo})}catch(s){if(tt(s))return{data:null,error:s};throw s}}async getUserIdentities(){var e;try{const{data:n,error:r}=await this.getUser();if(r)throw r;return{data:{identities:(e=n.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(n){if(tt(n))return{data:null,error:n};throw n}}async linkIdentity(e){var n;try{const{data:r,error:a}=await this._useSession(async s=>{var l,c,f,d,g;const{data:x,error:_}=s;if(_)throw _;const T=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(l=e.options)===null||l===void 0?void 0:l.redirectTo,scopes:(c=e.options)===null||c===void 0?void 0:c.scopes,queryParams:(f=e.options)===null||f===void 0?void 0:f.queryParams,skipBrowserRedirect:!0});return await mt(this.fetch,"GET",T,{headers:this.headers,jwt:(g=(d=x.session)===null||d===void 0?void 0:d.access_token)!==null&&g!==void 0?g:void 0})});if(a)throw a;return sa()&&!(!((n=e.options)===null||n===void 0)&&n.skipBrowserRedirect)&&window.location.assign(r==null?void 0:r.url),{data:{provider:e.provider,url:r==null?void 0:r.url},error:null}}catch(r){if(tt(r))return{data:{provider:e.provider,url:null},error:r};throw r}}async unlinkIdentity(e){try{return await this._useSession(async n=>{var r,a;const{data:s,error:l}=n;if(l)throw l;return await mt(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(a=(r=s.session)===null||r===void 0?void 0:r.access_token)!==null&&a!==void 0?a:void 0})})}catch(n){if(tt(n))return{data:null,error:n};throw n}}async _refreshAccessToken(e){const n=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{const r=Date.now();return await T8(async a=>(a>0&&await _8(200*Math.pow(2,a-1)),this._debug(n,"refreshing attempt",a),await mt(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:za})),(a,s)=>{const l=200*Math.pow(2,a);return s&&xh(s)&&Date.now()+l-r<bo})}catch(r){if(this._debug(n,"error",r),tt(r))return{data:{session:null,user:null},error:r};throw r}finally{this._debug(n,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,n){const r=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:n.redirectTo,scopes:n.scopes,queryParams:n.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",n,"url",r),sa()&&!n.skipBrowserRedirect&&window.location.assign(r),{data:{provider:e,url:r},error:null}}async _recoverAndRefresh(){var e,n;const r="#_recoverAndRefresh()";this._debug(r,"begin");try{const a=await os(this.storage,this.storageKey);if(a&&this.userStorage){let l=await os(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!l&&(l={user:a.user},await Ao(this.userStorage,this.storageKey+"-user",l)),a.user=(e=l==null?void 0:l.user)!==null&&e!==void 0?e:yh()}else if(a&&!a.user&&!a.user){const l=await os(this.storage,this.storageKey+"-user");l&&(l!=null&&l.user)?(a.user=l.user,await Ai(this.storage,this.storageKey+"-user"),await Ao(this.storage,this.storageKey,a)):a.user=yh()}if(this._debug(r,"session from storage",a),!this._isValidSession(a)){this._debug(r,"session is not valid"),a!==null&&await this._removeSession();return}const s=((n=a.expires_at)!==null&&n!==void 0?n:1/0)*1e3-Date.now()<gh;if(this._debug(r,`session has${s?"":" not"} expired with margin of ${gh}s`),s){if(this.autoRefreshToken&&a.refresh_token){const{error:l}=await this._callRefreshToken(a.refresh_token);l&&(console.error(l),xh(l)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",l),await this._removeSession()))}}else if(a.user&&a.user.__isUserNotAvailableProxy===!0)try{const{data:l,error:c}=await this._getUser(a.access_token);!c&&(l!=null&&l.user)?(a.user=l.user,await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)):this._debug(r,"could not get user data, skipping SIGNED_IN notification")}catch(l){console.error("Error getting user data:",l),this._debug(r,"error getting user data, skipping SIGNED_IN notification",l)}else await this._notifyAllSubscribers("SIGNED_IN",a)}catch(a){this._debug(r,"error",a),console.error(a);return}finally{this._debug(r,"end")}}async _callRefreshToken(e){var n,r;if(!e)throw new Ni;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const a=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(a,"begin");try{this.refreshingDeferred=new $f;const{data:s,error:l}=await this._refreshAccessToken(e);if(l)throw l;if(!s.session)throw new Ni;await this._saveSession(s.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",s.session);const c={session:s.session,error:null};return this.refreshingDeferred.resolve(c),c}catch(s){if(this._debug(a,"error",s),tt(s)){const l={session:null,error:s};return xh(s)||await this._removeSession(),(n=this.refreshingDeferred)===null||n===void 0||n.resolve(l),l}throw(r=this.refreshingDeferred)===null||r===void 0||r.reject(s),s}finally{this.refreshingDeferred=null,this._debug(a,"end")}}async _notifyAllSubscribers(e,n,r=!0){const a=`#_notifyAllSubscribers(${e})`;this._debug(a,"begin",n,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:e,session:n});const s=[],l=Array.from(this.stateChangeEmitters.values()).map(async c=>{try{await c.callback(e,n)}catch(f){s.push(f)}});if(await Promise.all(l),s.length>0){for(let c=0;c<s.length;c+=1)console.error(s[c]);throw s[0]}}finally{this._debug(a,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const n=Object.assign({},e),r=n.user&&n.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!r&&n.user&&await Ao(this.userStorage,this.storageKey+"-user",{user:n.user});const a=Object.assign({},n);delete a.user;const s=structuredClone(a);await Ao(this.storage,this.storageKey,s)}else{const a=structuredClone(n);await Ao(this.storage,this.storageKey,a)}}async _removeSession(){this._debug("#_removeSession()"),await Ai(this.storage,this.storageKey),await Ai(this.storage,this.storageKey+"-code-verifier"),await Ai(this.storage,this.storageKey+"-user"),this.userStorage&&await Ai(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&sa()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(n){console.error("removing visibilitychange callback failed",n)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),bo);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async n=>{const{data:{session:r}}=n;if(!r||!r.refresh_token||!r.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const a=Math.floor((r.expires_at*1e3-e)/bo);this._debug("#_autoRefreshTokenTick()",`access token expires in ${a} ticks, a tick lasts ${bo}ms, refresh threshold is ${Zh} ticks`),a<=Zh&&await this._callRefreshToken(r.refresh_token)})}catch(n){console.error("Auto refresh tick failed with error. This is likely a transient error.",n)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof DT)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!sa()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const n=`#_onVisibilityChanged(${e})`;this._debug(n,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(n,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,n,r){const a=[`provider=${encodeURIComponent(n)}`];if(r!=null&&r.redirectTo&&a.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),r!=null&&r.scopes&&a.push(`scopes=${encodeURIComponent(r.scopes)}`),this.flowType==="pkce"){const[s,l]=await yo(this.storage,this.storageKey),c=new URLSearchParams({code_challenge:`${encodeURIComponent(s)}`,code_challenge_method:`${encodeURIComponent(l)}`});a.push(c.toString())}if(r!=null&&r.queryParams){const s=new URLSearchParams(r.queryParams);a.push(s.toString())}return r!=null&&r.skipBrowserRedirect&&a.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${e}?${a.join("&")}`}async _unenroll(e){try{return await this._useSession(async n=>{var r;const{data:a,error:s}=n;return s?{data:null,error:s}:await mt(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(r=a==null?void 0:a.session)===null||r===void 0?void 0:r.access_token})})}catch(n){if(tt(n))return{data:null,error:n};throw n}}async _enroll(e){try{return await this._useSession(async n=>{var r,a;const{data:s,error:l}=n;if(l)return{data:null,error:l};const c=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:f,error:d}=await mt(this.fetch,"POST",`${this.url}/factors`,{body:c,headers:this.headers,jwt:(r=s==null?void 0:s.session)===null||r===void 0?void 0:r.access_token});return d?{data:null,error:d}:(e.factorType==="totp"&&(!((a=f==null?void 0:f.totp)===null||a===void 0)&&a.qr_code)&&(f.totp.qr_code=`data:image/svg+xml;utf-8,${f.totp.qr_code}`),{data:f,error:null})})}catch(n){if(tt(n))return{data:null,error:n};throw n}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var r;const{data:a,error:s}=n;if(s)return{data:null,error:s};const{data:l,error:c}=await mt(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(r=a==null?void 0:a.session)===null||r===void 0?void 0:r.access_token});return c?{data:null,error:c}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+l.expires_in},l)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",l),{data:l,error:c})})}catch(n){if(tt(n))return{data:null,error:n};throw n}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var r;const{data:a,error:s}=n;return s?{data:null,error:s}:await mt(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(r=a==null?void 0:a.session)===null||r===void 0?void 0:r.access_token})})}catch(n){if(tt(n))return{data:null,error:n};throw n}})}async _challengeAndVerify(e){const{data:n,error:r}=await this._challenge({factorId:e.factorId});return r?{data:null,error:r}:await this._verify({factorId:e.factorId,challengeId:n.id,code:e.code})}async _listFactors(){const{data:{user:e},error:n}=await this.getUser();if(n)return{data:null,error:n};const r=(e==null?void 0:e.factors)||[],a=r.filter(l=>l.factor_type==="totp"&&l.status==="verified"),s=r.filter(l=>l.factor_type==="phone"&&l.status==="verified");return{data:{all:r,totp:a,phone:s},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var n,r;const{data:{session:a},error:s}=e;if(s)return{data:null,error:s};if(!a)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:l}=vh(a.access_token);let c=null;l.aal&&(c=l.aal);let f=c;((r=(n=a.user.factors)===null||n===void 0?void 0:n.filter(x=>x.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(f="aal2");const g=l.amr||[];return{data:{currentLevel:c,nextLevel:f,currentAuthenticationMethods:g},error:null}}))}async fetchJwk(e,n={keys:[]}){let r=n.keys.find(c=>c.kid===e);if(r)return r;const a=Date.now();if(r=this.jwks.keys.find(c=>c.kid===e),r&&this.jwks_cached_at+a8>a)return r;const{data:s,error:l}=await mt(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(l)throw l;return!s.keys||s.keys.length===0||(this.jwks=s,this.jwks_cached_at=a,r=s.keys.find(c=>c.kid===e),!r)?null:r}async getClaims(e,n={}){try{let r=e;if(!r){const{data:T,error:E}=await this.getSession();if(E||!T.session)return{data:null,error:E};r=T.session.access_token}const{header:a,payload:s,signature:l,raw:{header:c,payload:f}}=vh(r);n!=null&&n.allowExpired||k8(s.exp);const d=!a.alg||a.alg.startsWith("HS")||!a.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(a.kid,n!=null&&n.keys?{keys:n.keys}:n==null?void 0:n.jwks);if(!d){const{error:T}=await this.getUser(r);if(T)throw T;return{data:{claims:s,header:a,signature:l},error:null}}const g=N8(a.alg),x=await crypto.subtle.importKey("jwk",d,g,!0,["verify"]);if(!await crypto.subtle.verify(g,x,l,m8(`${c}.${f}`)))throw new tm("Invalid JWT signature");return{data:{claims:s,header:a,signature:l},error:null}}catch(r){if(tt(r))return{data:null,error:r};throw r}}}vc.nextInstanceID=0;const j8=vc;class $8 extends j8{constructor(e){super(e)}}var W8=function(t,e,n,r){function a(s){return s instanceof n?s:new n(function(l){l(s)})}return new(n||(n=Promise))(function(s,l){function c(g){try{d(r.next(g))}catch(x){l(x)}}function f(g){try{d(r.throw(g))}catch(x){l(x)}}function d(g){g.done?s(g.value):a(g.value).then(c,f)}d((r=r.apply(t,e||[])).next())})};class Y8{constructor(e,n,r){var a,s,l;if(this.supabaseUrl=e,this.supabaseKey=n,!e)throw new Error("supabaseUrl is required.");if(!n)throw new Error("supabaseKey is required.");const c=Z6(e),f=new URL(c);this.realtimeUrl=new URL("realtime/v1",f),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",f),this.storageUrl=new URL("storage/v1",f),this.functionsUrl=new URL("functions/v1",f);const d=`sb-${f.hostname.split(".")[0]}-auth-token`,g={db:q6,realtime:$6,auth:Object.assign(Object.assign({},j6),{storageKey:d}),global:z6},x=Q6(r??{},g);this.storageKey=(a=x.auth.storageKey)!==null&&a!==void 0?a:"",this.headers=(s=x.global.headers)!==null&&s!==void 0?s:{},x.accessToken?(this.accessToken=x.accessToken,this.auth=new Proxy({},{get:(_,T)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(T)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((l=x.auth)!==null&&l!==void 0?l:{},this.headers,x.global.fetch),this.fetch=X6(n,this._getAccessToken.bind(this),x.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},x.realtime)),this.rest=new d6(new URL("rest/v1",f).href,{headers:this.headers,schema:x.db.schema,fetch:this.fetch}),x.accessToken||this._listenForAuthEvents()}get functions(){return new e6(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}get storage(){return new V6(this.storageUrl.href,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,n={},r={}){return this.rest.rpc(e,n,r)}channel(e,n={config:{}}){return this.realtime.channel(e,n)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,n;return W8(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:r}=yield this.auth.getSession();return(n=(e=r.session)===null||e===void 0?void 0:e.access_token)!==null&&n!==void 0?n:null})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:n,detectSessionInUrl:r,storage:a,storageKey:s,flowType:l,lock:c,debug:f},d,g){const x={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new $8({url:this.authUrl.href,headers:Object.assign(Object.assign({},x),d),storageKey:s,autoRefreshToken:e,persistSession:n,detectSessionInUrl:r,storage:a,flowType:l,lock:c,debug:f,fetch:g,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new A6(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((n,r)=>{this._handleTokenChanged(n,"CLIENT",r==null?void 0:r.access_token)})}_handleTokenChanged(e,n,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==r?this.changedAccessToken=r:e==="SIGNED_OUT"&&(this.realtime.setAuth(),n=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const J8=(t,e,n)=>new Y8(t,e,n),X8="https://niueahdukslronukqvbw.supabase.co",K8="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im5pdWVhaGR1a3Nscm9udWtxdmJ3Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTQ0OTI3OTAsImV4cCI6MjA3MDA2ODc5MH0.kVfUNeYeTRQ45MHgvkDhv-XLP54zFHkbz1SWY2q1vVo",nt=J8(X8,K8),Z8=()=>{const t="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";let e="";for(let n=0;n<6;n++)e+=t.charAt(Math.floor(Math.random()*t.length));return e},RT=async t=>{const{data:e,error:n}=await nt.from("doctor_connections").select(`
            id,
            created_at,
            doctor_id,
            user_id,
            doctor_note,
            doctors (
                full_name,
                phone_number
            )
        `).eq("user_id",t);return n?(console.error("Error fetching connections:",n),{data:null,error:"Failed to fetch Doctor connections."}):{data:e,error:null}},Q8=async(t,e,n)=>{const r=e.trim().toUpperCase(),a=n.trim().toLowerCase();if(!r||!a)return{data:null,error:"Doctor Code and First Name are required."};const s=await nt.from("doctors").select("id, full_name").eq("doctor_code",r).maybeSingle(),{data:l,error:c}=s;if(c)return console.error("Database error while finding doctor:",c),{data:null,error:"A database error occurred. Please try again later."};if(!l)return{data:null,error:"Invalid Doctor Code. Please double-check the code and try again."};if(!l.full_name||!l.full_name.toLowerCase().includes(a))return{data:null,error:"The Doctor's first name does not seem to match the provided code. Please verify both details."};const f=await nt.from("doctor_connections").select("id").eq("user_id",t).eq("doctor_id",l.id).maybeSingle(),{data:d,error:g}=f;if(g)return console.error("Database error checking existing connection:",g),{data:null,error:"Could not verify existing connections due to a database error."};if(d)return{data:null,error:"You are already connected with this Doctor."};const x={user_id:t,doctor_id:l.id},{error:_}=await nt.from("doctor_connections").insert([x]);return _?(console.error("Database error inserting connection:",_),{data:null,error:"Failed to create the connection due to a database error."}):{data:{success:!0},error:null}},FT=async t=>{const{error:e}=await nt.from("doctor_connections").delete().eq("id",t);return e?(console.error("Error disconnecting:",e),{data:null,error:"Failed to disconnect."}):{data:{success:!0},error:null}},eI=async t=>{const{data:e,error:n}=await nt.from("doctor_connections").select("id, created_at, doctor_id, user_id, doctor_note, doctors(full_name, phone_number)").eq("doctor_id",t);if(n)return{data:null,error:"Could not fetch patient list."};if(!e||e.length===0)return{data:[],error:null};const r=e.map(T=>T.user_id),{data:a,error:s}=await nt.from("profiles").select("*").in("id",r);if(s)return{data:null,error:"Could not fetch patient profiles."};if(!a)return{data:[],error:null};const{data:l,error:c}=await nt.from("food_history").select("*").in("user_id",r).order("created_at",{ascending:!1});if(c)return{data:null,error:"Could not fetch patient food histories."};const{data:f,error:d}=await nt.from("restricted_foods").select("*").in("user_id",r);if(d)return{data:null,error:"Could not fetch patient restricted foods."};const{data:g,error:x}=await nt.from("safe_foods").select("*").in("user_id",r);return x?{data:null,error:"Could not fetch patient safe foods."}:{data:a.map(T=>{const E=(l||[]).filter(b=>b.user_id===T.id&&b.nutrition).map(b=>({id:b.id,user_id:b.user_id,date:b.created_at,foodName:b.food_name||"Unnamed Food",estimatedWeightGrams:b.estimated_weight_grams||0,nutrition:b.nutrition,type:"food",dietaryWarnings:b.dietary_warnings?b.dietary_warnings:null,safetyVerdict:b.safety_verdict?b.safety_verdict:void 0})),S=(f==null?void 0:f.filter(b=>b.user_id===T.id).map(b=>({...b,reason:b.reason||""})))||[],C=(g==null?void 0:g.filter(b=>b.user_id===T.id))||[],k=e.find(b=>b.user_id===T.id);return{profile:{id:T.id,username:T.username,fullName:T.full_name,phoneNumber:T.phone_number,gender:T.gender??"other",dob:T.dob,age:null,heightCm:T.height_cm,weightKg:T.weight_kg,activityLevel:T.activity_level??"sedentary",medicalHistory:T.medical_history,updated_at:T.updated_at,healthStarRating:T.health_star_rating,dailyCalorieGoal:T.daily_calorie_goal,dailyProteinGoal:T.daily_protein_goal,dailyCarbohydratesGoal:T.daily_carbohydrates_goal,dailyFatGoal:T.daily_fat_goal,dailySugarGoal:T.daily_sugar_goal,dailySodiumGoal:T.daily_sodium_goal,dailyHydrationGoalMl:T.daily_hydration_goal_ml},history:E,connection:k,safeFoods:C,restrictedFoods:S}}),error:null}},tI=async(t,e)=>{const n={doctor_note:e},{error:r}=await nt.from("doctor_connections").update(n).eq("id",t);return r?(console.error("Error updating doctor note:",r),{data:null,error:"Failed to save the note."}):{data:{success:!0},error:null}},Vm=t=>{if(!t||!/^\d{4}-\d{2}-\d{2}$/.test(t))return null;try{const e=new Date(t);if(isNaN(e.getTime()))return null;const n=new Date;let r=n.getFullYear()-e.getFullYear();const a=n.getMonth()-e.getMonth();return(a<0||a===0&&n.getDate()<e.getDate())&&r--,r}catch{return null}},IT=(t,e)=>{const n=Vm(t);return n===null?e?e("na"):"N/A":e?e("ageYearsOld",{age:n}):`${n} years old`},Gm=t=>t===null?null:t<18.5?{status:"bmiUnderweight",colorClass:"text-blue-500 dark:text-blue-400",isRisk:!0}:t<25?{status:"bmiNormal",colorClass:"text-green-500 dark:text-green-400",isRisk:!1}:t<30?{status:"bmiOverweight",colorClass:"text-yellow-500 dark:text-yellow-400",isRisk:!0}:{status:"bmiObesity",colorClass:"text-red-500 dark:text-red-400",isRisk:!0},Hm=(t,e)=>{if(!t||!e||e===0)return null;const n=e/100;return t/(n*n)},c_=t=>{const e=Vm(t.dob),{weightKg:n,heightCm:r,gender:a,activityLevel:s}=t;if(!n||!r||!e||!a||!s)return null;const f=(10*n+6.25*r-5*e+(a==="male"?5:-161))*{sedentary:1.2,lightly_active:1.375,active:1.55,very_active:1.725}[s],d=Math.round(f/10)*10,g=Math.round(d*.2/4),x=Math.round(d*.5/4),_=Math.round(d*.3/9);return{calories:d,proteinGrams:g,carbohydratesGrams:x,fatGrams:_,sugarGrams:25,sodiumMilligrams:1500}},ja=({label:t,type:e,value:n,onChange:r,placeholder:a,name:s,required:l=!1,as:c})=>y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-ui-text-secondary dark:text-slate-300 mb-1",children:t}),c==="textarea"?y.jsx("textarea",{name:s,value:n??"",onChange:r,placeholder:a,required:l,rows:4,className:"w-full px-3 py-2 bg-slate-100 dark:bg-slate-700 border border-ui-border dark:border-slate-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-brand-primary text-ui-text dark:text-slate-50"}):y.jsx("input",{name:s,type:e||"text",value:n??"",onChange:r,placeholder:a,required:l,className:"w-full px-3 py-2 bg-slate-100 dark:bg-slate-700 border border-ui-border dark:border-slate-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-brand-primary text-ui-text dark:text-slate-50"})]}),u_=({label:t,name:e,options:n,selectedValue:r,onChange:a})=>y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-ui-text-secondary dark:text-slate-300 mb-2",children:t}),y.jsx("div",{className:"flex flex-wrap gap-2",children:n.map(s=>y.jsx("button",{type:"button",name:e,onClick:()=>a(s.value),className:`px-4 py-2 text-sm font-semibold rounded-lg capitalize transform hover:scale-105 ${r===s.value?"bg-brand-primary text-white shadow-md":"bg-slate-200 dark:bg-slate-700 text-ui-text dark:text-slate-200 hover:bg-slate-300 dark:hover:bg-slate-600"}`,children:s.label},s.value))})]}),nI=({userId:t})=>{const[e,n]=pe.useState([]),[r,a]=pe.useState(""),[s,l]=pe.useState(""),[c,f]=pe.useState(!0),[d,g]=pe.useState(null),[x,_]=pe.useState(null),{t:T}=Vt(),E=pe.useCallback(async()=>{f(!0);const{data:k,error:N}=await RT(t);N?g(T("profileFetchConnectionsError")):k&&n(k),f(!1)},[t,T]);pe.useEffect(()=>{E()},[E]);const S=async k=>{k.preventDefault(),f(!0),g(null),_(null);const{data:N,error:b}=await Q8(t,r,s);b?g(T(b)||b):N!=null&&N.success&&(_(T("profileConnectSuccess")),a(""),l(""),await E()),f(!1)},C=async k=>{if(!window.confirm(T("profileDisconnectConfirm")))return;f(!0),g(null);const{data:N,error:b}=await FT(k);b?g(T(b)||b):N!=null&&N.success&&await E(),f(!1)};return y.jsxs("div",{className:"space-y-6",children:[y.jsx("h3",{className:"text-xl font-bold text-ui-text dark:text-slate-100",children:T("profileDoctorConnect")}),y.jsx("p",{className:"text-sm text-ui-text-secondary dark:text-slate-400",children:T("profileDoctorConnectSubtitle")}),c&&!e.length?y.jsx(hn,{}):null,e.length>0&&y.jsxs("div",{className:"space-y-3",children:[y.jsx("h4",{className:"text-sm font-semibold text-ui-text-secondary dark:text-slate-400",children:T("profileConnectedWith")}),e.map(k=>{var N;return y.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-100 dark:bg-slate-700/50 rounded-lg",children:[y.jsx("p",{className:"font-semibold text-ui-text dark:text-slate-200",children:(N=k.doctors)==null?void 0:N.full_name}),y.jsx("button",{onClick:()=>C(k.id),disabled:c,className:"px-3 py-1 text-xs font-semibold text-red-600 bg-red-100 dark:text-red-200 dark:bg-red-900/40 rounded-md hover:bg-red-200 dark:hover:bg-red-900/60",children:T("profileDisconnect")})]},k.id)})]}),y.jsxs("form",{onSubmit:S,className:"space-y-3",children:[y.jsx(ja,{label:T("profileDoctorFirstName"),type:"text",name:"doctorFirstName",value:s,onChange:k=>l(k.target.value),placeholder:T("profileDoctorFirstNamePlaceholder"),required:!0}),y.jsx(ja,{label:T("profileDoctorCode"),type:"text",name:"doctorCode",value:r,onChange:k=>a(k.target.value.toUpperCase()),placeholder:T("profileDoctorCodePlaceholder"),required:!0}),y.jsx("button",{type:"submit",disabled:c||!r||!s,className:"w-full sm:w-auto flex items-center justify-center gap-2 px-4 py-2 bg-green-600 text-white font-semibold rounded-lg hover:bg-green-700 disabled:bg-slate-400 disabled:cursor-not-allowed",children:c?y.jsx(hn,{className:"h-5 w-5"}):T("profileConnect")}),d&&y.jsx("p",{className:"text-sm text-red-500",children:d}),x&&y.jsx("p",{className:"text-sm text-green-500",children:x})]})]})},f_=({currentProfile:t,onSave:e,isSetupMode:n=!1,isSaving:r,safeFoods:a=[],restrictedFoods:s=[]})=>{const[l,c]=pe.useState(t),{t:f}=Vt(),d=C=>{const{name:k,value:N,type:b}=C.target,I=b==="number";c(F=>({...F,[k]:I?N===""?null:parseFloat(N):N}))},g=(C,k)=>{c(N=>({...N,[C]:k}))},x=C=>{C.preventDefault(),e(l,t)};pe.useMemo(()=>Vm(l.dob),[l.dob]);const _=pe.useMemo(()=>Hm(l.weightKg,l.heightCm),[l.weightKg,l.heightCm]),T=pe.useMemo(()=>Gm(_),[_]),E=[{value:"female",label:f("female")},{value:"male",label:f("male")},{value:"other",label:f("other")}],S=[{value:"sedentary",label:f("sedentary")},{value:"lightly_active",label:f("lightly_active")},{value:"active",label:f("active")},{value:"very_active",label:f("very_active")}];return y.jsxs("div",{className:"w-full max-w-4xl mx-auto animate-fade-in space-y-8",children:[y.jsxs("div",{className:"text-center",children:[y.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-ui-text dark:text-slate-50",children:f(n?"profileWelcome":"profileTitle")}),y.jsx("p",{className:"text-ui-text-secondary dark:text-slate-400 mt-2",children:f(n?"profileWelcomeSubtitle":"profileUpdateSubtitle")})]}),y.jsxs("form",{onSubmit:x,className:"space-y-8",children:[y.jsxs("div",{className:"bg-ui-card dark:bg-slate-800 p-6 sm:p-8 rounded-xl shadow-lg border border-ui-border dark:border-slate-700",children:[y.jsx("h2",{className:"text-xl font-bold text-ui-text dark:text-slate-100 mb-6",children:f("profilePersonalDetails")}),y.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-6",children:[y.jsx(ja,{label:f("authFullName"),name:"fullName",value:l.fullName,onChange:d,placeholder:f("profileFullNamePlaceholder"),required:!0}),y.jsx(ja,{label:f("authUsername"),name:"username",value:l.username,onChange:d,placeholder:f("profileUsernamePlaceholder"),required:!0}),y.jsx(ja,{label:f("authPhoneNumber"),name:"phoneNumber",type:"tel",value:l.phoneNumber,onChange:d,placeholder:f("profilePhonePlaceholder")}),y.jsx(ja,{label:f("profileDob"),name:"dob",type:"date",value:l.dob,onChange:d,placeholder:"YYYY-MM-DD",required:!0}),y.jsx(u_,{label:f("profileGender"),name:"gender",options:E,selectedValue:l.gender,onChange:C=>g("gender",C)})]})]}),y.jsxs("div",{className:"bg-ui-card dark:bg-slate-800 p-6 sm:p-8 rounded-xl shadow-lg border border-ui-border dark:border-slate-700",children:[y.jsx("h2",{className:"text-xl font-bold text-ui-text dark:text-slate-100 mb-6",children:f("profileHealthMetrics")}),y.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-6",children:[y.jsx(ja,{label:f("profileHeight"),name:"heightCm",type:"number",value:l.heightCm,onChange:d,placeholder:f("profileHeightPlaceholder"),required:!0}),y.jsx(ja,{label:f("profileWeight"),name:"weightKg",type:"number",value:l.weightKg,onChange:d,placeholder:f("profileWeightPlaceholder"),required:!0}),y.jsxs("div",{className:"p-4 bg-slate-100 dark:bg-slate-900/50 rounded-lg md:col-span-2",children:[y.jsx("h3",{className:"text-sm font-medium text-ui-text-secondary dark:text-slate-300 mb-2",children:f("profileLiveBmi")}),_&&T?y.jsxs("div",{className:"text-center",children:[y.jsx("p",{className:`text-4xl font-bold ${T.colorClass}`,children:_.toFixed(1)}),y.jsx("p",{className:`font-semibold ${T.colorClass}`,children:f(T.status)})]}):y.jsx("p",{className:"text-center text-ui-text-secondary dark:text-slate-400",children:f("profileEnterBmi")})]}),y.jsx(u_,{label:f("profileActivityLevel"),name:"activityLevel",options:S,selectedValue:l.activityLevel,onChange:C=>g("activityLevel",C)}),y.jsx(ja,{label:f("profileMedicalHistory"),name:"medicalHistory",as:"textarea",value:l.medicalHistory,onChange:d,placeholder:f("profileMedicalHistoryPlaceholder")})]})]}),y.jsxs("button",{type:"submit",disabled:r,className:"w-full flex justify-center items-center gap-2 py-3 px-4 bg-brand-primary text-white font-semibold rounded-lg shadow-sm hover:bg-brand-secondary disabled:bg-slate-400 disabled:cursor-not-allowed",children:[r?y.jsx(hn,{className:"h-5 w-5"}):y.jsx(jf,{className:"h-5 w-5"}),f(n?"profileSaveContinue":"profileSaveChanges")]})]}),!n&&y.jsxs(y.Fragment,{children:[y.jsx("div",{className:"bg-ui-card dark:bg-slate-800 p-6 sm:p-8 rounded-xl shadow-lg border border-ui-border dark:border-slate-700",children:y.jsx(nI,{userId:l.id})}),(a.length>0||s.length>0)&&y.jsxs("div",{className:"bg-ui-card dark:bg-slate-800 p-6 sm:p-8 rounded-xl shadow-lg border border-ui-border dark:border-slate-700",children:[y.jsx("h2",{className:"text-2xl font-bold text-ui-text dark:text-slate-100 mb-6 text-center",children:f("profileGuidelinesTitle")}),y.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[y.jsxs("div",{children:[y.jsxs("h3",{className:"text-xl font-semibold text-green-600 dark:text-green-400 mb-4 flex items-center gap-2",children:[y.jsx(Rm,{className:"h-6 w-6"}),f("profileApprovedFoods")]}),y.jsx("div",{className:"space-y-2",children:a.length>0?a.map(C=>y.jsxs("div",{className:"p-3 bg-slate-100 dark:bg-slate-700/50 rounded-lg",children:[y.jsx("p",{className:"font-semibold text-ui-text dark:text-slate-200",children:C.food_name}),C.brand_name&&y.jsxs("p",{className:"text-xs text-ui-text-secondary dark:text-slate-400",children:[f("profileBrand")," ",C.brand_name]})]},C.id)):y.jsx("p",{className:"text-sm text-ui-text-secondary dark:text-slate-400",children:f("profileNoApproved")})})]}),y.jsxs("div",{children:[y.jsxs("h3",{className:"text-xl font-semibold text-red-600 dark:text-red-400 mb-4 flex items-center gap-2",children:[y.jsx(Qa,{className:"h-6 w-6"}),f("profileRestrictedFoods")]}),y.jsx("div",{className:"space-y-2",children:s.length>0?s.map(C=>y.jsxs("div",{className:"p-3 bg-red-100 dark:bg-red-900/40 rounded-lg border border-red-200 dark:border-red-800",children:[y.jsx("p",{className:"font-semibold text-red-800 dark:text-red-200",children:C.food_name}),C.brand_name&&y.jsxs("p",{className:"text-xs text-red-700 dark:text-red-300",children:[f("profileBrand")," ",C.brand_name]}),y.jsxs("p",{className:"text-sm text-red-700 dark:text-red-300 mt-1",children:[y.jsx("span",{className:"font-semibold",children:f("profileReason")})," ",C.reason]})]},C.id)):y.jsx("p",{className:"text-sm text-ui-text-secondary dark:text-slate-400",children:f("profileNoRestricted")})})]})]})]})]})]})},rI=()=>{const[t,e]=pe.useState(!1),[n,r]=pe.useState(""),[a,s]=pe.useState(""),[l,c]=pe.useState(""),[f,d]=pe.useState(""),[g,x]=pe.useState(""),[_,T]=pe.useState(""),[E,S]=pe.useState(""),[C,k]=pe.useState(!0),[N,b]=pe.useState("patient"),[I,F]=pe.useState(null),[P,D]=pe.useState(null),{t:j}=Vt(),B=async X=>{X.preventDefault(),e(!0),F(null),D(null);try{if(C){const{error:Z}=await nt.auth.signInWithPassword({email:n,password:a});if(Z)throw Z}else{const Z=N==="patient"?{data:{role:"patient",username:l,full_name:f,phone_number:g}}:{data:{role:"doctor",username:l,full_name:f,phone_number:g,medical_registration_id:_,specialization:E,doctor_code:Z8()}},{error:ye}=await nt.auth.signUp({email:n,password:a,options:Z});if(ye)throw ye;D(j("authCheckEmail"))}}catch(Z){Z instanceof Error?F(Z.message):F("An unknown error occurred.")}finally{e(!1)}},te=()=>y.jsxs("div",{className:"flex justify-center mb-6 bg-slate-100 dark:bg-slate-900 p-1 rounded-lg shadow-sm border border-ui-border dark:border-slate-700",children:[y.jsx("button",{type:"button",onClick:()=>b("patient"),className:`px-4 py-2 text-sm font-semibold rounded-md transition-colors capitalize w-full ${N==="patient"?"bg-brand-primary text-white shadow":"text-ui-text-secondary hover:bg-slate-200 dark:hover:bg-slate-700"}`,children:j("patient")}),y.jsx("button",{type:"button",onClick:()=>b("doctor"),className:`px-4 py-2 text-sm font-semibold rounded-md transition-colors capitalize w-full ${N==="doctor"?"bg-brand-primary text-white shadow":"text-ui-text-secondary hover:bg-slate-200 dark:hover:bg-slate-700"}`,children:j("doctor")})]});return y.jsx("div",{className:"min-h-screen flex flex-col items-center justify-center bg-ui-bg dark:bg-slate-900 p-4 animate-fade-in",children:y.jsxs("div",{className:"w-full max-w-sm",children:[y.jsx("div",{className:"flex justify-center mb-6",children:y.jsx(wm,{className:"h-10 sm:h-12"})}),y.jsxs("div",{className:"bg-ui-card dark:bg-slate-800 p-6 sm:p-8 rounded-xl shadow-lg border border-ui-border dark:border-slate-700",children:[y.jsx(te,{}),y.jsx("h2",{className:"text-2xl font-bold text-center text-ui-text dark:text-slate-100 mb-2",children:j(C?"authWelcome":N==="patient"?"authCreatePatientAccount":"authCreateDoctorAccount")}),y.jsx("p",{className:"text-center text-ui-text-secondary dark:text-slate-400 mb-6",children:j(C?"authLoginContinue":"authSignUpStart")}),y.jsxs("form",{onSubmit:B,className:"space-y-4",children:[!C&&y.jsxs(y.Fragment,{children:[y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-ui-text-secondary dark:text-slate-300 mb-1",htmlFor:"username",children:j("authUsername")}),y.jsx("input",{id:"username",className:"w-full px-3 py-2 bg-slate-100 dark:bg-slate-700 border border-ui-border dark:border-slate-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-brand-primary text-ui-text dark:text-slate-50",type:"text",value:l,required:!0,placeholder:j("authUsernamePlaceholder"),onChange:X=>c(X.target.value)})]}),y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-ui-text-secondary dark:text-slate-300 mb-1",htmlFor:"fullName",children:j("authFullName")}),y.jsx("input",{id:"fullName",className:"w-full px-3 py-2 bg-slate-100 dark:bg-slate-700 border border-ui-border dark:border-slate-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-brand-primary text-ui-text dark:text-slate-50",type:"text",value:f,required:!0,placeholder:j("authFullNamePlaceholder"),onChange:X=>d(X.target.value)})]}),y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-ui-text-secondary dark:text-slate-300 mb-1",htmlFor:"phoneNumber",children:j("authPhoneNumber")}),y.jsx("input",{id:"phoneNumber",className:"w-full px-3 py-2 bg-slate-100 dark:bg-slate-700 border border-ui-border dark:border-slate-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-brand-primary text-ui-text dark:text-slate-50",type:"tel",value:g,placeholder:j("authPhoneNumberPlaceholder"),onChange:X=>x(X.target.value)})]}),N==="doctor"&&y.jsxs(y.Fragment,{children:[y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-ui-text-secondary dark:text-slate-300 mb-1",htmlFor:"medicalId",children:j("authMedicalId")}),y.jsx("input",{id:"medicalId",className:"w-full px-3 py-2 bg-slate-100 dark:bg-slate-700 border border-ui-border dark:border-slate-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-brand-primary text-ui-text dark:text-slate-50",type:"text",value:_,required:!0,placeholder:j("authMedicalIdPlaceholder"),onChange:X=>T(X.target.value)})]}),y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-ui-text-secondary dark:text-slate-300 mb-1",htmlFor:"specialization",children:j("authSpecialization")}),y.jsx("input",{id:"specialization",className:"w-full px-3 py-2 bg-slate-100 dark:bg-slate-700 border border-ui-border dark:border-slate-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-brand-primary text-ui-text dark:text-slate-50",type:"text",value:E,placeholder:j("authSpecializationPlaceholder"),onChange:X=>S(X.target.value)})]})]})]}),y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-ui-text-secondary dark:text-slate-300 mb-1",htmlFor:"email",children:j("authEmail")}),y.jsx("input",{id:"email",className:"w-full px-3 py-2 bg-slate-100 dark:bg-slate-700 border border-ui-border dark:border-slate-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-brand-primary text-ui-text dark:text-slate-50",type:"email",value:n,required:!0,placeholder:j("authEmailPlaceholder"),onChange:X=>r(X.target.value)})]}),y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-ui-text-secondary dark:text-slate-300 mb-1",htmlFor:"password",children:j("authPassword")}),y.jsx("input",{id:"password",className:"w-full px-3 py-2 bg-slate-100 dark:bg-slate-700 border border-ui-border dark:border-slate-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-brand-primary text-ui-text dark:text-slate-50",type:"password",value:a,required:!0,placeholder:"",onChange:X=>s(X.target.value)})]}),y.jsx("button",{type:"submit",disabled:t,className:"w-full flex justify-center py-2.5 px-4 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-brand-primary hover:bg-brand-secondary focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-brand-primary disabled:bg-slate-400 disabled:cursor-not-allowed",children:t?y.jsx(hn,{className:"h-5 w-5"}):j(C?"authLogin":"authSignUp")})]}),I&&y.jsx("p",{className:"mt-4 text-center text-sm text-red-600 dark:text-red-400",children:I}),P&&y.jsx("p",{className:"mt-4 text-center text-sm text-green-600 dark:text-green-400",children:P}),y.jsx("p",{className:"mt-6 text-center text-sm",children:y.jsx("button",{onClick:()=>{k(!C),F(null),D(null)},className:"font-medium text-brand-primary hover:text-brand-secondary",children:j(C?"authNeedAccount":"authHaveAccount")})})]}),y.jsx("footer",{className:"w-full flex justify-center mt-8 py-4",children:y.jsx(Q2,{className:"h-auto max-w-xs"})})]})})},aI=({percentage:t,label:e,value:n,goal:r,colorClass:a="stroke-brand-primary"})=>{const l=2*Math.PI*54,c=Math.min(Math.max(t,0),100),f=l-c/100*l,d=t>100?"stroke-red-500":a;return y.jsxs("div",{className:"relative flex items-center justify-center w-48 h-48 neumorphic-outset dark:neumorphic-outset p-2 rounded-full",children:[y.jsx("div",{className:"absolute w-40 h-40 neumorphic-inset rounded-full"}),y.jsxs("svg",{className:"transform -rotate-90 w-48 h-48",viewBox:"0 0 120 120",children:[y.jsx("circle",{className:"stroke-slate-200 dark:stroke-slate-700",strokeWidth:"8",stroke:"currentColor",fill:"transparent",r:54,cx:"60",cy:"60"}),y.jsx("circle",{className:`progress-ring__circle--progress ${d} transition-all duration-500`,strokeWidth:"8",strokeDasharray:l,strokeDashoffset:f,strokeLinecap:"round",stroke:"currentColor",fill:"transparent",r:54,cx:"60",cy:"60"})]}),y.jsxs("div",{className:"absolute flex flex-col items-center justify-center text-center",children:[y.jsx("span",{className:`text-3xl font-bold text-ui-text dark:text-slate-50 transition-colors ${t>100?"text-red-500 dark:text-red-400":""}`,children:n.toFixed(0)}),y.jsxs("span",{className:"text-sm text-ui-text-secondary dark:text-slate-400",children:["/ ",r.toFixed(0)]}),y.jsx("span",{className:"text-sm font-semibold text-ui-text dark:text-slate-300 mt-1",children:e})]})]})},Zl=({label:t,icon:e,current:n,goal:r,color:a,unit:s="g",style:l})=>{const c=r>0?n/r*100:0,f=Math.min(c,100),d=c>100,g=d?"bg-red-500":a,x=d?"text-red-500 dark:text-red-400":"text-ui-text-secondary dark:text-slate-400";return y.jsxs("div",{className:"animate-slide-up",style:l,children:[y.jsxs("div",{className:"flex justify-between items-center mb-1 text-sm",children:[y.jsxs("div",{className:"flex items-center gap-2 font-semibold text-ui-text dark:text-slate-200",children:[e,y.jsx("span",{children:t})]}),y.jsxs("span",{className:`${x}`,children:[n.toFixed(0)," / ",r.toFixed(0),s]})]}),y.jsx("div",{className:"w-full bg-slate-200 dark:bg-slate-700 rounded-full h-2.5",children:y.jsx("div",{className:`${g} h-2.5 rounded-full`,style:{width:`${f}%`,transition:"width 0.5s ease-in-out"}})})]})},iI=({insight:t,isLoading:e})=>{const{t:n}=Vt();return e?y.jsxs("div",{className:"glass-card p-4 flex items-center justify-center gap-3 animate-pulse-fast min-h-[80px]",children:[y.jsx(hn,{className:"h-8 w-8"}),y.jsx("p",{className:"text-ui-text-secondary dark:text-slate-300",children:n("dashboardGeneratingTip")})]}):t?y.jsxs("div",{className:"glass-card p-4 flex items-center gap-3 animate-fade-in min-h-[80px]",children:[y.jsx("span",{className:"text-4xl flex-shrink-0",children:t.emoji}),y.jsxs("div",{children:[y.jsx("h4",{className:"font-bold text-ui-text dark:text-slate-100",children:t.title}),y.jsx("p",{className:"text-sm text-ui-text-secondary dark:text-slate-300",children:t.message})]})]}):y.jsxs("div",{className:"glass-card p-4 flex items-center gap-3 animate-fade-in min-h-[80px]",children:[y.jsx(PF,{className:"h-8 w-8 text-brand-primary flex-shrink-0"}),y.jsxs("div",{children:[y.jsx("h4",{className:"font-bold text-ui-text dark:text-slate-100",children:n("dashboardLogFirstMeal")}),y.jsx("p",{className:"text-sm text-ui-text-secondary dark:text-slate-300",children:n("dashboardGetInsights")})]})]})},sI=({suggestion:t,isLoading:e,onSuggest:n,error:r})=>{const{t:a}=Vt();return y.jsxs("div",{className:"glass-card p-6 flex flex-col justify-between h-full",children:[y.jsxs("div",{children:[y.jsxs("h3",{className:"text-xl font-bold text-ui-text dark:text-slate-100 mb-2 flex items-center gap-2",children:[y.jsx(OF,{className:"h-6 w-6 text-brand-primary"}),a("dashboardAiMealSuggestion")]}),e?y.jsxs("div",{className:"flex flex-col items-center justify-center py-4",children:[y.jsx(hn,{}),y.jsx("p",{className:"mt-2 text-sm text-ui-text-secondary dark:text-slate-400",children:a("dashboardThinkingMeal")})]}):r?y.jsxs("div",{className:"p-3 bg-red-100 dark:bg-red-900/40 rounded-lg text-red-700 dark:text-red-200 text-sm flex items-start gap-2",children:[y.jsx(Qa,{className:"h-5 w-5 flex-shrink-0 mt-0.5"}),y.jsx("span",{children:r})]}):t?y.jsxs("div",{className:"space-y-3 animate-fade-in",children:[y.jsx("h4",{className:"text-lg font-bold text-brand-secondary capitalize",children:t.mealName}),y.jsx("p",{className:"text-sm text-ui-text-secondary dark:text-slate-300",children:t.description}),y.jsxs("div",{className:"p-3 bg-brand-primary/10 dark:bg-brand-primary/20 rounded-lg",children:[y.jsx("p",{className:"text-xs font-semibold text-brand-primary dark:text-brand-accent mb-1",children:a("dashboardWhyThisMeal")}),y.jsx("p",{className:"text-sm text-brand-primary/80 dark:text-brand-accent/90",children:t.reason})]})]}):y.jsx("p",{className:"text-sm text-ui-text-secondary dark:text-slate-400",children:a("dashboardGetSuggestion")})]}),y.jsxs("button",{onClick:n,disabled:e,className:"w-full mt-4 flex items-center justify-center gap-2 px-4 py-2 bg-brand-primary text-white font-semibold rounded-lg hover:bg-brand-secondary disabled:bg-slate-400",children:[y.jsx(sc,{className:"h-5 w-5"}),a(t?"dashboardSuggestAnother":"dashboardSuggestMeal")]})]})},oI=({connections:t})=>{const{t:e}=Vt(),n=t.filter(r=>r.doctor_note&&r.doctor_note.trim()!=="");return n.length===0?null:y.jsxs("div",{className:"glass-card p-6 animate-slide-up",style:{animationDelay:"100ms"},children:[y.jsx("h3",{className:"text-xl font-bold text-ui-text dark:text-slate-100 mb-3",children:e("dashboardDoctorNotes")}),y.jsx("div",{className:"space-y-4",children:n.map(r=>{var a,s;return y.jsxs("div",{className:"p-4 bg-blue-100 dark:bg-blue-900/40 rounded-lg border border-blue-200 dark:border-blue-700",children:[y.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[y.jsx(xs,{className:"h-5 w-5 text-blue-600 dark:text-blue-300"}),y.jsx("p",{className:"font-semibold text-blue-800 dark:text-blue-200",children:e("dashboardNoteFrom",{name:((s=(a=r.doctors)==null?void 0:a.full_name)==null?void 0:s.split(" ").pop())||""})})]}),y.jsx("p",{className:"text-blue-700 dark:text-blue-300 whitespace-pre-wrap text-sm",children:r.doctor_note})]},r.id)})})]})},lI=({profile:t,style:e})=>{const{t:n}=Vt(),r=Hm(t.weightKg,t.heightCm),a=Gm(r);return y.jsxs("div",{className:"glass-card p-6 flex flex-col justify-center items-center animate-slide-up",style:e,children:[y.jsx("h3",{className:"text-lg font-bold text-ui-text dark:text-slate-100 mb-2",children:n("dashboardBmi")}),r&&a?y.jsxs(y.Fragment,{children:[y.jsx("p",{className:`text-5xl font-bold ${a.colorClass}`,children:r.toFixed(1)}),y.jsx("p",{className:`font-semibold ${a.colorClass}`,children:a.status})]}):y.jsx("p",{className:"text-ui-text-secondary dark:text-slate-400",children:n("dashboardEnterBmi")})]})},cI=({userProfile:t,todaysIntake:e,healthInsight:n,isLoadingInsight:r,mealSuggestion:a,isSuggestingMeal:s,onSuggestMeal:l,setView:c,error:f,doctorConnections:d})=>{var N;const g=t.dailyCalorieGoal??2e3,x=t.dailyProteinGoal??50,_=t.dailyCarbohydratesGoal??250,T=t.dailyFatGoal??65,E=t.dailySugarGoal??25,S=t.dailySodiumGoal??1500,C=g>0?e.calories/g*100:0,{t:k}=Vt();return y.jsxs("div",{className:"w-full max-w-6xl mx-auto animate-fade-in space-y-6 sm:space-y-8",children:[y.jsxs("div",{className:"text-center animate-slide-up",children:[y.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-ui-text dark:text-slate-50",children:k("dashboardTitle")}),y.jsx("p",{className:"text-ui-text-secondary dark:text-slate-400 mt-1",children:k("dashboardGreeting",{name:((N=t.fullName)==null?void 0:N.split(" ")[0])||k("patient")})})]}),y.jsxs("div",{className:"flex flex-col sm:flex-row flex-wrap justify-center items-center gap-4 animate-slide-up",style:{animationDelay:"100ms"},children:[y.jsxs("button",{onClick:()=>c("analyze"),className:"w-full sm:w-auto inline-flex items-center justify-center gap-2 px-6 py-3 bg-gradient-to-r from-brand-secondary to-brand-primary text-white font-bold rounded-full hover:shadow-lg hover:-translate-y-0.5 shadow-md",children:[y.jsx(Mm,{className:"h-6 w-6"}),k("dashboardScanFood")]}),y.jsxs("button",{onClick:()=>c("prescription"),className:"w-full sm:w-auto inline-flex items-center justify-center gap-2 px-6 py-3 bg-gradient-to-r from-blue-500 to-blue-600 text-white font-bold rounded-full hover:shadow-lg hover:-translate-y-0.5 shadow-md",children:[y.jsx(Pc,{className:"h-6 w-6"}),k("dashboardAnalyzePrescription")]})]}),y.jsx(oI,{connections:d}),y.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 sm:gap-8",children:[y.jsxs("div",{className:"lg:col-span-2 grid grid-cols-1 sm:grid-cols-2 gap-6 sm:gap-8",children:[y.jsx("div",{className:"flex justify-center items-center glass-card p-6 animate-slide-up",style:{animationDelay:"200ms"},children:g>0?y.jsx(aI,{percentage:C,label:k("dashboardCalories"),value:e.calories,goal:g}):y.jsxs("div",{className:"flex flex-col items-center justify-center h-full w-48 h-48",children:[y.jsx(hn,{}),y.jsx("p",{className:"text-xs text-ui-text-secondary dark:text-slate-400 mt-2",children:k("dashboardLoadingGoals")})]})}),y.jsx(lI,{profile:t,style:{animationDelay:"300ms"}}),y.jsxs("div",{className:"sm:col-span-2 glass-card p-6 space-y-6 animate-slide-up",style:{animationDelay:"400ms"},children:[y.jsx("h3",{className:"text-xl font-bold text-ui-text dark:text-slate-100",children:k("dashboardMacros")}),x>0?y.jsxs("div",{className:"space-y-4",children:[y.jsx(Zl,{label:k("nutrientProtein"),icon:y.jsx(Em,{className:"h-5 w-5"}),current:e.proteinGrams,goal:x,color:"bg-red-500",style:{animationDelay:"450ms"}}),y.jsx(Zl,{label:k("nutrientCarbs"),icon:y.jsx(Cm,{className:"h-5 w-5"}),current:e.carbohydratesGrams,goal:_,color:"bg-blue-500",style:{animationDelay:"500ms"}}),y.jsx(Zl,{label:k("nutrientFat"),icon:y.jsx(bm,{className:"h-5 w-5"}),current:e.fatGrams,goal:T,color:"bg-yellow-500",style:{animationDelay:"550ms"}})]}):y.jsx("p",{className:"text-ui-text-secondary dark:text-slate-400 text-sm",children:k("dashboardLoadingMacros")})]})]}),y.jsxs("div",{className:"space-y-6 sm:space-y-8",children:[y.jsxs("div",{className:"glass-card p-6 space-y-4 animate-slide-up",style:{animationDelay:"300ms"},children:[y.jsx("h3",{className:"text-xl font-bold text-ui-text dark:text-slate-100",children:k("dashboardDailyLimits")}),y.jsx(Zl,{label:k("nutrientSugar"),icon:y.jsx(Am,{className:"h-5 w-5"}),current:e.sugarGrams,goal:E,color:"bg-purple-500",style:{animationDelay:"350ms"}}),y.jsx(Zl,{label:k("nutrientSodium"),icon:y.jsx(km,{className:"h-5 w-5"}),current:e.sodiumMilligrams,goal:S,color:"bg-pink-500",unit:"mg",style:{animationDelay:"400ms"}})]}),y.jsx("div",{className:"animate-slide-up",style:{animationDelay:"400ms"},children:y.jsxs("div",{className:"glass-card p-6",children:[y.jsx("h3",{className:"text-xl font-bold text-ui-text dark:text-slate-100 mb-2",children:k("dashboardAiTip")}),y.jsx(iI,{insight:n,isLoading:r})]})})]})]}),y.jsx("div",{className:"grid grid-cols-1",children:y.jsx("div",{className:"animate-slide-up",style:{animationDelay:"500ms"},children:y.jsx(sI,{suggestion:a,isLoading:s,onSuggest:l,error:f})})})]})};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Af={};Af.version="0.18.5";var PT=1252,uI=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],zm={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},qm=function(t){uI.indexOf(t)!=-1&&(PT=zm[0]=t)};function fI(){qm(1252)}var la=function(t){qm(t)};function jm(){la(1200),fI()}function d_(t){for(var e=[],n=0,r=t.length;n<r;++n)e[n]=t.charCodeAt(n);return e}function dI(t){for(var e=[],n=0;n<t.length>>1;++n)e[n]=String.fromCharCode(t.charCodeAt(2*n)+(t.charCodeAt(2*n+1)<<8));return e.join("")}function LT(t){for(var e=[],n=0;n<t.length>>1;++n)e[n]=String.fromCharCode(t.charCodeAt(2*n+1)+(t.charCodeAt(2*n)<<8));return e.join("")}var nc=function(t){var e=t.charCodeAt(0),n=t.charCodeAt(1);return e==255&&n==254?dI(t.slice(2)):e==254&&n==255?LT(t.slice(2)):e==65279?t.slice(1):t},lf=function(e){return String.fromCharCode(e)},h_=function(e){return String.fromCharCode(e)},yc,Ri="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function _c(t){for(var e="",n=0,r=0,a=0,s=0,l=0,c=0,f=0,d=0;d<t.length;)n=t.charCodeAt(d++),s=n>>2,r=t.charCodeAt(d++),l=(n&3)<<4|r>>4,a=t.charCodeAt(d++),c=(r&15)<<2|a>>6,f=a&63,isNaN(r)?c=f=64:isNaN(a)&&(f=64),e+=Ri.charAt(s)+Ri.charAt(l)+Ri.charAt(c)+Ri.charAt(f);return e}function Dr(t){var e="",n=0,r=0,a=0,s=0,l=0,c=0,f=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var d=0;d<t.length;)s=Ri.indexOf(t.charAt(d++)),l=Ri.indexOf(t.charAt(d++)),n=s<<2|l>>4,e+=String.fromCharCode(n),c=Ri.indexOf(t.charAt(d++)),r=(l&15)<<4|c>>2,c!==64&&(e+=String.fromCharCode(r)),f=Ri.indexOf(t.charAt(d++)),a=(c&3)<<6|f,f!==64&&(e+=String.fromCharCode(a));return e}var lt=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),ei=function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,n){return n?new Buffer(e,n):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function Ii(t){return lt?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function m_(t){return lt?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var Nr=function(e){return lt?ei(e,"binary"):e.split("").map(function(n){return n.charCodeAt(0)&255})};function Wf(t){if(typeof ArrayBuffer>"u")return Nr(t);for(var e=new ArrayBuffer(t.length),n=new Uint8Array(e),r=0;r!=t.length;++r)n[r]=t.charCodeAt(r)&255;return e}function Bi(t){if(Array.isArray(t))return t.map(function(r){return String.fromCharCode(r)}).join("");for(var e=[],n=0;n<t.length;++n)e[n]=String.fromCharCode(t[n]);return e.join("")}function hI(t){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(t)}function $m(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return $m(new Uint8Array(t));for(var e=new Array(t.length),n=0;n<t.length;++n)e[n]=t[n];return e}var In=lt?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:ei(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,n=0;for(e=0;e<t.length;++e)n+=t[e].length;var r=new Uint8Array(n),a=0;for(e=0,n=0;e<t.length;n+=a,++e)if(a=t[e].length,t[e]instanceof Uint8Array)r.set(t[e],n);else{if(typeof t[e]=="string")throw"wtf";r.set(new Uint8Array(t[e]),n)}return r}return[].concat.apply([],t.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function mI(t){for(var e=[],n=0,r=t.length+250,a=Ii(t.length+255),s=0;s<t.length;++s){var l=t.charCodeAt(s);if(l<128)a[n++]=l;else if(l<2048)a[n++]=192|l>>6&31,a[n++]=128|l&63;else if(l>=55296&&l<57344){l=(l&1023)+64;var c=t.charCodeAt(++s)&1023;a[n++]=240|l>>8&7,a[n++]=128|l>>2&63,a[n++]=128|c>>6&15|(l&3)<<4,a[n++]=128|c&63}else a[n++]=224|l>>12&15,a[n++]=128|l>>6&63,a[n++]=128|l&63;n>r&&(e.push(a.slice(0,n)),n=0,a=Ii(65535),r=65530)}return e.push(a.slice(0,n)),In(e)}var ur=/\u0000/g,rc=/[\u0001-\u0006]/g;function Io(t){for(var e="",n=t.length-1;n>=0;)e+=t.charAt(n--);return e}function ca(t,e){var n=""+t;return n.length>=e?n:sn("0",e-n.length)+n}function Wm(t,e){var n=""+t;return n.length>=e?n:sn(" ",e-n.length)+n}function kf(t,e){var n=""+t;return n.length>=e?n:n+sn(" ",e-n.length)}function pI(t,e){var n=""+Math.round(t);return n.length>=e?n:sn("0",e-n.length)+n}function gI(t,e){var n=""+t;return n.length>=e?n:sn("0",e-n.length)+n}var p_=Math.pow(2,32);function So(t,e){if(t>p_||t<-p_)return pI(t,e);var n=Math.round(t);return gI(n,e)}function Nf(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var g_=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Th=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function xI(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"/ "hh""mm""ss" "',t}var Ye={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},x_={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},vI={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Mf(t,e,n){for(var r=t<0?-1:1,a=t*r,s=0,l=1,c=0,f=1,d=0,g=0,x=Math.floor(a);d<e&&(x=Math.floor(a),c=x*l+s,g=x*d+f,!(a-x<5e-8));)a=1/(a-x),s=l,l=c,f=d,d=g;if(g>e&&(d>e?(g=f,c=s):(g=d,c=l)),!n)return[0,r*c,g];var _=Math.floor(r*c/g);return[_,r*c-_*g,g]}function fs(t,e,n){if(t>2958465||t<0)return null;var r=t|0,a=Math.floor(86400*(t-r)),s=0,l=[],c={D:r,T:a,u:86400*(t-r)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(c.u)<1e-6&&(c.u=0),e&&e.date1904&&(r+=1462),c.u>.9999&&(c.u=0,++a==86400&&(c.T=a=0,++r,++c.D)),r===60)l=n?[1317,10,29]:[1900,2,29],s=3;else if(r===0)l=n?[1317,8,29]:[1900,1,0],s=6;else{r>60&&--r;var f=new Date(1900,0,1);f.setDate(f.getDate()+r-1),l=[f.getFullYear(),f.getMonth()+1,f.getDate()],s=f.getDay(),r<60&&(s=(s+6)%7),n&&(s=EI(f,l))}return c.y=l[0],c.m=l[1],c.d=l[2],c.S=a%60,a=Math.floor(a/60),c.M=a%60,a=Math.floor(a/60),c.H=a,c.q=s,c}var OT=new Date(1899,11,31,0,0,0),yI=OT.getTime(),_I=new Date(1900,2,1,0,0,0);function UT(t,e){var n=t.getTime();return e?n-=1461*24*60*60*1e3:t>=_I&&(n+=24*60*60*1e3),(n-(yI+(t.getTimezoneOffset()-OT.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Ym(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function TI(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function wI(t){var e=t<0?12:11,n=Ym(t.toFixed(12));return n.length<=e||(n=t.toPrecision(10),n.length<=e)?n:t.toExponential(5)}function SI(t){var e=Ym(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function Tc(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),n;return e>=-4&&e<=-1?n=t.toPrecision(10+e):Math.abs(e)<=9?n=wI(t):e===10?n=t.toFixed(10).substr(0,12):n=SI(t),Ym(TI(n.toUpperCase()))}function vs(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):Tc(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return Kr(14,UT(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function EI(t,e){e[0]-=581;var n=t.getDay();return t<60&&(n=(n+6)%7),n}function CI(t,e,n,r){var a="",s=0,l=0,c=n.y,f,d=0;switch(t){case 98:c=n.y+543;case 121:switch(e.length){case 1:case 2:f=c%100,d=2;break;default:f=c%1e4,d=4;break}break;case 109:switch(e.length){case 1:case 2:f=n.m,d=e.length;break;case 3:return Th[n.m-1][1];case 5:return Th[n.m-1][0];default:return Th[n.m-1][2]}break;case 100:switch(e.length){case 1:case 2:f=n.d,d=e.length;break;case 3:return g_[n.q][0];default:return g_[n.q][1]}break;case 104:switch(e.length){case 1:case 2:f=1+(n.H+11)%12,d=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:f=n.H,d=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:f=n.M,d=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return n.u===0&&(e=="s"||e=="ss")?ca(n.S,e.length):(r>=2?l=r===3?1e3:100:l=r===1?10:1,s=Math.round(l*(n.S+n.u)),s>=60*l&&(s=0),e==="s"?s===0?"0":""+s/l:(a=ca(s,2+r),e==="ss"?a.substr(0,2):"."+a.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":f=n.D*24+n.H;break;case"[m]":case"[mm]":f=(n.D*24+n.H)*60+n.M;break;case"[s]":case"[ss]":f=((n.D*24+n.H)*60+n.M)*60+Math.round(n.S+n.u);break;default:throw"bad abstime format: "+e}d=e.length===3?1:2;break;case 101:f=c,d=1;break}var g=d>0?ca(f,d):"";return g}function Fi(t){var e=3;if(t.length<=e)return t;for(var n=t.length%e,r=t.substr(0,n);n!=t.length;n+=e)r+=(r.length>0?",":"")+t.substr(n,e);return r}var BT=/%/g;function bI(t,e,n){var r=e.replace(BT,""),a=e.length-r.length;return Wa(t,r,n*Math.pow(10,2*a))+sn("%",a)}function AI(t,e,n){for(var r=e.length-1;e.charCodeAt(r-1)===44;)--r;return Wa(t,e.substr(0,r),n/Math.pow(10,3*(e.length-r)))}function VT(t,e){var n,r=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+VT(t,-e);var a=t.indexOf(".");a===-1&&(a=t.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%a;if(s<0&&(s+=a),n=(e/Math.pow(10,s)).toPrecision(r+1+(a+s)%a),n.indexOf("e")===-1){var l=Math.floor(Math.log(e)*Math.LOG10E);for(n.indexOf(".")===-1?n=n.charAt(0)+"."+n.substr(1)+"E+"+(l-n.length+s):n+="E+"+(l-s);n.substr(0,2)==="0.";)n=n.charAt(0)+n.substr(2,a)+"."+n.substr(2+a),n=n.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");n=n.replace(/\+-/,"-")}n=n.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,f,d,g){return f+d+g.substr(0,(a+s)%a)+"."+g.substr(s)+"E"})}else n=e.toExponential(r);return t.match(/E\+00$/)&&n.match(/e[+-]\d$/)&&(n=n.substr(0,n.length-1)+"0"+n.charAt(n.length-1)),t.match(/E\-/)&&n.match(/e\+/)&&(n=n.replace(/e\+/,"e")),n.replace("e","E")}var GT=/# (\?+)( ?)\/( ?)(\d+)/;function kI(t,e,n){var r=parseInt(t[4],10),a=Math.round(e*r),s=Math.floor(a/r),l=a-s*r,c=r;return n+(s===0?"":""+s)+" "+(l===0?sn(" ",t[1].length+1+t[4].length):Wm(l,t[1].length)+t[2]+"/"+t[3]+ca(c,t[4].length))}function NI(t,e,n){return n+(e===0?"":""+e)+sn(" ",t[1].length+2+t[4].length)}var HT=/^#*0*\.([0#]+)/,zT=/\).*[0#]/,qT=/\(###\) ###\\?-####/;function lr(t){for(var e="",n,r=0;r!=t.length;++r)switch(n=t.charCodeAt(r)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(n)}return e}function v_(t,e){var n=Math.pow(10,e);return""+Math.round(t*n)/n}function y_(t,e){var n=t-Math.floor(t),r=Math.pow(10,e);return e<(""+Math.round(n*r)).length?0:Math.round(n*r)}function MI(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function DI(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function qr(t,e,n){if(t.charCodeAt(0)===40&&!e.match(zT)){var r=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return n>=0?qr("n",r,n):"("+qr("n",r,-n)+")"}if(e.charCodeAt(e.length-1)===44)return AI(t,e,n);if(e.indexOf("%")!==-1)return bI(t,e,n);if(e.indexOf("E")!==-1)return VT(e,n);if(e.charCodeAt(0)===36)return"$"+qr(t,e.substr(e.charAt(1)==" "?2:1),n);var a,s,l,c,f=Math.abs(n),d=n<0?"-":"";if(e.match(/^00+$/))return d+So(f,e.length);if(e.match(/^[#?]+$/))return a=So(n,0),a==="0"&&(a=""),a.length>e.length?a:lr(e.substr(0,e.length-a.length))+a;if(s=e.match(GT))return kI(s,f,d);if(e.match(/^#+0+$/))return d+So(f,e.length-e.indexOf("0"));if(s=e.match(HT))return a=v_(n,s[1].length).replace(/^([^\.]+)$/,"$1."+lr(s[1])).replace(/\.$/,"."+lr(s[1])).replace(/\.(\d*)$/,function(E,S){return"."+S+sn("0",lr(s[1]).length-S.length)}),e.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return d+v_(f,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return d+Fi(So(f,0));if(s=e.match(/^#,##0\.([#0]*0)$/))return n<0?"-"+qr(t,e,-n):Fi(""+(Math.floor(n)+MI(n,s[1].length)))+"."+ca(y_(n,s[1].length),s[1].length);if(s=e.match(/^#,#*,#0/))return qr(t,e.replace(/^#,#*,/,""),n);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Io(qr(t,e.replace(/[\\-]/g,""),n)),l=0,Io(Io(e.replace(/\\/g,"")).replace(/[0#]/g,function(E){return l<a.length?a.charAt(l++):E==="0"?"0":""}));if(e.match(qT))return a=qr(t,"##########",n),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var g="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(s[4].length,7),c=Mf(f,Math.pow(10,l)-1,!1),a=""+d,g=Wa("n",s[1],c[1]),g.charAt(g.length-1)==" "&&(g=g.substr(0,g.length-1)+"0"),a+=g+s[2]+"/"+s[3],g=kf(c[2],l),g.length<s[4].length&&(g=lr(s[4].substr(s[4].length-g.length))+g),a+=g,a;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(s[1].length,s[4].length),7),c=Mf(f,Math.pow(10,l)-1,!0),d+(c[0]||(c[1]?"":"0"))+" "+(c[1]?Wm(c[1],l)+s[2]+"/"+s[3]+kf(c[2],l):sn(" ",2*l+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return a=So(n,0),e.length<=a.length?a:lr(e.substr(0,e.length-a.length))+a;if(s=e.match(/^([#0?]+)\.([#0]+)$/)){a=""+n.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),l=a.indexOf(".");var x=e.indexOf(".")-l,_=e.length-a.length-x;return lr(e.substr(0,x)+a+e.substr(e.length-_))}if(s=e.match(/^00,000\.([#0]*0)$/))return l=y_(n,s[1].length),n<0?"-"+qr(t,e,-n):Fi(DI(n)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(E){return"00,"+(E.length<3?ca(0,3-E.length):"")+E})+"."+ca(l,s[1].length);switch(e){case"###,##0.00":return qr(t,"#,##0.00",n);case"###,###":case"##,###":case"#,###":var T=Fi(So(f,0));return T!=="0"?d+T:"";case"###,###.00":return qr(t,"###,##0.00",n).replace(/^0\./,".");case"#,###.00":return qr(t,"#,##0.00",n).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function RI(t,e,n){for(var r=e.length-1;e.charCodeAt(r-1)===44;)--r;return Wa(t,e.substr(0,r),n/Math.pow(10,3*(e.length-r)))}function FI(t,e,n){var r=e.replace(BT,""),a=e.length-r.length;return Wa(t,r,n*Math.pow(10,2*a))+sn("%",a)}function jT(t,e){var n,r=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+jT(t,-e);var a=t.indexOf(".");a===-1&&(a=t.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%a;if(s<0&&(s+=a),n=(e/Math.pow(10,s)).toPrecision(r+1+(a+s)%a),!n.match(/[Ee]/)){var l=Math.floor(Math.log(e)*Math.LOG10E);n.indexOf(".")===-1?n=n.charAt(0)+"."+n.substr(1)+"E+"+(l-n.length+s):n+="E+"+(l-s),n=n.replace(/\+-/,"-")}n=n.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,f,d,g){return f+d+g.substr(0,(a+s)%a)+"."+g.substr(s)+"E"})}else n=e.toExponential(r);return t.match(/E\+00$/)&&n.match(/e[+-]\d$/)&&(n=n.substr(0,n.length-1)+"0"+n.charAt(n.length-1)),t.match(/E\-/)&&n.match(/e\+/)&&(n=n.replace(/e\+/,"e")),n.replace("e","E")}function wa(t,e,n){if(t.charCodeAt(0)===40&&!e.match(zT)){var r=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return n>=0?wa("n",r,n):"("+wa("n",r,-n)+")"}if(e.charCodeAt(e.length-1)===44)return RI(t,e,n);if(e.indexOf("%")!==-1)return FI(t,e,n);if(e.indexOf("E")!==-1)return jT(e,n);if(e.charCodeAt(0)===36)return"$"+wa(t,e.substr(e.charAt(1)==" "?2:1),n);var a,s,l,c,f=Math.abs(n),d=n<0?"-":"";if(e.match(/^00+$/))return d+ca(f,e.length);if(e.match(/^[#?]+$/))return a=""+n,n===0&&(a=""),a.length>e.length?a:lr(e.substr(0,e.length-a.length))+a;if(s=e.match(GT))return NI(s,f,d);if(e.match(/^#+0+$/))return d+ca(f,e.length-e.indexOf("0"));if(s=e.match(HT))return a=(""+n).replace(/^([^\.]+)$/,"$1."+lr(s[1])).replace(/\.$/,"."+lr(s[1])),a=a.replace(/\.(\d*)$/,function(E,S){return"."+S+sn("0",lr(s[1]).length-S.length)}),e.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return d+(""+f).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return d+Fi(""+f);if(s=e.match(/^#,##0\.([#0]*0)$/))return n<0?"-"+wa(t,e,-n):Fi(""+n)+"."+sn("0",s[1].length);if(s=e.match(/^#,#*,#0/))return wa(t,e.replace(/^#,#*,/,""),n);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Io(wa(t,e.replace(/[\\-]/g,""),n)),l=0,Io(Io(e.replace(/\\/g,"")).replace(/[0#]/g,function(E){return l<a.length?a.charAt(l++):E==="0"?"0":""}));if(e.match(qT))return a=wa(t,"##########",n),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var g="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(s[4].length,7),c=Mf(f,Math.pow(10,l)-1,!1),a=""+d,g=Wa("n",s[1],c[1]),g.charAt(g.length-1)==" "&&(g=g.substr(0,g.length-1)+"0"),a+=g+s[2]+"/"+s[3],g=kf(c[2],l),g.length<s[4].length&&(g=lr(s[4].substr(s[4].length-g.length))+g),a+=g,a;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(s[1].length,s[4].length),7),c=Mf(f,Math.pow(10,l)-1,!0),d+(c[0]||(c[1]?"":"0"))+" "+(c[1]?Wm(c[1],l)+s[2]+"/"+s[3]+kf(c[2],l):sn(" ",2*l+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return a=""+n,e.length<=a.length?a:lr(e.substr(0,e.length-a.length))+a;if(s=e.match(/^([#0]+)\.([#0]+)$/)){a=""+n.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),l=a.indexOf(".");var x=e.indexOf(".")-l,_=e.length-a.length-x;return lr(e.substr(0,x)+a+e.substr(e.length-_))}if(s=e.match(/^00,000\.([#0]*0)$/))return n<0?"-"+wa(t,e,-n):Fi(""+n).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(E){return"00,"+(E.length<3?ca(0,3-E.length):"")+E})+"."+ca(0,s[1].length);switch(e){case"###,###":case"##,###":case"#,###":var T=Fi(""+f);return T!=="0"?d+T:"";default:if(e.match(/\.[0#?]*$/))return wa(t,e.slice(0,e.lastIndexOf(".")),n)+lr(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function Wa(t,e,n){return(n|0)===n?wa(t,e,n):qr(t,e,n)}function II(t){for(var e=[],n=!1,r=0,a=0;r<t.length;++r)switch(t.charCodeAt(r)){case 34:n=!n;break;case 95:case 42:case 92:++r;break;case 59:e[e.length]=t.substr(a,r-a),a=r+1}if(e[e.length]=t.substr(a),n===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var $T=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Jo(t){for(var e=0,n="",r="";e<t.length;)switch(n=t.charAt(e)){case"G":Nf(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(r=n;t.charAt(e++)!=="]"&&e<t.length;)r+=t.charAt(e);if(r.match($T))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(n=t.charAt(++e))>-1||n=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===n;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function PI(t,e,n,r){for(var a=[],s="",l=0,c="",f="t",d,g,x,_="H";l<t.length;)switch(c=t.charAt(l)){case"G":if(!Nf(t,l))throw new Error("unrecognized character "+c+" in "+t);a[a.length]={t:"G",v:"General"},l+=7;break;case'"':for(s="";(x=t.charCodeAt(++l))!==34&&l<t.length;)s+=String.fromCharCode(x);a[a.length]={t:"t",v:s},++l;break;case"\\":var T=t.charAt(++l),E=T==="("||T===")"?T:"t";a[a.length]={t:E,v:T},++l;break;case"_":a[a.length]={t:"t",v:" "},l+=2;break;case"@":a[a.length]={t:"T",v:e},++l;break;case"B":case"b":if(t.charAt(l+1)==="1"||t.charAt(l+1)==="2"){if(d==null&&(d=fs(e,n,t.charAt(l+1)==="2"),d==null))return"";a[a.length]={t:"X",v:t.substr(l,2)},f=c,l+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":c=c.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||d==null&&(d=fs(e,n),d==null))return"";for(s=c;++l<t.length&&t.charAt(l).toLowerCase()===c;)s+=c;c==="m"&&f.toLowerCase()==="h"&&(c="M"),c==="h"&&(c=_),a[a.length]={t:c,v:s},f=c;break;case"A":case"a":case"":var S={t:c,v:c};if(d==null&&(d=fs(e,n)),t.substr(l,3).toUpperCase()==="A/P"?(d!=null&&(S.v=d.H>=12?"P":"A"),S.t="T",_="h",l+=3):t.substr(l,5).toUpperCase()==="AM/PM"?(d!=null&&(S.v=d.H>=12?"PM":"AM"),S.t="T",l+=5,_="h"):t.substr(l,5).toUpperCase()==="/"?(d!=null&&(S.v=d.H>=12?"":""),S.t="T",l+=5,_="h"):(S.t="t",++l),d==null&&S.t==="T")return"";a[a.length]=S,f=c;break;case"[":for(s=c;t.charAt(l++)!=="]"&&l<t.length;)s+=t.charAt(l);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match($T)){if(d==null&&(d=fs(e,n),d==null))return"";a[a.length]={t:"Z",v:s.toLowerCase()},f=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",Jo(t)||(a[a.length]={t:"t",v:s}));break;case".":if(d!=null){for(s=c;++l<t.length&&(c=t.charAt(l))==="0";)s+=c;a[a.length]={t:"s",v:s};break}case"0":case"#":for(s=c;++l<t.length&&"0#?.,E+-%".indexOf(c=t.charAt(l))>-1;)s+=c;a[a.length]={t:"n",v:s};break;case"?":for(s=c;t.charAt(++l)===c;)s+=c;a[a.length]={t:c,v:s},f=c;break;case"*":++l,(t.charAt(l)==" "||t.charAt(l)=="*")&&++l;break;case"(":case")":a[a.length]={t:r===1?"t":c,v:c},++l;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=c;l<t.length&&"0123456789".indexOf(t.charAt(++l))>-1;)s+=t.charAt(l);a[a.length]={t:"D",v:s};break;case" ":a[a.length]={t:c,v:c},++l;break;case"$":a[a.length]={t:"t",v:"$"},++l;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(c)===-1)throw new Error("unrecognized character "+c+" in "+t);a[a.length]={t:"t",v:c},++l;break}var C=0,k=0,N;for(l=a.length-1,f="t";l>=0;--l)switch(a[l].t){case"h":case"H":a[l].t=_,f="h",C<1&&(C=1);break;case"s":(N=a[l].v.match(/\.0+$/))&&(k=Math.max(k,N[0].length-1)),C<3&&(C=3);case"d":case"y":case"M":case"e":f=a[l].t;break;case"m":f==="s"&&(a[l].t="M",C<2&&(C=2));break;case"X":break;case"Z":C<1&&a[l].v.match(/[Hh]/)&&(C=1),C<2&&a[l].v.match(/[Mm]/)&&(C=2),C<3&&a[l].v.match(/[Ss]/)&&(C=3)}switch(C){case 0:break;case 1:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M),d.M>=60&&(d.M=0,++d.H);break;case 2:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M);break}var b="",I;for(l=0;l<a.length;++l)switch(a[l].t){case"t":case"T":case" ":case"D":break;case"X":a[l].v="",a[l].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[l].v=CI(a[l].t.charCodeAt(0),a[l].v,d,k),a[l].t="t";break;case"n":case"?":for(I=l+1;a[I]!=null&&((c=a[I].t)==="?"||c==="D"||(c===" "||c==="t")&&a[I+1]!=null&&(a[I+1].t==="?"||a[I+1].t==="t"&&a[I+1].v==="/")||a[l].t==="("&&(c===" "||c==="n"||c===")")||c==="t"&&(a[I].v==="/"||a[I].v===" "&&a[I+1]!=null&&a[I+1].t=="?"));)a[l].v+=a[I].v,a[I]={v:"",t:";"},++I;b+=a[l].v,l=I-1;break;case"G":a[l].t="t",a[l].v=vs(e,n);break}var F="",P,D;if(b.length>0){b.charCodeAt(0)==40?(P=e<0&&b.charCodeAt(0)===45?-e:e,D=Wa("n",b,P)):(P=e<0&&r>1?-e:e,D=Wa("n",b,P),P<0&&a[0]&&a[0].t=="t"&&(D=D.substr(1),a[0].v="-"+a[0].v)),I=D.length-1;var j=a.length;for(l=0;l<a.length;++l)if(a[l]!=null&&a[l].t!="t"&&a[l].v.indexOf(".")>-1){j=l;break}var B=a.length;if(j===a.length&&D.indexOf("E")===-1){for(l=a.length-1;l>=0;--l)a[l]==null||"n?".indexOf(a[l].t)===-1||(I>=a[l].v.length-1?(I-=a[l].v.length,a[l].v=D.substr(I+1,a[l].v.length)):I<0?a[l].v="":(a[l].v=D.substr(0,I+1),I=-1),a[l].t="t",B=l);I>=0&&B<a.length&&(a[B].v=D.substr(0,I+1)+a[B].v)}else if(j!==a.length&&D.indexOf("E")===-1){for(I=D.indexOf(".")-1,l=j;l>=0;--l)if(!(a[l]==null||"n?".indexOf(a[l].t)===-1)){for(g=a[l].v.indexOf(".")>-1&&l===j?a[l].v.indexOf(".")-1:a[l].v.length-1,F=a[l].v.substr(g+1);g>=0;--g)I>=0&&(a[l].v.charAt(g)==="0"||a[l].v.charAt(g)==="#")&&(F=D.charAt(I--)+F);a[l].v=F,a[l].t="t",B=l}for(I>=0&&B<a.length&&(a[B].v=D.substr(0,I+1)+a[B].v),I=D.indexOf(".")+1,l=j;l<a.length;++l)if(!(a[l]==null||"n?(".indexOf(a[l].t)===-1&&l!==j)){for(g=a[l].v.indexOf(".")>-1&&l===j?a[l].v.indexOf(".")+1:0,F=a[l].v.substr(0,g);g<a[l].v.length;++g)I<D.length&&(F+=D.charAt(I++));a[l].v=F,a[l].t="t",B=l}}}for(l=0;l<a.length;++l)a[l]!=null&&"n?".indexOf(a[l].t)>-1&&(P=r>1&&e<0&&l>0&&a[l-1].v==="-"?-e:e,a[l].v=Wa(a[l].t,a[l].v,P),a[l].t="t");var te="";for(l=0;l!==a.length;++l)a[l]!=null&&(te+=a[l].v);return te}var __=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function T_(t,e){if(e==null)return!1;var n=parseFloat(e[2]);switch(e[1]){case"=":if(t==n)return!0;break;case">":if(t>n)return!0;break;case"<":if(t<n)return!0;break;case"<>":if(t!=n)return!0;break;case">=":if(t>=n)return!0;break;case"<=":if(t<=n)return!0;break}return!1}function LI(t,e){var n=II(t),r=n.length,a=n[r-1].indexOf("@");if(r<4&&a>-1&&--r,n.length>4)throw new Error("cannot find right format for |"+n.join("|")+"|");if(typeof e!="number")return[4,n.length===4||a>-1?n[n.length-1]:"@"];switch(n.length){case 1:n=a>-1?["General","General","General",n[0]]:[n[0],n[0],n[0],"@"];break;case 2:n=a>-1?[n[0],n[0],n[0],n[1]]:[n[0],n[1],n[0],"@"];break;case 3:n=a>-1?[n[0],n[1],n[0],n[2]]:[n[0],n[1],n[2],"@"];break}var s=e>0?n[0]:e<0?n[1]:n[2];if(n[0].indexOf("[")===-1&&n[1].indexOf("[")===-1)return[r,s];if(n[0].match(/\[[=<>]/)!=null||n[1].match(/\[[=<>]/)!=null){var l=n[0].match(__),c=n[1].match(__);return T_(e,l)?[r,n[0]]:T_(e,c)?[r,n[1]]:[r,n[l!=null&&c!=null?2:1]]}return[r,s]}function Kr(t,e,n){n==null&&(n={});var r="";switch(typeof t){case"string":t=="m/d/yy"&&n.dateNF?r=n.dateNF:r=t;break;case"number":t==14&&n.dateNF?r=n.dateNF:r=(n.table!=null?n.table:Ye)[t],r==null&&(r=n.table&&n.table[x_[t]]||Ye[x_[t]]),r==null&&(r=vI[t]||"General");break}if(Nf(r,0))return vs(e,n);e instanceof Date&&(e=UT(e,n.date1904));var a=LI(r,e);if(Nf(a[1]))return vs(e,n);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return PI(a[1],e,n,a[0])}function Ya(t,e){if(typeof e!="number"){e=+e||-1;for(var n=0;n<392;++n){if(Ye[n]==null){e<0&&(e=n);continue}if(Ye[n]==t){e=n;break}}e<0&&(e=391)}return Ye[e]=t,e}function Yf(t){for(var e=0;e!=392;++e)t[e]!==void 0&&Ya(t[e],e)}function Xo(){Ye=xI()}var OI={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},WT=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function UI(t){var e=typeof t=="number"?Ye[t]:t;return e=e.replace(WT,"(\\d+)"),new RegExp("^"+e+"$")}function BI(t,e,n){var r=-1,a=-1,s=-1,l=-1,c=-1,f=-1;(e.match(WT)||[]).forEach(function(x,_){var T=parseInt(n[_+1],10);switch(x.toLowerCase().charAt(0)){case"y":r=T;break;case"d":s=T;break;case"h":l=T;break;case"s":f=T;break;case"m":l>=0?c=T:a=T;break}}),f>=0&&c==-1&&a>=0&&(c=a,a=-1);var d=(""+(r>=0?r:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);d.length==7&&(d="0"+d),d.length==8&&(d="20"+d);var g=("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2)+":"+("00"+(f>=0?f:0)).slice(-2);return l==-1&&c==-1&&f==-1?d:r==-1&&a==-1&&s==-1?g:d+"T"+g}var VI=function(){var t={};t.version="1.2.0";function e(){for(var D=0,j=new Array(256),B=0;B!=256;++B)D=B,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,j[B]=D;return typeof Int32Array<"u"?new Int32Array(j):j}var n=e();function r(D){var j=0,B=0,te=0,X=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(te=0;te!=256;++te)X[te]=D[te];for(te=0;te!=256;++te)for(B=D[te],j=256+te;j<4096;j+=256)B=X[j]=B>>>8^D[B&255];var Z=[];for(te=1;te!=16;++te)Z[te-1]=typeof Int32Array<"u"?X.subarray(te*256,te*256+256):X.slice(te*256,te*256+256);return Z}var a=r(n),s=a[0],l=a[1],c=a[2],f=a[3],d=a[4],g=a[5],x=a[6],_=a[7],T=a[8],E=a[9],S=a[10],C=a[11],k=a[12],N=a[13],b=a[14];function I(D,j){for(var B=j^-1,te=0,X=D.length;te<X;)B=B>>>8^n[(B^D.charCodeAt(te++))&255];return~B}function F(D,j){for(var B=j^-1,te=D.length-15,X=0;X<te;)B=b[D[X++]^B&255]^N[D[X++]^B>>8&255]^k[D[X++]^B>>16&255]^C[D[X++]^B>>>24]^S[D[X++]]^E[D[X++]]^T[D[X++]]^_[D[X++]]^x[D[X++]]^g[D[X++]]^d[D[X++]]^f[D[X++]]^c[D[X++]]^l[D[X++]]^s[D[X++]]^n[D[X++]];for(te+=15;X<te;)B=B>>>8^n[(B^D[X++])&255];return~B}function P(D,j){for(var B=j^-1,te=0,X=D.length,Z=0,ye=0;te<X;)Z=D.charCodeAt(te++),Z<128?B=B>>>8^n[(B^Z)&255]:Z<2048?(B=B>>>8^n[(B^(192|Z>>6&31))&255],B=B>>>8^n[(B^(128|Z&63))&255]):Z>=55296&&Z<57344?(Z=(Z&1023)+64,ye=D.charCodeAt(te++)&1023,B=B>>>8^n[(B^(240|Z>>8&7))&255],B=B>>>8^n[(B^(128|Z>>2&63))&255],B=B>>>8^n[(B^(128|ye>>6&15|(Z&3)<<4))&255],B=B>>>8^n[(B^(128|ye&63))&255]):(B=B>>>8^n[(B^(224|Z>>12&15))&255],B=B>>>8^n[(B^(128|Z>>6&63))&255],B=B>>>8^n[(B^(128|Z&63))&255]);return~B}return t.table=n,t.bstr=I,t.buf=F,t.str=P,t}(),ze=function(){var e={};e.version="1.2.1";function n(M,G){for(var O=M.split("/"),U=G.split("/"),V=0,H=0,le=Math.min(O.length,U.length);V<le;++V){if(H=O[V].length-U[V].length)return H;if(O[V]!=U[V])return O[V]<U[V]?-1:1}return O.length-U.length}function r(M){if(M.charAt(M.length-1)=="/")return M.slice(0,-1).indexOf("/")===-1?M:r(M.slice(0,-1));var G=M.lastIndexOf("/");return G===-1?M:M.slice(0,G+1)}function a(M){if(M.charAt(M.length-1)=="/")return a(M.slice(0,-1));var G=M.lastIndexOf("/");return G===-1?M:M.slice(G+1)}function s(M,G){typeof G=="string"&&(G=new Date(G));var O=G.getHours();O=O<<6|G.getMinutes(),O=O<<5|G.getSeconds()>>>1,M.write_shift(2,O);var U=G.getFullYear()-1980;U=U<<4|G.getMonth()+1,U=U<<5|G.getDate(),M.write_shift(2,U)}function l(M){var G=M.read_shift(2)&65535,O=M.read_shift(2)&65535,U=new Date,V=O&31;O>>>=5;var H=O&15;O>>>=4,U.setMilliseconds(0),U.setFullYear(O+1980),U.setMonth(H-1),U.setDate(V);var le=G&31;G>>>=5;var ge=G&63;return G>>>=6,U.setHours(G),U.setMinutes(ge),U.setSeconds(le<<1),U}function c(M){qn(M,0);for(var G={},O=0;M.l<=M.length-4;){var U=M.read_shift(2),V=M.read_shift(2),H=M.l+V,le={};switch(U){case 21589:O=M.read_shift(1),O&1&&(le.mtime=M.read_shift(4)),V>5&&(O&2&&(le.atime=M.read_shift(4)),O&4&&(le.ctime=M.read_shift(4))),le.mtime&&(le.mt=new Date(le.mtime*1e3));break}M.l=H,G[U]=le}return G}var f;function d(){return f||(f={})}function g(M,G){if(M[0]==80&&M[1]==75)return ma(M,G);if((M[0]|32)==109&&(M[1]|32)==105)return n0(M,G);if(M.length<512)throw new Error("CFB file size "+M.length+" < 512");var O=3,U=512,V=0,H=0,le=0,ge=0,ae=0,ue=[],de=M.slice(0,512);qn(de,0);var ke=x(de);switch(O=ke[0],O){case 3:U=512;break;case 4:U=4096;break;case 0:if(ke[1]==0)return ma(M,G);default:throw new Error("Major Version: Expected 3 or 4 saw "+O)}U!==512&&(de=M.slice(0,U),qn(de,28));var Re=M.slice(0,U);_(de,O);var Ue=de.read_shift(4,"i");if(O===3&&Ue!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ue);de.l+=4,le=de.read_shift(4,"i"),de.l+=4,de.chk("00100000","Mini Stream Cutoff Size: "),ge=de.read_shift(4,"i"),V=de.read_shift(4,"i"),ae=de.read_shift(4,"i"),H=de.read_shift(4,"i");for(var De=-1,Le=0;Le<109&&(De=de.read_shift(4,"i"),!(De<0));++Le)ue[Le]=De;var Qe=T(M,U);C(ae,H,Qe,U,ue);var It=N(Qe,le,ue,U);It[le].name="!Directory",V>0&&ge!==ye&&(It[ge].name="!MiniFAT"),It[ue[0]].name="!FAT",It.fat_addrs=ue,It.ssz=U;var Pt={},jt=[],ka=[],ai=[];b(le,It,Qe,jt,V,Pt,ka,ge),E(ka,ai,jt),jt.shift();var Fr={FileIndex:ka,FullPaths:ai};return G&&G.raw&&(Fr.raw={header:Re,sectors:Qe}),Fr}function x(M){if(M[M.l]==80&&M[M.l+1]==75)return[0,0];M.chk(Me,"Header Signature: "),M.l+=16;var G=M.read_shift(2,"u");return[M.read_shift(2,"u"),G]}function _(M,G){var O=9;switch(M.l+=2,O=M.read_shift(2)){case 9:if(G!=3)throw new Error("Sector Shift: Expected 9 saw "+O);break;case 12:if(G!=4)throw new Error("Sector Shift: Expected 12 saw "+O);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+O)}M.chk("0600","Mini Sector Shift: "),M.chk("000000000000","Reserved: ")}function T(M,G){for(var O=Math.ceil(M.length/G)-1,U=[],V=1;V<O;++V)U[V-1]=M.slice(V*G,(V+1)*G);return U[O-1]=M.slice(O*G),U}function E(M,G,O){for(var U=0,V=0,H=0,le=0,ge=0,ae=O.length,ue=[],de=[];U<ae;++U)ue[U]=de[U]=U,G[U]=O[U];for(;ge<de.length;++ge)U=de[ge],V=M[U].L,H=M[U].R,le=M[U].C,ue[U]===U&&(V!==-1&&ue[V]!==V&&(ue[U]=ue[V]),H!==-1&&ue[H]!==H&&(ue[U]=ue[H])),le!==-1&&(ue[le]=U),V!==-1&&U!=ue[U]&&(ue[V]=ue[U],de.lastIndexOf(V)<ge&&de.push(V)),H!==-1&&U!=ue[U]&&(ue[H]=ue[U],de.lastIndexOf(H)<ge&&de.push(H));for(U=1;U<ae;++U)ue[U]===U&&(H!==-1&&ue[H]!==H?ue[U]=ue[H]:V!==-1&&ue[V]!==V&&(ue[U]=ue[V]));for(U=1;U<ae;++U)if(M[U].type!==0){if(ge=U,ge!=ue[ge])do ge=ue[ge],G[U]=G[ge]+"/"+G[U];while(ge!==0&&ue[ge]!==-1&&ge!=ue[ge]);ue[U]=-1}for(G[0]+="/",U=1;U<ae;++U)M[U].type!==2&&(G[U]+="/")}function S(M,G,O){for(var U=M.start,V=M.size,H=[],le=U;O&&V>0&&le>=0;)H.push(G.slice(le*Z,le*Z+Z)),V-=Z,le=us(O,le*4);return H.length===0?xe(0):In(H).slice(0,M.size)}function C(M,G,O,U,V){var H=ye;if(M===ye){if(G!==0)throw new Error("DIFAT chain shorter than expected")}else if(M!==-1){var le=O[M],ge=(U>>>2)-1;if(!le)return;for(var ae=0;ae<ge&&(H=us(le,ae*4))!==ye;++ae)V.push(H);C(us(le,U-4),G-1,O,U,V)}}function k(M,G,O,U,V){var H=[],le=[];V||(V=[]);var ge=U-1,ae=0,ue=0;for(ae=G;ae>=0;){V[ae]=!0,H[H.length]=ae,le.push(M[ae]);var de=O[Math.floor(ae*4/U)];if(ue=ae*4&ge,U<4+ue)throw new Error("FAT boundary crossed: "+ae+" 4 "+U);if(!M[de])break;ae=us(M[de],ue)}return{nodes:H,data:F_([le])}}function N(M,G,O,U){var V=M.length,H=[],le=[],ge=[],ae=[],ue=U-1,de=0,ke=0,Re=0,Ue=0;for(de=0;de<V;++de)if(ge=[],Re=de+G,Re>=V&&(Re-=V),!le[Re]){ae=[];var De=[];for(ke=Re;ke>=0;){De[ke]=!0,le[ke]=!0,ge[ge.length]=ke,ae.push(M[ke]);var Le=O[Math.floor(ke*4/U)];if(Ue=ke*4&ue,U<4+Ue)throw new Error("FAT boundary crossed: "+ke+" 4 "+U);if(!M[Le]||(ke=us(M[Le],Ue),De[ke]))break}H[Re]={nodes:ge,data:F_([ae])}}return H}function b(M,G,O,U,V,H,le,ge){for(var ae=0,ue=U.length?2:0,de=G[M].data,ke=0,Re=0,Ue;ke<de.length;ke+=128){var De=de.slice(ke,ke+128);qn(De,64),Re=De.read_shift(2),Ue=tp(De,0,Re-ue),U.push(Ue);var Le={name:Ue,type:De.read_shift(1),color:De.read_shift(1),L:De.read_shift(4,"i"),R:De.read_shift(4,"i"),C:De.read_shift(4,"i"),clsid:De.read_shift(16),state:De.read_shift(4,"i"),start:0,size:0},Qe=De.read_shift(2)+De.read_shift(2)+De.read_shift(2)+De.read_shift(2);Qe!==0&&(Le.ct=I(De,De.l-8));var It=De.read_shift(2)+De.read_shift(2)+De.read_shift(2)+De.read_shift(2);It!==0&&(Le.mt=I(De,De.l-8)),Le.start=De.read_shift(4,"i"),Le.size=De.read_shift(4,"i"),Le.size<0&&Le.start<0&&(Le.size=Le.type=0,Le.start=ye,Le.name=""),Le.type===5?(ae=Le.start,V>0&&ae!==ye&&(G[ae].name="!StreamData")):Le.size>=4096?(Le.storage="fat",G[Le.start]===void 0&&(G[Le.start]=k(O,Le.start,G.fat_addrs,G.ssz)),G[Le.start].name=Le.name,Le.content=G[Le.start].data.slice(0,Le.size)):(Le.storage="minifat",Le.size<0?Le.size=0:ae!==ye&&Le.start!==ye&&G[ae]&&(Le.content=S(Le,G[ae].data,(G[ge]||{}).data))),Le.content&&qn(Le.content,0),H[Ue]=Le,le.push(Le)}}function I(M,G){return new Date((kr(M,G+4)/1e7*Math.pow(2,32)+kr(M,G)/1e7-11644473600)*1e3)}function F(M,G){return d(),g(f.readFileSync(M),G)}function P(M,G){var O=G&&G.type;switch(O||lt&&Buffer.isBuffer(M)&&(O="buffer"),O||"base64"){case"file":return F(M,G);case"base64":return g(Nr(Dr(M)),G);case"binary":return g(Nr(M),G)}return g(M,G)}function D(M,G){var O=G||{},U=O.root||"Root Entry";if(M.FullPaths||(M.FullPaths=[]),M.FileIndex||(M.FileIndex=[]),M.FullPaths.length!==M.FileIndex.length)throw new Error("inconsistent CFB structure");M.FullPaths.length===0&&(M.FullPaths[0]=U+"/",M.FileIndex[0]={name:U,type:5}),O.CLSID&&(M.FileIndex[0].clsid=O.CLSID),j(M)}function j(M){var G="Sh33tJ5";if(!ze.find(M,"/"+G)){var O=xe(4);O[0]=55,O[1]=O[3]=50,O[2]=54,M.FileIndex.push({name:G,type:2,content:O,size:4,L:69,R:69,C:69}),M.FullPaths.push(M.FullPaths[0]+G),B(M)}}function B(M,G){D(M);for(var O=!1,U=!1,V=M.FullPaths.length-1;V>=0;--V){var H=M.FileIndex[V];switch(H.type){case 0:U?O=!0:(M.FileIndex.pop(),M.FullPaths.pop());break;case 1:case 2:case 5:U=!0,isNaN(H.R*H.L*H.C)&&(O=!0),H.R>-1&&H.L>-1&&H.R==H.L&&(O=!0);break;default:O=!0;break}}if(!(!O&&!G)){var le=new Date(1987,1,19),ge=0,ae=Object.create?Object.create(null):{},ue=[];for(V=0;V<M.FullPaths.length;++V)ae[M.FullPaths[V]]=!0,M.FileIndex[V].type!==0&&ue.push([M.FullPaths[V],M.FileIndex[V]]);for(V=0;V<ue.length;++V){var de=r(ue[V][0]);U=ae[de],U||(ue.push([de,{name:a(de).replace("/",""),type:1,clsid:ee,ct:le,mt:le,content:null}]),ae[de]=!0)}for(ue.sort(function(Ue,De){return n(Ue[0],De[0])}),M.FullPaths=[],M.FileIndex=[],V=0;V<ue.length;++V)M.FullPaths[V]=ue[V][0],M.FileIndex[V]=ue[V][1];for(V=0;V<ue.length;++V){var ke=M.FileIndex[V],Re=M.FullPaths[V];if(ke.name=a(Re).replace("/",""),ke.L=ke.R=ke.C=-(ke.color=1),ke.size=ke.content?ke.content.length:0,ke.start=0,ke.clsid=ke.clsid||ee,V===0)ke.C=ue.length>1?1:-1,ke.size=0,ke.type=5;else if(Re.slice(-1)=="/"){for(ge=V+1;ge<ue.length&&r(M.FullPaths[ge])!=Re;++ge);for(ke.C=ge>=ue.length?-1:ge,ge=V+1;ge<ue.length&&r(M.FullPaths[ge])!=r(Re);++ge);ke.R=ge>=ue.length?-1:ge,ke.type=1}else r(M.FullPaths[V+1]||"")==r(Re)&&(ke.R=V+1),ke.type=2}}}function te(M,G){var O=G||{};if(O.fileType=="mad")return pa(M,O);switch(B(M),O.fileType){case"zip":return Qr(M,O)}var U=function(Ue){for(var De=0,Le=0,Qe=0;Qe<Ue.FileIndex.length;++Qe){var It=Ue.FileIndex[Qe];if(It.content){var Pt=It.content.length;Pt>0&&(Pt<4096?De+=Pt+63>>6:Le+=Pt+511>>9)}}for(var jt=Ue.FullPaths.length+3>>2,ka=De+7>>3,ai=De+127>>7,Fr=ka+Le+jt+ai,ea=Fr+127>>7,zi=ea<=109?0:Math.ceil((ea-109)/127);Fr+ea+zi+127>>7>ea;)zi=++ea<=109?0:Math.ceil((ea-109)/127);var ta=[1,zi,ea,ai,jt,Le,De,0];return Ue.FileIndex[0].size=De<<6,ta[7]=(Ue.FileIndex[0].start=ta[0]+ta[1]+ta[2]+ta[3]+ta[4]+ta[5])+(ta[6]+7>>3),ta}(M),V=xe(U[7]<<9),H=0,le=0;{for(H=0;H<8;++H)V.write_shift(1,Se[H]);for(H=0;H<8;++H)V.write_shift(2,0);for(V.write_shift(2,62),V.write_shift(2,3),V.write_shift(2,65534),V.write_shift(2,9),V.write_shift(2,6),H=0;H<3;++H)V.write_shift(2,0);for(V.write_shift(4,0),V.write_shift(4,U[2]),V.write_shift(4,U[0]+U[1]+U[2]+U[3]-1),V.write_shift(4,0),V.write_shift(4,4096),V.write_shift(4,U[3]?U[0]+U[1]+U[2]-1:ye),V.write_shift(4,U[3]),V.write_shift(-4,U[1]?U[0]-1:ye),V.write_shift(4,U[1]),H=0;H<109;++H)V.write_shift(-4,H<U[2]?U[1]+H:-1)}if(U[1])for(le=0;le<U[1];++le){for(;H<236+le*127;++H)V.write_shift(-4,H<U[2]?U[1]+H:-1);V.write_shift(-4,le===U[1]-1?ye:le+1)}var ge=function(Ue){for(le+=Ue;H<le-1;++H)V.write_shift(-4,H+1);Ue&&(++H,V.write_shift(-4,ye))};for(le=H=0,le+=U[1];H<le;++H)V.write_shift(-4,me.DIFSECT);for(le+=U[2];H<le;++H)V.write_shift(-4,me.FATSECT);ge(U[3]),ge(U[4]);for(var ae=0,ue=0,de=M.FileIndex[0];ae<M.FileIndex.length;++ae)de=M.FileIndex[ae],de.content&&(ue=de.content.length,!(ue<4096)&&(de.start=le,ge(ue+511>>9)));for(ge(U[6]+7>>3);V.l&511;)V.write_shift(-4,me.ENDOFCHAIN);for(le=H=0,ae=0;ae<M.FileIndex.length;++ae)de=M.FileIndex[ae],de.content&&(ue=de.content.length,!(!ue||ue>=4096)&&(de.start=le,ge(ue+63>>6)));for(;V.l&511;)V.write_shift(-4,me.ENDOFCHAIN);for(H=0;H<U[4]<<2;++H){var ke=M.FullPaths[H];if(!ke||ke.length===0){for(ae=0;ae<17;++ae)V.write_shift(4,0);for(ae=0;ae<3;++ae)V.write_shift(4,-1);for(ae=0;ae<12;++ae)V.write_shift(4,0);continue}de=M.FileIndex[H],H===0&&(de.start=de.size?de.start-1:ye);var Re=H===0&&O.root||de.name;if(ue=2*(Re.length+1),V.write_shift(64,Re,"utf16le"),V.write_shift(2,ue),V.write_shift(1,de.type),V.write_shift(1,de.color),V.write_shift(-4,de.L),V.write_shift(-4,de.R),V.write_shift(-4,de.C),de.clsid)V.write_shift(16,de.clsid,"hex");else for(ae=0;ae<4;++ae)V.write_shift(4,0);V.write_shift(4,de.state||0),V.write_shift(4,0),V.write_shift(4,0),V.write_shift(4,0),V.write_shift(4,0),V.write_shift(4,de.start),V.write_shift(4,de.size),V.write_shift(4,0)}for(H=1;H<M.FileIndex.length;++H)if(de=M.FileIndex[H],de.size>=4096)if(V.l=de.start+1<<9,lt&&Buffer.isBuffer(de.content))de.content.copy(V,V.l,0,de.size),V.l+=de.size+511&-512;else{for(ae=0;ae<de.size;++ae)V.write_shift(1,de.content[ae]);for(;ae&511;++ae)V.write_shift(1,0)}for(H=1;H<M.FileIndex.length;++H)if(de=M.FileIndex[H],de.size>0&&de.size<4096)if(lt&&Buffer.isBuffer(de.content))de.content.copy(V,V.l,0,de.size),V.l+=de.size+63&-64;else{for(ae=0;ae<de.size;++ae)V.write_shift(1,de.content[ae]);for(;ae&63;++ae)V.write_shift(1,0)}if(lt)V.l=V.length;else for(;V.l<V.length;)V.write_shift(1,0);return V}function X(M,G){var O=M.FullPaths.map(function(ae){return ae.toUpperCase()}),U=O.map(function(ae){var ue=ae.split("/");return ue[ue.length-(ae.slice(-1)=="/"?2:1)]}),V=!1;G.charCodeAt(0)===47?(V=!0,G=O[0].slice(0,-1)+G):V=G.indexOf("/")!==-1;var H=G.toUpperCase(),le=V===!0?O.indexOf(H):U.indexOf(H);if(le!==-1)return M.FileIndex[le];var ge=!H.match(rc);for(H=H.replace(ur,""),ge&&(H=H.replace(rc,"!")),le=0;le<O.length;++le)if((ge?O[le].replace(rc,"!"):O[le]).replace(ur,"")==H||(ge?U[le].replace(rc,"!"):U[le]).replace(ur,"")==H)return M.FileIndex[le];return null}var Z=64,ye=-2,Me="d0cf11e0a1b11ae1",Se=[208,207,17,224,161,177,26,225],ee="00000000000000000000000000000000",me={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:ye,FREESECT:-1,HEADER_SIGNATURE:Me,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ee,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Pe(M,G,O){d();var U=te(M,O);f.writeFileSync(G,U)}function re(M){for(var G=new Array(M.length),O=0;O<M.length;++O)G[O]=String.fromCharCode(M[O]);return G.join("")}function z(M,G){var O=te(M,G);switch(G&&G.type||"buffer"){case"file":return d(),f.writeFileSync(G.filename,O),O;case"binary":return typeof O=="string"?O:re(O);case"base64":return _c(typeof O=="string"?O:re(O));case"buffer":if(lt)return Buffer.isBuffer(O)?O:ei(O);case"array":return typeof O=="string"?Nr(O):O}return O}var ce;function L(M){try{var G=M.InflateRaw,O=new G;if(O._processChunk(new Uint8Array([3,0]),O._finishFlushFlag),O.bytesRead)ce=M;else throw new Error("zlib does not expose bytesRead")}catch(U){console.error("cannot use native zlib: "+(U.message||U))}}function W(M,G){if(!ce)return Zt(M,G);var O=ce.InflateRaw,U=new O,V=U._processChunk(M.slice(M.l),U._finishFlushFlag);return M.l+=U.bytesRead,V}function q(M){return ce?ce.deflateRawSync(M):et(M)}var K=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ie=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Ce=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Te(M){var G=(M<<1|M<<11)&139536|(M<<5|M<<15)&558144;return(G>>16|G>>8|G)&255}for(var be=typeof Uint8Array<"u",Ae=be?new Uint8Array(256):[],Xe=0;Xe<256;++Xe)Ae[Xe]=Te(Xe);function Y(M,G){var O=Ae[M&255];return G<=8?O>>>8-G:(O=O<<8|Ae[M>>8&255],G<=16?O>>>16-G:(O=O<<8|Ae[M>>16&255],O>>>24-G))}function yt(M,G){var O=G&7,U=G>>>3;return(M[U]|(O<=6?0:M[U+1]<<8))>>>O&3}function st(M,G){var O=G&7,U=G>>>3;return(M[U]|(O<=5?0:M[U+1]<<8))>>>O&7}function _t(M,G){var O=G&7,U=G>>>3;return(M[U]|(O<=4?0:M[U+1]<<8))>>>O&15}function qe(M,G){var O=G&7,U=G>>>3;return(M[U]|(O<=3?0:M[U+1]<<8))>>>O&31}function Ne(M,G){var O=G&7,U=G>>>3;return(M[U]|(O<=1?0:M[U+1]<<8))>>>O&127}function bt(M,G,O){var U=G&7,V=G>>>3,H=(1<<O)-1,le=M[V]>>>U;return O<8-U||(le|=M[V+1]<<8-U,O<16-U)||(le|=M[V+2]<<16-U,O<24-U)||(le|=M[V+3]<<24-U),le&H}function Ln(M,G,O){var U=G&7,V=G>>>3;return U<=5?M[V]|=(O&7)<<U:(M[V]|=O<<U&255,M[V+1]=(O&7)>>8-U),G+3}function On(M,G,O){var U=G&7,V=G>>>3;return O=(O&1)<<U,M[V]|=O,G+1}function $n(M,G,O){var U=G&7,V=G>>>3;return O<<=U,M[V]|=O&255,O>>>=8,M[V+1]=O,G+8}function ha(M,G,O){var U=G&7,V=G>>>3;return O<<=U,M[V]|=O&255,O>>>=8,M[V+1]=O&255,M[V+2]=O>>>8,G+16}function Un(M,G){var O=M.length,U=2*O>G?2*O:G+5,V=0;if(O>=G)return M;if(lt){var H=m_(U);if(M.copy)M.copy(H);else for(;V<M.length;++V)H[V]=M[V];return H}else if(be){var le=new Uint8Array(U);if(le.set)le.set(M);else for(;V<O;++V)le[V]=M[V];return le}return M.length=U,M}function Cn(M){for(var G=new Array(M),O=0;O<M;++O)G[O]=0;return G}function yr(M,G,O){var U=1,V=0,H=0,le=0,ge=0,ae=M.length,ue=be?new Uint16Array(32):Cn(32);for(H=0;H<32;++H)ue[H]=0;for(H=ae;H<O;++H)M[H]=0;ae=M.length;var de=be?new Uint16Array(ae):Cn(ae);for(H=0;H<ae;++H)ue[V=M[H]]++,U<V&&(U=V),de[H]=0;for(ue[0]=0,H=1;H<=U;++H)ue[H+16]=ge=ge+ue[H-1]<<1;for(H=0;H<ae;++H)ge=M[H],ge!=0&&(de[H]=ue[ge+16]++);var ke=0;for(H=0;H<ae;++H)if(ke=M[H],ke!=0)for(ge=Y(de[H],U)>>U-ke,le=(1<<U+4-ke)-1;le>=0;--le)G[ge|le<<ke]=ke&15|H<<4;return U}var Bn=be?new Uint16Array(512):Cn(512),cn=be?new Uint16Array(32):Cn(32);if(!be){for(var Ht=0;Ht<512;++Ht)Bn[Ht]=0;for(Ht=0;Ht<32;++Ht)cn[Ht]=0}(function(){for(var M=[],G=0;G<32;G++)M.push(5);yr(M,cn,32);var O=[];for(G=0;G<=143;G++)O.push(8);for(;G<=255;G++)O.push(9);for(;G<=279;G++)O.push(7);for(;G<=287;G++)O.push(8);yr(O,Bn,288)})();var zt=function(){for(var G=be?new Uint8Array(32768):[],O=0,U=0;O<Ce.length-1;++O)for(;U<Ce[O+1];++U)G[U]=O;for(;U<32768;++U)G[U]=29;var V=be?new Uint8Array(259):[];for(O=0,U=0;O<ie.length-1;++O)for(;U<ie[O+1];++U)V[U]=O;function H(ge,ae){for(var ue=0;ue<ge.length;){var de=Math.min(65535,ge.length-ue),ke=ue+de==ge.length;for(ae.write_shift(1,+ke),ae.write_shift(2,de),ae.write_shift(2,~de&65535);de-- >0;)ae[ae.l++]=ge[ue++]}return ae.l}function le(ge,ae){for(var ue=0,de=0,ke=be?new Uint16Array(32768):[];de<ge.length;){var Re=Math.min(65535,ge.length-de);if(Re<10){for(ue=Ln(ae,ue,+(de+Re==ge.length)),ue&7&&(ue+=8-(ue&7)),ae.l=ue/8|0,ae.write_shift(2,Re),ae.write_shift(2,~Re&65535);Re-- >0;)ae[ae.l++]=ge[de++];ue=ae.l*8;continue}ue=Ln(ae,ue,+(de+Re==ge.length)+2);for(var Ue=0;Re-- >0;){var De=ge[de];Ue=(Ue<<5^De)&32767;var Le=-1,Qe=0;if((Le=ke[Ue])&&(Le|=de&-32768,Le>de&&(Le-=32768),Le<de))for(;ge[Le+Qe]==ge[de+Qe]&&Qe<250;)++Qe;if(Qe>2){De=V[Qe],De<=22?ue=$n(ae,ue,Ae[De+1]>>1)-1:($n(ae,ue,3),ue+=5,$n(ae,ue,Ae[De-23]>>5),ue+=3);var It=De<8?0:De-4>>2;It>0&&(ha(ae,ue,Qe-ie[De]),ue+=It),De=G[de-Le],ue=$n(ae,ue,Ae[De]>>3),ue-=3;var Pt=De<4?0:De-2>>1;Pt>0&&(ha(ae,ue,de-Le-Ce[De]),ue+=Pt);for(var jt=0;jt<Qe;++jt)ke[Ue]=de&32767,Ue=(Ue<<5^ge[de])&32767,++de;Re-=Qe-1}else De<=143?De=De+48:ue=On(ae,ue,1),ue=$n(ae,ue,Ae[De]),ke[Ue]=de&32767,++de}ue=$n(ae,ue,0)-1}return ae.l=(ue+7)/8|0,ae.l}return function(ae,ue){return ae.length<8?H(ae,ue):le(ae,ue)}}();function et(M){var G=xe(50+Math.floor(M.length*1.1)),O=zt(M,G);return G.slice(0,O)}var Ft=be?new Uint16Array(32768):Cn(32768),ir=be?new Uint16Array(32768):Cn(32768),qt=be?new Uint16Array(128):Cn(128),sr=1,Oe=1;function St(M,G){var O=qe(M,G)+257;G+=5;var U=qe(M,G)+1;G+=5;var V=_t(M,G)+4;G+=4;for(var H=0,le=be?new Uint8Array(19):Cn(19),ge=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ae=1,ue=be?new Uint8Array(8):Cn(8),de=be?new Uint8Array(8):Cn(8),ke=le.length,Re=0;Re<V;++Re)le[K[Re]]=H=st(M,G),ae<H&&(ae=H),ue[H]++,G+=3;var Ue=0;for(ue[0]=0,Re=1;Re<=ae;++Re)de[Re]=Ue=Ue+ue[Re-1]<<1;for(Re=0;Re<ke;++Re)(Ue=le[Re])!=0&&(ge[Re]=de[Ue]++);var De=0;for(Re=0;Re<ke;++Re)if(De=le[Re],De!=0){Ue=Ae[ge[Re]]>>8-De;for(var Le=(1<<7-De)-1;Le>=0;--Le)qt[Ue|Le<<De]=De&7|Re<<3}var Qe=[];for(ae=1;Qe.length<O+U;)switch(Ue=qt[Ne(M,G)],G+=Ue&7,Ue>>>=3){case 16:for(H=3+yt(M,G),G+=2,Ue=Qe[Qe.length-1];H-- >0;)Qe.push(Ue);break;case 17:for(H=3+st(M,G),G+=3;H-- >0;)Qe.push(0);break;case 18:for(H=11+Ne(M,G),G+=7;H-- >0;)Qe.push(0);break;default:Qe.push(Ue),ae<Ue&&(ae=Ue);break}var It=Qe.slice(0,O),Pt=Qe.slice(O);for(Re=O;Re<286;++Re)It[Re]=0;for(Re=U;Re<30;++Re)Pt[Re]=0;return sr=yr(It,Ft,286),Oe=yr(Pt,ir,30),G}function Be(M,G){if(M[0]==3&&!(M[1]&3))return[Ii(G),2];for(var O=0,U=0,V=m_(G||1<<18),H=0,le=V.length>>>0,ge=0,ae=0;(U&1)==0;){if(U=st(M,O),O+=3,U>>>1)U>>1==1?(ge=9,ae=5):(O=St(M,O),ge=sr,ae=Oe);else{O&7&&(O+=8-(O&7));var ue=M[O>>>3]|M[(O>>>3)+1]<<8;if(O+=32,ue>0)for(!G&&le<H+ue&&(V=Un(V,H+ue),le=V.length);ue-- >0;)V[H++]=M[O>>>3],O+=8;continue}for(;;){!G&&le<H+32767&&(V=Un(V,H+32767),le=V.length);var de=bt(M,O,ge),ke=U>>>1==1?Bn[de]:Ft[de];if(O+=ke&15,ke>>>=4,(ke>>>8&255)===0)V[H++]=ke;else{if(ke==256)break;ke-=257;var Re=ke<8?0:ke-4>>2;Re>5&&(Re=0);var Ue=H+ie[ke];Re>0&&(Ue+=bt(M,O,Re),O+=Re),de=bt(M,O,ae),ke=U>>>1==1?cn[de]:ir[de],O+=ke&15,ke>>>=4;var De=ke<4?0:ke-2>>1,Le=Ce[ke];for(De>0&&(Le+=bt(M,O,De),O+=De),!G&&le<Ue&&(V=Un(V,Ue+100),le=V.length);H<Ue;)V[H]=V[H-Le],++H}}}return G?[V,O+7>>>3]:[V.slice(0,H),O+7>>>3]}function Zt(M,G){var O=M.slice(M.l||0),U=Be(O,G);return M.l+=U[1],U[0]}function Et(M,G){if(M)typeof console<"u"&&console.error(G);else throw new Error(G)}function ma(M,G){var O=M;qn(O,0);var U=[],V=[],H={FileIndex:U,FullPaths:V};D(H,{root:G.root});for(var le=O.length-4;(O[le]!=80||O[le+1]!=75||O[le+2]!=5||O[le+3]!=6)&&le>=0;)--le;O.l=le+4,O.l+=4;var ge=O.read_shift(2);O.l+=6;var ae=O.read_shift(4);for(O.l=ae,le=0;le<ge;++le){O.l+=20;var ue=O.read_shift(4),de=O.read_shift(4),ke=O.read_shift(2),Re=O.read_shift(2),Ue=O.read_shift(2);O.l+=8;var De=O.read_shift(4),Le=c(O.slice(O.l+ke,O.l+ke+Re));O.l+=ke+Re+Ue;var Qe=O.l;O.l=De+4,Aa(O,ue,de,H,Le),O.l=Qe}return H}function Aa(M,G,O,U,V){M.l+=2;var H=M.read_shift(2),le=M.read_shift(2),ge=l(M);if(H&8257)throw new Error("Unsupported ZIP encryption");for(var ae=M.read_shift(4),ue=M.read_shift(4),de=M.read_shift(4),ke=M.read_shift(2),Re=M.read_shift(2),Ue="",De=0;De<ke;++De)Ue+=String.fromCharCode(M[M.l++]);if(Re){var Le=c(M.slice(M.l,M.l+Re));(Le[21589]||{}).mt&&(ge=Le[21589].mt),((V||{})[21589]||{}).mt&&(ge=V[21589].mt)}M.l+=Re;var Qe=M.slice(M.l,M.l+ue);switch(le){case 8:Qe=W(M,de);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+le)}var It=!1;H&8&&(ae=M.read_shift(4),ae==134695760&&(ae=M.read_shift(4),It=!0),ue=M.read_shift(4),de=M.read_shift(4)),ue!=G&&Et(It,"Bad compressed size: "+G+" != "+ue),de!=O&&Et(It,"Bad uncompressed size: "+O+" != "+de),An(U,Ue,Qe,{unsafe:!0,mt:ge})}function Qr(M,G){var O=G||{},U=[],V=[],H=xe(1),le=O.compression?8:0,ge=0,ae=0,ue=0,de=0,ke=0,Re=M.FullPaths[0],Ue=Re,De=M.FileIndex[0],Le=[],Qe=0;for(ae=1;ae<M.FullPaths.length;++ae)if(Ue=M.FullPaths[ae].slice(Re.length),De=M.FileIndex[ae],!(!De.size||!De.content||Ue=="Sh33tJ5")){var It=de,Pt=xe(Ue.length);for(ue=0;ue<Ue.length;++ue)Pt.write_shift(1,Ue.charCodeAt(ue)&127);Pt=Pt.slice(0,Pt.l),Le[ke]=VI.buf(De.content,0);var jt=De.content;le==8&&(jt=q(jt)),H=xe(30),H.write_shift(4,67324752),H.write_shift(2,20),H.write_shift(2,ge),H.write_shift(2,le),De.mt?s(H,De.mt):H.write_shift(4,0),H.write_shift(-4,Le[ke]),H.write_shift(4,jt.length),H.write_shift(4,De.content.length),H.write_shift(2,Pt.length),H.write_shift(2,0),de+=H.length,U.push(H),de+=Pt.length,U.push(Pt),de+=jt.length,U.push(jt),H=xe(46),H.write_shift(4,33639248),H.write_shift(2,0),H.write_shift(2,20),H.write_shift(2,ge),H.write_shift(2,le),H.write_shift(4,0),H.write_shift(-4,Le[ke]),H.write_shift(4,jt.length),H.write_shift(4,De.content.length),H.write_shift(2,Pt.length),H.write_shift(2,0),H.write_shift(2,0),H.write_shift(2,0),H.write_shift(2,0),H.write_shift(4,0),H.write_shift(4,It),Qe+=H.l,V.push(H),Qe+=Pt.length,V.push(Pt),++ke}return H=xe(22),H.write_shift(4,101010256),H.write_shift(2,0),H.write_shift(2,0),H.write_shift(2,ke),H.write_shift(2,ke),H.write_shift(4,Qe),H.write_shift(4,de),H.write_shift(2,0),In([In(U),In(V),H])}var Rr={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Rs(M,G){if(M.ctype)return M.ctype;var O=M.name||"",U=O.match(/\.([^\.]+)$/);return U&&Rr[U[1]]||G&&(U=(O=G).match(/[\.\\]([^\.\\])+$/),U&&Rr[U[1]])?Rr[U[1]]:"application/octet-stream"}function ft(M){for(var G=_c(M),O=[],U=0;U<G.length;U+=76)O.push(G.slice(U,U+76));return O.join(`\r
`)+`\r
`}function Hi(M){var G=M.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(ue){var de=ue.charCodeAt(0).toString(16).toUpperCase();return"="+(de.length==1?"0"+de:de)});G=G.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),G.charAt(0)==`
`&&(G="=0D"+G.slice(1)),G=G.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var O=[],U=G.split(`\r
`),V=0;V<U.length;++V){var H=U[V];if(H.length==0){O.push("");continue}for(var le=0;le<H.length;){var ge=76,ae=H.slice(le,le+ge);ae.charAt(ge-1)=="="?ge--:ae.charAt(ge-2)=="="?ge-=2:ae.charAt(ge-3)=="="&&(ge-=3),ae=H.slice(le,le+ge),le+=ge,le<H.length&&(ae+="="),O.push(ae)}}return O.join(`\r
`)}function Qo(M){for(var G=[],O=0;O<M.length;++O){for(var U=M[O];O<=M.length&&U.charAt(U.length-1)=="=";)U=U.slice(0,U.length-1)+M[++O];G.push(U)}for(var V=0;V<G.length;++V)G[V]=G[V].replace(/[=][0-9A-Fa-f]{2}/g,function(H){return String.fromCharCode(parseInt(H.slice(1),16))});return Nr(G.join(`\r
`))}function $c(M,G,O){for(var U="",V="",H="",le,ge=0;ge<10;++ge){var ae=G[ge];if(!ae||ae.match(/^\s*$/))break;var ue=ae.match(/^(.*?):\s*([^\s].*)$/);if(ue)switch(ue[1].toLowerCase()){case"content-location":U=ue[2].trim();break;case"content-type":H=ue[2].trim();break;case"content-transfer-encoding":V=ue[2].trim();break}}switch(++ge,V.toLowerCase()){case"base64":le=Nr(Dr(G.slice(ge).join("")));break;case"quoted-printable":le=Qo(G.slice(ge));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+V)}var de=An(M,U.slice(O.length),le,{unsafe:!0});H&&(de.ctype=H)}function n0(M,G){if(re(M.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var O=G&&G.root||"",U=(lt&&Buffer.isBuffer(M)?M.toString("binary"):re(M)).split(`\r
`),V=0,H="";for(V=0;V<U.length;++V)if(H=U[V],!!/^Content-Location:/i.test(H)&&(H=H.slice(H.indexOf("file")),O||(O=H.slice(0,H.lastIndexOf("/")+1)),H.slice(0,O.length)!=O))for(;O.length>0&&(O=O.slice(0,O.length-1),O=O.slice(0,O.lastIndexOf("/")+1),H.slice(0,O.length)!=O););var le=(U[1]||"").match(/boundary="(.*?)"/);if(!le)throw new Error("MAD cannot find boundary");var ge="--"+(le[1]||""),ae=[],ue=[],de={FileIndex:ae,FullPaths:ue};D(de);var ke,Re=0;for(V=0;V<U.length;++V){var Ue=U[V];Ue!==ge&&Ue!==ge+"--"||(Re++&&$c(de,U.slice(ke,V),O),ke=V)}return de}function pa(M,G){var O=G||{},U=O.boundary||"SheetJS";U="------="+U;for(var V=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+U.slice(2)+'"',"","",""],H=M.FullPaths[0],le=H,ge=M.FileIndex[0],ae=1;ae<M.FullPaths.length;++ae)if(le=M.FullPaths[ae].slice(H.length),ge=M.FileIndex[ae],!(!ge.size||!ge.content||le=="Sh33tJ5")){le=le.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Qe){return"_x"+Qe.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Qe){return"_u"+Qe.charCodeAt(0).toString(16)+"_"});for(var ue=ge.content,de=lt&&Buffer.isBuffer(ue)?ue.toString("binary"):re(ue),ke=0,Re=Math.min(1024,de.length),Ue=0,De=0;De<=Re;++De)(Ue=de.charCodeAt(De))>=32&&Ue<128&&++ke;var Le=ke>=Re*4/5;V.push(U),V.push("Content-Location: "+(O.root||"file:///C:/SheetJS/")+le),V.push("Content-Transfer-Encoding: "+(Le?"quoted-printable":"base64")),V.push("Content-Type: "+Rs(ge,le)),V.push(""),V.push(Le?Hi(de):ft(de))}return V.push(U+`--\r
`),V.join(`\r
`)}function bn(M){var G={};return D(G,M),G}function An(M,G,O,U){var V=U&&U.unsafe;V||D(M);var H=!V&&ze.find(M,G);if(!H){var le=M.FullPaths[0];G.slice(0,le.length)==le?le=G:(le.slice(-1)!="/"&&(le+="/"),le=(le+G).replace("//","/")),H={name:a(G),type:2},M.FileIndex.push(H),M.FullPaths.push(le),V||ze.utils.cfb_gc(M)}return H.content=O,H.size=O?O.length:0,U&&(U.CLSID&&(H.clsid=U.CLSID),U.mt&&(H.mt=U.mt),U.ct&&(H.ct=U.ct)),H}function ri(M,G){D(M);var O=ze.find(M,G);if(O){for(var U=0;U<M.FileIndex.length;++U)if(M.FileIndex[U]==O)return M.FileIndex.splice(U,1),M.FullPaths.splice(U,1),!0}return!1}function el(M,G,O){D(M);var U=ze.find(M,G);if(U){for(var V=0;V<M.FileIndex.length;++V)if(M.FileIndex[V]==U)return M.FileIndex[V].name=a(O),M.FullPaths[V]=O,!0}return!1}function r0(M){B(M,!0)}return e.find=X,e.read=P,e.parse=g,e.write=z,e.writeFile=Pe,e.utils={cfb_new:bn,cfb_add:An,cfb_del:ri,cfb_mov:el,cfb_gc:r0,ReadShift:cc,CheckField:pw,prep_blob:qn,bconcat:In,use_zlib:L,_deflateRaw:et,_inflateRaw:Zt,consts:me},e}();function GI(t){return typeof t=="string"?Wf(t):Array.isArray(t)?hI(t):t}function Uc(t,e,n){if(typeof Deno<"u"){if(n&&typeof e=="string")switch(n){case"utf8":e=new TextEncoder(n).encode(e);break;case"binary":e=Wf(e);break;default:throw new Error("Unsupported encoding "+n)}return Deno.writeFileSync(t,e)}var r=n=="utf8"?Ea(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(r,t);if(typeof Blob<"u"){var a=new Blob([GI(r)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(a,t);if(typeof saveAs<"u")return saveAs(a,t);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(a);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:t,saveAs:!0});var l=document.createElement("a");if(l.download!=null)return l.download=t,l.href=s,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var c=File(t);return c.open("w"),c.encoding="binary",Array.isArray(e)&&(e=Bi(e)),c.write(e),c.close(),e}catch(f){if(!f.message||!f.message.match(/onstruct/))throw f}throw new Error("cannot save file "+t)}function HI(t){if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(t);e.open("r"),e.encoding="binary";var n=e.read();return e.close(),n}catch(r){if(!r.message||!r.message.match(/onstruct/))throw r}throw new Error("Cannot access file "+t)}function ln(t){for(var e=Object.keys(t),n=[],r=0;r<e.length;++r)Object.prototype.hasOwnProperty.call(t,e[r])&&n.push(e[r]);return n}function w_(t,e){for(var n=[],r=ln(t),a=0;a!==r.length;++a)n[t[r[a]][e]]==null&&(n[t[r[a]][e]]=r[a]);return n}function Jf(t){for(var e=[],n=ln(t),r=0;r!==n.length;++r)e[t[n[r]]]=n[r];return e}function Xf(t){for(var e=[],n=ln(t),r=0;r!==n.length;++r)e[t[n[r]]]=parseInt(n[r],10);return e}function zI(t){for(var e=[],n=ln(t),r=0;r!==n.length;++r)e[t[n[r]]]==null&&(e[t[n[r]]]=[]),e[t[n[r]]].push(n[r]);return e}var Df=new Date(1899,11,30,0,0,0);function En(t,e){var n=t.getTime(),r=Df.getTime()+(t.getTimezoneOffset()-Df.getTimezoneOffset())*6e4;return(n-r)/(24*60*60*1e3)}var YT=new Date,qI=Df.getTime()+(YT.getTimezoneOffset()-Df.getTimezoneOffset())*6e4,S_=YT.getTimezoneOffset();function Kf(t){var e=new Date;return e.setTime(t*24*60*60*1e3+qI),e.getTimezoneOffset()!==S_&&e.setTime(e.getTime()+(e.getTimezoneOffset()-S_)*6e4),e}function jI(t){var e=0,n=0,r=!1,a=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var s=1;s!=a.length;++s)if(a[s]){switch(n=1,s>3&&(r=!0),a[s].slice(a[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[s].slice(a[s].length-1));case"D":n*=24;case"H":n*=60;case"M":if(r)n*=60;else throw new Error("Unsupported ISO Duration Field: M")}e+=n*parseInt(a[s],10)}return e}var E_=new Date("2017-02-19T19:06:09.000Z"),JT=isNaN(E_.getFullYear())?new Date("2/19/17"):E_,$I=JT.getFullYear()==2017;function Xt(t,e){var n=new Date(t);if($I)return e>0?n.setTime(n.getTime()+n.getTimezoneOffset()*60*1e3):e<0&&n.setTime(n.getTime()-n.getTimezoneOffset()*60*1e3),n;if(t instanceof Date)return t;if(JT.getFullYear()==1917&&!isNaN(n.getFullYear())){var r=n.getFullYear();return t.indexOf(""+r)>-1||n.setFullYear(n.getFullYear()+100),n}var a=t.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return t.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function ys(t,e){if(lt&&Buffer.isBuffer(t)){if(e){if(t[0]==255&&t[1]==254)return Ea(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return Ea(LT(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(t[0]==255&&t[1]==254)return Ea(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return Ea(new TextDecoder("utf-16be").decode(t.slice(2)))}var n={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(s){return n[s]||s})}catch{}for(var r=[],a=0;a!=t.length;++a)r.push(String.fromCharCode(t[a]));return r.join("")}function Kt(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=Kt(t[n]));return e}function sn(t,e){for(var n="";n.length<e;)n+=t;return n}function ua(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var n=1,r=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return n*=100,""});return!isNaN(e=Number(r))||(r=r.replace(/[(](.*)[)]/,function(a,s){return n=-n,s}),!isNaN(e=Number(r)))?e/n:e}var WI=["january","february","march","april","may","june","july","august","september","october","november","december"];function Bo(t){var e=new Date(t),n=new Date(NaN),r=e.getYear(),a=e.getMonth(),s=e.getDate();if(isNaN(s))return n;var l=t.toLowerCase();if(l.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(l=l.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),l.length>3&&WI.indexOf(l)==-1)return n}else if(l.match(/[a-z]/))return n;return r<0||r>8099?n:(a>0||s>1)&&r!=101?e:t.match(/[^-0-9:,\/\\]/)?n:e}var YI=function(){var t="abacaba".split(/(:?b)/i).length==5;return function(n,r,a){if(t||typeof r=="string")return n.split(r);for(var s=n.split(r),l=[s[0]],c=1;c<s.length;++c)l.push(a),l.push(s[c]);return l}}();function XT(t){return t?t.content&&t.type?ys(t.content,!0):t.data?nc(t.data):t.asNodeBuffer&&lt?nc(t.asNodeBuffer().toString("binary")):t.asBinary?nc(t.asBinary()):t._data&&t._data.getContent?nc(ys(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function KT(t){if(!t)return null;if(t.data)return d_(t.data);if(t.asNodeBuffer&&lt)return t.asNodeBuffer();if(t._data&&t._data.getContent){var e=t._data.getContent();return typeof e=="string"?d_(e):Array.prototype.slice.call(e)}return t.content&&t.type?t.content:null}function JI(t){return t&&t.name.slice(-4)===".bin"?KT(t):XT(t)}function Wr(t,e){for(var n=t.FullPaths||ln(t.files),r=e.toLowerCase().replace(/[\/]/g,"\\"),a=r.replace(/\\/g,"/"),s=0;s<n.length;++s){var l=n[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(r==l||a==l)return t.files?t.files[n[s]]:t.FileIndex[s]}return null}function Jm(t,e){var n=Wr(t,e);if(n==null)throw new Error("Cannot find file "+e+" in zip");return n}function yn(t,e,n){if(!n)return JI(Jm(t,e));if(!e)return null;try{return yn(t,e)}catch{return null}}function Mr(t,e,n){if(!n)return XT(Jm(t,e));if(!e)return null;try{return Mr(t,e)}catch{return null}}function XI(t,e,n){return KT(Jm(t,e))}function C_(t){for(var e=t.FullPaths||ln(t.files),n=[],r=0;r<e.length;++r)e[r].slice(-1)!="/"&&n.push(e[r].replace(/^Root Entry[\/]/,""));return n.sort()}function it(t,e,n){if(t.FullPaths){if(typeof n=="string"){var r;return lt?r=ei(n):r=mI(n),ze.utils.cfb_add(t,e,r)}ze.utils.cfb_add(t,e,n)}else t.file(e,n)}function Xm(){return ze.utils.cfb_new()}function ZT(t,e){switch(e.type){case"base64":return ze.read(t,{type:"base64"});case"binary":return ze.read(t,{type:"binary"});case"buffer":case"array":return ze.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function ac(t,e){if(t.charAt(0)=="/")return t.slice(1);var n=e.split("/");e.slice(-1)!="/"&&n.pop();for(var r=t.split("/");r.length!==0;){var a=r.shift();a===".."?n.pop():a!=="."&&n.push(a)}return n.join("/")}var pn=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,KI=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,b_=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,ZI=/<[^>]*>/g,ar=pn.match(b_)?b_:ZI,QI=/<\w*:/,e5=/<(\/?)\w+:/;function Ze(t,e,n){for(var r={},a=0,s=0;a!==t.length&&!((s=t.charCodeAt(a))===32||s===10||s===13);++a);if(e||(r[0]=t.slice(0,a)),a===t.length)return r;var l=t.match(KI),c=0,f="",d=0,g="",x="",_=1;if(l)for(d=0;d!=l.length;++d){for(x=l[d],s=0;s!=x.length&&x.charCodeAt(s)!==61;++s);for(g=x.slice(0,s).trim();x.charCodeAt(s+1)==32;)++s;for(_=(a=x.charCodeAt(s+1))==34||a==39?1:0,f=x.slice(s+1+_,x.length-_),c=0;c!=g.length&&g.charCodeAt(c)!==58;++c);if(c===g.length)g.indexOf("_")>0&&(g=g.slice(0,g.indexOf("_"))),r[g]=f,r[g.toLowerCase()]=f;else{var T=(c===5&&g.slice(0,5)==="xmlns"?"xmlns":"")+g.slice(c+1);if(r[T]&&g.slice(c-3,c)=="ext")continue;r[T]=f,r[T.toLowerCase()]=f}}return r}function Ca(t){return t.replace(e5,"<$1")}var QT={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Km=Jf(QT),gt=function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;return function n(r){var a=r+"",s=a.indexOf("<![CDATA[");if(s==-1)return a.replace(t,function(c,f){return QT[c]||String.fromCharCode(parseInt(f,c.indexOf("x")>-1?16:10))||c}).replace(e,function(c,f){return String.fromCharCode(parseInt(f,16))});var l=a.indexOf("]]>");return n(a.slice(0,s))+a.slice(s+9,l)+n(a.slice(l+3))}}(),Zm=/[&<>'"]/g,t5=/[\u0000-\u0008\u000b-\u001f]/g;function Dt(t){var e=t+"";return e.replace(Zm,function(n){return Km[n]}).replace(t5,function(n){return"_x"+("000"+n.charCodeAt(0).toString(16)).slice(-4)+"_"})}function A_(t){return Dt(t).replace(/ /g,"_x0020_")}var ew=/[\u0000-\u001f]/g;function Qm(t){var e=t+"";return e.replace(Zm,function(n){return Km[n]}).replace(/\n/g,"<br/>").replace(ew,function(n){return"&#x"+("000"+n.charCodeAt(0).toString(16)).slice(-4)+";"})}function n5(t){var e=t+"";return e.replace(Zm,function(n){return Km[n]}).replace(ew,function(n){return"&#x"+n.charCodeAt(0).toString(16).toUpperCase()+";"})}var k_=function(){var t=/&#(\d+);/g;function e(n,r){return String.fromCharCode(parseInt(r,10))}return function(r){return r.replace(t,e)}}();function r5(t){return t.replace(/(\r\n|[\r\n])/g,"&#10;")}function Jt(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function wh(t){for(var e="",n=0,r=0,a=0,s=0,l=0,c=0;n<t.length;){if(r=t.charCodeAt(n++),r<128){e+=String.fromCharCode(r);continue}if(a=t.charCodeAt(n++),r>191&&r<224){l=(r&31)<<6,l|=a&63,e+=String.fromCharCode(l);continue}if(s=t.charCodeAt(n++),r<240){e+=String.fromCharCode((r&15)<<12|(a&63)<<6|s&63);continue}l=t.charCodeAt(n++),c=((r&7)<<18|(a&63)<<12|(s&63)<<6|l&63)-65536,e+=String.fromCharCode(55296+(c>>>10&1023)),e+=String.fromCharCode(56320+(c&1023))}return e}function N_(t){var e=Ii(2*t.length),n,r,a=1,s=0,l=0,c;for(r=0;r<t.length;r+=a)a=1,(c=t.charCodeAt(r))<128?n=c:c<224?(n=(c&31)*64+(t.charCodeAt(r+1)&63),a=2):c<240?(n=(c&15)*4096+(t.charCodeAt(r+1)&63)*64+(t.charCodeAt(r+2)&63),a=3):(a=4,n=(c&7)*262144+(t.charCodeAt(r+1)&63)*4096+(t.charCodeAt(r+2)&63)*64+(t.charCodeAt(r+3)&63),n-=65536,l=55296+(n>>>10&1023),n=56320+(n&1023)),l!==0&&(e[s++]=l&255,e[s++]=l>>>8,l=0),e[s++]=n%256,e[s++]=n>>>8;return e.slice(0,s).toString("ucs2")}function M_(t){return ei(t,"binary").toString("utf8")}var cf="foo bar baz",Bt=lt&&(M_(cf)==wh(cf)&&M_||N_(cf)==wh(cf)&&N_)||wh,Ea=lt?function(t){return ei(t,"utf8").toString("binary")}:function(t){for(var e=[],n=0,r=0,a=0;n<t.length;)switch(r=t.charCodeAt(n++),!0){case r<128:e.push(String.fromCharCode(r));break;case r<2048:e.push(String.fromCharCode(192+(r>>6))),e.push(String.fromCharCode(128+(r&63)));break;case(r>=55296&&r<57344):r-=55296,a=t.charCodeAt(n++)-56320+(r<<10),e.push(String.fromCharCode(240+(a>>18&7))),e.push(String.fromCharCode(144+(a>>12&63))),e.push(String.fromCharCode(128+(a>>6&63))),e.push(String.fromCharCode(128+(a&63)));break;default:e.push(String.fromCharCode(224+(r>>12))),e.push(String.fromCharCode(128+(r>>6&63))),e.push(String.fromCharCode(128+(r&63)))}return e.join("")},wc=function(){var t={};return function(n,r){var a=n+"|"+(r||"");return t[a]?t[a]:t[a]=new RegExp("<(?:\\w+:)?"+n+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+n+">",r||"")}}(),tw=function(){var t=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(n){for(var r=n.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<t.length;++a)r=r.replace(t[a][0],t[a][1]);return r}}(),a5=function(){var t={};return function(n){return t[n]!==void 0?t[n]:t[n]=new RegExp("<(?:vt:)?"+n+">([\\s\\S]*?)</(?:vt:)?"+n+">","g")}}(),i5=/<\/?(?:vt:)?variant>/g,s5=/<(?:vt:)([^>]*)>([\s\S]*)</;function D_(t,e){var n=Ze(t),r=t.match(a5(n.baseType))||[],a=[];if(r.length!=n.size){if(e.WTF)throw new Error("unexpected vector length "+r.length+" != "+n.size);return a}return r.forEach(function(s){var l=s.replace(i5,"").match(s5);l&&a.push({v:Bt(l[2]),t:l[1]})}),a}var nw=/(^\s|\s$|\n)/;function jn(t,e){return"<"+t+(e.match(nw)?' xml:space="preserve"':"")+">"+e+"</"+t+">"}function Sc(t){return ln(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function Fe(t,e,n){return"<"+t+(n!=null?Sc(n):"")+(e!=null?(e.match(nw)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function nm(t,e){try{return t.toISOString().replace(/\.\d*/,"")}catch(n){if(e)throw n}return""}function o5(t,e){switch(typeof t){case"string":var n=Fe("vt:lpwstr",Dt(t));return n=n.replace(/&quot;/g,"_x0022_"),n;case"number":return Fe((t|0)==t?"vt:i4":"vt:r8",Dt(String(t)));case"boolean":return Fe("vt:bool",t?"true":"false")}if(t instanceof Date)return Fe("vt:filetime",nm(t));throw new Error("Unable to serialize "+t)}function ep(t){if(lt&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return Bt(Bi($m(t)));throw new Error("Bad input format: expected Buffer or string")}var Ec=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,Sn={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},bs=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Ar={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function l5(t,e){for(var n=1-2*(t[e+7]>>>7),r=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),a=t[e+6]&15,s=5;s>=0;--s)a=a*256+t[e+s];return r==2047?a==0?n*(1/0):NaN:(r==0?r=-1022:(r-=1023,a+=Math.pow(2,52)),n*Math.pow(2,r-52)*a)}function c5(t,e,n){var r=(e<0||1/e==-1/0?1:0)<<7,a=0,s=0,l=r?-e:e;isFinite(l)?l==0?a=s=0:(a=Math.floor(Math.log(l)/Math.LN2),s=l*Math.pow(2,52-a),a<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?a=-1022:(s-=Math.pow(2,52),a+=1023)):(a=2047,s=isNaN(e)?26985:0);for(var c=0;c<=5;++c,s/=256)t[n+c]=s&255;t[n+6]=(a&15)<<4|s&15,t[n+7]=a>>4|r}var R_=function(t){for(var e=[],n=10240,r=0;r<t[0].length;++r)if(t[0][r])for(var a=0,s=t[0][r].length;a<s;a+=n)e.push.apply(e,t[0][r].slice(a,a+n));return e},F_=lt?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:ei(e)})):R_(t)}:R_,I_=function(t,e,n){for(var r=[],a=e;a<n;a+=2)r.push(String.fromCharCode($a(t,a)));return r.join("").replace(ur,"")},tp=lt?function(t,e,n){return Buffer.isBuffer(t)?t.toString("utf16le",e,n).replace(ur,""):I_(t,e,n)}:I_,P_=function(t,e,n){for(var r=[],a=e;a<e+n;++a)r.push(("0"+t[a].toString(16)).slice(-2));return r.join("")},rw=lt?function(t,e,n){return Buffer.isBuffer(t)?t.toString("hex",e,e+n):P_(t,e,n)}:P_,L_=function(t,e,n){for(var r=[],a=e;a<n;a++)r.push(String.fromCharCode(ko(t,a)));return r.join("")},Bc=lt?function(e,n,r){return Buffer.isBuffer(e)?e.toString("utf8",n,r):L_(e,n,r)}:L_,aw=function(t,e){var n=kr(t,e);return n>0?Bc(t,e+4,e+4+n-1):""},iw=aw,sw=function(t,e){var n=kr(t,e);return n>0?Bc(t,e+4,e+4+n-1):""},ow=sw,lw=function(t,e){var n=2*kr(t,e);return n>0?Bc(t,e+4,e+4+n-1):""},cw=lw,uw=function(e,n){var r=kr(e,n);return r>0?tp(e,n+4,n+4+r):""},fw=uw,dw=function(t,e){var n=kr(t,e);return n>0?Bc(t,e+4,e+4+n):""},hw=dw,mw=function(t,e){return l5(t,e)},Rf=mw,np=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};lt&&(iw=function(e,n){if(!Buffer.isBuffer(e))return aw(e,n);var r=e.readUInt32LE(n);return r>0?e.toString("utf8",n+4,n+4+r-1):""},ow=function(e,n){if(!Buffer.isBuffer(e))return sw(e,n);var r=e.readUInt32LE(n);return r>0?e.toString("utf8",n+4,n+4+r-1):""},cw=function(e,n){if(!Buffer.isBuffer(e))return lw(e,n);var r=2*e.readUInt32LE(n);return e.toString("utf16le",n+4,n+4+r-1)},fw=function(e,n){if(!Buffer.isBuffer(e))return uw(e,n);var r=e.readUInt32LE(n);return e.toString("utf16le",n+4,n+4+r)},hw=function(e,n){if(!Buffer.isBuffer(e))return dw(e,n);var r=e.readUInt32LE(n);return e.toString("utf8",n+4,n+4+r)},Rf=function(e,n){return Buffer.isBuffer(e)?e.readDoubleLE(n):mw(e,n)},np=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var ko=function(t,e){return t[e]},$a=function(t,e){return t[e+1]*256+t[e]},u5=function(t,e){var n=t[e+1]*256+t[e];return n<32768?n:(65535-n+1)*-1},kr=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},us=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},f5=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function cc(t,e){var n="",r,a,s=[],l,c,f,d;switch(e){case"dbcs":if(d=this.l,lt&&Buffer.isBuffer(this))n=this.slice(this.l,this.l+2*t).toString("utf16le");else for(f=0;f<t;++f)n+=String.fromCharCode($a(this,d)),d+=2;t*=2;break;case"utf8":n=Bc(this,this.l,this.l+t);break;case"utf16le":t*=2,n=tp(this,this.l,this.l+t);break;case"wstr":return cc.call(this,t,"dbcs");case"lpstr-ansi":n=iw(this,this.l),t=4+kr(this,this.l);break;case"lpstr-cp":n=ow(this,this.l),t=4+kr(this,this.l);break;case"lpwstr":n=cw(this,this.l),t=4+2*kr(this,this.l);break;case"lpp4":t=4+kr(this,this.l),n=fw(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+kr(this,this.l),n=hw(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,n="";(l=ko(this,this.l+t++))!==0;)s.push(lf(l));n=s.join("");break;case"_wstr":for(t=0,n="";(l=$a(this,this.l+t))!==0;)s.push(lf(l)),t+=2;t+=2,n=s.join("");break;case"dbcs-cont":for(n="",d=this.l,f=0;f<t;++f){if(this.lens&&this.lens.indexOf(d)!==-1)return l=ko(this,d),this.l=d+1,c=cc.call(this,t-f,l?"dbcs-cont":"sbcs-cont"),s.join("")+c;s.push(lf($a(this,d))),d+=2}n=s.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(n="",d=this.l,f=0;f!=t;++f){if(this.lens&&this.lens.indexOf(d)!==-1)return l=ko(this,d),this.l=d+1,c=cc.call(this,t-f,l?"dbcs-cont":"sbcs-cont"),s.join("")+c;s.push(lf(ko(this,d))),d+=1}n=s.join("");break;default:switch(t){case 1:return r=ko(this,this.l),this.l++,r;case 2:return r=(e==="i"?u5:$a)(this,this.l),this.l+=2,r;case 4:case-4:return e==="i"||(this[this.l+3]&128)===0?(r=(t>0?us:f5)(this,this.l),this.l+=4,r):(a=kr(this,this.l),this.l+=4,a);case 8:case-8:if(e==="f")return t==8?a=Rf(this,this.l):a=Rf([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;t=8;case 16:n=rw(this,this.l,t);break}}return this.l+=t,n}var d5=function(t,e,n){t[n]=e&255,t[n+1]=e>>>8&255,t[n+2]=e>>>16&255,t[n+3]=e>>>24&255},h5=function(t,e,n){t[n]=e&255,t[n+1]=e>>8&255,t[n+2]=e>>16&255,t[n+3]=e>>24&255},m5=function(t,e,n){t[n]=e&255,t[n+1]=e>>>8&255};function p5(t,e,n){var r=0,a=0;if(n==="dbcs"){for(a=0;a!=e.length;++a)m5(this,e.charCodeAt(a),this.l+2*a);r=2*e.length}else if(n==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=e.length;++a)this[this.l+a]=e.charCodeAt(a)&255;r=e.length}else if(n==="hex"){for(;a<t;++a)this[this.l++]=parseInt(e.slice(2*a,2*a+2),16)||0;return this}else if(n==="utf16le"){var s=Math.min(this.l+t,this.length);for(a=0;a<Math.min(e.length,t);++a){var l=e.charCodeAt(a);this[this.l++]=l&255,this[this.l++]=l>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(t){case 1:r=1,this[this.l]=e&255;break;case 2:r=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:r=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:r=4,d5(this,e,this.l);break;case 8:if(r=8,n==="f"){c5(this,e,this.l);break}case 16:break;case-4:r=4,h5(this,e,this.l);break}return this.l+=r,this}function pw(t,e){var n=rw(this,this.l,t.length>>1);if(n!==t)throw new Error(e+"Expected "+t+" saw "+n);this.l+=t.length>>1}function qn(t,e){t.l=e,t.read_shift=cc,t.chk=pw,t.write_shift=p5}function rr(t,e){t.l+=e}function xe(t){var e=Ii(t);return qn(e,0),e}function ti(t,e,n){if(t){var r,a,s;qn(t,t.l||0);for(var l=t.length,c=0,f=0;t.l<l;){c=t.read_shift(1),c&128&&(c=(c&127)+((t.read_shift(1)&127)<<7));var d=Mc[c]||Mc[65535];for(r=t.read_shift(1),s=r&127,a=1;a<4&&r&128;++a)s+=((r=t.read_shift(1))&127)<<7*a;f=t.l+s;var g=d.f&&d.f(t,s,n);if(t.l=f,e(g,d,c))return}}}function xr(){var t=[],e=lt?256:2048,n=function(d){var g=xe(d);return qn(g,0),g},r=n(e),a=function(){r&&(r.length>r.l&&(r=r.slice(0,r.l),r.l=r.length),r.length>0&&t.push(r),r=null)},s=function(d){return r&&d<r.length-r.l?r:(a(),r=n(Math.max(d+1,e)))},l=function(){return a(),In(t)},c=function(d){a(),r=d,r.l==null&&(r.l=r.length),s(e)};return{next:s,push:c,end:l,_bufs:t}}function Ee(t,e,n,r){var a=+e,s;if(!isNaN(a)){r||(r=Mc[a].p||(n||[]).length||0),s=1+(a>=128?1:0)+1,r>=128&&++s,r>=16384&&++s,r>=2097152&&++s;var l=t.next(s);a<=127?l.write_shift(1,a):(l.write_shift(1,(a&127)+128),l.write_shift(1,a>>7));for(var c=0;c!=4;++c)if(r>=128)l.write_shift(1,(r&127)+128),r>>=7;else{l.write_shift(1,r);break}r>0&&np(n)&&t.push(n)}}function uc(t,e,n){var r=Kt(t);if(e.s?(r.cRel&&(r.c+=e.s.c),r.rRel&&(r.r+=e.s.r)):(r.cRel&&(r.c+=e.c),r.rRel&&(r.r+=e.r)),!n||n.biff<12){for(;r.c>=256;)r.c-=256;for(;r.r>=65536;)r.r-=65536}return r}function O_(t,e,n){var r=Kt(t);return r.s=uc(r.s,e.s,n),r.e=uc(r.e,e.s,n),r}function fc(t,e){if(t.cRel&&t.c<0)for(t=Kt(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=Kt(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var n=Je(t);return!t.cRel&&t.cRel!=null&&(n=v5(n)),!t.rRel&&t.rRel!=null&&(n=g5(n)),n}function Sh(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+tn(t.s.c)+":"+(t.e.cRel?"":"$")+tn(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+mn(t.s.r)+":"+(t.e.rRel?"":"$")+mn(t.e.r):fc(t.s,e.biff)+":"+fc(t.e,e.biff)}function rp(t){return parseInt(x5(t),10)-1}function mn(t){return""+(t+1)}function g5(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function x5(t){return t.replace(/\$(\d+)$/,"$1")}function ap(t){for(var e=y5(t),n=0,r=0;r!==e.length;++r)n=26*n+e.charCodeAt(r)-64;return n-1}function tn(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function v5(t){return t.replace(/^([A-Z])/,"$$$1")}function y5(t){return t.replace(/^\$([A-Z])/,"$1")}function _5(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function nn(t){for(var e=0,n=0,r=0;r<t.length;++r){var a=t.charCodeAt(r);a>=48&&a<=57?e=10*e+(a-48):a>=65&&a<=90&&(n=26*n+(a-64))}return{c:n-1,r:e-1}}function Je(t){for(var e=t.c+1,n="";e;e=(e-1)/26|0)n=String.fromCharCode((e-1)%26+65)+n;return n+(t.r+1)}function vr(t){var e=t.indexOf(":");return e==-1?{s:nn(t),e:nn(t)}:{s:nn(t.slice(0,e)),e:nn(t.slice(e+1))}}function rt(t,e){return typeof e>"u"||typeof e=="number"?rt(t.s,t.e):(typeof t!="string"&&(t=Je(t)),typeof e!="string"&&(e=Je(e)),t==e?t:t+":"+e)}function xt(t){var e={s:{c:0,r:0},e:{c:0,r:0}},n=0,r=0,a=0,s=t.length;for(n=0;r<s&&!((a=t.charCodeAt(r)-64)<1||a>26);++r)n=26*n+a;for(e.s.c=--n,n=0;r<s&&!((a=t.charCodeAt(r)-48)<0||a>9);++r)n=10*n+a;if(e.s.r=--n,r===s||a!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++r,n=0;r!=s&&!((a=t.charCodeAt(r)-64)<1||a>26);++r)n=26*n+a;for(e.e.c=--n,n=0;r!=s&&!((a=t.charCodeAt(r)-48)<0||a>9);++r)n=10*n+a;return e.e.r=--n,e}function U_(t,e){var n=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=Kr(t.z,n?En(e):e)}catch{}try{return t.w=Kr((t.XF||{}).numFmtId||(n?14:0),n?En(e):e)}catch{return""+e}}function Xa(t,e,n){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&n&&n.dateNF&&(t.z=n.dateNF),t.t=="e"?ni[t.v]||t.v:e==null?U_(t,t.v):U_(t,e))}function Vi(t,e){var n=e&&e.sheet?e.sheet:"Sheet1",r={};return r[n]=t,{SheetNames:[n],Sheets:r}}function gw(t,e,n){var r=n||{},a=t?Array.isArray(t):r.dense,s=t||(a?[]:{}),l=0,c=0;if(s&&r.origin!=null){if(typeof r.origin=="number")l=r.origin;else{var f=typeof r.origin=="string"?nn(r.origin):r.origin;l=f.r,c=f.c}s["!ref"]||(s["!ref"]="A1:A1")}var d={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var g=xt(s["!ref"]);d.s.c=g.s.c,d.s.r=g.s.r,d.e.c=Math.max(d.e.c,g.e.c),d.e.r=Math.max(d.e.r,g.e.r),l==-1&&(d.e.r=l=g.e.r+1)}for(var x=0;x!=e.length;++x)if(e[x]){if(!Array.isArray(e[x]))throw new Error("aoa_to_sheet expects an array of arrays");for(var _=0;_!=e[x].length;++_)if(!(typeof e[x][_]>"u")){var T={v:e[x][_]},E=l+x,S=c+_;if(d.s.r>E&&(d.s.r=E),d.s.c>S&&(d.s.c=S),d.e.r<E&&(d.e.r=E),d.e.c<S&&(d.e.c=S),e[x][_]&&typeof e[x][_]=="object"&&!Array.isArray(e[x][_])&&!(e[x][_]instanceof Date))T=e[x][_];else if(Array.isArray(T.v)&&(T.f=e[x][_][1],T.v=T.v[0]),T.v===null)if(T.f)T.t="n";else if(r.nullError)T.t="e",T.v=0;else if(r.sheetStubs)T.t="z";else continue;else typeof T.v=="number"?T.t="n":typeof T.v=="boolean"?T.t="b":T.v instanceof Date?(T.z=r.dateNF||Ye[14],r.cellDates?(T.t="d",T.w=Kr(T.z,En(T.v))):(T.t="n",T.v=En(T.v),T.w=Kr(T.z,T.v))):T.t="s";if(a)s[E]||(s[E]=[]),s[E][S]&&s[E][S].z&&(T.z=s[E][S].z),s[E][S]=T;else{var C=Je({c:S,r:E});s[C]&&s[C].z&&(T.z=s[C].z),s[C]=T}}}return d.s.c<1e7&&(s["!ref"]=rt(d)),s}function Ko(t,e){return gw(null,t,e)}function T5(t){return t.read_shift(4,"i")}function fa(t,e){return e||(e=xe(4)),e.write_shift(4,t),e}function nr(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function Pn(t,e){var n=!1;return e==null&&(n=!0,e=xe(4+2*t.length)),e.write_shift(4,t.length),t.length>0&&e.write_shift(0,t,"dbcs"),n?e.slice(0,e.l):e}function w5(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function S5(t,e){return e||(e=xe(4)),e.write_shift(2,0),e.write_shift(2,0),e}function ip(t,e){var n=t.l,r=t.read_shift(1),a=nr(t),s=[],l={t:a,h:a};if((r&1)!==0){for(var c=t.read_shift(4),f=0;f!=c;++f)s.push(w5(t));l.r=s}else l.r=[{ich:0,ifnt:0}];return t.l=n+e,l}function E5(t,e){var n=!1;return e==null&&(n=!0,e=xe(15+4*t.t.length)),e.write_shift(1,0),Pn(t.t,e),n?e.slice(0,e.l):e}var C5=ip;function b5(t,e){var n=!1;return e==null&&(n=!0,e=xe(23+4*t.t.length)),e.write_shift(1,1),Pn(t.t,e),e.write_shift(4,1),S5({},e),n?e.slice(0,e.l):e}function Zr(t){var e=t.read_shift(4),n=t.read_shift(2);return n+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:n}}function As(t,e){return e==null&&(e=xe(8)),e.write_shift(-4,t.c),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}function ks(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}function Ns(t,e){return e==null&&(e=xe(4)),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}var A5=nr,xw=Pn;function sp(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}function Ff(t,e){var n=!1;return e==null&&(n=!0,e=xe(127)),e.write_shift(4,t.length>0?t.length:4294967295),t.length>0&&e.write_shift(0,t,"dbcs"),n?e.slice(0,e.l):e}var k5=nr,rm=sp,op=Ff;function lp(t){var e=t.slice(t.l,t.l+4),n=e[0]&1,r=e[0]&2;t.l+=4;var a=r===0?Rf([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):us(e,0)>>2;return n?a/100:a}function vw(t,e){e==null&&(e=xe(4));var n=0,r=0,a=t*100;if(t==(t|0)&&t>=-536870912&&t<1<<29?r=1:a==(a|0)&&a>=-536870912&&a<1<<29&&(r=1,n=1),r)e.write_shift(-4,((n?a:t)<<2)+(n+2));else throw new Error("unsupported RkNumber "+t)}function yw(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}function N5(t,e){return e||(e=xe(16)),e.write_shift(4,t.s.r),e.write_shift(4,t.e.r),e.write_shift(4,t.s.c),e.write_shift(4,t.e.c),e}var Ms=yw,Zo=N5;function er(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function _s(t,e){return(e||xe(8)).write_shift(8,t,"f")}function M5(t){var e={},n=t.read_shift(1),r=n>>>1,a=t.read_shift(1),s=t.read_shift(2,"i"),l=t.read_shift(1),c=t.read_shift(1),f=t.read_shift(1);switch(t.l++,r){case 0:e.auto=1;break;case 1:e.index=a;var d=ds[a];d&&(e.rgb=bc(d));break;case 2:e.rgb=bc([l,c,f]);break;case 3:e.theme=a;break}return s!=0&&(e.tint=s>0?s/32767:s/32768),e}function If(t,e){if(e||(e=xe(8)),!t||t.auto)return e.write_shift(4,0),e.write_shift(4,0),e;t.index!=null?(e.write_shift(1,2),e.write_shift(1,t.index)):t.theme!=null?(e.write_shift(1,6),e.write_shift(1,t.theme)):(e.write_shift(1,5),e.write_shift(1,0));var n=t.tint||0;if(n>0?n*=32767:n<0&&(n*=32768),e.write_shift(2,n),!t.rgb||t.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var r=t.rgb||"FFFFFF";typeof r=="number"&&(r=("000000"+r.toString(16)).slice(-6)),e.write_shift(1,parseInt(r.slice(0,2),16)),e.write_shift(1,parseInt(r.slice(2,4),16)),e.write_shift(1,parseInt(r.slice(4,6),16)),e.write_shift(1,255)}return e}function D5(t){var e=t.read_shift(1);t.l++;var n={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return n}function R5(t,e){e||(e=xe(2));var n=(t.italic?2:0)|(t.strike?8:0)|(t.outline?16:0)|(t.shadow?32:0)|(t.condense?64:0)|(t.extend?128:0);return e.write_shift(1,n),e.write_shift(1,0),e}function _w(t,e){var n={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},r=t.read_shift(4);switch(r){case 0:return"";case 4294967295:case 4294967294:return n[t.read_shift(4)]||""}if(r>400)throw new Error("Unsupported Clipboard: "+r.toString(16));return t.l-=4,t.read_shift(0,e==1?"lpstr":"lpwstr")}function F5(t){return _w(t,1)}function I5(t){return _w(t,2)}var cp=2,gr=3,uf=11,B_=12,Pf=19,ff=64,P5=65,L5=71,O5=4108,U5=4126,Fn=80,Tw=81,B5=[Fn,Tw],am={1:{n:"CodePage",t:cp},2:{n:"Category",t:Fn},3:{n:"PresentationFormat",t:Fn},4:{n:"ByteCount",t:gr},5:{n:"LineCount",t:gr},6:{n:"ParagraphCount",t:gr},7:{n:"SlideCount",t:gr},8:{n:"NoteCount",t:gr},9:{n:"HiddenCount",t:gr},10:{n:"MultimediaClipCount",t:gr},11:{n:"ScaleCrop",t:uf},12:{n:"HeadingPairs",t:O5},13:{n:"TitlesOfParts",t:U5},14:{n:"Manager",t:Fn},15:{n:"Company",t:Fn},16:{n:"LinksUpToDate",t:uf},17:{n:"CharacterCount",t:gr},19:{n:"SharedDoc",t:uf},22:{n:"HyperlinksChanged",t:uf},23:{n:"AppVersion",t:gr,p:"version"},24:{n:"DigSig",t:P5},26:{n:"ContentType",t:Fn},27:{n:"ContentStatus",t:Fn},28:{n:"Language",t:Fn},29:{n:"Version",t:Fn},255:{},2147483648:{n:"Locale",t:Pf},2147483651:{n:"Behavior",t:Pf},1919054434:{}},im={1:{n:"CodePage",t:cp},2:{n:"Title",t:Fn},3:{n:"Subject",t:Fn},4:{n:"Author",t:Fn},5:{n:"Keywords",t:Fn},6:{n:"Comments",t:Fn},7:{n:"Template",t:Fn},8:{n:"LastAuthor",t:Fn},9:{n:"RevNumber",t:Fn},10:{n:"EditTime",t:ff},11:{n:"LastPrinted",t:ff},12:{n:"CreatedDate",t:ff},13:{n:"ModifiedDate",t:ff},14:{n:"PageCount",t:gr},15:{n:"WordCount",t:gr},16:{n:"CharCount",t:gr},17:{n:"Thumbnail",t:L5},18:{n:"Application",t:Fn},19:{n:"DocSecurity",t:gr},255:{},2147483648:{n:"Locale",t:Pf},2147483651:{n:"Behavior",t:Pf},1919054434:{}},V_={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},V5=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function G5(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var H5=G5([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),ds=Kt(H5),ni={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},ww={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},sm={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},df={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function up(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function z5(t){var e=up();if(!t||!t.match)return e;var n={};if((t.match(ar)||[]).forEach(function(r){var a=Ze(r);switch(a[0].replace(QI,"<")){case"<?xml":break;case"<Types":e.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":n[a.Extension]=a.ContentType;break;case"<Override":e[sm[a.ContentType]]!==void 0&&e[sm[a.ContentType]].push(a.PartName);break}}),e.xmlns!==Sn.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=n,delete e.calcchains,e}function Sw(t,e){var n=zI(sm),r=[],a;r[r.length]=pn,r[r.length]=Fe("Types",null,{xmlns:Sn.CT,"xmlns:xsd":Sn.xsd,"xmlns:xsi":Sn.xsi}),r=r.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(f){return Fe("Default",null,{Extension:f[0],ContentType:f[1]})}));var s=function(f){t[f]&&t[f].length>0&&(a=t[f][0],r[r.length]=Fe("Override",null,{PartName:(a[0]=="/"?"":"/")+a,ContentType:df[f][e.bookType]||df[f].xlsx}))},l=function(f){(t[f]||[]).forEach(function(d){r[r.length]=Fe("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:df[f][e.bookType]||df[f].xlsx})})},c=function(f){(t[f]||[]).forEach(function(d){r[r.length]=Fe("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:n[f][0]})})};return s("workbooks"),l("sheets"),l("charts"),c("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(c),c("vba"),c("comments"),c("threadedcomments"),c("drawings"),l("metadata"),c("people"),r.length>2&&(r[r.length]="</Types>",r[1]=r[1].replace("/>",">")),r.join("")}var ut={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Cc(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function dc(t,e){var n={"!id":{}};if(!t)return n;e.charAt(0)!=="/"&&(e="/"+e);var r={};return(t.match(ar)||[]).forEach(function(a){var s=Ze(a);if(s[0]==="<Relationship"){var l={};l.Type=s.Type,l.Target=s.Target,l.Id=s.Id,s.TargetMode&&(l.TargetMode=s.TargetMode);var c=s.TargetMode==="External"?s.Target:ac(s.Target,e);n[c]=l,r[s.Id]=l}}),n["!id"]=r,n}function Po(t){var e=[pn,Fe("Relationships",null,{xmlns:Sn.RELS})];return ln(t["!id"]).forEach(function(n){e[e.length]=Fe("Relationship",null,t["!id"][n])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function Mt(t,e,n,r,a,s){if(a||(a={}),t["!id"]||(t["!id"]={}),t["!idx"]||(t["!idx"]=1),e<0)for(e=t["!idx"];t["!id"]["rId"+e];++e);if(t["!idx"]=e+1,a.Id="rId"+e,a.Type=r,a.Target=n,[ut.HLINK,ut.XPATH,ut.XMISS].indexOf(a.Type)>-1&&(a.TargetMode="External"),t["!id"][a.Id])throw new Error("Cannot rewrite rId "+e);return t["!id"][a.Id]=a,t[("/"+a.Target).replace("//","/")]=a,e}var q5="application/vnd.oasis.opendocument.spreadsheet";function j5(t,e){for(var n=ep(t),r,a;r=Ec.exec(n);)switch(r[3]){case"manifest":break;case"file-entry":if(a=Ze(r[0],!1),a.path=="/"&&a.type!==q5)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw r}}function $5(t){var e=[pn];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var n=0;n<t.length;++n)e.push('  <manifest:file-entry manifest:full-path="'+t[n][0]+'" manifest:media-type="'+t[n][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function G_(t,e,n){return['  <rdf:Description rdf:about="'+t+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(n||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function W5(t,e){return['  <rdf:Description rdf:about="'+t+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function Y5(t){var e=[pn];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var n=0;n!=t.length;++n)e.push(G_(t[n][0],t[n][1])),e.push(W5("",t[n][0]));return e.push(G_("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function Ew(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Af.version+"</meta:generator></office:meta></office:document-meta>"}var Xr=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],J5=function(){for(var t=new Array(Xr.length),e=0;e<Xr.length;++e){var n=Xr[e],r="(?:"+n[0].slice(0,n[0].indexOf(":"))+":)"+n[0].slice(n[0].indexOf(":")+1);t[e]=new RegExp("<"+r+"[^>]*>([\\s\\S]*?)</"+r+">")}return t}();function Cw(t){var e={};t=Bt(t);for(var n=0;n<Xr.length;++n){var r=Xr[n],a=t.match(J5[n]);a!=null&&a.length>0&&(e[r[1]]=gt(a[1])),r[2]==="date"&&e[r[1]]&&(e[r[1]]=Xt(e[r[1]]))}return e}function Eh(t,e,n,r,a){a[t]!=null||e==null||e===""||(a[t]=e,e=Dt(e),r[r.length]=n?Fe(t,e,n):jn(t,e))}function bw(t,e){var n=e||{},r=[pn,Fe("cp:coreProperties",null,{"xmlns:cp":Sn.CORE_PROPS,"xmlns:dc":Sn.dc,"xmlns:dcterms":Sn.dcterms,"xmlns:dcmitype":Sn.dcmitype,"xmlns:xsi":Sn.xsi})],a={};if(!t&&!n.Props)return r.join("");t&&(t.CreatedDate!=null&&Eh("dcterms:created",typeof t.CreatedDate=="string"?t.CreatedDate:nm(t.CreatedDate,n.WTF),{"xsi:type":"dcterms:W3CDTF"},r,a),t.ModifiedDate!=null&&Eh("dcterms:modified",typeof t.ModifiedDate=="string"?t.ModifiedDate:nm(t.ModifiedDate,n.WTF),{"xsi:type":"dcterms:W3CDTF"},r,a));for(var s=0;s!=Xr.length;++s){var l=Xr[s],c=n.Props&&n.Props[l[1]]!=null?n.Props[l[1]]:t?t[l[1]]:null;c===!0?c="1":c===!1?c="0":typeof c=="number"&&(c=String(c)),c!=null&&Eh(l[0],c,null,r,a)}return r.length>2&&(r[r.length]="</cp:coreProperties>",r[1]=r[1].replace("/>",">")),r.join("")}var hs=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],Aw=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function kw(t,e,n,r){var a=[];if(typeof t=="string")a=D_(t,r);else for(var s=0;s<t.length;++s)a=a.concat(t[s].map(function(g){return{v:g}}));var l=typeof e=="string"?D_(e,r).map(function(g){return g.v}):e,c=0,f=0;if(l.length>0)for(var d=0;d!==a.length;d+=2){switch(f=+a[d+1].v,a[d].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":n.Worksheets=f,n.SheetNames=l.slice(c,c+f);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":n.NamedRanges=f,n.DefinedNames=l.slice(c,c+f);break;case"Charts":case"Diagramme":n.Chartsheets=f,n.ChartNames=l.slice(c,c+f);break}c+=f}}function X5(t,e,n){var r={};return e||(e={}),t=Bt(t),hs.forEach(function(a){var s=(t.match(wc(a[0]))||[])[1];switch(a[2]){case"string":s&&(e[a[1]]=gt(s));break;case"bool":e[a[1]]=s==="true";break;case"raw":var l=t.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));l&&l.length>0&&(r[a[1]]=l[1]);break}}),r.HeadingPairs&&r.TitlesOfParts&&kw(r.HeadingPairs,r.TitlesOfParts,e,n),e}function Nw(t){var e=[],n=Fe;return t||(t={}),t.Application="SheetJS",e[e.length]=pn,e[e.length]=Fe("Properties",null,{xmlns:Sn.EXT_PROPS,"xmlns:vt":Sn.vt}),hs.forEach(function(r){if(t[r[1]]!==void 0){var a;switch(r[2]){case"string":a=Dt(String(t[r[1]]));break;case"bool":a=t[r[1]]?"true":"false";break}a!==void 0&&(e[e.length]=n(r[0],a))}}),e[e.length]=n("HeadingPairs",n("vt:vector",n("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+n("vt:variant",n("vt:i4",String(t.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=n("TitlesOfParts",n("vt:vector",t.SheetNames.map(function(r){return"<vt:lpstr>"+Dt(r)+"</vt:lpstr>"}).join(""),{size:t.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var K5=/<[^>]+>[^<]*/g;function Z5(t,e){var n={},r="",a=t.match(K5);if(a)for(var s=0;s!=a.length;++s){var l=a[s],c=Ze(l);switch(c[0]){case"<?xml":break;case"<Properties":break;case"<property":r=gt(c.name);break;case"</property>":r=null;break;default:if(l.indexOf("<vt:")===0){var f=l.split(">"),d=f[0].slice(4),g=f[1];switch(d){case"lpstr":case"bstr":case"lpwstr":n[r]=gt(g);break;case"bool":n[r]=Jt(g);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":n[r]=parseInt(g,10);break;case"r4":case"r8":case"decimal":n[r]=parseFloat(g);break;case"filetime":case"date":n[r]=Xt(g);break;case"cy":case"error":n[r]=gt(g);break;default:if(d.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",l,d,f)}}else if(l.slice(0,2)!=="</"){if(e.WTF)throw new Error(l)}}}return n}function Mw(t){var e=[pn,Fe("Properties",null,{xmlns:Sn.CUST_PROPS,"xmlns:vt":Sn.vt})];if(!t)return e.join("");var n=1;return ln(t).forEach(function(a){++n,e[e.length]=Fe("property",o5(t[a]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:n,name:Dt(a)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var om={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Ch;function Q5(t,e,n){Ch||(Ch=Jf(om)),e=Ch[e]||e,t[e]=n}function eP(t,e){var n=[];return ln(om).map(function(r){for(var a=0;a<Xr.length;++a)if(Xr[a][1]==r)return Xr[a];for(a=0;a<hs.length;++a)if(hs[a][1]==r)return hs[a];throw r}).forEach(function(r){if(t[r[1]]!=null){var a=e&&e.Props&&e.Props[r[1]]!=null?e.Props[r[1]]:t[r[1]];switch(r[2]){case"date":a=new Date(a).toISOString().replace(/\.\d*Z/,"Z");break}typeof a=="number"?a=String(a):a===!0||a===!1?a=a?"1":"0":a instanceof Date&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"")),n.push(jn(om[r[1]]||r[1],a))}}),Fe("DocumentProperties",n.join(""),{xmlns:Ar.o})}function tP(t,e){var n=["Worksheets","SheetNames"],r="CustomDocumentProperties",a=[];return t&&ln(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)){for(var l=0;l<Xr.length;++l)if(s==Xr[l][1])return;for(l=0;l<hs.length;++l)if(s==hs[l][1])return;for(l=0;l<n.length;++l)if(s==n[l])return;var c=t[s],f="string";typeof c=="number"?(f="float",c=String(c)):c===!0||c===!1?(f="boolean",c=c?"1":"0"):c=String(c),a.push(Fe(A_(s),c,{"dt:dt":f}))}}),e&&ln(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)&&!(t&&Object.prototype.hasOwnProperty.call(t,s))){var l=e[s],c="string";typeof l=="number"?(c="float",l=String(l)):l===!0||l===!1?(c="boolean",l=l?"1":"0"):l instanceof Date?(c="dateTime.tz",l=l.toISOString()):l=String(l),a.push(Fe(A_(s),l,{"dt:dt":c}))}}),"<"+r+' xmlns="'+Ar.o+'">'+a.join("")+"</"+r+">"}function fp(t){var e=t.read_shift(4),n=t.read_shift(4);return new Date((n/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function nP(t){var e=typeof t=="string"?new Date(Date.parse(t)):t,n=e.getTime()/1e3+11644473600,r=n%Math.pow(2,32),a=(n-r)/Math.pow(2,32);r*=1e7,a*=1e7;var s=r/Math.pow(2,32)|0;s>0&&(r=r%Math.pow(2,32),a+=s);var l=xe(8);return l.write_shift(4,r),l.write_shift(4,a),l}function Dw(t,e,n){var r=t.l,a=t.read_shift(0,"lpstr-cp");if(n)for(;t.l-r&3;)++t.l;return a}function Rw(t,e,n){var r=t.read_shift(0,"lpwstr");return r}function Fw(t,e,n){return e===31?Rw(t):Dw(t,e,n)}function lm(t,e,n){return Fw(t,e,n===!1?0:4)}function rP(t,e){if(!e)throw new Error("VtUnalignedString must have positive length");return Fw(t,e,0)}function aP(t){for(var e=t.read_shift(4),n=[],r=0;r!=e;++r){var a=t.l;n[r]=t.read_shift(0,"lpwstr").replace(ur,""),t.l-a&2&&(t.l+=2)}return n}function iP(t){for(var e=t.read_shift(4),n=[],r=0;r!=e;++r)n[r]=t.read_shift(0,"lpstr-cp").replace(ur,"");return n}function sP(t){var e=t.l,n=Lf(t,Tw);t[t.l]==0&&t[t.l+1]==0&&t.l-e&2&&(t.l+=2);var r=Lf(t,gr);return[n,r]}function oP(t){for(var e=t.read_shift(4),n=[],r=0;r<e/2;++r)n.push(sP(t));return n}function H_(t,e){for(var n=t.read_shift(4),r={},a=0;a!=n;++a){var s=t.read_shift(4),l=t.read_shift(4);r[s]=t.read_shift(l,e===1200?"utf16le":"utf8").replace(ur,"").replace(rc,"!"),e===1200&&l%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>3<<2),r}function Iw(t){var e=t.read_shift(4),n=t.slice(t.l,t.l+e);return t.l+=e,(e&3)>0&&(t.l+=4-(e&3)&3),n}function lP(t){var e={};return e.Size=t.read_shift(4),t.l+=e.Size+3-(e.Size-1)%4,e}function Lf(t,e,n){var r=t.read_shift(2),a,s=n||{};if(t.l+=2,e!==B_&&r!==e&&B5.indexOf(e)===-1&&!((e&65534)==4126&&(r&65534)==4126))throw new Error("Expected type "+e+" saw "+r);switch(e===B_?r:e){case 2:return a=t.read_shift(2,"i"),s.raw||(t.l+=2),a;case 3:return a=t.read_shift(4,"i"),a;case 11:return t.read_shift(4)!==0;case 19:return a=t.read_shift(4),a;case 30:return Dw(t,r,4).replace(ur,"");case 31:return Rw(t);case 64:return fp(t);case 65:return Iw(t);case 71:return lP(t);case 80:return lm(t,r,!s.raw).replace(ur,"");case 81:return rP(t,r).replace(ur,"");case 4108:return oP(t);case 4126:case 4127:return r==4127?aP(t):iP(t);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+r)}}function z_(t,e){var n=xe(4),r=xe(4);switch(n.write_shift(4,t==80?31:t),t){case 3:r.write_shift(-4,e);break;case 5:r=xe(8),r.write_shift(8,e,"f");break;case 11:r.write_shift(4,e?1:0);break;case 64:r=nP(e);break;case 31:case 80:for(r=xe(4+2*(e.length+1)+(e.length%2?0:2)),r.write_shift(4,e.length+1),r.write_shift(0,e,"dbcs");r.l!=r.length;)r.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+e)}return In([n,r])}function q_(t,e){var n=t.l,r=t.read_shift(4),a=t.read_shift(4),s=[],l=0,c=0,f=-1,d={};for(l=0;l!=a;++l){var g=t.read_shift(4),x=t.read_shift(4);s[l]=[g,x+n]}s.sort(function(N,b){return N[1]-b[1]});var _={};for(l=0;l!=a;++l){if(t.l!==s[l][1]){var T=!0;if(l>0&&e)switch(e[s[l-1][0]].t){case 2:t.l+2===s[l][1]&&(t.l+=2,T=!1);break;case 80:t.l<=s[l][1]&&(t.l=s[l][1],T=!1);break;case 4108:t.l<=s[l][1]&&(t.l=s[l][1],T=!1);break}if((!e||l==0)&&t.l<=s[l][1]&&(T=!1,t.l=s[l][1]),T)throw new Error("Read Error: Expected address "+s[l][1]+" at "+t.l+" :"+l)}if(e){var E=e[s[l][0]];if(_[E.n]=Lf(t,E.t,{raw:!0}),E.p==="version"&&(_[E.n]=String(_[E.n]>>16)+"."+("0000"+String(_[E.n]&65535)).slice(-4)),E.n=="CodePage")switch(_[E.n]){case 0:_[E.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:la(c=_[E.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+_[E.n])}}else if(s[l][0]===1){if(c=_.CodePage=Lf(t,cp),la(c),f!==-1){var S=t.l;t.l=s[f][1],d=H_(t,c),t.l=S}}else if(s[l][0]===0){if(c===0){f=l,t.l=s[l+1][1];continue}d=H_(t,c)}else{var C=d[s[l][0]],k;switch(t[t.l]){case 65:t.l+=4,k=Iw(t);break;case 30:t.l+=4,k=lm(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,k=lm(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,k=t.read_shift(4,"i");break;case 19:t.l+=4,k=t.read_shift(4);break;case 5:t.l+=4,k=t.read_shift(8,"f");break;case 11:t.l+=4,k=dn(t,4);break;case 64:t.l+=4,k=Xt(fp(t));break;default:throw new Error("unparsed value: "+t[t.l])}_[C]=k}}return t.l=n+r,_}var Pw=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function cP(t){switch(typeof t){case"boolean":return 11;case"number":return(t|0)==t?3:5;case"string":return 31;case"object":if(t instanceof Date)return 64;break}return-1}function j_(t,e,n){var r=xe(8),a=[],s=[],l=8,c=0,f=xe(8),d=xe(8);if(f.write_shift(4,2),f.write_shift(4,1200),d.write_shift(4,1),s.push(f),a.push(d),l+=8+f.length,!e){d=xe(8),d.write_shift(4,0),a.unshift(d);var g=[xe(4)];for(g[0].write_shift(4,t.length),c=0;c<t.length;++c){var x=t[c][0];for(f=xe(8+2*(x.length+1)+(x.length%2?0:2)),f.write_shift(4,c+2),f.write_shift(4,x.length+1),f.write_shift(0,x,"dbcs");f.l!=f.length;)f.write_shift(1,0);g.push(f)}f=In(g),s.unshift(f),l+=8+f.length}for(c=0;c<t.length;++c)if(!(e&&!e[t[c][0]])&&!(Pw.indexOf(t[c][0])>-1||Aw.indexOf(t[c][0])>-1)&&t[c][1]!=null){var _=t[c][1],T=0;if(e){T=+e[t[c][0]];var E=n[T];if(E.p=="version"&&typeof _=="string"){var S=_.split(".");_=(+S[0]<<16)+(+S[1]||0)}f=z_(E.t,_)}else{var C=cP(_);C==-1&&(C=31,_=String(_)),f=z_(C,_)}s.push(f),d=xe(8),d.write_shift(4,e?T:2+c),a.push(d),l+=8+f.length}var k=8*(s.length+1);for(c=0;c<s.length;++c)a[c].write_shift(4,k),k+=s[c].length;return r.write_shift(4,l),r.write_shift(4,s.length),In([r].concat(a).concat(s))}function $_(t,e,n){var r=t.content;if(!r)return{};qn(r,0);var a,s,l,c,f=0;r.chk("feff","Byte Order: "),r.read_shift(2);var d=r.read_shift(4),g=r.read_shift(16);if(g!==ze.utils.consts.HEADER_CLSID&&g!==n)throw new Error("Bad PropertySet CLSID "+g);if(a=r.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(s=r.read_shift(16),c=r.read_shift(4),a===1&&c!==r.l)throw new Error("Length mismatch: "+c+" !== "+r.l);a===2&&(l=r.read_shift(16),f=r.read_shift(4));var x=q_(r,e),_={SystemIdentifier:d};for(var T in x)_[T]=x[T];if(_.FMTID=s,a===1)return _;if(f-r.l==2&&(r.l+=2),r.l!==f)throw new Error("Length mismatch 2: "+r.l+" !== "+f);var E;try{E=q_(r,null)}catch{}for(T in E)_[T]=E[T];return _.FMTID=[s,l],_}function W_(t,e,n,r,a,s){var l=xe(a?68:48),c=[l];l.write_shift(2,65534),l.write_shift(2,0),l.write_shift(4,842412599),l.write_shift(16,ze.utils.consts.HEADER_CLSID,"hex"),l.write_shift(4,a?2:1),l.write_shift(16,e,"hex"),l.write_shift(4,a?68:48);var f=j_(t,n,r);if(c.push(f),a){var d=j_(a,null,null);l.write_shift(16,s,"hex"),l.write_shift(4,68+f.length),c.push(d)}return In(c)}function ki(t,e){return t.read_shift(e),null}function uP(t,e){e||(e=xe(t));for(var n=0;n<t;++n)e.write_shift(1,0);return e}function fP(t,e,n){for(var r=[],a=t.l+e;t.l<a;)r.push(n(t,a-t.l));if(a!==t.l)throw new Error("Slurp error");return r}function dn(t,e){return t.read_shift(e)===1}function cr(t,e){return e||(e=xe(2)),e.write_shift(2,+!!t),e}function _n(t){return t.read_shift(2,"u")}function Yr(t,e){return e||(e=xe(2)),e.write_shift(2,t),e}function Lw(t,e){return fP(t,e,_n)}function dP(t){var e=t.read_shift(1),n=t.read_shift(1);return n===1?e:e===1}function Ow(t,e,n){return n||(n=xe(2)),n.write_shift(1,e=="e"?+t:+!!t),n.write_shift(1,e=="e"?1:0),n}function Vc(t,e,n){var r=t.read_shift(n&&n.biff>=12?2:1),a="sbcs-cont";if(n&&n.biff>=8,!n||n.biff==8){var s=t.read_shift(1);s&&(a="dbcs-cont")}else n.biff==12&&(a="wstr");n.biff>=2&&n.biff<=5&&(a="cpstr");var l=r?t.read_shift(r,a):"";return l}function hP(t){var e=t.read_shift(2),n=t.read_shift(1),r=n&4,a=n&8,s=1+(n&1),l=0,c,f={};a&&(l=t.read_shift(2)),r&&(c=t.read_shift(4));var d=s==2?"dbcs-cont":"sbcs-cont",g=e===0?"":t.read_shift(e,d);return a&&(t.l+=4*l),r&&(t.l+=c),f.t=g,a||(f.raw="<t>"+f.t+"</t>",f.r=f.t),f}function mP(t){var e=t.t||"",n=xe(3);n.write_shift(2,e.length),n.write_shift(1,1);var r=xe(2*e.length);r.write_shift(2*e.length,e,"utf16le");var a=[n,r];return In(a)}function Ts(t,e,n){var r;if(n){if(n.biff>=2&&n.biff<=5)return t.read_shift(e,"cpstr");if(n.biff>=12)return t.read_shift(e,"dbcs-cont")}var a=t.read_shift(1);return a===0?r=t.read_shift(e,"sbcs-cont"):r=t.read_shift(e,"dbcs-cont"),r}function Gc(t,e,n){var r=t.read_shift(n&&n.biff==2?1:2);return r===0?(t.l++,""):Ts(t,r,n)}function Ds(t,e,n){if(n.biff>5)return Gc(t,e,n);var r=t.read_shift(1);return r===0?(t.l++,""):t.read_shift(r,n.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function Uw(t,e,n){return n||(n=xe(3+2*t.length)),n.write_shift(2,t.length),n.write_shift(1,1),n.write_shift(31,t,"utf16le"),n}function pP(t){var e=t.read_shift(1);t.l++;var n=t.read_shift(2);return t.l+=2,[e,n]}function gP(t){var e=t.read_shift(4),n=t.l,r=!1;e>24&&(t.l+=e-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(r=!0),t.l=n);var a=t.read_shift((r?e-24:e)>>1,"utf16le").replace(ur,"");return r&&(t.l+=24),a}function xP(t){for(var e=t.read_shift(2),n="";e-- >0;)n+="../";var r=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=t.read_shift(4);if(a===0)return n+r.replace(/\\/g,"/");var s=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var l=t.read_shift(s>>1,"utf16le").replace(ur,"");return n+l}function vP(t,e){var n=t.read_shift(16);switch(n){case"e0c9ea79f9bace118c8200aa004ba90b":return gP(t);case"0303000000000000c000000000000046":return xP(t);default:throw new Error("Unsupported Moniker "+n)}}function hf(t){var e=t.read_shift(4),n=e>0?t.read_shift(e,"utf16le").replace(ur,""):"";return n}function Y_(t,e){e||(e=xe(6+t.length*2)),e.write_shift(4,1+t.length);for(var n=0;n<t.length;++n)e.write_shift(2,t.charCodeAt(n));return e.write_shift(2,0),e}function yP(t,e){var n=t.l+e,r=t.read_shift(4);if(r!==2)throw new Error("Unrecognized streamVersion: "+r);var a=t.read_shift(2);t.l+=2;var s,l,c,f,d="",g,x;a&16&&(s=hf(t,n-t.l)),a&128&&(l=hf(t,n-t.l)),(a&257)===257&&(c=hf(t,n-t.l)),(a&257)===1&&(f=vP(t,n-t.l)),a&8&&(d=hf(t,n-t.l)),a&32&&(g=t.read_shift(16)),a&64&&(x=fp(t)),t.l=n;var _=l||c||f||"";_&&d&&(_+="#"+d),_||(_="#"+d),a&2&&_.charAt(0)=="/"&&_.charAt(1)!="/"&&(_="file://"+_);var T={Target:_};return g&&(T.guid=g),x&&(T.time=x),s&&(T.Tooltip=s),T}function _P(t){var e=xe(512),n=0,r=t.Target;r.slice(0,7)=="file://"&&(r=r.slice(7));var a=r.indexOf("#"),s=a>-1?31:23;switch(r.charAt(0)){case"#":s=28;break;case".":s&=-3;break}e.write_shift(4,2),e.write_shift(4,s);var l=[8,6815827,6619237,4849780,83];for(n=0;n<l.length;++n)e.write_shift(4,l[n]);if(s==28)r=r.slice(1),Y_(r,e);else if(s&2){for(l="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),n=0;n<l.length;++n)e.write_shift(1,parseInt(l[n],16));var c=a>-1?r.slice(0,a):r;for(e.write_shift(4,2*(c.length+1)),n=0;n<c.length;++n)e.write_shift(2,c.charCodeAt(n));e.write_shift(2,0),s&8&&Y_(a>-1?r.slice(a+1):"",e)}else{for(l="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),n=0;n<l.length;++n)e.write_shift(1,parseInt(l[n],16));for(var f=0;r.slice(f*3,f*3+3)=="../"||r.slice(f*3,f*3+3)=="..\\";)++f;for(e.write_shift(2,f),e.write_shift(4,r.length-3*f+1),n=0;n<r.length-3*f;++n)e.write_shift(1,r.charCodeAt(n+3*f)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),n=0;n<6;++n)e.write_shift(4,0)}return e.slice(0,e.l)}function Bw(t){var e=t.read_shift(1),n=t.read_shift(1),r=t.read_shift(1),a=t.read_shift(1);return[e,n,r,a]}function Vw(t,e){var n=Bw(t);return n[3]=0,n}function ba(t){var e=t.read_shift(2),n=t.read_shift(2),r=t.read_shift(2);return{r:e,c:n,ixfe:r}}function ws(t,e,n,r){return r||(r=xe(6)),r.write_shift(2,t),r.write_shift(2,e),r.write_shift(2,n||0),r}function TP(t){var e=t.read_shift(2),n=t.read_shift(2);return t.l+=8,{type:e,flags:n}}function wP(t,e,n){return e===0?"":Ds(t,e,n)}function SP(t,e,n){var r=n.biff>8?4:2,a=t.read_shift(r),s=t.read_shift(r,"i"),l=t.read_shift(r,"i");return[a,s,l]}function Gw(t){var e=t.read_shift(2),n=lp(t);return[e,n]}function EP(t,e,n){t.l+=4,e-=4;var r=t.l+e,a=Vc(t,e,n),s=t.read_shift(2);if(r-=t.l,s!==r)throw new Error("Malformed AddinUdf: padding = "+r+" != "+s);return t.l+=s,a}function Zf(t){var e=t.read_shift(2),n=t.read_shift(2),r=t.read_shift(2),a=t.read_shift(2);return{s:{c:r,r:e},e:{c:a,r:n}}}function Hw(t,e){return e||(e=xe(8)),e.write_shift(2,t.s.r),e.write_shift(2,t.e.r),e.write_shift(2,t.s.c),e.write_shift(2,t.e.c),e}function zw(t){var e=t.read_shift(2),n=t.read_shift(2),r=t.read_shift(1),a=t.read_shift(1);return{s:{c:r,r:e},e:{c:a,r:n}}}var CP=zw;function qw(t){t.l+=4;var e=t.read_shift(2),n=t.read_shift(2),r=t.read_shift(2);return t.l+=12,[n,e,r]}function bP(t){var e={};return t.l+=4,t.l+=16,e.fSharedNote=t.read_shift(2),t.l+=4,e}function AP(t){var e={};return t.l+=4,t.cf=t.read_shift(2),e}function Jn(t){t.l+=2,t.l+=t.read_shift(2)}var kP={0:Jn,4:Jn,5:Jn,6:Jn,7:AP,8:Jn,9:Jn,10:Jn,11:Jn,12:Jn,13:bP,14:Jn,15:Jn,16:Jn,17:Jn,18:Jn,19:Jn,20:Jn,21:qw};function NP(t,e){for(var n=t.l+e,r=[];t.l<n;){var a=t.read_shift(2);t.l-=2;try{r.push(kP[a](t,n-t.l))}catch{return t.l=n,r}}return t.l!=n&&(t.l=n),r}function mf(t,e){var n={BIFFVer:0,dt:0};switch(n.BIFFVer=t.read_shift(2),e-=2,e>=2&&(n.dt=t.read_shift(2),t.l-=2),n.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+n.BIFFVer)}return t.read_shift(e),n}function dp(t,e,n){var r=1536,a=16;switch(n.bookType){case"biff8":break;case"biff5":r=1280,a=8;break;case"biff4":r=4,a=6;break;case"biff3":r=3,a=6;break;case"biff2":r=2,a=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=xe(a);return s.write_shift(2,r),s.write_shift(2,e),a>4&&s.write_shift(2,29282),a>6&&s.write_shift(2,1997),a>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function MP(t,e){return e===0||t.read_shift(2),1200}function DP(t,e,n){if(n.enc)return t.l+=e,"";var r=t.l,a=Ds(t,0,n);return t.read_shift(e+r-t.l),a}function RP(t,e){var n=!e||e.biff==8,r=xe(n?112:54);for(r.write_shift(e.biff==8?2:1,7),n&&r.write_shift(1,0),r.write_shift(4,859007059),r.write_shift(4,5458548|(n?0:536870912));r.l<r.length;)r.write_shift(1,n?0:32);return r}function FP(t,e,n){var r=n&&n.biff==8||e==2?t.read_shift(2):(t.l+=e,0);return{fDialog:r&16,fBelow:r&64,fRight:r&128}}function IP(t,e,n){var r=t.read_shift(4),a=t.read_shift(1)&3,s=t.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var l=Vc(t,0,n);return l.length===0&&(l="Sheet1"),{pos:r,hs:a,dt:s,name:l}}function PP(t,e){var n=!e||e.biff>=8?2:1,r=xe(8+n*t.name.length);r.write_shift(4,t.pos),r.write_shift(1,t.hs||0),r.write_shift(1,t.dt),r.write_shift(1,t.name.length),e.biff>=8&&r.write_shift(1,1),r.write_shift(n*t.name.length,t.name,e.biff<8?"sbcs":"utf16le");var a=r.slice(0,r.l);return a.l=r.l,a}function LP(t,e){for(var n=t.l+e,r=t.read_shift(4),a=t.read_shift(4),s=[],l=0;l!=a&&t.l<n;++l)s.push(hP(t));return s.Count=r,s.Unique=a,s}function OP(t,e){var n=xe(8);n.write_shift(4,t.Count),n.write_shift(4,t.Unique);for(var r=[],a=0;a<t.length;++a)r[a]=mP(t[a]);var s=In([n].concat(r));return s.parts=[n.length].concat(r.map(function(l){return l.length})),s}function UP(t,e){var n={};return n.dsst=t.read_shift(2),t.l+=e-2,n}function BP(t){var e={};e.r=t.read_shift(2),e.c=t.read_shift(2),e.cnt=t.read_shift(2)-e.c;var n=t.read_shift(2);t.l+=4;var r=t.read_shift(1);return t.l+=3,r&7&&(e.level=r&7),r&32&&(e.hidden=!0),r&64&&(e.hpt=n/20),e}function VP(t){var e=TP(t);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var n=t.read_shift(4);return n!==0}function GP(t){return t.read_shift(2),t.read_shift(4)}function J_(t,e,n){var r=0;n&&n.biff==2||(r=t.read_shift(2));var a=t.read_shift(2);n&&n.biff==2&&(r=1-(a>>15),a&=32767);var s={Unsynced:r&1,DyZero:(r&2)>>1,ExAsc:(r&4)>>2,ExDsc:(r&8)>>3};return[s,a]}function HP(t){var e=t.read_shift(2),n=t.read_shift(2),r=t.read_shift(2),a=t.read_shift(2),s=t.read_shift(2),l=t.read_shift(2),c=t.read_shift(2),f=t.read_shift(2),d=t.read_shift(2);return{Pos:[e,n],Dim:[r,a],Flags:s,CurTab:l,FirstTab:c,Selected:f,TabRatio:d}}function zP(){var t=xe(18);return t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,29280),t.write_shift(2,17600),t.write_shift(2,56),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,1),t.write_shift(2,500),t}function qP(t,e,n){if(n&&n.biff>=2&&n.biff<5)return{};var r=t.read_shift(2);return{RTL:r&64}}function jP(t){var e=xe(18),n=1718;return t&&t.RTL&&(n|=64),e.write_shift(2,n),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function $P(){}function WP(t,e,n){var r={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(n&&n.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return r.name=Vc(t,0,n),r}function YP(t,e){var n=t.name||"Arial",r=e&&e.biff==5,a=r?15+n.length:16+2*n.length,s=xe(a);return s.write_shift(2,t.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,n.length),r||s.write_shift(1,1),s.write_shift((r?1:2)*n.length,n,r?"sbcs":"utf16le"),s}function JP(t){var e=ba(t);return e.isst=t.read_shift(4),e}function XP(t,e,n,r){var a=xe(10);return ws(t,e,r,a),a.write_shift(4,n),a}function KP(t,e,n){n.biffguess&&n.biff==2&&(n.biff=5);var r=t.l+e,a=ba(t);n.biff==2&&t.l++;var s=Gc(t,r-t.l,n);return a.val=s,a}function ZP(t,e,n,r,a){var s=!a||a.biff==8,l=xe(8+ +s+(1+s)*n.length);return ws(t,e,r,l),l.write_shift(2,n.length),s&&l.write_shift(1,1),l.write_shift((1+s)*n.length,n,s?"utf16le":"sbcs"),l}function QP(t,e,n){var r=t.read_shift(2),a=Ds(t,0,n);return[r,a]}function eL(t,e,n,r){var a=n&&n.biff==5;r||(r=xe(a?3+e.length:5+2*e.length)),r.write_shift(2,t),r.write_shift(a?1:2,e.length),a||r.write_shift(1,1),r.write_shift((a?1:2)*e.length,e,a?"sbcs":"utf16le");var s=r.length>r.l?r.slice(0,r.l):r;return s.l==null&&(s.l=s.length),s}var tL=Ds;function X_(t,e,n){var r=t.l+e,a=n.biff==8||!n.biff?4:2,s=t.read_shift(a),l=t.read_shift(a),c=t.read_shift(2),f=t.read_shift(2);return t.l=r,{s:{r:s,c},e:{r:l,c:f}}}function nL(t,e){var n=e.biff==8||!e.biff?4:2,r=xe(2*n+6);return r.write_shift(n,t.s.r),r.write_shift(n,t.e.r+1),r.write_shift(2,t.s.c),r.write_shift(2,t.e.c+1),r.write_shift(2,0),r}function rL(t){var e=t.read_shift(2),n=t.read_shift(2),r=Gw(t);return{r:e,c:n,ixfe:r[0],rknum:r[1]}}function aL(t,e){for(var n=t.l+e-2,r=t.read_shift(2),a=t.read_shift(2),s=[];t.l<n;)s.push(Gw(t));if(t.l!==n)throw new Error("MulRK read error");var l=t.read_shift(2);if(s.length!=l-a+1)throw new Error("MulRK length mismatch");return{r,c:a,C:l,rkrec:s}}function iL(t,e){for(var n=t.l+e-2,r=t.read_shift(2),a=t.read_shift(2),s=[];t.l<n;)s.push(t.read_shift(2));if(t.l!==n)throw new Error("MulBlank read error");var l=t.read_shift(2);if(s.length!=l-a+1)throw new Error("MulBlank length mismatch");return{r,c:a,C:l,ixfe:s}}function sL(t,e,n,r){var a={},s=t.read_shift(4),l=t.read_shift(4),c=t.read_shift(4),f=t.read_shift(2);return a.patternType=V5[c>>26],r.cellStyles&&(a.alc=s&7,a.fWrap=s>>3&1,a.alcV=s>>4&7,a.fJustLast=s>>7&1,a.trot=s>>8&255,a.cIndent=s>>16&15,a.fShrinkToFit=s>>20&1,a.iReadOrder=s>>22&2,a.fAtrNum=s>>26&1,a.fAtrFnt=s>>27&1,a.fAtrAlc=s>>28&1,a.fAtrBdr=s>>29&1,a.fAtrPat=s>>30&1,a.fAtrProt=s>>31&1,a.dgLeft=l&15,a.dgRight=l>>4&15,a.dgTop=l>>8&15,a.dgBottom=l>>12&15,a.icvLeft=l>>16&127,a.icvRight=l>>23&127,a.grbitDiag=l>>30&3,a.icvTop=c&127,a.icvBottom=c>>7&127,a.icvDiag=c>>14&127,a.dgDiag=c>>21&15,a.icvFore=f&127,a.icvBack=f>>7&127,a.fsxButton=f>>14&1),a}function oL(t,e,n){var r={};return r.ifnt=t.read_shift(2),r.numFmtId=t.read_shift(2),r.flags=t.read_shift(2),r.fStyle=r.flags>>2&1,e-=6,r.data=sL(t,e,r.fStyle,n),r}function K_(t,e,n,r){var a=n&&n.biff==5;r||(r=xe(a?16:20)),r.write_shift(2,0),t.style?(r.write_shift(2,t.numFmtId||0),r.write_shift(2,65524)):(r.write_shift(2,t.numFmtId||0),r.write_shift(2,e<<4));var s=0;return t.numFmtId>0&&a&&(s|=1024),r.write_shift(4,s),r.write_shift(4,0),a||r.write_shift(4,0),r.write_shift(2,0),r}function lL(t){t.l+=4;var e=[t.read_shift(2),t.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function cL(t){var e=xe(8);return e.write_shift(4,0),e.write_shift(2,0),e.write_shift(2,0),e}function Z_(t,e,n){var r=ba(t);(n.biff==2||e==9)&&++t.l;var a=dP(t);return r.val=a,r.t=a===!0||a===!1?"b":"e",r}function uL(t,e,n,r,a,s){var l=xe(8);return ws(t,e,r,l),Ow(n,s,l),l}function fL(t,e,n){n.biffguess&&n.biff==2&&(n.biff=5);var r=ba(t),a=er(t);return r.val=a,r}function dL(t,e,n,r){var a=xe(14);return ws(t,e,r,a),_s(n,a),a}var Q_=wP;function hL(t,e,n){var r=t.l+e,a=t.read_shift(2),s=t.read_shift(2);if(n.sbcch=s,s==1025||s==14849)return[s,a];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var l=Ts(t,s),c=[];r>t.l;)c.push(Gc(t));return[s,a,l,c]}function e2(t,e,n){var r=t.read_shift(2),a,s={fBuiltIn:r&1,fWantAdvise:r>>>1&1,fWantPict:r>>>2&1,fOle:r>>>3&1,fOleLink:r>>>4&1,cf:r>>>5&1023,fIcon:r>>>15&1};return n.sbcch===14849&&(a=EP(t,e-2,n)),s.body=a||t.read_shift(e-2),typeof a=="string"&&(s.Name=a),s}var mL=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function t2(t,e,n){var r=t.l+e,a=t.read_shift(2),s=t.read_shift(1),l=t.read_shift(1),c=t.read_shift(n&&n.biff==2?1:2),f=0;(!n||n.biff>=5)&&(n.biff!=5&&(t.l+=2),f=t.read_shift(2),n.biff==5&&(t.l+=2),t.l+=4);var d=Ts(t,l,n);a&32&&(d=mL[d.charCodeAt(0)]);var g=r-t.l;n&&n.biff==2&&--g;var x=r==t.l||c===0||!(g>0)?[]:N7(t,g,n,c);return{chKey:s,Name:d,itab:f,rgce:x}}function jw(t,e,n){if(n.biff<8)return pL(t,e,n);for(var r=[],a=t.l+e,s=t.read_shift(n.biff>8?4:2);s--!==0;)r.push(SP(t,n.biff>8?12:6,n));if(t.l!=a)throw new Error("Bad ExternSheet: "+t.l+" != "+a);return r}function pL(t,e,n){t[t.l+1]==3&&t[t.l]++;var r=Vc(t,e,n);return r.charCodeAt(0)==3?r.slice(1):r}function gL(t,e,n){if(n.biff<8){t.l+=e;return}var r=t.read_shift(2),a=t.read_shift(2),s=Ts(t,r,n),l=Ts(t,a,n);return[s,l]}function xL(t,e,n){var r=zw(t);t.l++;var a=t.read_shift(1);return e-=8,[M7(t,e,n),a,r]}function n2(t,e,n){var r=CP(t);switch(n.biff){case 2:t.l++,e-=7;break;case 3:case 4:t.l+=2,e-=8;break;default:t.l+=6,e-=12}return[r,A7(t,e,n)]}function vL(t){var e=t.read_shift(4)!==0,n=t.read_shift(4)!==0,r=t.read_shift(4);return[e,n,r]}function yL(t,e,n){if(!(n.biff<8)){var r=t.read_shift(2),a=t.read_shift(2),s=t.read_shift(2),l=t.read_shift(2),c=Ds(t,0,n);return n.biff<8&&t.read_shift(1),[{r,c:a},c,l,s]}}function _L(t,e,n){return yL(t,e,n)}function TL(t,e){for(var n=[],r=t.read_shift(2);r--;)n.push(Zf(t));return n}function wL(t){var e=xe(2+t.length*8);e.write_shift(2,t.length);for(var n=0;n<t.length;++n)Hw(t[n],e);return e}function SL(t,e,n){if(n&&n.biff<8)return CL(t,e,n);var r=qw(t),a=NP(t,e-22,r[1]);return{cmo:r,ft:a}}var EL={8:function(t,e){var n=t.l+e;t.l+=10;var r=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var a=t.read_shift(1);return t.l+=a,t.l=n,{fmt:r}}};function CL(t,e,n){t.l+=4;var r=t.read_shift(2),a=t.read_shift(2),s=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,e-=36;var l=[];return l.push((EL[r]||rr)(t,e,n)),{cmo:[a,r,s],ft:l}}function bL(t,e,n){var r=t.l,a="";try{t.l+=4;var s=(n.lastobj||{cmo:[0,0]}).cmo[1],l;[0,5,7,11,12,14].indexOf(s)==-1?t.l+=6:l=pP(t,6,n);var c=t.read_shift(2);t.read_shift(2),_n(t,2);var f=t.read_shift(2);t.l+=f;for(var d=1;d<t.lens.length-1;++d){if(t.l-r!=t.lens[d])throw new Error("TxO: bad continue record");var g=t[t.l],x=Ts(t,t.lens[d+1]-t.lens[d]-1);if(a+=x,a.length>=(g?c:2*c))break}if(a.length!==c&&a.length!==c*2)throw new Error("cchText: "+c+" != "+a.length);return t.l=r+e,{t:a}}catch{return t.l=r+e,{t:a}}}function AL(t,e){var n=Zf(t);t.l+=16;var r=yP(t,e-24);return[n,r]}function kL(t){var e=xe(24),n=nn(t[0]);e.write_shift(2,n.r),e.write_shift(2,n.r),e.write_shift(2,n.c),e.write_shift(2,n.c);for(var r="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<16;++a)e.write_shift(1,parseInt(r[a],16));return In([e,_P(t[1])])}function NL(t,e){t.read_shift(2);var n=Zf(t),r=t.read_shift((e-10)/2,"dbcs-cont");return r=r.replace(ur,""),[n,r]}function ML(t){var e=t[1].Tooltip,n=xe(10+2*(e.length+1));n.write_shift(2,2048);var r=nn(t[0]);n.write_shift(2,r.r),n.write_shift(2,r.r),n.write_shift(2,r.c),n.write_shift(2,r.c);for(var a=0;a<e.length;++a)n.write_shift(2,e.charCodeAt(a));return n.write_shift(2,0),n}function DL(t){var e=[0,0],n;return n=t.read_shift(2),e[0]=V_[n]||n,n=t.read_shift(2),e[1]=V_[n]||n,e}function RL(t){return t||(t=xe(4)),t.write_shift(2,1),t.write_shift(2,1),t}function FL(t){for(var e=t.read_shift(2),n=[];e-- >0;)n.push(Vw(t));return n}function IL(t){for(var e=t.read_shift(2),n=[];e-- >0;)n.push(Vw(t));return n}function PL(t){t.l+=2;var e={cxfs:0,crc:0};return e.cxfs=t.read_shift(2),e.crc=t.read_shift(4),e}function $w(t,e,n){if(!n.cellStyles)return rr(t,e);var r=n&&n.biff>=12?4:2,a=t.read_shift(r),s=t.read_shift(r),l=t.read_shift(r),c=t.read_shift(r),f=t.read_shift(2);r==2&&(t.l+=2);var d={s:a,e:s,w:l,ixfe:c,flags:f};return(n.biff>=5||!n.biff)&&(d.level=f>>8&7),d}function LL(t,e){var n=xe(12);n.write_shift(2,e),n.write_shift(2,e),n.write_shift(2,t.width*256),n.write_shift(2,0);var r=0;return t.hidden&&(r|=1),n.write_shift(1,r),r=t.level||0,n.write_shift(1,r),n.write_shift(2,0),n}function OL(t,e){var n={};return e<32||(t.l+=16,n.header=er(t),n.footer=er(t),t.l+=2),n}function UL(t,e,n){var r={area:!1};if(n.biff!=5)return t.l+=e,r;var a=t.read_shift(1);return t.l+=3,a&16&&(r.area=!0),r}function BL(t){for(var e=xe(2*t),n=0;n<t;++n)e.write_shift(2,n+1);return e}var VL=ba,GL=Lw,HL=Gc;function zL(t){var e=t.read_shift(2),n=t.read_shift(2),r=t.read_shift(4),a={fmt:e,env:n,len:r,data:t.slice(t.l,t.l+r)};return t.l+=r,a}function qL(t,e,n){n.biffguess&&n.biff==5&&(n.biff=2);var r=ba(t);++t.l;var a=Ds(t,e-7,n);return r.t="str",r.val=a,r}function jL(t){var e=ba(t);++t.l;var n=er(t);return e.t="n",e.val=n,e}function $L(t,e,n){var r=xe(15);return jc(r,t,e),r.write_shift(8,n,"f"),r}function WL(t){var e=ba(t);++t.l;var n=t.read_shift(2);return e.t="n",e.val=n,e}function YL(t,e,n){var r=xe(9);return jc(r,t,e),r.write_shift(2,n),r}function JL(t){var e=t.read_shift(1);return e===0?(t.l++,""):t.read_shift(e,"sbcs-cont")}function XL(t,e){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=e-13}function KL(t,e,n){var r=t.l+e,a=ba(t),s=t.read_shift(2),l=Ts(t,s,n);return t.l=r,a.t="str",a.val=l,a}var ZL=[2,3,48,49,131,139,140,245],cm=function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=Jf({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function n(c,f){var d=[],g=Ii(1);switch(f.type){case"base64":g=Nr(Dr(c));break;case"binary":g=Nr(c);break;case"buffer":case"array":g=c;break}qn(g,0);var x=g.read_shift(1),_=!!(x&136),T=!1,E=!1;switch(x){case 2:break;case 3:break;case 48:T=!0,_=!0;break;case 49:T=!0,_=!0;break;case 131:break;case 139:break;case 140:E=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+x.toString(16))}var S=0,C=521;x==2&&(S=g.read_shift(2)),g.l+=3,x!=2&&(S=g.read_shift(4)),S>1048576&&(S=1e6),x!=2&&(C=g.read_shift(2));var k=g.read_shift(2),N=f.codepage||1252;x!=2&&(g.l+=16,g.read_shift(1),g[g.l]!==0&&(N=t[g[g.l]]),g.l+=1,g.l+=2),E&&(g.l+=36);for(var b=[],I={},F=Math.min(g.length,x==2?521:C-10-(T?264:0)),P=E?32:11;g.l<F&&g[g.l]!=13;)switch(I={},I.name=yc.utils.decode(N,g.slice(g.l,g.l+P)).replace(/[\u0000\r\n].*$/g,""),g.l+=P,I.type=String.fromCharCode(g.read_shift(1)),x!=2&&!E&&(I.offset=g.read_shift(4)),I.len=g.read_shift(1),x==2&&(I.offset=g.read_shift(2)),I.dec=g.read_shift(1),I.name.length&&b.push(I),x!=2&&(g.l+=E?13:14),I.type){case"B":(!T||I.len!=8)&&f.WTF&&console.log("Skipping "+I.name+":"+I.type);break;case"G":case"P":f.WTF&&console.log("Skipping "+I.name+":"+I.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+I.type)}if(g[g.l]!==13&&(g.l=C-1),g.read_shift(1)!==13)throw new Error("DBF Terminator not found "+g.l+" "+g[g.l]);g.l=C;var D=0,j=0;for(d[0]=[],j=0;j!=b.length;++j)d[0][j]=b[j].name;for(;S-- >0;){if(g[g.l]===42){g.l+=k;continue}for(++g.l,d[++D]=[],j=0,j=0;j!=b.length;++j){var B=g.slice(g.l,g.l+b[j].len);g.l+=b[j].len,qn(B,0);var te=yc.utils.decode(N,B);switch(b[j].type){case"C":te.trim().length&&(d[D][j]=te.replace(/\s+$/,""));break;case"D":te.length===8?d[D][j]=new Date(+te.slice(0,4),+te.slice(4,6)-1,+te.slice(6,8)):d[D][j]=te;break;case"F":d[D][j]=parseFloat(te.trim());break;case"+":case"I":d[D][j]=E?B.read_shift(-4,"i")^2147483648:B.read_shift(4,"i");break;case"L":switch(te.trim().toUpperCase()){case"Y":case"T":d[D][j]=!0;break;case"N":case"F":d[D][j]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+te+"|")}break;case"M":if(!_)throw new Error("DBF Unexpected MEMO for type "+x.toString(16));d[D][j]="##MEMO##"+(E?parseInt(te.trim(),10):B.read_shift(4));break;case"N":te=te.replace(/\u0000/g,"").trim(),te&&te!="."&&(d[D][j]=+te||0);break;case"@":d[D][j]=new Date(B.read_shift(-8,"f")-621356832e5);break;case"T":d[D][j]=new Date((B.read_shift(4)-2440588)*864e5+B.read_shift(4));break;case"Y":d[D][j]=B.read_shift(4,"i")/1e4+B.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":d[D][j]=-B.read_shift(-8,"f");break;case"B":if(T&&b[j].len==8){d[D][j]=B.read_shift(8,"f");break}case"G":case"P":B.l+=b[j].len;break;case"0":if(b[j].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+b[j].type)}}}if(x!=2&&g.l<g.length&&g[g.l++]!=26)throw new Error("DBF EOF Marker missing "+(g.l-1)+" of "+g.length+" "+g[g.l-1].toString(16));return f&&f.sheetRows&&(d=d.slice(0,f.sheetRows)),f.DBF=b,d}function r(c,f){var d=f||{};d.dateNF||(d.dateNF="yyyymmdd");var g=Ko(n(c,d),d);return g["!cols"]=d.DBF.map(function(x){return{wch:x.len,DBF:x}}),delete d.DBF,g}function a(c,f){try{return Vi(r(c,f),f)}catch(d){if(f&&f.WTF)throw d}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function l(c,f){var d=f||{};if(+d.codepage>=0&&la(+d.codepage),d.type=="string")throw new Error("Cannot write DBF to JS string");var g=xr(),x=Bf(c,{header:1,raw:!0,cellDates:!0}),_=x[0],T=x.slice(1),E=c["!cols"]||[],S=0,C=0,k=0,N=1;for(S=0;S<_.length;++S){if(((E[S]||{}).DBF||{}).name){_[S]=E[S].DBF.name,++k;continue}if(_[S]!=null){if(++k,typeof _[S]=="number"&&(_[S]=_[S].toString(10)),typeof _[S]!="string")throw new Error("DBF Invalid column name "+_[S]+" |"+typeof _[S]+"|");if(_.indexOf(_[S])!==S){for(C=0;C<1024;++C)if(_.indexOf(_[S]+"_"+C)==-1){_[S]+="_"+C;break}}}}var b=xt(c["!ref"]),I=[],F=[],P=[];for(S=0;S<=b.e.c-b.s.c;++S){var D="",j="",B=0,te=[];for(C=0;C<T.length;++C)T[C][S]!=null&&te.push(T[C][S]);if(te.length==0||_[S]==null){I[S]="?";continue}for(C=0;C<te.length;++C){switch(typeof te[C]){case"number":j="B";break;case"string":j="C";break;case"boolean":j="L";break;case"object":j=te[C]instanceof Date?"D":"C";break;default:j="C"}B=Math.max(B,String(te[C]).length),D=D&&D!=j?"C":j}B>250&&(B=250),j=((E[S]||{}).DBF||{}).type,j=="C"&&E[S].DBF.len>B&&(B=E[S].DBF.len),D=="B"&&j=="N"&&(D="N",P[S]=E[S].DBF.dec,B=E[S].DBF.len),F[S]=D=="C"||j=="N"?B:s[D]||0,N+=F[S],I[S]=D}var X=g.next(32);for(X.write_shift(4,318902576),X.write_shift(4,T.length),X.write_shift(2,296+32*k),X.write_shift(2,N),S=0;S<4;++S)X.write_shift(4,0);for(X.write_shift(4,0|(+e[PT]||3)<<8),S=0,C=0;S<_.length;++S)if(_[S]!=null){var Z=g.next(32),ye=(_[S].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);Z.write_shift(1,ye,"sbcs"),Z.write_shift(1,I[S]=="?"?"C":I[S],"sbcs"),Z.write_shift(4,C),Z.write_shift(1,F[S]||s[I[S]]||0),Z.write_shift(1,P[S]||0),Z.write_shift(1,2),Z.write_shift(4,0),Z.write_shift(1,0),Z.write_shift(4,0),Z.write_shift(4,0),C+=F[S]||s[I[S]]||0}var Me=g.next(264);for(Me.write_shift(4,13),S=0;S<65;++S)Me.write_shift(4,0);for(S=0;S<T.length;++S){var Se=g.next(N);for(Se.write_shift(1,0),C=0;C<_.length;++C)if(_[C]!=null)switch(I[C]){case"L":Se.write_shift(1,T[S][C]==null?63:T[S][C]?84:70);break;case"B":Se.write_shift(8,T[S][C]||0,"f");break;case"N":var ee="0";for(typeof T[S][C]=="number"&&(ee=T[S][C].toFixed(P[C]||0)),k=0;k<F[C]-ee.length;++k)Se.write_shift(1,32);Se.write_shift(1,ee,"sbcs");break;case"D":T[S][C]?(Se.write_shift(4,("0000"+T[S][C].getFullYear()).slice(-4),"sbcs"),Se.write_shift(2,("00"+(T[S][C].getMonth()+1)).slice(-2),"sbcs"),Se.write_shift(2,("00"+T[S][C].getDate()).slice(-2),"sbcs")):Se.write_shift(8,"00000000","sbcs");break;case"C":var me=String(T[S][C]!=null?T[S][C]:"").slice(0,F[C]);for(Se.write_shift(1,me,"sbcs"),k=0;k<F[C]-me.length;++k)Se.write_shift(1,32);break}}return g.next(1).write_shift(1,26),g.end()}return{to_workbook:a,to_sheet:r,from_sheet:l}}(),Ww=function(){var t={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+ln(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),n=function(_,T){var E=t[T];return typeof E=="number"?h_(E):E},r=function(_,T,E){var S=T.charCodeAt(0)-32<<4|E.charCodeAt(0)-48;return S==59?_:h_(S)};t["|"]=254;function a(_,T){switch(T.type){case"base64":return s(Dr(_),T);case"binary":return s(_,T);case"buffer":return s(lt&&Buffer.isBuffer(_)?_.toString("binary"):Bi(_),T);case"array":return s(ys(_),T)}throw new Error("Unrecognized type "+T.type)}function s(_,T){var E=_.split(/[\n\r]+/),S=-1,C=-1,k=0,N=0,b=[],I=[],F=null,P={},D=[],j=[],B=[],te=0,X;for(+T.codepage>=0&&la(+T.codepage);k!==E.length;++k){te=0;var Z=E[k].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,r).replace(e,n),ye=Z.replace(/;;/g,"\0").split(";").map(function(K){return K.replace(/\u0000/g,";")}),Me=ye[0],Se;if(Z.length>0)switch(Me){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":ye[1].charAt(0)=="P"&&I.push(Z.slice(3).replace(/;;/g,";"));break;case"C":var ee=!1,me=!1,Pe=!1,re=!1,z=-1,ce=-1;for(N=1;N<ye.length;++N)switch(ye[N].charAt(0)){case"A":break;case"X":C=parseInt(ye[N].slice(1))-1,me=!0;break;case"Y":for(S=parseInt(ye[N].slice(1))-1,me||(C=0),X=b.length;X<=S;++X)b[X]=[];break;case"K":Se=ye[N].slice(1),Se.charAt(0)==='"'?Se=Se.slice(1,Se.length-1):Se==="TRUE"?Se=!0:Se==="FALSE"?Se=!1:isNaN(ua(Se))?isNaN(Bo(Se).getDate())||(Se=Xt(Se)):(Se=ua(Se),F!==null&&Jo(F)&&(Se=Kf(Se))),ee=!0;break;case"E":re=!0;var L=Lo(ye[N].slice(1),{r:S,c:C});b[S][C]=[b[S][C],L];break;case"S":Pe=!0,b[S][C]=[b[S][C],"S5S"];break;case"G":break;case"R":z=parseInt(ye[N].slice(1))-1;break;case"C":ce=parseInt(ye[N].slice(1))-1;break;default:if(T&&T.WTF)throw new Error("SYLK bad record "+Z)}if(ee&&(b[S][C]&&b[S][C].length==2?b[S][C][0]=Se:b[S][C]=Se,F=null),Pe){if(re)throw new Error("SYLK shared formula cannot have own formula");var W=z>-1&&b[z][ce];if(!W||!W[1])throw new Error("SYLK shared formula cannot find base");b[S][C][1]=fS(W[1],{r:S-z,c:C-ce})}break;case"F":var q=0;for(N=1;N<ye.length;++N)switch(ye[N].charAt(0)){case"X":C=parseInt(ye[N].slice(1))-1,++q;break;case"Y":for(S=parseInt(ye[N].slice(1))-1,X=b.length;X<=S;++X)b[X]=[];break;case"M":te=parseInt(ye[N].slice(1))/20;break;case"F":break;case"G":break;case"P":F=I[parseInt(ye[N].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(B=ye[N].slice(1).split(" "),X=parseInt(B[0],10);X<=parseInt(B[1],10);++X)te=parseInt(B[2],10),j[X-1]=te===0?{hidden:!0}:{wch:te},Pi(j[X-1]);break;case"C":C=parseInt(ye[N].slice(1))-1,j[C]||(j[C]={});break;case"R":S=parseInt(ye[N].slice(1))-1,D[S]||(D[S]={}),te>0?(D[S].hpt=te,D[S].hpx=Go(te)):te===0&&(D[S].hidden=!0);break;default:if(T&&T.WTF)throw new Error("SYLK bad record "+Z)}q<1&&(F=null);break;default:if(T&&T.WTF)throw new Error("SYLK bad record "+Z)}}return D.length>0&&(P["!rows"]=D),j.length>0&&(P["!cols"]=j),T&&T.sheetRows&&(b=b.slice(0,T.sheetRows)),[b,P]}function l(_,T){var E=a(_,T),S=E[0],C=E[1],k=Ko(S,T);return ln(C).forEach(function(N){k[N]=C[N]}),k}function c(_,T){return Vi(l(_,T),T)}function f(_,T,E,S){var C="C;Y"+(E+1)+";X"+(S+1)+";K";switch(_.t){case"n":C+=_.v||0,_.f&&!_.F&&(C+=";E"+vp(_.f,{r:E,c:S}));break;case"b":C+=_.v?"TRUE":"FALSE";break;case"e":C+=_.w||_.v;break;case"d":C+='"'+(_.w||_.v)+'"';break;case"s":C+='"'+_.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return C}function d(_,T){T.forEach(function(E,S){var C="F;W"+(S+1)+" "+(S+1)+" ";E.hidden?C+="0":(typeof E.width=="number"&&!E.wpx&&(E.wpx=Ac(E.width)),typeof E.wpx=="number"&&!E.wch&&(E.wch=kc(E.wpx)),typeof E.wch=="number"&&(C+=Math.round(E.wch))),C.charAt(C.length-1)!=" "&&_.push(C)})}function g(_,T){T.forEach(function(E,S){var C="F;";E.hidden?C+="M0;":E.hpt?C+="M"+20*E.hpt+";":E.hpx&&(C+="M"+20*Nc(E.hpx)+";"),C.length>2&&_.push(C+"R"+(S+1))})}function x(_,T){var E=["ID;PWXL;N;E"],S=[],C=xt(_["!ref"]),k,N=Array.isArray(_),b=`\r
`;E.push("P;PGeneral"),E.push("F;P0;DG0G8;M255"),_["!cols"]&&d(E,_["!cols"]),_["!rows"]&&g(E,_["!rows"]),E.push("B;Y"+(C.e.r-C.s.r+1)+";X"+(C.e.c-C.s.c+1)+";D"+[C.s.c,C.s.r,C.e.c,C.e.r].join(" "));for(var I=C.s.r;I<=C.e.r;++I)for(var F=C.s.c;F<=C.e.c;++F){var P=Je({r:I,c:F});k=N?(_[I]||[])[F]:_[P],!(!k||k.v==null&&(!k.f||k.F))&&S.push(f(k,_,I,F))}return E.join(b)+b+S.join(b)+b+"E"+b}return{to_workbook:c,to_sheet:l,from_sheet:x}}(),Yw=function(){function t(s,l){switch(l.type){case"base64":return e(Dr(s),l);case"binary":return e(s,l);case"buffer":return e(lt&&Buffer.isBuffer(s)?s.toString("binary"):Bi(s),l);case"array":return e(ys(s),l)}throw new Error("Unrecognized type "+l.type)}function e(s,l){for(var c=s.split(`
`),f=-1,d=-1,g=0,x=[];g!==c.length;++g){if(c[g].trim()==="BOT"){x[++f]=[],d=0;continue}if(!(f<0)){var _=c[g].trim().split(","),T=_[0],E=_[1];++g;for(var S=c[g]||"";(S.match(/["]/g)||[]).length&1&&g<c.length-1;)S+=`
`+c[++g];switch(S=S.trim(),+T){case-1:if(S==="BOT"){x[++f]=[],d=0;continue}else if(S!=="EOD")throw new Error("Unrecognized DIF special command "+S);break;case 0:S==="TRUE"?x[f][d]=!0:S==="FALSE"?x[f][d]=!1:isNaN(ua(E))?isNaN(Bo(E).getDate())?x[f][d]=E:x[f][d]=Xt(E):x[f][d]=ua(E),++d;break;case 1:S=S.slice(1,S.length-1),S=S.replace(/""/g,'"'),S&&S.match(/^=".*"$/)&&(S=S.slice(2,-1)),x[f][d++]=S!==""?S:null;break}if(S==="EOD")break}}return l&&l.sheetRows&&(x=x.slice(0,l.sheetRows)),x}function n(s,l){return Ko(t(s,l),l)}function r(s,l){return Vi(n(s,l),l)}var a=function(){var s=function(f,d,g,x,_){f.push(d),f.push(g+","+x),f.push('"'+_.replace(/"/g,'""')+'"')},l=function(f,d,g,x){f.push(d+","+g),f.push(d==1?'"'+x.replace(/"/g,'""')+'"':x)};return function(f){var d=[],g=xt(f["!ref"]),x,_=Array.isArray(f);s(d,"TABLE",0,1,"sheetjs"),s(d,"VECTORS",0,g.e.r-g.s.r+1,""),s(d,"TUPLES",0,g.e.c-g.s.c+1,""),s(d,"DATA",0,0,"");for(var T=g.s.r;T<=g.e.r;++T){l(d,-1,0,"BOT");for(var E=g.s.c;E<=g.e.c;++E){var S=Je({r:T,c:E});if(x=_?(f[T]||[])[E]:f[S],!x){l(d,1,0,"");continue}switch(x.t){case"n":var C=x.w;!C&&x.v!=null&&(C=x.v),C==null?x.f&&!x.F?l(d,1,0,"="+x.f):l(d,1,0,""):l(d,0,C,"V");break;case"b":l(d,0,x.v?1:0,x.v?"TRUE":"FALSE");break;case"s":l(d,1,0,isNaN(x.v)?x.v:'="'+x.v+'"');break;case"d":x.w||(x.w=Kr(x.z||Ye[14],En(Xt(x.v)))),l(d,0,x.w,"V");break;default:l(d,1,0,"")}}}l(d,-1,0,"EOD");var k=`\r
`,N=d.join(k);return N}}();return{to_workbook:r,to_sheet:n,from_sheet:a}}(),Jw=function(){function t(x){return x.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(x){return x.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function n(x,_){for(var T=x.split(`
`),E=-1,S=-1,C=0,k=[];C!==T.length;++C){var N=T[C].trim().split(":");if(N[0]==="cell"){var b=nn(N[1]);if(k.length<=b.r)for(E=k.length;E<=b.r;++E)k[E]||(k[E]=[]);switch(E=b.r,S=b.c,N[2]){case"t":k[E][S]=t(N[3]);break;case"v":k[E][S]=+N[3];break;case"vtf":var I=N[N.length-1];case"vtc":switch(N[3]){case"nl":k[E][S]=!!+N[4];break;default:k[E][S]=+N[4];break}N[2]=="vtf"&&(k[E][S]=[k[E][S],I])}}}return _&&_.sheetRows&&(k=k.slice(0,_.sheetRows)),k}function r(x,_){return Ko(n(x,_),_)}function a(x,_){return Vi(r(x,_),_)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),l=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,c=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),f="--SocialCalcSpreadsheetControlSave--";function d(x){if(!x||!x["!ref"])return"";for(var _=[],T=[],E,S="",C=vr(x["!ref"]),k=Array.isArray(x),N=C.s.r;N<=C.e.r;++N)for(var b=C.s.c;b<=C.e.c;++b)if(S=Je({r:N,c:b}),E=k?(x[N]||[])[b]:x[S],!(!E||E.v==null||E.t==="z")){switch(T=["cell",S,"t"],E.t){case"s":case"str":T.push(e(E.v));break;case"n":E.f?(T[2]="vtf",T[3]="n",T[4]=E.v,T[5]=e(E.f)):(T[2]="v",T[3]=E.v);break;case"b":T[2]="vt"+(E.f?"f":"c"),T[3]="nl",T[4]=E.v?"1":"0",T[5]=e(E.f||(E.v?"TRUE":"FALSE"));break;case"d":var I=En(Xt(E.v));T[2]="vtc",T[3]="nd",T[4]=""+I,T[5]=E.w||Kr(E.z||Ye[14],I);break;case"e":continue}_.push(T.join(":"))}return _.push("sheet:c:"+(C.e.c-C.s.c+1)+":r:"+(C.e.r-C.s.r+1)+":tvf:1"),_.push("valueformat:1:text-wiki"),_.join(`
`)}function g(x){return[s,l,c,l,d(x),f].join(`
`)}return{to_workbook:a,to_sheet:r,from_sheet:g}}(),Vo=function(){function t(g,x,_,T,E){E.raw?x[_][T]=g:g===""||(g==="TRUE"?x[_][T]=!0:g==="FALSE"?x[_][T]=!1:isNaN(ua(g))?isNaN(Bo(g).getDate())?x[_][T]=g:x[_][T]=Xt(g):x[_][T]=ua(g))}function e(g,x){var _=x||{},T=[];if(!g||g.length===0)return T;for(var E=g.split(/[\r\n]/),S=E.length-1;S>=0&&E[S].length===0;)--S;for(var C=10,k=0,N=0;N<=S;++N)k=E[N].indexOf(" "),k==-1?k=E[N].length:k++,C=Math.max(C,k);for(N=0;N<=S;++N){T[N]=[];var b=0;for(t(E[N].slice(0,C).trim(),T,N,b,_),b=1;b<=(E[N].length-C)/10+1;++b)t(E[N].slice(C+(b-1)*10,C+b*10).trim(),T,N,b,_)}return _.sheetRows&&(T=T.slice(0,_.sheetRows)),T}var n={44:",",9:"	",59:";",124:"|"},r={44:3,9:2,59:1,124:0};function a(g){for(var x={},_=!1,T=0,E=0;T<g.length;++T)(E=g.charCodeAt(T))==34?_=!_:!_&&E in n&&(x[E]=(x[E]||0)+1);E=[];for(T in x)Object.prototype.hasOwnProperty.call(x,T)&&E.push([x[T],T]);if(!E.length){x=r;for(T in x)Object.prototype.hasOwnProperty.call(x,T)&&E.push([x[T],T])}return E.sort(function(S,C){return S[0]-C[0]||r[S[1]]-r[C[1]]}),n[E.pop()[1]]||44}function s(g,x){var _=x||{},T="",E=_.dense?[]:{},S={s:{c:0,r:0},e:{c:0,r:0}};g.slice(0,4)=="sep="?g.charCodeAt(5)==13&&g.charCodeAt(6)==10?(T=g.charAt(4),g=g.slice(7)):g.charCodeAt(5)==13||g.charCodeAt(5)==10?(T=g.charAt(4),g=g.slice(6)):T=a(g.slice(0,1024)):_&&_.FS?T=_.FS:T=a(g.slice(0,1024));var C=0,k=0,N=0,b=0,I=0,F=T.charCodeAt(0),P=!1,D=0,j=g.charCodeAt(0);g=g.replace(/\r\n/mg,`
`);var B=_.dateNF!=null?UI(_.dateNF):null;function te(){var X=g.slice(b,I),Z={};if(X.charAt(0)=='"'&&X.charAt(X.length-1)=='"'&&(X=X.slice(1,-1).replace(/""/g,'"')),X.length===0)Z.t="z";else if(_.raw)Z.t="s",Z.v=X;else if(X.trim().length===0)Z.t="s",Z.v=X;else if(X.charCodeAt(0)==61)X.charCodeAt(1)==34&&X.charCodeAt(X.length-1)==34?(Z.t="s",Z.v=X.slice(2,-1).replace(/""/g,'"')):hB(X)?(Z.t="n",Z.f=X.slice(1)):(Z.t="s",Z.v=X);else if(X=="TRUE")Z.t="b",Z.v=!0;else if(X=="FALSE")Z.t="b",Z.v=!1;else if(!isNaN(N=ua(X)))Z.t="n",_.cellText!==!1&&(Z.w=X),Z.v=N;else if(!isNaN(Bo(X).getDate())||B&&X.match(B)){Z.z=_.dateNF||Ye[14];var ye=0;B&&X.match(B)&&(X=BI(X,_.dateNF,X.match(B)||[]),ye=1),_.cellDates?(Z.t="d",Z.v=Xt(X,ye)):(Z.t="n",Z.v=En(Xt(X,ye))),_.cellText!==!1&&(Z.w=Kr(Z.z,Z.v instanceof Date?En(Z.v):Z.v)),_.cellNF||delete Z.z}else Z.t="s",Z.v=X;if(Z.t=="z"||(_.dense?(E[C]||(E[C]=[]),E[C][k]=Z):E[Je({c:k,r:C})]=Z),b=I+1,j=g.charCodeAt(b),S.e.c<k&&(S.e.c=k),S.e.r<C&&(S.e.r=C),D==F)++k;else if(k=0,++C,_.sheetRows&&_.sheetRows<=C)return!0}e:for(;I<g.length;++I)switch(D=g.charCodeAt(I)){case 34:j===34&&(P=!P);break;case F:case 10:case 13:if(!P&&te())break e;break}return I-b>0&&te(),E["!ref"]=rt(S),E}function l(g,x){return!(x&&x.PRN)||x.FS||g.slice(0,4)=="sep="||g.indexOf("	")>=0||g.indexOf(",")>=0||g.indexOf(";")>=0?s(g,x):Ko(e(g,x),x)}function c(g,x){var _="",T=x.type=="string"?[0,0,0,0]:bp(g,x);switch(x.type){case"base64":_=Dr(g);break;case"binary":_=g;break;case"buffer":x.codepage==65001?_=g.toString("utf8"):x.codepage&&typeof yc<"u"||(_=lt&&Buffer.isBuffer(g)?g.toString("binary"):Bi(g));break;case"array":_=ys(g);break;case"string":_=g;break;default:throw new Error("Unrecognized type "+x.type)}return T[0]==239&&T[1]==187&&T[2]==191?_=Bt(_.slice(3)):x.type!="string"&&x.type!="buffer"&&x.codepage==65001?_=Bt(_):x.type=="binary"&&typeof yc<"u",_.slice(0,19)=="socialcalc:version:"?Jw.to_sheet(x.type=="string"?_:Bt(_),x):l(_,x)}function f(g,x){return Vi(c(g,x),x)}function d(g){for(var x=[],_=xt(g["!ref"]),T,E=Array.isArray(g),S=_.s.r;S<=_.e.r;++S){for(var C=[],k=_.s.c;k<=_.e.c;++k){var N=Je({r:S,c:k});if(T=E?(g[S]||[])[k]:g[N],!T||T.v==null){C.push("          ");continue}for(var b=(T.w||(Xa(T),T.w)||"").slice(0,10);b.length<10;)b+=" ";C.push(b+(k===0?" ":""))}x.push(C.join(""))}return x.join(`
`)}return{to_workbook:f,to_sheet:c,from_sheet:d}}();function QL(t,e){var n=e||{},r=!!n.WTF;n.WTF=!0;try{var a=Ww.to_workbook(t,n);return n.WTF=r,a}catch(s){if(n.WTF=r,!s.message.match(/SYLK bad record ID/)&&r)throw s;return Vo.to_workbook(t,e)}}var ms=function(){function t(L,W,q){if(L){qn(L,L.l||0);for(var K=q.Enum||z;L.l<L.length;){var ie=L.read_shift(2),Ce=K[ie]||K[65535],Te=L.read_shift(2),be=L.l+Te,Ae=Ce.f&&Ce.f(L,Te,q);if(L.l=be,W(Ae,Ce,ie))return}}}function e(L,W){switch(W.type){case"base64":return n(Nr(Dr(L)),W);case"binary":return n(Nr(L),W);case"buffer":case"array":return n(L,W)}throw"Unsupported type "+W.type}function n(L,W){if(!L)return L;var q=W||{},K=q.dense?[]:{},ie="Sheet1",Ce="",Te=0,be={},Ae=[],Xe=[],Y={s:{r:0,c:0},e:{r:0,c:0}},yt=q.sheetRows||0;if(L[2]==0&&(L[3]==8||L[3]==9)&&L.length>=16&&L[14]==5&&L[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(L[2]==2)q.Enum=z,t(L,function(Ne,bt,Ln){switch(Ln){case 0:q.vers=Ne,Ne>=4096&&(q.qpro=!0);break;case 6:Y=Ne;break;case 204:Ne&&(Ce=Ne);break;case 222:Ce=Ne;break;case 15:case 51:q.qpro||(Ne[1].v=Ne[1].v.slice(1));case 13:case 14:case 16:Ln==14&&(Ne[2]&112)==112&&(Ne[2]&15)>1&&(Ne[2]&15)<15&&(Ne[1].z=q.dateNF||Ye[14],q.cellDates&&(Ne[1].t="d",Ne[1].v=Kf(Ne[1].v))),q.qpro&&Ne[3]>Te&&(K["!ref"]=rt(Y),be[ie]=K,Ae.push(ie),K=q.dense?[]:{},Y={s:{r:0,c:0},e:{r:0,c:0}},Te=Ne[3],ie=Ce||"Sheet"+(Te+1),Ce="");var On=q.dense?(K[Ne[0].r]||[])[Ne[0].c]:K[Je(Ne[0])];if(On){On.t=Ne[1].t,On.v=Ne[1].v,Ne[1].z!=null&&(On.z=Ne[1].z),Ne[1].f!=null&&(On.f=Ne[1].f);break}q.dense?(K[Ne[0].r]||(K[Ne[0].r]=[]),K[Ne[0].r][Ne[0].c]=Ne[1]):K[Je(Ne[0])]=Ne[1];break}},q);else if(L[2]==26||L[2]==14)q.Enum=ce,L[2]==14&&(q.qpro=!0,L.l=0),t(L,function(Ne,bt,Ln){switch(Ln){case 204:ie=Ne;break;case 22:Ne[1].v=Ne[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Ne[3]>Te&&(K["!ref"]=rt(Y),be[ie]=K,Ae.push(ie),K=q.dense?[]:{},Y={s:{r:0,c:0},e:{r:0,c:0}},Te=Ne[3],ie="Sheet"+(Te+1)),yt>0&&Ne[0].r>=yt)break;q.dense?(K[Ne[0].r]||(K[Ne[0].r]=[]),K[Ne[0].r][Ne[0].c]=Ne[1]):K[Je(Ne[0])]=Ne[1],Y.e.c<Ne[0].c&&(Y.e.c=Ne[0].c),Y.e.r<Ne[0].r&&(Y.e.r=Ne[0].r);break;case 27:Ne[14e3]&&(Xe[Ne[14e3][0]]=Ne[14e3][1]);break;case 1537:Xe[Ne[0]]=Ne[1],Ne[0]==Te&&(ie=Ne[1]);break}},q);else throw new Error("Unrecognized LOTUS BOF "+L[2]);if(K["!ref"]=rt(Y),be[Ce||ie]=K,Ae.push(Ce||ie),!Xe.length)return{SheetNames:Ae,Sheets:be};for(var st={},_t=[],qe=0;qe<Xe.length;++qe)be[Ae[qe]]?(_t.push(Xe[qe]||Ae[qe]),st[Xe[qe]]=be[Xe[qe]]||be[Ae[qe]]):(_t.push(Xe[qe]),st[Xe[qe]]={"!ref":"A1"});return{SheetNames:_t,Sheets:st}}function r(L,W){var q=W||{};if(+q.codepage>=0&&la(+q.codepage),q.type=="string")throw new Error("Cannot write WK1 to JS string");var K=xr(),ie=xt(L["!ref"]),Ce=Array.isArray(L),Te=[];Ie(K,0,s(1030)),Ie(K,6,f(ie));for(var be=Math.min(ie.e.r,8191),Ae=ie.s.r;Ae<=be;++Ae)for(var Xe=mn(Ae),Y=ie.s.c;Y<=ie.e.c;++Y){Ae===ie.s.r&&(Te[Y]=tn(Y));var yt=Te[Y]+Xe,st=Ce?(L[Ae]||[])[Y]:L[yt];if(!(!st||st.t=="z"))if(st.t=="n")(st.v|0)==st.v&&st.v>=-32768&&st.v<=32767?Ie(K,13,T(Ae,Y,st.v)):Ie(K,14,S(Ae,Y,st.v));else{var _t=Xa(st);Ie(K,15,x(Ae,Y,_t.slice(0,239)))}}return Ie(K,1),K.end()}function a(L,W){var q=W||{};if(+q.codepage>=0&&la(+q.codepage),q.type=="string")throw new Error("Cannot write WK3 to JS string");var K=xr();Ie(K,0,l(L));for(var ie=0,Ce=0;ie<L.SheetNames.length;++ie)(L.Sheets[L.SheetNames[ie]]||{})["!ref"]&&Ie(K,27,re(L.SheetNames[ie],Ce++));var Te=0;for(ie=0;ie<L.SheetNames.length;++ie){var be=L.Sheets[L.SheetNames[ie]];if(!(!be||!be["!ref"])){for(var Ae=xt(be["!ref"]),Xe=Array.isArray(be),Y=[],yt=Math.min(Ae.e.r,8191),st=Ae.s.r;st<=yt;++st)for(var _t=mn(st),qe=Ae.s.c;qe<=Ae.e.c;++qe){st===Ae.s.r&&(Y[qe]=tn(qe));var Ne=Y[qe]+_t,bt=Xe?(be[st]||[])[qe]:be[Ne];if(!(!bt||bt.t=="z"))if(bt.t=="n")Ie(K,23,te(st,qe,Te,bt.v));else{var Ln=Xa(bt);Ie(K,22,D(st,qe,Te,Ln.slice(0,239)))}}++Te}}return Ie(K,1),K.end()}function s(L){var W=xe(2);return W.write_shift(2,L),W}function l(L){var W=xe(26);W.write_shift(2,4096),W.write_shift(2,4),W.write_shift(4,0);for(var q=0,K=0,ie=0,Ce=0;Ce<L.SheetNames.length;++Ce){var Te=L.SheetNames[Ce],be=L.Sheets[Te];if(!(!be||!be["!ref"])){++ie;var Ae=vr(be["!ref"]);q<Ae.e.r&&(q=Ae.e.r),K<Ae.e.c&&(K=Ae.e.c)}}return q>8191&&(q=8191),W.write_shift(2,q),W.write_shift(1,ie),W.write_shift(1,K),W.write_shift(2,0),W.write_shift(2,0),W.write_shift(1,1),W.write_shift(1,2),W.write_shift(4,0),W.write_shift(4,0),W}function c(L,W,q){var K={s:{c:0,r:0},e:{c:0,r:0}};return W==8&&q.qpro?(K.s.c=L.read_shift(1),L.l++,K.s.r=L.read_shift(2),K.e.c=L.read_shift(1),L.l++,K.e.r=L.read_shift(2),K):(K.s.c=L.read_shift(2),K.s.r=L.read_shift(2),W==12&&q.qpro&&(L.l+=2),K.e.c=L.read_shift(2),K.e.r=L.read_shift(2),W==12&&q.qpro&&(L.l+=2),K.s.c==65535&&(K.s.c=K.e.c=K.s.r=K.e.r=0),K)}function f(L){var W=xe(8);return W.write_shift(2,L.s.c),W.write_shift(2,L.s.r),W.write_shift(2,L.e.c),W.write_shift(2,L.e.r),W}function d(L,W,q){var K=[{c:0,r:0},{t:"n",v:0},0,0];return q.qpro&&q.vers!=20768?(K[0].c=L.read_shift(1),K[3]=L.read_shift(1),K[0].r=L.read_shift(2),L.l+=2):(K[2]=L.read_shift(1),K[0].c=L.read_shift(2),K[0].r=L.read_shift(2)),K}function g(L,W,q){var K=L.l+W,ie=d(L,W,q);if(ie[1].t="s",q.vers==20768){L.l++;var Ce=L.read_shift(1);return ie[1].v=L.read_shift(Ce,"utf8"),ie}return q.qpro&&L.l++,ie[1].v=L.read_shift(K-L.l,"cstr"),ie}function x(L,W,q){var K=xe(7+q.length);K.write_shift(1,255),K.write_shift(2,W),K.write_shift(2,L),K.write_shift(1,39);for(var ie=0;ie<K.length;++ie){var Ce=q.charCodeAt(ie);K.write_shift(1,Ce>=128?95:Ce)}return K.write_shift(1,0),K}function _(L,W,q){var K=d(L,W,q);return K[1].v=L.read_shift(2,"i"),K}function T(L,W,q){var K=xe(7);return K.write_shift(1,255),K.write_shift(2,W),K.write_shift(2,L),K.write_shift(2,q,"i"),K}function E(L,W,q){var K=d(L,W,q);return K[1].v=L.read_shift(8,"f"),K}function S(L,W,q){var K=xe(13);return K.write_shift(1,255),K.write_shift(2,W),K.write_shift(2,L),K.write_shift(8,q,"f"),K}function C(L,W,q){var K=L.l+W,ie=d(L,W,q);if(ie[1].v=L.read_shift(8,"f"),q.qpro)L.l=K;else{var Ce=L.read_shift(2);I(L.slice(L.l,L.l+Ce),ie),L.l+=Ce}return ie}function k(L,W,q){var K=W&32768;return W&=-32769,W=(K?L:0)+(W>=8192?W-16384:W),(K?"":"$")+(q?tn(W):mn(W))}var N={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},b=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function I(L,W){qn(L,0);for(var q=[],K=0,ie="",Ce="",Te="",be="";L.l<L.length;){var Ae=L[L.l++];switch(Ae){case 0:q.push(L.read_shift(8,"f"));break;case 1:Ce=k(W[0].c,L.read_shift(2),!0),ie=k(W[0].r,L.read_shift(2),!1),q.push(Ce+ie);break;case 2:{var Xe=k(W[0].c,L.read_shift(2),!0),Y=k(W[0].r,L.read_shift(2),!1);Ce=k(W[0].c,L.read_shift(2),!0),ie=k(W[0].r,L.read_shift(2),!1),q.push(Xe+Y+":"+Ce+ie)}break;case 3:if(L.l<L.length){console.error("WK1 premature formula end");return}break;case 4:q.push("("+q.pop()+")");break;case 5:q.push(L.read_shift(2));break;case 6:{for(var yt="";Ae=L[L.l++];)yt+=String.fromCharCode(Ae);q.push('"'+yt.replace(/"/g,'""')+'"')}break;case 8:q.push("-"+q.pop());break;case 23:q.push("+"+q.pop());break;case 22:q.push("NOT("+q.pop()+")");break;case 20:case 21:be=q.pop(),Te=q.pop(),q.push(["AND","OR"][Ae-20]+"("+Te+","+be+")");break;default:if(Ae<32&&b[Ae])be=q.pop(),Te=q.pop(),q.push(Te+b[Ae]+be);else if(N[Ae]){if(K=N[Ae][1],K==69&&(K=L[L.l++]),K>q.length){console.error("WK1 bad formula parse 0x"+Ae.toString(16)+":|"+q.join("|")+"|");return}var st=q.slice(-K);q.length-=K,q.push(N[Ae][0]+"("+st.join(",")+")")}else return Ae<=7?console.error("WK1 invalid opcode "+Ae.toString(16)):Ae<=24?console.error("WK1 unsupported op "+Ae.toString(16)):Ae<=30?console.error("WK1 invalid opcode "+Ae.toString(16)):Ae<=115?console.error("WK1 unsupported function opcode "+Ae.toString(16)):console.error("WK1 unrecognized opcode "+Ae.toString(16))}}q.length==1?W[1].f=""+q[0]:console.error("WK1 bad formula parse |"+q.join("|")+"|")}function F(L){var W=[{c:0,r:0},{t:"n",v:0},0];return W[0].r=L.read_shift(2),W[3]=L[L.l++],W[0].c=L[L.l++],W}function P(L,W){var q=F(L);return q[1].t="s",q[1].v=L.read_shift(W-4,"cstr"),q}function D(L,W,q,K){var ie=xe(6+K.length);ie.write_shift(2,L),ie.write_shift(1,q),ie.write_shift(1,W),ie.write_shift(1,39);for(var Ce=0;Ce<K.length;++Ce){var Te=K.charCodeAt(Ce);ie.write_shift(1,Te>=128?95:Te)}return ie.write_shift(1,0),ie}function j(L,W){var q=F(L);q[1].v=L.read_shift(2);var K=q[1].v>>1;if(q[1].v&1)switch(K&7){case 0:K=(K>>3)*5e3;break;case 1:K=(K>>3)*500;break;case 2:K=(K>>3)/20;break;case 3:K=(K>>3)/200;break;case 4:K=(K>>3)/2e3;break;case 5:K=(K>>3)/2e4;break;case 6:K=(K>>3)/16;break;case 7:K=(K>>3)/64;break}return q[1].v=K,q}function B(L,W){var q=F(L),K=L.read_shift(4),ie=L.read_shift(4),Ce=L.read_shift(2);if(Ce==65535)return K===0&&ie===3221225472?(q[1].t="e",q[1].v=15):K===0&&ie===3489660928?(q[1].t="e",q[1].v=42):q[1].v=0,q;var Te=Ce&32768;return Ce=(Ce&32767)-16446,q[1].v=(1-Te*2)*(ie*Math.pow(2,Ce+32)+K*Math.pow(2,Ce)),q}function te(L,W,q,K){var ie=xe(14);if(ie.write_shift(2,L),ie.write_shift(1,q),ie.write_shift(1,W),K==0)return ie.write_shift(4,0),ie.write_shift(4,0),ie.write_shift(2,65535),ie;var Ce=0,Te=0,be=0,Ae=0;return K<0&&(Ce=1,K=-K),Te=Math.log2(K)|0,K/=Math.pow(2,Te-31),Ae=K>>>0,(Ae&2147483648)==0&&(K/=2,++Te,Ae=K>>>0),K-=Ae,Ae|=2147483648,Ae>>>=0,K*=Math.pow(2,32),be=K>>>0,ie.write_shift(4,be),ie.write_shift(4,Ae),Te+=16383+(Ce?32768:0),ie.write_shift(2,Te),ie}function X(L,W){var q=B(L);return L.l+=W-14,q}function Z(L,W){var q=F(L),K=L.read_shift(4);return q[1].v=K>>6,q}function ye(L,W){var q=F(L),K=L.read_shift(8,"f");return q[1].v=K,q}function Me(L,W){var q=ye(L);return L.l+=W-10,q}function Se(L,W){return L[L.l+W-1]==0?L.read_shift(W,"cstr"):""}function ee(L,W){var q=L[L.l++];q>W-1&&(q=W-1);for(var K="";K.length<q;)K+=String.fromCharCode(L[L.l++]);return K}function me(L,W,q){if(!(!q.qpro||W<21)){var K=L.read_shift(1);L.l+=17,L.l+=1,L.l+=2;var ie=L.read_shift(W-21,"cstr");return[K,ie]}}function Pe(L,W){for(var q={},K=L.l+W;L.l<K;){var ie=L.read_shift(2);if(ie==14e3){for(q[ie]=[0,""],q[ie][0]=L.read_shift(2);L[L.l];)q[ie][1]+=String.fromCharCode(L[L.l]),L.l++;L.l++}}return q}function re(L,W){var q=xe(5+L.length);q.write_shift(2,14e3),q.write_shift(2,W);for(var K=0;K<L.length;++K){var ie=L.charCodeAt(K);q[q.l++]=ie>127?95:ie}return q[q.l++]=0,q}var z={0:{n:"BOF",f:_n},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:c},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:_},14:{n:"NUMBER",f:E},15:{n:"LABEL",f:g},16:{n:"FORMULA",f:C},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:g},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Se},222:{n:"SHEETNAMELP",f:ee},65535:{n:""}},ce={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:P},23:{n:"NUMBER17",f:B},24:{n:"NUMBER18",f:j},25:{n:"FORMULA19",f:X},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Pe},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:Z},38:{n:"??"},39:{n:"NUMBER27",f:ye},40:{n:"FORMULA28",f:Me},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Se},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:me},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:r,book_to_wk3:a,to_workbook:e}}();function eO(t){var e={},n=t.match(ar),r=0,a=!1;if(n)for(;r!=n.length;++r){var s=Ze(n[r]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;e.cp=zm[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=s.val;break;case"<sz":e.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":s.rgb&&(e.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(s[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+s[0])}}return e}var tO=function(){var t=wc("t"),e=wc("rPr");function n(s){var l=s.match(t);if(!l)return{t:"s",v:""};var c={t:"s",v:gt(l[1])},f=s.match(e);return f&&(c.s=eO(f[1])),c}var r=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(l){return l.replace(r,"").split(a).map(n).filter(function(c){return c.v})}}(),nO=function(){var e=/(\r\n|\n)/g;function n(a,s,l){var c=[];a.u&&c.push("text-decoration: underline;"),a.uval&&c.push("text-underline-style:"+a.uval+";"),a.sz&&c.push("font-size:"+a.sz+"pt;"),a.outline&&c.push("text-effect: outline;"),a.shadow&&c.push("text-shadow: auto;"),s.push('<span style="'+c.join("")+'">'),a.b&&(s.push("<b>"),l.push("</b>")),a.i&&(s.push("<i>"),l.push("</i>")),a.strike&&(s.push("<s>"),l.push("</s>"));var f=a.valign||"";return f=="superscript"||f=="super"?f="sup":f=="subscript"&&(f="sub"),f!=""&&(s.push("<"+f+">"),l.push("</"+f+">")),l.push("</span>"),a}function r(a){var s=[[],a.v,[]];return a.v?(a.s&&n(a.s,s[0],s[2]),s[0].join("")+s[1].replace(e,"<br/>")+s[2].join("")):""}return function(s){return s.map(r).join("")}}(),rO=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,aO=/<(?:\w+:)?r>/,iO=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function hp(t,e){var n=e?e.cellHTML:!0,r={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(r.t=gt(Bt(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),r.r=Bt(t),n&&(r.h=Qm(r.t))):t.match(aO)&&(r.r=Bt(t),r.t=gt(Bt((t.replace(iO,"").match(rO)||[]).join("").replace(ar,""))),n&&(r.h=nO(tO(r.r)))),r):{t:""}}var sO=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,oO=/<(?:\w+:)?(?:si|sstItem)>/g,lO=/<\/(?:\w+:)?(?:si|sstItem)>/;function cO(t,e){var n=[],r="";if(!t)return n;var a=t.match(sO);if(a){r=a[2].replace(oO,"").split(lO);for(var s=0;s!=r.length;++s){var l=hp(r[s].trim(),e);l!=null&&(n[n.length]=l)}a=Ze(a[1]),n.Count=a.count,n.Unique=a.uniqueCount}return n}var uO=/^\s|\s$|[\t\n\r]/;function Xw(t,e){if(!e.bookSST)return"";var n=[pn];n[n.length]=Fe("sst",null,{xmlns:bs[0],count:t.Count,uniqueCount:t.Unique});for(var r=0;r!=t.length;++r)if(t[r]!=null){var a=t[r],s="<si>";a.r?s+=a.r:(s+="<t",a.t||(a.t=""),a.t.match(uO)&&(s+=' xml:space="preserve"'),s+=">"+Dt(a.t)+"</t>"),s+="</si>",n[n.length]=s}return n.length>2&&(n[n.length]="</sst>",n[1]=n[1].replace("/>",">")),n.join("")}function fO(t){return[t.read_shift(4),t.read_shift(4)]}function dO(t,e){var n=[],r=!1;return ti(t,function(s,l,c){switch(c){case 159:n.Count=s[0],n.Unique=s[1];break;case 19:n.push(s);break;case 160:return!0;case 35:r=!0;break;case 36:r=!1;break;default:if(l.T,!r||e.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}),n}function hO(t,e){return e||(e=xe(8)),e.write_shift(4,t.Count),e.write_shift(4,t.Unique),e}var mO=E5;function pO(t){var e=xr();Ee(e,159,hO(t));for(var n=0;n<t.length;++n)Ee(e,19,mO(t[n]));return Ee(e,160),e.end()}function Kw(t){for(var e=[],n=t.split(""),r=0;r<n.length;++r)e[r]=n[r].charCodeAt(0);return e}function Ja(t,e){var n={};return n.Major=t.read_shift(2),n.Minor=t.read_shift(2),e>=4&&(t.l+=e-4),n}function gO(t){var e={};return e.id=t.read_shift(0,"lpp4"),e.R=Ja(t,4),e.U=Ja(t,4),e.W=Ja(t,4),e}function xO(t){for(var e=t.read_shift(4),n=t.l+e-4,r={},a=t.read_shift(4),s=[];a-- >0;)s.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(r.name=t.read_shift(0,"lpp4"),r.comps=s,t.l!=n)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+n);return r}function vO(t){var e=[];t.l+=4;for(var n=t.read_shift(4);n-- >0;)e.push(xO(t));return e}function yO(t){var e=[];t.l+=4;for(var n=t.read_shift(4);n-- >0;)e.push(t.read_shift(0,"lpp4"));return e}function _O(t){var e={};return t.read_shift(4),t.l+=4,e.id=t.read_shift(0,"lpp4"),e.name=t.read_shift(0,"lpp4"),e.R=Ja(t,4),e.U=Ja(t,4),e.W=Ja(t,4),e}function TO(t){var e=_O(t);if(e.ename=t.read_shift(0,"8lpp4"),e.blksz=t.read_shift(4),e.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function Zw(t,e){var n=t.l+e,r={};r.Flags=t.read_shift(4)&63,t.l+=4,r.AlgID=t.read_shift(4);var a=!1;switch(r.AlgID){case 26126:case 26127:case 26128:a=r.Flags==36;break;case 26625:a=r.Flags==4;break;case 0:a=r.Flags==16||r.Flags==4||r.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+r.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return r.AlgIDHash=t.read_shift(4),r.KeySize=t.read_shift(4),r.ProviderType=t.read_shift(4),t.l+=8,r.CSPName=t.read_shift(n-t.l>>1,"utf16le"),t.l=n,r}function Qw(t,e){var n={},r=t.l+e;return t.l+=4,n.Salt=t.slice(t.l,t.l+16),t.l+=16,n.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),n.VerifierHash=t.slice(t.l,r),t.l=r,n}function wO(t){var e=Ja(t);switch(e.Minor){case 2:return[e.Minor,SO(t)];case 3:return[e.Minor,EO()];case 4:return[e.Minor,CO(t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function SO(t){var e=t.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var n=t.read_shift(4),r=Zw(t,n),a=Qw(t,t.length-t.l);return{t:"Std",h:r,v:a}}function EO(){throw new Error("File is password-protected: ECMA-376 Extensible")}function CO(t){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var n=t.read_shift(t.length-t.l,"utf8"),r={};return n.replace(ar,function(s){var l=Ze(s);switch(Ca(l[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(c){r[c]=l[c]});break;case"<dataIntegrity":r.encryptedHmacKey=l.encryptedHmacKey,r.encryptedHmacValue=l.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":r.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":r.uri=l.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":r.encs.push(l);break;default:throw l[0]}}),r}function bO(t,e){var n={},r=n.EncryptionVersionInfo=Ja(t,4);if(e-=4,r.Minor!=2)throw new Error("unrecognized minor version code: "+r.Minor);if(r.Major>4||r.Major<2)throw new Error("unrecognized major version code: "+r.Major);n.Flags=t.read_shift(4),e-=4;var a=t.read_shift(4);return e-=4,n.EncryptionHeader=Zw(t,a),e-=a,n.EncryptionVerifier=Qw(t,e),n}function AO(t){var e={},n=e.EncryptionVersionInfo=Ja(t,4);if(n.Major!=1||n.Minor!=1)throw"unrecognized version code "+n.Major+" : "+n.Minor;return e.Salt=t.read_shift(16),e.EncryptedVerifier=t.read_shift(16),e.EncryptedVerifierHash=t.read_shift(16),e}function mp(t){var e=0,n,r=Kw(t),a=r.length+1,s,l,c,f,d;for(n=Ii(a),n[0]=r.length,s=1;s!=a;++s)n[s]=r[s-1];for(s=a-1;s>=0;--s)l=n[s],c=(e&16384)===0?0:1,f=e<<1&32767,d=c|f,e=d^l;return e^52811}var eS=function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],n=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],r=function(l){return(l/2|l*128)&255},a=function(l,c){return r(l^c)},s=function(l){for(var c=e[l.length-1],f=104,d=l.length-1;d>=0;--d)for(var g=l[d],x=0;x!=7;++x)g&64&&(c^=n[f]),g*=2,--f;return c};return function(l){for(var c=Kw(l),f=s(c),d=c.length,g=Ii(16),x=0;x!=16;++x)g[x]=0;var _,T,E;for((d&1)===1&&(_=f>>8,g[d]=a(t[0],_),--d,_=f&255,T=c[c.length-1],g[d]=a(T,_));d>0;)--d,_=f>>8,g[d]=a(c[d],_),--d,_=f&255,g[d]=a(c[d],_);for(d=15,E=15-c.length;E>0;)_=f>>8,g[d]=a(t[E],_),--d,--E,_=f&255,g[d]=a(c[d],_),--d,--E;return g}}(),kO=function(t,e,n,r,a){a||(a=e),r||(r=eS(t));var s,l;for(s=0;s!=e.length;++s)l=e[s],l^=r[n],l=(l>>5|l<<3)&255,a[s]=l,++n;return[a,n,r]},NO=function(t){var e=0,n=eS(t);return function(r){var a=kO("",r,e,n);return e=a[1],a[0]}};function MO(t,e,n,r){var a={key:_n(t),verificationBytes:_n(t)};return n.password&&(a.verifier=mp(n.password)),r.valid=a.verificationBytes===a.verifier,r.valid&&(r.insitu=NO(n.password)),a}function DO(t,e,n){var r=n||{};return r.Info=t.read_shift(2),t.l-=2,r.Info===1?r.Data=AO(t):r.Data=bO(t,e),r}function RO(t,e,n){var r={Type:n.biff>=8?t.read_shift(2):0};return r.Type?DO(t,e-2,r):MO(t,n.biff>=8?e:e-2,n,r),r}var tS=function(){function t(a,s){switch(s.type){case"base64":return e(Dr(a),s);case"binary":return e(a,s);case"buffer":return e(lt&&Buffer.isBuffer(a)?a.toString("binary"):Bi(a),s);case"array":return e(ys(a),s)}throw new Error("Unrecognized type "+s.type)}function e(a,s){var l=s||{},c=l.dense?[]:{},f=a.match(/\\trowd.*?\\row\b/g);if(!f.length)throw new Error("RTF missing table");var d={s:{c:0,r:0},e:{c:0,r:f.length-1}};return f.forEach(function(g,x){Array.isArray(c)&&(c[x]=[]);for(var _=/\\\w+\b/g,T=0,E,S=-1;E=_.exec(g);){switch(E[0]){case"\\cell":var C=g.slice(T,_.lastIndex-E[0].length);if(C[0]==" "&&(C=C.slice(1)),++S,C.length){var k={v:C,t:"s"};Array.isArray(c)?c[x][S]=k:c[Je({r:x,c:S})]=k}break}T=_.lastIndex}S>d.e.c&&(d.e.c=S)}),c["!ref"]=rt(d),c}function n(a,s){return Vi(t(a,s),s)}function r(a){for(var s=["{\\rtf1\\ansi"],l=xt(a["!ref"]),c,f=Array.isArray(a),d=l.s.r;d<=l.e.r;++d){s.push("\\trowd\\trautofit1");for(var g=l.s.c;g<=l.e.c;++g)s.push("\\cellx"+(g+1));for(s.push("\\pard\\intbl"),g=l.s.c;g<=l.e.c;++g){var x=Je({r:d,c:g});c=f?(a[d]||[])[g]:a[x],!(!c||c.v==null&&(!c.f||c.F))&&(s.push(" "+(c.w||(Xa(c),c.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:n,to_sheet:t,from_sheet:r}}();function FO(t){var e=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function bc(t){for(var e=0,n=1;e!=3;++e)n=n*256+(t[e]>255?255:t[e]<0?0:t[e]);return n.toString(16).toUpperCase().slice(1)}function IO(t){var e=t[0]/255,n=t[1]/255,r=t[2]/255,a=Math.max(e,n,r),s=Math.min(e,n,r),l=a-s;if(l===0)return[0,0,e];var c=0,f=0,d=a+s;switch(f=l/(d>1?2-d:d),a){case e:c=((n-r)/l+6)%6;break;case n:c=(r-e)/l+2;break;case r:c=(e-n)/l+4;break}return[c/6,f,d/2]}function PO(t){var e=t[0],n=t[1],r=t[2],a=n*2*(r<.5?r:1-r),s=r-a/2,l=[s,s,s],c=6*e,f;if(n!==0)switch(c|0){case 0:case 6:f=a*c,l[0]+=a,l[1]+=f;break;case 1:f=a*(2-c),l[0]+=f,l[1]+=a;break;case 2:f=a*(c-2),l[1]+=a,l[2]+=f;break;case 3:f=a*(4-c),l[1]+=f,l[2]+=a;break;case 4:f=a*(c-4),l[2]+=a,l[0]+=f;break;case 5:f=a*(6-c),l[2]+=f,l[0]+=a;break}for(var d=0;d!=3;++d)l[d]=Math.round(l[d]*255);return l}function Of(t,e){if(e===0)return t;var n=IO(FO(t));return e<0?n[2]=n[2]*(1+e):n[2]=1-(1-n[2])*(1-e),bc(PO(n))}var nS=6,LO=15,OO=1,Qn=nS;function Ac(t){return Math.floor((t+Math.round(128/Qn)/256)*Qn)}function kc(t){return Math.floor((t-5)/Qn*100+.5)/100}function Uf(t){return Math.round((t*Qn+5)/Qn*256)/256}function bh(t){return Uf(kc(Ac(t)))}function pp(t){var e=Math.abs(t-bh(t)),n=Qn;if(e>.005)for(Qn=OO;Qn<LO;++Qn)Math.abs(t-bh(t))<=e&&(e=Math.abs(t-bh(t)),n=Qn);Qn=n}function Pi(t){t.width?(t.wpx=Ac(t.width),t.wch=kc(t.wpx),t.MDW=Qn):t.wpx?(t.wch=kc(t.wpx),t.width=Uf(t.wch),t.MDW=Qn):typeof t.wch=="number"&&(t.width=Uf(t.wch),t.wpx=Ac(t.width),t.MDW=Qn),t.customWidth&&delete t.customWidth}var UO=96,rS=UO;function Nc(t){return t*96/rS}function Go(t){return t*rS/96}var BO={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function VO(t,e,n,r){e.Borders=[];var a={},s=!1;(t[0].match(ar)||[]).forEach(function(l){var c=Ze(l);switch(Ca(c[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},c.diagonalUp&&(a.diagonalUp=Jt(c.diagonalUp)),c.diagonalDown&&(a.diagonalDown=Jt(c.diagonalDown)),e.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+c[0]+" in borders")}})}function GO(t,e,n,r){e.Fills=[];var a={},s=!1;(t[0].match(ar)||[]).forEach(function(l){var c=Ze(l);switch(Ca(c[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},e.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":c.patternType&&(a.patternType=c.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),c.indexed&&(a.bgColor.indexed=parseInt(c.indexed,10)),c.theme&&(a.bgColor.theme=parseInt(c.theme,10)),c.tint&&(a.bgColor.tint=parseFloat(c.tint)),c.rgb&&(a.bgColor.rgb=c.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),c.theme&&(a.fgColor.theme=parseInt(c.theme,10)),c.tint&&(a.fgColor.tint=parseFloat(c.tint)),c.rgb!=null&&(a.fgColor.rgb=c.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+c[0]+" in fills")}})}function HO(t,e,n,r){e.Fonts=[];var a={},s=!1;(t[0].match(ar)||[]).forEach(function(l){var c=Ze(l);switch(Ca(c[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(a),a={};break;case"<name":c.val&&(a.name=Bt(c.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=c.val?Jt(c.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=c.val?Jt(c.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(c.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=c.val?Jt(c.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=c.val?Jt(c.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=c.val?Jt(c.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=c.val?Jt(c.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=c.val?Jt(c.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":c.val&&(a.sz=+c.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":c.val&&(a.vertAlign=c.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":c.val&&(a.family=parseInt(c.val,10));break;case"<family/>":case"</family>":break;case"<scheme":c.val&&(a.scheme=c.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(c.val=="1")break;c.codepage=zm[parseInt(c.val,10)];break;case"<color":if(a.color||(a.color={}),c.auto&&(a.color.auto=Jt(c.auto)),c.rgb)a.color.rgb=c.rgb.slice(-6);else if(c.indexed){a.color.index=parseInt(c.indexed,10);var f=ds[a.color.index];a.color.index==81&&(f=ds[1]),f||(f=ds[1]),a.color.rgb=f[0].toString(16)+f[1].toString(16)+f[2].toString(16)}else c.theme&&(a.color.theme=parseInt(c.theme,10),c.tint&&(a.color.tint=parseFloat(c.tint)),c.theme&&n.themeElements&&n.themeElements.clrScheme&&(a.color.rgb=Of(n.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+c[0]+" in fonts")}})}function zO(t,e,n){e.NumberFmt=[];for(var r=ln(Ye),a=0;a<r.length;++a)e.NumberFmt[r[a]]=Ye[r[a]];var s=t[0].match(ar);if(s)for(a=0;a<s.length;++a){var l=Ze(s[a]);switch(Ca(l[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var c=gt(Bt(l.formatCode)),f=parseInt(l.numFmtId,10);if(e.NumberFmt[f]=c,f>0){if(f>392){for(f=392;f>60&&e.NumberFmt[f]!=null;--f);e.NumberFmt[f]=c}Ya(c,f)}}break;case"</numFmt>":break;default:if(n.WTF)throw new Error("unrecognized "+l[0]+" in numFmts")}}}function qO(t){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var r=n[0];r<=n[1];++r)t[r]!=null&&(e[e.length]=Fe("numFmt",null,{numFmtId:r,formatCode:Dt(t[r])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=Fe("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var pf=["numFmtId","fillId","fontId","borderId","xfId"],gf=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function jO(t,e,n){e.CellXf=[];var r,a=!1;(t[0].match(ar)||[]).forEach(function(s){var l=Ze(s),c=0;switch(Ca(l[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(r=l,delete r[0],c=0;c<pf.length;++c)r[pf[c]]&&(r[pf[c]]=parseInt(r[pf[c]],10));for(c=0;c<gf.length;++c)r[gf[c]]&&(r[gf[c]]=Jt(r[gf[c]]));if(e.NumberFmt&&r.numFmtId>392){for(c=392;c>60;--c)if(e.NumberFmt[r.numFmtId]==e.NumberFmt[c]){r.numFmtId=c;break}}e.CellXf.push(r);break;case"</xf>":break;case"<alignment":case"<alignment/>":var f={};l.vertical&&(f.vertical=l.vertical),l.horizontal&&(f.horizontal=l.horizontal),l.textRotation!=null&&(f.textRotation=l.textRotation),l.indent&&(f.indent=l.indent),l.wrapText&&(f.wrapText=Jt(l.wrapText)),r.alignment=f;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+l[0]+" in cellXfs")}})}function $O(t){var e=[];return e[e.length]=Fe("cellXfs",null),t.forEach(function(n){e[e.length]=Fe("xf",null,n)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=Fe("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var WO=function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,n=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,r=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(c,f,d){var g={};if(!c)return g;c=c.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var x;return(x=c.match(e))&&zO(x,g,d),(x=c.match(a))&&HO(x,g,f,d),(x=c.match(r))&&GO(x,g,f,d),(x=c.match(s))&&VO(x,g,f,d),(x=c.match(n))&&jO(x,g,d),g}}();function aS(t,e){var n=[pn,Fe("styleSheet",null,{xmlns:bs[0],"xmlns:vt":Sn.vt})],r;return t.SSF&&(r=qO(t.SSF))!=null&&(n[n.length]=r),n[n.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',n[n.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',n[n.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',n[n.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(r=$O(e.cellXfs))&&(n[n.length]=r),n[n.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',n[n.length]='<dxfs count="0"/>',n[n.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',n.length>2&&(n[n.length]="</styleSheet>",n[1]=n[1].replace("/>",">")),n.join("")}function YO(t,e){var n=t.read_shift(2),r=nr(t);return[n,r]}function JO(t,e,n){n||(n=xe(6+4*e.length)),n.write_shift(2,t),Pn(e,n);var r=n.length>n.l?n.slice(0,n.l):n;return n.l==null&&(n.l=n.length),r}function XO(t,e,n){var r={};r.sz=t.read_shift(2)/20;var a=D5(t);a.fItalic&&(r.italic=1),a.fCondense&&(r.condense=1),a.fExtend&&(r.extend=1),a.fShadow&&(r.shadow=1),a.fOutline&&(r.outline=1),a.fStrikeout&&(r.strike=1);var s=t.read_shift(2);switch(s===700&&(r.bold=1),t.read_shift(2)){case 1:r.vertAlign="superscript";break;case 2:r.vertAlign="subscript";break}var l=t.read_shift(1);l!=0&&(r.underline=l);var c=t.read_shift(1);c>0&&(r.family=c);var f=t.read_shift(1);switch(f>0&&(r.charset=f),t.l++,r.color=M5(t),t.read_shift(1)){case 1:r.scheme="major";break;case 2:r.scheme="minor";break}return r.name=nr(t),r}function KO(t,e){e||(e=xe(25+4*32)),e.write_shift(2,t.sz*20),R5(t,e),e.write_shift(2,t.bold?700:400);var n=0;t.vertAlign=="superscript"?n=1:t.vertAlign=="subscript"&&(n=2),e.write_shift(2,n),e.write_shift(1,t.underline||0),e.write_shift(1,t.family||0),e.write_shift(1,t.charset||0),e.write_shift(1,0),If(t.color,e);var r=0;return r=2,e.write_shift(1,r),Pn(t.name,e),e.length>e.l?e.slice(0,e.l):e}var ZO=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Ah,QO=rr;function r2(t,e){e||(e=xe(4*3+8*7+16*1)),Ah||(Ah=Jf(ZO));var n=Ah[t.patternType];n==null&&(n=40),e.write_shift(4,n);var r=0;if(n!=40)for(If({auto:1},e),If({auto:1},e);r<12;++r)e.write_shift(4,0);else{for(;r<4;++r)e.write_shift(4,0);for(;r<12;++r)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function eU(t,e){var n=t.l+e,r=t.read_shift(2),a=t.read_shift(2);return t.l=n,{ixfe:r,numFmtId:a}}function iS(t,e,n){n||(n=xe(16)),n.write_shift(2,e||0),n.write_shift(2,t.numFmtId||0),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(1,0),n.write_shift(1,0);var r=0;return n.write_shift(1,r),n.write_shift(1,0),n.write_shift(1,0),n.write_shift(1,0),n}function Ql(t,e){return e||(e=xe(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var tU=rr;function nU(t,e){return e||(e=xe(51)),e.write_shift(1,0),Ql(null,e),Ql(null,e),Ql(null,e),Ql(null,e),Ql(null,e),e.length>e.l?e.slice(0,e.l):e}function rU(t,e){return e||(e=xe(12+4*10)),e.write_shift(4,t.xfId),e.write_shift(2,1),e.write_shift(1,0),e.write_shift(1,0),Ff(t.name||"",e),e.length>e.l?e.slice(0,e.l):e}function aU(t,e,n){var r=xe(2052);return r.write_shift(4,t),Ff(e,r),Ff(n,r),r.length>r.l?r.slice(0,r.l):r}function iU(t,e,n){var r={};r.NumberFmt=[];for(var a in Ye)r.NumberFmt[a]=Ye[a];r.CellXf=[],r.Fonts=[];var s=[],l=!1;return ti(t,function(f,d,g){switch(g){case 44:r.NumberFmt[f[0]]=f[1],Ya(f[1],f[0]);break;case 43:r.Fonts.push(f),f.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(f.color.rgb=Of(e.themeElements.clrScheme[f.color.theme].rgb,f.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&r.CellXf.push(f);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:s.push(g),l=!0;break;case 38:s.pop(),l=!1;break;default:if(d.T>0)s.push(g);else if(d.T<0)s.pop();else if(!l||n.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+g.toString(16))}}),r}function sU(t,e){if(e){var n=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var a=r[0];a<=r[1];++a)e[a]!=null&&++n}),n!=0&&(Ee(t,615,fa(n)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var a=r[0];a<=r[1];++a)e[a]!=null&&Ee(t,44,JO(a,e[a]))}),Ee(t,616))}}function oU(t){var e=1;Ee(t,611,fa(e)),Ee(t,43,KO({sz:12,color:{theme:1},name:"Calibri",family:2})),Ee(t,612)}function lU(t){var e=2;Ee(t,603,fa(e)),Ee(t,45,r2({patternType:"none"})),Ee(t,45,r2({patternType:"gray125"})),Ee(t,604)}function cU(t){var e=1;Ee(t,613,fa(e)),Ee(t,46,nU()),Ee(t,614)}function uU(t){var e=1;Ee(t,626,fa(e)),Ee(t,47,iS({numFmtId:0},65535)),Ee(t,627)}function fU(t,e){Ee(t,617,fa(e.length)),e.forEach(function(n){Ee(t,47,iS(n,0))}),Ee(t,618)}function dU(t){var e=1;Ee(t,619,fa(e)),Ee(t,48,rU({xfId:0,name:"Normal"})),Ee(t,620)}function hU(t){var e=0;Ee(t,505,fa(e)),Ee(t,506)}function mU(t){var e=0;Ee(t,508,aU(e,"TableStyleMedium9","PivotStyleMedium4")),Ee(t,509)}function pU(t,e){var n=xr();return Ee(n,278),sU(n,t.SSF),oU(n),lU(n),cU(n),uU(n),fU(n,e.cellXfs),dU(n),hU(n),mU(n),Ee(n,279),n.end()}var gU=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function xU(t,e,n){e.themeElements.clrScheme=[];var r={};(t[0].match(ar)||[]).forEach(function(a){var s=Ze(a);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":r.rgb=s.val;break;case"<a:sysClr":r.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(e.themeElements.clrScheme[gU.indexOf(s[0])]=r,r={}):r.name=s[0].slice(3,s[0].length-1);break;default:if(n&&n.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function vU(){}function yU(){}var _U=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,TU=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,wU=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function SU(t,e,n){e.themeElements={};var r;[["clrScheme",_U,xU],["fontScheme",TU,vU],["fmtScheme",wU,yU]].forEach(function(a){if(!(r=t.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](r,e,n)})}var EU=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function sS(t,e){(!t||t.length===0)&&(t=gp());var n,r={};if(!(n=t.match(EU)))throw new Error("themeElements not found in theme");return SU(n[0],r,e),r.raw=t,r}function gp(t,e){if(e&&e.themeXLSX)return e.themeXLSX;if(t&&typeof t.raw=="string")return t.raw;var n=[pn];return n[n.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',n[n.length]="<a:themeElements>",n[n.length]='<a:clrScheme name="Office">',n[n.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',n[n.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',n[n.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',n[n.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',n[n.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',n[n.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',n[n.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',n[n.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',n[n.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',n[n.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',n[n.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',n[n.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',n[n.length]="</a:clrScheme>",n[n.length]='<a:fontScheme name="Office">',n[n.length]="<a:majorFont>",n[n.length]='<a:latin typeface="Cambria"/>',n[n.length]='<a:ea typeface=""/>',n[n.length]='<a:cs typeface=""/>',n[n.length]='<a:font script="Jpan" typeface=" "/>',n[n.length]='<a:font script="Hang" typeface=" "/>',n[n.length]='<a:font script="Hans" typeface=""/>',n[n.length]='<a:font script="Hant" typeface=""/>',n[n.length]='<a:font script="Arab" typeface="Times New Roman"/>',n[n.length]='<a:font script="Hebr" typeface="Times New Roman"/>',n[n.length]='<a:font script="Thai" typeface="Tahoma"/>',n[n.length]='<a:font script="Ethi" typeface="Nyala"/>',n[n.length]='<a:font script="Beng" typeface="Vrinda"/>',n[n.length]='<a:font script="Gujr" typeface="Shruti"/>',n[n.length]='<a:font script="Khmr" typeface="MoolBoran"/>',n[n.length]='<a:font script="Knda" typeface="Tunga"/>',n[n.length]='<a:font script="Guru" typeface="Raavi"/>',n[n.length]='<a:font script="Cans" typeface="Euphemia"/>',n[n.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',n[n.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',n[n.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',n[n.length]='<a:font script="Thaa" typeface="MV Boli"/>',n[n.length]='<a:font script="Deva" typeface="Mangal"/>',n[n.length]='<a:font script="Telu" typeface="Gautami"/>',n[n.length]='<a:font script="Taml" typeface="Latha"/>',n[n.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',n[n.length]='<a:font script="Orya" typeface="Kalinga"/>',n[n.length]='<a:font script="Mlym" typeface="Kartika"/>',n[n.length]='<a:font script="Laoo" typeface="DokChampa"/>',n[n.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',n[n.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',n[n.length]='<a:font script="Viet" typeface="Times New Roman"/>',n[n.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',n[n.length]='<a:font script="Geor" typeface="Sylfaen"/>',n[n.length]="</a:majorFont>",n[n.length]="<a:minorFont>",n[n.length]='<a:latin typeface="Calibri"/>',n[n.length]='<a:ea typeface=""/>',n[n.length]='<a:cs typeface=""/>',n[n.length]='<a:font script="Jpan" typeface=" "/>',n[n.length]='<a:font script="Hang" typeface=" "/>',n[n.length]='<a:font script="Hans" typeface=""/>',n[n.length]='<a:font script="Hant" typeface=""/>',n[n.length]='<a:font script="Arab" typeface="Arial"/>',n[n.length]='<a:font script="Hebr" typeface="Arial"/>',n[n.length]='<a:font script="Thai" typeface="Tahoma"/>',n[n.length]='<a:font script="Ethi" typeface="Nyala"/>',n[n.length]='<a:font script="Beng" typeface="Vrinda"/>',n[n.length]='<a:font script="Gujr" typeface="Shruti"/>',n[n.length]='<a:font script="Khmr" typeface="DaunPenh"/>',n[n.length]='<a:font script="Knda" typeface="Tunga"/>',n[n.length]='<a:font script="Guru" typeface="Raavi"/>',n[n.length]='<a:font script="Cans" typeface="Euphemia"/>',n[n.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',n[n.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',n[n.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',n[n.length]='<a:font script="Thaa" typeface="MV Boli"/>',n[n.length]='<a:font script="Deva" typeface="Mangal"/>',n[n.length]='<a:font script="Telu" typeface="Gautami"/>',n[n.length]='<a:font script="Taml" typeface="Latha"/>',n[n.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',n[n.length]='<a:font script="Orya" typeface="Kalinga"/>',n[n.length]='<a:font script="Mlym" typeface="Kartika"/>',n[n.length]='<a:font script="Laoo" typeface="DokChampa"/>',n[n.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',n[n.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',n[n.length]='<a:font script="Viet" typeface="Arial"/>',n[n.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',n[n.length]='<a:font script="Geor" typeface="Sylfaen"/>',n[n.length]="</a:minorFont>",n[n.length]="</a:fontScheme>",n[n.length]='<a:fmtScheme name="Office">',n[n.length]="<a:fillStyleLst>",n[n.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:lin ang="16200000" scaled="1"/>',n[n.length]="</a:gradFill>",n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:lin ang="16200000" scaled="0"/>',n[n.length]="</a:gradFill>",n[n.length]="</a:fillStyleLst>",n[n.length]="<a:lnStyleLst>",n[n.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]="</a:lnStyleLst>",n[n.length]="<a:effectStyleLst>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]="</a:effectStyle>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]="</a:effectStyle>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',n[n.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',n[n.length]="</a:effectStyle>",n[n.length]="</a:effectStyleLst>",n[n.length]="<a:bgFillStyleLst>",n[n.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',n[n.length]="</a:gradFill>",n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',n[n.length]="</a:gradFill>",n[n.length]="</a:bgFillStyleLst>",n[n.length]="</a:fmtScheme>",n[n.length]="</a:themeElements>",n[n.length]="<a:objectDefaults>",n[n.length]="<a:spDef>",n[n.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',n[n.length]="</a:spDef>",n[n.length]="<a:lnDef>",n[n.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',n[n.length]="</a:lnDef>",n[n.length]="</a:objectDefaults>",n[n.length]="<a:extraClrSchemeLst/>",n[n.length]="</a:theme>",n.join("")}function CU(t,e,n){var r=t.l+e,a=t.read_shift(4);if(a!==124226){if(!n.cellStyles){t.l=r;return}var s=t.slice(t.l);t.l=r;var l;try{l=ZT(s,{type:"array"})}catch{return}var c=Mr(l,"theme/theme/theme1.xml",!0);if(c)return sS(c,n)}}function bU(t){return t.read_shift(4)}function AU(t){var e={};switch(e.xclrType=t.read_shift(2),e.nTintShade=t.read_shift(2),e.xclrType){case 0:t.l+=4;break;case 1:e.xclrValue=kU(t,4);break;case 2:e.xclrValue=Bw(t);break;case 3:e.xclrValue=bU(t);break;case 4:t.l+=4;break}return t.l+=8,e}function kU(t,e){return rr(t,e)}function NU(t,e){return rr(t,e)}function MU(t){var e=t.read_shift(2),n=t.read_shift(2)-4,r=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:r[1]=AU(t);break;case 6:r[1]=NU(t,n);break;case 14:case 15:r[1]=t.read_shift(n===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+n)}return r}function DU(t,e){var n=t.l+e;t.l+=2;var r=t.read_shift(2);t.l+=2;for(var a=t.read_shift(2),s=[];a-- >0;)s.push(MU(t,n-t.l));return{ixfe:r,ext:s}}function RU(t,e){e.forEach(function(n){n[0]})}function FU(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:nr(t)}}function IU(t){var e=xe(12+2*t.name.length);return e.write_shift(4,t.flags),e.write_shift(4,t.version),Pn(t.name,e),e.slice(0,e.l)}function PU(t){for(var e=[],n=t.read_shift(4);n-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function LU(t){var e=xe(4+8*t.length);e.write_shift(4,t.length);for(var n=0;n<t.length;++n)e.write_shift(4,t[n][0]),e.write_shift(4,t[n][1]);return e}function OU(t,e){var n=xe(8+2*e.length);return n.write_shift(4,t),Pn(e,n),n.slice(0,n.l)}function UU(t){return t.l+=4,t.read_shift(4)!=0}function BU(t,e){var n=xe(8);return n.write_shift(4,t),n.write_shift(4,1),n}function VU(t,e,n){var r={Types:[],Cell:[],Value:[]},a=n||{},s=[],l=!1,c=2;return ti(t,function(f,d,g){switch(g){case 335:r.Types.push({name:f.name});break;case 51:f.forEach(function(x){c==1?r.Cell.push({type:r.Types[x[0]-1].name,index:x[1]}):c==0&&r.Value.push({type:r.Types[x[0]-1].name,index:x[1]})});break;case 337:c=f?1:0;break;case 338:c=2;break;case 35:s.push(g),l=!0;break;case 36:s.pop(),l=!1;break;default:if(!d.T){if(!l||a.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+g.toString(16))}}}),r}function GU(){var t=xr();return Ee(t,332),Ee(t,334,fa(1)),Ee(t,335,IU({name:"XLDAPR",version:12e4,flags:3496657072})),Ee(t,336),Ee(t,339,OU(1,"XLDAPR")),Ee(t,52),Ee(t,35,fa(514)),Ee(t,4096,fa(0)),Ee(t,4097,Yr(1)),Ee(t,36),Ee(t,53),Ee(t,340),Ee(t,337,BU(1)),Ee(t,51,LU([[1,0]])),Ee(t,338),Ee(t,333),t.end()}function HU(t,e,n){var r={Types:[],Cell:[],Value:[]};if(!t)return r;var a=!1,s=2,l;return t.replace(ar,function(c){var f=Ze(c);switch(Ca(f[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":r.Types.push({name:f.name});break;case"</metadataType>":break;case"<futureMetadata":for(var d=0;d<r.Types.length;++d)r.Types[d].name==f.name&&(l=r.Types[d]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?r.Cell.push({type:r.Types[f.t-1].name,index:+f.v}):s==0&&r.Value.push({type:r.Types[f.t-1].name,index:+f.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!l)break;l.offsets||(l.offsets=[]),l.offsets.push(+f.i);break;default:if(!a&&n.WTF)throw new Error("unrecognized "+f[0]+" in metadata")}return c}),r}function oS(){var t=[pn];return t.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),t.join("")}function zU(t){var e=[];if(!t)return e;var n=1;return(t.match(ar)||[]).forEach(function(r){var a=Ze(r);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?n=a.i:a.i=n,e.push(a);break}}),e}function qU(t){var e={};e.i=t.read_shift(4);var n={};n.r=t.read_shift(4),n.c=t.read_shift(4),e.r=Je(n);var r=t.read_shift(1);return r&2&&(e.l="1"),r&8&&(e.a="1"),e}function jU(t,e,n){var r=[];return ti(t,function(s,l,c){switch(c){case 63:r.push(s);break;default:if(!l.T)throw new Error("Unexpected record 0x"+c.toString(16))}}),r}function $U(t,e,n,r){if(!t)return t;var a=r||{},s=!1;ti(t,function(c,f,d){switch(d){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!f.T){if(!s||a.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}},a)}function WU(t,e){if(!t)return"??";var n=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][n].Target}var Do=1024;function lS(t,e){for(var n=[21600,21600],r=["m0,0l0",n[1],n[0],n[1],n[0],"0xe"].join(","),a=[Fe("xml",null,{"xmlns:v":Ar.v,"xmlns:o":Ar.o,"xmlns:x":Ar.x,"xmlns:mv":Ar.mv}).replace(/\/>/,">"),Fe("o:shapelayout",Fe("o:idmap",null,{"v:ext":"edit",data:t}),{"v:ext":"edit"}),Fe("v:shapetype",[Fe("v:stroke",null,{joinstyle:"miter"}),Fe("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:n.join(","),path:r})];Do<t*1e3;)Do+=1e3;return e.forEach(function(s){var l=nn(s[0]),c={color2:"#BEFF82",type:"gradient"};c.type=="gradient"&&(c.angle="-180");var f=c.type=="gradient"?Fe("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,d=Fe("v:fill",f,c),g={on:"t",obscured:"t"};++Do,a=a.concat(["<v:shape"+Sc({id:"_x0000_s"+Do,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",d,Fe("v:shadow",null,g),Fe("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",jn("x:Anchor",[l.c+1,0,l.r+1,0,l.c+3,20,l.r+5,20].join(",")),jn("x:AutoFill","False"),jn("x:Row",String(l.r)),jn("x:Column",String(l.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),a.push("</xml>"),a.join("")}function a2(t,e,n,r){var a=Array.isArray(t),s;e.forEach(function(l){var c=nn(l.ref);if(a?(t[c.r]||(t[c.r]=[]),s=t[c.r][c.c]):s=t[l.ref],!s){s={t:"z"},a?t[c.r][c.c]=s:t[l.ref]=s;var f=xt(t["!ref"]||"BDWGO1000001:A1");f.s.r>c.r&&(f.s.r=c.r),f.e.r<c.r&&(f.e.r=c.r),f.s.c>c.c&&(f.s.c=c.c),f.e.c<c.c&&(f.e.c=c.c);var d=rt(f);d!==t["!ref"]&&(t["!ref"]=d)}s.c||(s.c=[]);var g={a:l.author,t:l.t,r:l.r,T:n};l.h&&(g.h=l.h);for(var x=s.c.length-1;x>=0;--x){if(!n&&s.c[x].T)return;n&&!s.c[x].T&&s.c.splice(x,1)}if(n&&r){for(x=0;x<r.length;++x)if(g.a==r[x].id){g.a=r[x].name||g.a;break}}s.c.push(g)})}function YU(t,e){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var n=[],r=[],a=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(l){if(!(l===""||l.trim()==="")){var c=l.match(/<(?:\w+:)?author[^>]*>(.*)/);c&&n.push(c[1])}});var s=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(l){if(!(l===""||l.trim()==="")){var c=l.match(/<(?:\w+:)?comment[^>]*>/);if(c){var f=Ze(c[0]),d={author:f.authorId&&n[f.authorId]||"sheetjsghost",ref:f.ref,guid:f.guid},g=nn(f.ref);if(!(e.sheetRows&&e.sheetRows<=g.r)){var x=l.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),_=!!x&&!!x[1]&&hp(x[1])||{r:"",t:"",h:""};d.r=_.r,_.r=="<t></t>"&&(_.t=_.h=""),d.t=(_.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(d.h=_.h),r.push(d)}}}}),r}function cS(t){var e=[pn,Fe("comments",null,{xmlns:bs[0]})],n=[];return e.push("<authors>"),t.forEach(function(r){r[1].forEach(function(a){var s=Dt(a.a);n.indexOf(s)==-1&&(n.push(s),e.push("<author>"+s+"</author>")),a.T&&a.ID&&n.indexOf("tc="+a.ID)==-1&&(n.push("tc="+a.ID),e.push("<author>tc="+a.ID+"</author>"))})}),n.length==0&&(n.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),t.forEach(function(r){var a=0,s=[];if(r[1][0]&&r[1][0].T&&r[1][0].ID?a=n.indexOf("tc="+r[1][0].ID):r[1].forEach(function(f){f.a&&(a=n.indexOf(Dt(f.a))),s.push(f.t||"")}),e.push('<comment ref="'+r[0]+'" authorId="'+a+'"><text>'),s.length<=1)e.push(jn("t",Dt(s[0]||"")));else{for(var l=`Comment:
    `+s[0]+`
`,c=1;c<s.length;++c)l+=`Reply:
    `+s[c]+`
`;e.push(jn("t",Dt(l)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function JU(t,e){var n=[],r=!1,a={},s=0;return t.replace(ar,function(c,f){var d=Ze(c);switch(Ca(d[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:d.personId,guid:d.id,ref:d.ref,T:1};break;case"</threadedComment>":a.t!=null&&n.push(a);break;case"<text>":case"<text":s=f+c.length;break;case"</text>":a.t=t.slice(s,f).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":r=!0;break;case"</mentions>":r=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;default:if(!r&&e.WTF)throw new Error("unrecognized "+d[0]+" in threaded comments")}return c}),n}function XU(t,e,n){var r=[pn,Fe("ThreadedComments",null,{xmlns:Sn.TCMNT}).replace(/[\/]>/,">")];return t.forEach(function(a){var s="";(a[1]||[]).forEach(function(l,c){if(!l.T){delete l.ID;return}l.a&&e.indexOf(l.a)==-1&&e.push(l.a);var f={ref:a[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+n.tcid++).slice(-12)+"}"};c==0?s=f.id:f.parentId=s,l.ID=f.id,l.a&&(f.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(l.a)).slice(-12)+"}"),r.push(Fe("threadedComment",jn("text",l.t||""),f))})}),r.push("</ThreadedComments>"),r.join("")}function KU(t,e){var n=[],r=!1;return t.replace(ar,function(s){var l=Ze(s);switch(Ca(l[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":n.push({name:l.displayname,id:l.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;default:if(!r&&e.WTF)throw new Error("unrecognized "+l[0]+" in threaded comments")}return s}),n}function ZU(t){var e=[pn,Fe("personList",null,{xmlns:Sn.TCMNT,"xmlns:x":bs[0]}).replace(/[\/]>/,">")];return t.forEach(function(n,r){e.push(Fe("person",null,{displayName:n,id:"{54EE7950-7262-4200-6969-"+("000000000000"+r).slice(-12)+"}",userId:n,providerId:"None"}))}),e.push("</personList>"),e.join("")}function QU(t){var e={};e.iauthor=t.read_shift(4);var n=Ms(t);return e.rfx=n.s,e.ref=Je(n.s),t.l+=16,e}function eB(t,e){return e==null&&(e=xe(36)),e.write_shift(4,t[1].iauthor),Zo(t[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var tB=nr;function nB(t){return Pn(t.slice(0,54))}function rB(t,e){var n=[],r=[],a={},s=!1;return ti(t,function(c,f,d){switch(d){case 632:r.push(c);break;case 635:a=c;break;case 637:a.t=c.t,a.h=c.h,a.r=c.r;break;case 636:if(a.author=r[a.iauthor],delete a.iauthor,e.sheetRows&&a.rfx&&e.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,n.push(a);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!f.T){if(!s||e.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}),n}function aB(t){var e=xr(),n=[];return Ee(e,628),Ee(e,630),t.forEach(function(r){r[1].forEach(function(a){n.indexOf(a.a)>-1||(n.push(a.a.slice(0,54)),Ee(e,632,nB(a.a)))})}),Ee(e,631),Ee(e,633),t.forEach(function(r){r[1].forEach(function(a){a.iauthor=n.indexOf(a.a);var s={s:nn(r[0]),e:nn(r[0])};Ee(e,635,eB([s,a])),a.t&&a.t.length>0&&Ee(e,637,b5(a)),Ee(e,636),delete a.iauthor})}),Ee(e,634),Ee(e,629),e.end()}var iB="application/vnd.ms-office.vbaProject";function sB(t){var e=ze.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(n,r){if(!(n.slice(-1)==="/"||!n.match(/_VBA_PROJECT_CUR/))){var a=n.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");ze.utils.cfb_add(e,a,t.FileIndex[r].content)}}),ze.write(e)}function oB(t,e){e.FullPaths.forEach(function(n,r){if(r!=0){var a=n.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");a.slice(-1)!=="/"&&ze.utils.cfb_add(t,a,e.FileIndex[r].content)}})}var uS=["xlsb","xlsm","xlam","biff8","xla"];function lB(){return{"!type":"dialog"}}function cB(){return{"!type":"dialog"}}function uB(){return{"!type":"macro"}}function fB(){return{"!type":"macro"}}var Lo=function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function n(r,a,s,l){var c=!1,f=!1;s.length==0?f=!0:s.charAt(0)=="["&&(f=!0,s=s.slice(1,-1)),l.length==0?c=!0:l.charAt(0)=="["&&(c=!0,l=l.slice(1,-1));var d=s.length>0?parseInt(s,10)|0:0,g=l.length>0?parseInt(l,10)|0:0;return c?g+=e.c:--g,f?d+=e.r:--d,a+(c?"":"$")+tn(g)+(f?"":"$")+mn(d)}return function(a,s){return e=s,a.replace(t,n)}}(),xp=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,vp=function(){return function(e,n){return e.replace(xp,function(r,a,s,l,c,f){var d=ap(l)-(s?0:n.c),g=rp(f)-(c?0:n.r),x=g==0?"":c?g+1:"["+g+"]",_=d==0?"":s?d+1:"["+d+"]";return a+"R"+x+"C"+_})}}();function fS(t,e){return t.replace(xp,function(n,r,a,s,l,c){return r+(a=="$"?a+s:tn(ap(s)+e.c))+(l=="$"?l+c:mn(rp(c)+e.r))})}function dB(t,e,n){var r=vr(e),a=r.s,s=nn(n),l={r:s.r-a.r,c:s.c-a.c};return fS(t,l)}function hB(t){return t.length!=1}function i2(t){return t.replace(/_xlfn\./g,"")}function vn(t){t.l+=1}function Li(t,e){var n=t.read_shift(2);return[n&16383,n>>14&1,n>>15&1]}function dS(t,e,n){var r=2;if(n){if(n.biff>=2&&n.biff<=5)return hS(t);n.biff==12&&(r=4)}var a=t.read_shift(r),s=t.read_shift(r),l=Li(t),c=Li(t);return{s:{r:a,c:l[0],cRel:l[1],rRel:l[2]},e:{r:s,c:c[0],cRel:c[1],rRel:c[2]}}}function hS(t){var e=Li(t),n=Li(t),r=t.read_shift(1),a=t.read_shift(1);return{s:{r:e[0],c:r,cRel:e[1],rRel:e[2]},e:{r:n[0],c:a,cRel:n[1],rRel:n[2]}}}function mB(t,e,n){if(n.biff<8)return hS(t);var r=t.read_shift(n.biff==12?4:2),a=t.read_shift(n.biff==12?4:2),s=Li(t),l=Li(t);return{s:{r,c:s[0],cRel:s[1],rRel:s[2]},e:{r:a,c:l[0],cRel:l[1],rRel:l[2]}}}function mS(t,e,n){if(n&&n.biff>=2&&n.biff<=5)return pB(t);var r=t.read_shift(n&&n.biff==12?4:2),a=Li(t);return{r,c:a[0],cRel:a[1],rRel:a[2]}}function pB(t){var e=Li(t),n=t.read_shift(1);return{r:e[0],c:n,cRel:e[1],rRel:e[2]}}function gB(t){var e=t.read_shift(2),n=t.read_shift(2);return{r:e,c:n&255,fQuoted:!!(n&16384),cRel:n>>15,rRel:n>>15}}function xB(t,e,n){var r=n&&n.biff?n.biff:8;if(r>=2&&r<=5)return vB(t);var a=t.read_shift(r>=12?4:2),s=t.read_shift(2),l=(s&16384)>>14,c=(s&32768)>>15;if(s&=16383,c==1)for(;a>524287;)a-=1048576;if(l==1)for(;s>8191;)s=s-16384;return{r:a,c:s,cRel:l,rRel:c}}function vB(t){var e=t.read_shift(2),n=t.read_shift(1),r=(e&32768)>>15,a=(e&16384)>>14;return e&=16383,r==1&&e>=8192&&(e=e-16384),a==1&&n>=128&&(n=n-256),{r:e,c:n,cRel:a,rRel:r}}function yB(t,e,n){var r=(t[t.l++]&96)>>5,a=dS(t,n.biff>=2&&n.biff<=5?6:8,n);return[r,a]}function _B(t,e,n){var r=(t[t.l++]&96)>>5,a=t.read_shift(2,"i"),s=8;if(n)switch(n.biff){case 5:t.l+=12,s=6;break;case 12:s=12;break}var l=dS(t,s,n);return[r,a,l]}function TB(t,e,n){var r=(t[t.l++]&96)>>5;return t.l+=n&&n.biff>8?12:n.biff<8?6:8,[r]}function wB(t,e,n){var r=(t[t.l++]&96)>>5,a=t.read_shift(2),s=8;if(n)switch(n.biff){case 5:t.l+=12,s=6;break;case 12:s=12;break}return t.l+=s,[r,a]}function SB(t,e,n){var r=(t[t.l++]&96)>>5,a=mB(t,e-1,n);return[r,a]}function EB(t,e,n){var r=(t[t.l++]&96)>>5;return t.l+=n.biff==2?6:n.biff==12?14:7,[r]}function s2(t){var e=t[t.l+1]&1,n=1;return t.l+=4,[e,n]}function CB(t,e,n){t.l+=2;for(var r=t.read_shift(n&&n.biff==2?1:2),a=[],s=0;s<=r;++s)a.push(t.read_shift(n&&n.biff==2?1:2));return a}function bB(t,e,n){var r=t[t.l+1]&255?1:0;return t.l+=2,[r,t.read_shift(n&&n.biff==2?1:2)]}function AB(t,e,n){var r=t[t.l+1]&255?1:0;return t.l+=2,[r,t.read_shift(n&&n.biff==2?1:2)]}function kB(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function NB(t,e,n){var r=t[t.l+1]&255?1:0;return t.l+=n&&n.biff==2?3:4,[r]}function pS(t){var e=t.read_shift(1),n=t.read_shift(1);return[e,n]}function MB(t){return t.read_shift(2),pS(t)}function DB(t){return t.read_shift(2),pS(t)}function RB(t,e,n){var r=(t[t.l]&96)>>5;t.l+=1;var a=mS(t,0,n);return[r,a]}function FB(t,e,n){var r=(t[t.l]&96)>>5;t.l+=1;var a=xB(t,0,n);return[r,a]}function IB(t,e,n){var r=(t[t.l]&96)>>5;t.l+=1;var a=t.read_shift(2);n&&n.biff==5&&(t.l+=12);var s=mS(t,0,n);return[r,a,s]}function PB(t,e,n){var r=(t[t.l]&96)>>5;t.l+=1;var a=t.read_shift(n&&n.biff<=3?1:2);return[U7[a],vS[a],r]}function LB(t,e,n){var r=t[t.l++],a=t.read_shift(1),s=n&&n.biff<=3?[r==88?-1:0,t.read_shift(1)]:OB(t);return[a,(s[0]===0?vS:O7)[s[1]]]}function OB(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function UB(t,e,n){t.l+=n&&n.biff==2?3:4}function BB(t,e,n){if(t.l++,n&&n.biff==12)return[t.read_shift(4,"i"),0];var r=t.read_shift(2),a=t.read_shift(n&&n.biff==2?1:2);return[r,a]}function VB(t){return t.l++,ni[t.read_shift(1)]}function GB(t){return t.l++,t.read_shift(2)}function HB(t){return t.l++,t.read_shift(1)!==0}function zB(t){return t.l++,er(t)}function qB(t,e,n){return t.l++,Vc(t,e-1,n)}function jB(t,e){var n=[t.read_shift(1)];if(e==12)switch(n[0]){case 2:n[0]=4;break;case 4:n[0]=16;break;case 0:n[0]=1;break;case 1:n[0]=2;break}switch(n[0]){case 4:n[1]=dn(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:n[1]=ni[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:n[1]=er(t);break;case 2:n[1]=Ds(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+n[0])}return n}function $B(t,e,n){for(var r=t.read_shift(n.biff==12?4:2),a=[],s=0;s!=r;++s)a.push((n.biff==12?Ms:Zf)(t));return a}function WB(t,e,n){var r=0,a=0;n.biff==12?(r=t.read_shift(4),a=t.read_shift(4)):(a=1+t.read_shift(1),r=1+t.read_shift(2)),n.biff>=2&&n.biff<8&&(--r,--a==0&&(a=256));for(var s=0,l=[];s!=r&&(l[s]=[]);++s)for(var c=0;c!=a;++c)l[s][c]=jB(t,n.biff);return l}function YB(t,e,n){var r=t.read_shift(1)>>>5&3,a=!n||n.biff>=8?4:2,s=t.read_shift(a);switch(n.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[r,0,s]}function JB(t,e,n){if(n.biff==5)return XB(t);var r=t.read_shift(1)>>>5&3,a=t.read_shift(2),s=t.read_shift(4);return[r,a,s]}function XB(t){var e=t.read_shift(1)>>>5&3,n=t.read_shift(2,"i");t.l+=8;var r=t.read_shift(2);return t.l+=12,[e,n,r]}function KB(t,e,n){var r=t.read_shift(1)>>>5&3;t.l+=n&&n.biff==2?3:4;var a=t.read_shift(n&&n.biff==2?1:2);return[r,a]}function ZB(t,e,n){var r=t.read_shift(1)>>>5&3,a=t.read_shift(n&&n.biff==2?1:2);return[r,a]}function QB(t,e,n){var r=t.read_shift(1)>>>5&3;return t.l+=4,n.biff<8&&t.l--,n.biff==12&&(t.l+=2),[r]}function e7(t,e,n){var r=(t[t.l++]&96)>>5,a=t.read_shift(2),s=4;if(n)switch(n.biff){case 5:s=15;break;case 12:s=6;break}return t.l+=s,[r,a]}var t7=rr,n7=rr,r7=rr;function Hc(t,e,n){return t.l+=2,[gB(t)]}function yp(t){return t.l+=6,[]}var a7=Hc,i7=yp,s7=yp,o7=Hc;function gS(t){return t.l+=2,[_n(t),t.read_shift(2)&1]}var l7=Hc,c7=gS,u7=yp,f7=Hc,d7=Hc,h7=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function m7(t){t.l+=2;var e=t.read_shift(2),n=t.read_shift(2),r=t.read_shift(4),a=t.read_shift(2),s=t.read_shift(2),l=h7[n>>2&31];return{ixti:e,coltype:n&3,rt:l,idx:r,c:a,C:s}}function p7(t){return t.l+=2,[t.read_shift(4)]}function g7(t,e,n){return t.l+=5,t.l+=2,t.l+=n.biff==2?1:4,["PTGSHEET"]}function x7(t,e,n){return t.l+=n.biff==2?4:5,["PTGENDSHEET"]}function v7(t){var e=t.read_shift(1)>>>5&3,n=t.read_shift(2);return[e,n]}function y7(t){var e=t.read_shift(1)>>>5&3,n=t.read_shift(2);return[e,n]}function _7(t){return t.l+=4,[0,0]}var o2={1:{n:"PtgExp",f:BB},2:{n:"PtgTbl",f:r7},3:{n:"PtgAdd",f:vn},4:{n:"PtgSub",f:vn},5:{n:"PtgMul",f:vn},6:{n:"PtgDiv",f:vn},7:{n:"PtgPower",f:vn},8:{n:"PtgConcat",f:vn},9:{n:"PtgLt",f:vn},10:{n:"PtgLe",f:vn},11:{n:"PtgEq",f:vn},12:{n:"PtgGe",f:vn},13:{n:"PtgGt",f:vn},14:{n:"PtgNe",f:vn},15:{n:"PtgIsect",f:vn},16:{n:"PtgUnion",f:vn},17:{n:"PtgRange",f:vn},18:{n:"PtgUplus",f:vn},19:{n:"PtgUminus",f:vn},20:{n:"PtgPercent",f:vn},21:{n:"PtgParen",f:vn},22:{n:"PtgMissArg",f:vn},23:{n:"PtgStr",f:qB},26:{n:"PtgSheet",f:g7},27:{n:"PtgEndSheet",f:x7},28:{n:"PtgErr",f:VB},29:{n:"PtgBool",f:HB},30:{n:"PtgInt",f:GB},31:{n:"PtgNum",f:zB},32:{n:"PtgArray",f:EB},33:{n:"PtgFunc",f:PB},34:{n:"PtgFuncVar",f:LB},35:{n:"PtgName",f:YB},36:{n:"PtgRef",f:RB},37:{n:"PtgArea",f:yB},38:{n:"PtgMemArea",f:KB},39:{n:"PtgMemErr",f:t7},40:{n:"PtgMemNoMem",f:n7},41:{n:"PtgMemFunc",f:ZB},42:{n:"PtgRefErr",f:QB},43:{n:"PtgAreaErr",f:TB},44:{n:"PtgRefN",f:FB},45:{n:"PtgAreaN",f:SB},46:{n:"PtgMemAreaN",f:v7},47:{n:"PtgMemNoMemN",f:y7},57:{n:"PtgNameX",f:JB},58:{n:"PtgRef3d",f:IB},59:{n:"PtgArea3d",f:_B},60:{n:"PtgRefErr3d",f:e7},61:{n:"PtgAreaErr3d",f:wB},255:{}},T7={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},w7={1:{n:"PtgElfLel",f:gS},2:{n:"PtgElfRw",f:f7},3:{n:"PtgElfCol",f:a7},6:{n:"PtgElfRwV",f:d7},7:{n:"PtgElfColV",f:o7},10:{n:"PtgElfRadical",f:l7},11:{n:"PtgElfRadicalS",f:u7},13:{n:"PtgElfColS",f:i7},15:{n:"PtgElfColSV",f:s7},16:{n:"PtgElfRadicalLel",f:c7},25:{n:"PtgList",f:m7},29:{n:"PtgSxName",f:p7},255:{}},S7={0:{n:"PtgAttrNoop",f:_7},1:{n:"PtgAttrSemi",f:NB},2:{n:"PtgAttrIf",f:AB},4:{n:"PtgAttrChoose",f:CB},8:{n:"PtgAttrGoto",f:bB},16:{n:"PtgAttrSum",f:UB},32:{n:"PtgAttrBaxcel",f:s2},33:{n:"PtgAttrBaxcel",f:s2},64:{n:"PtgAttrSpace",f:MB},65:{n:"PtgAttrSpaceSemi",f:DB},128:{n:"PtgAttrIfError",f:kB},255:{}};function zc(t,e,n,r){if(r.biff<8)return rr(t,e);for(var a=t.l+e,s=[],l=0;l!==n.length;++l)switch(n[l][0]){case"PtgArray":n[l][1]=WB(t,0,r),s.push(n[l][1]);break;case"PtgMemArea":n[l][2]=$B(t,n[l][1],r),s.push(n[l][2]);break;case"PtgExp":r&&r.biff==12&&(n[l][1][1]=t.read_shift(4),s.push(n[l][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+n[l][0]}return e=a-t.l,e!==0&&s.push(rr(t,e)),s}function qc(t,e,n){for(var r=t.l+e,a,s,l=[];r!=t.l;)e=r-t.l,s=t[t.l],a=o2[s]||o2[T7[s]],(s===24||s===25)&&(a=(s===24?w7:S7)[t[t.l+1]]),!a||!a.f?rr(t,e):l.push([a.n,a.f(t,e,n)]);return l}function E7(t){for(var e=[],n=0;n<t.length;++n){for(var r=t[n],a=[],s=0;s<r.length;++s){var l=r[s];if(l)switch(l[0]){case 2:a.push('"'+l[1].replace(/"/g,'""')+'"');break;default:a.push(l[1])}else a.push("")}e.push(a.join(","))}return e.join(";")}var C7={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function b7(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function xS(t,e,n){if(!t)return"SH33TJSERR0";if(n.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var r=t.XTI[e];if(n.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!r)return"SH33TJSERR1";var a="";if(n.biff>8)switch(t[r[0]][0]){case 357:return a=r[1]==-1?"#REF":t.SheetNames[r[1]],r[1]==r[2]?a:a+":"+t.SheetNames[r[2]];case 358:return n.SID!=null?t.SheetNames[n.SID]:"SH33TJSSAME"+t[r[0]][0];case 355:default:return"SH33TJSSRC"+t[r[0]][0]}switch(t[r[0]][0][0]){case 1025:return a=r[1]==-1?"#REF":t.SheetNames[r[1]]||"SH33TJSERR3",r[1]==r[2]?a:a+":"+t.SheetNames[r[2]];case 14849:return t[r[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return t[r[0]][0][3]?(a=r[1]==-1?"#REF":t[r[0]][0][3][r[1]]||"SH33TJSERR4",r[1]==r[2]?a:a+":"+t[r[0]][0][3][r[2]]):"SH33TJSERR2"}}function l2(t,e,n){var r=xS(t,e,n);return r=="#REF"?r:b7(r,n)}function Zn(t,e,n,r,a){var s=a&&a.biff||8,l={s:{c:0,r:0}},c=[],f,d,g,x=0,_=0,T,E="";if(!t[0]||!t[0][0])return"";for(var S=-1,C="",k=0,N=t[0].length;k<N;++k){var b=t[0][k];switch(b[0]){case"PtgUminus":c.push("-"+c.pop());break;case"PtgUplus":c.push("+"+c.pop());break;case"PtgPercent":c.push(c.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(f=c.pop(),d=c.pop(),S>=0){switch(t[0][S][1][0]){case 0:C=sn(" ",t[0][S][1][1]);break;case 1:C=sn("\r",t[0][S][1][1]);break;default:if(C="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][S][1][0])}d=d+C,S=-1}c.push(d+C7[b[0]]+f);break;case"PtgIsect":f=c.pop(),d=c.pop(),c.push(d+" "+f);break;case"PtgUnion":f=c.pop(),d=c.pop(),c.push(d+","+f);break;case"PtgRange":f=c.pop(),d=c.pop(),c.push(d+":"+f);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":g=uc(b[1][1],l,a),c.push(fc(g,s));break;case"PtgRefN":g=n?uc(b[1][1],n,a):b[1][1],c.push(fc(g,s));break;case"PtgRef3d":x=b[1][1],g=uc(b[1][2],l,a),E=l2(r,x,a),c.push(E+"!"+fc(g,s));break;case"PtgFunc":case"PtgFuncVar":var I=b[1][0],F=b[1][1];I||(I=0),I&=127;var P=I==0?[]:c.slice(-I);c.length-=I,F==="User"&&(F=P.shift()),c.push(F+"("+P.join(",")+")");break;case"PtgBool":c.push(b[1]?"TRUE":"FALSE");break;case"PtgInt":c.push(b[1]);break;case"PtgNum":c.push(String(b[1]));break;case"PtgStr":c.push('"'+b[1].replace(/"/g,'""')+'"');break;case"PtgErr":c.push(b[1]);break;case"PtgAreaN":T=O_(b[1][1],n?{s:n}:l,a),c.push(Sh(T,a));break;case"PtgArea":T=O_(b[1][1],l,a),c.push(Sh(T,a));break;case"PtgArea3d":x=b[1][1],T=b[1][2],E=l2(r,x,a),c.push(E+"!"+Sh(T,a));break;case"PtgAttrSum":c.push("SUM("+c.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":_=b[1][2];var D=(r.names||[])[_-1]||(r[0]||[])[_],j=D?D.Name:"SH33TJSNAME"+String(_);j&&j.slice(0,6)=="_xlfn."&&!a.xlfn&&(j=j.slice(6)),c.push(j);break;case"PtgNameX":var B=b[1][1];_=b[1][2];var te;if(a.biff<=5)B<0&&(B=-B),r[B]&&(te=r[B][_]);else{var X="";if(((r[B]||[])[0]||[])[0]==14849||(((r[B]||[])[0]||[])[0]==1025?r[B][_]&&r[B][_].itab>0&&(X=r.SheetNames[r[B][_].itab-1]+"!"):X=r.SheetNames[_-1]+"!"),r[B]&&r[B][_])X+=r[B][_].Name;else if(r[0]&&r[0][_])X+=r[0][_].Name;else{var Z=(xS(r,B,a)||"").split(";;");Z[_-1]?X=Z[_-1]:X+="SH33TJSERRX"}c.push(X);break}te||(te={Name:"SH33TJSERRY"}),c.push(te.Name);break;case"PtgParen":var ye="(",Me=")";if(S>=0){switch(C="",t[0][S][1][0]){case 2:ye=sn(" ",t[0][S][1][1])+ye;break;case 3:ye=sn("\r",t[0][S][1][1])+ye;break;case 4:Me=sn(" ",t[0][S][1][1])+Me;break;case 5:Me=sn("\r",t[0][S][1][1])+Me;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][S][1][0])}S=-1}c.push(ye+c.pop()+Me);break;case"PtgRefErr":c.push("#REF!");break;case"PtgRefErr3d":c.push("#REF!");break;case"PtgExp":g={c:b[1][1],r:b[1][0]};var Se={c:n.c,r:n.r};if(r.sharedf[Je(g)]){var ee=r.sharedf[Je(g)];c.push(Zn(ee,l,Se,r,a))}else{var me=!1;for(f=0;f!=r.arrayf.length;++f)if(d=r.arrayf[f],!(g.c<d[0].s.c||g.c>d[0].e.c)&&!(g.r<d[0].s.r||g.r>d[0].e.r)){c.push(Zn(d[1],l,Se,r,a)),me=!0;break}me||c.push(b[1])}break;case"PtgArray":c.push("{"+E7(b[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":S=k;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":c.push("");break;case"PtgAreaErr":c.push("#REF!");break;case"PtgAreaErr3d":c.push("#REF!");break;case"PtgList":c.push("Table"+b[1].idx+"[#"+b[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(b));default:throw new Error("Unrecognized Formula Token: "+String(b))}var Pe=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&S>=0&&Pe.indexOf(t[0][k][0])==-1){b=t[0][S];var re=!0;switch(b[1][0]){case 4:re=!1;case 0:C=sn(" ",b[1][1]);break;case 5:re=!1;case 1:C=sn("\r",b[1][1]);break;default:if(C="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+b[1][0])}c.push((re?C:"")+c.pop()+(re?"":C)),S=-1}}if(c.length>1&&a.WTF)throw new Error("bad formula stack");return c[0]}function A7(t,e,n){var r=t.l+e,a=n.biff==2?1:2,s,l=t.read_shift(a);if(l==65535)return[[],rr(t,e-2)];var c=qc(t,l,n);return e!==l+a&&(s=zc(t,e-l-a,c,n)),t.l=r,[c,s]}function k7(t,e,n){var r=t.l+e,a=n.biff==2?1:2,s,l=t.read_shift(a);if(l==65535)return[[],rr(t,e-2)];var c=qc(t,l,n);return e!==l+a&&(s=zc(t,e-l-a,c,n)),t.l=r,[c,s]}function N7(t,e,n,r){var a=t.l+e,s=qc(t,r,n),l;return a!==t.l&&(l=zc(t,a-t.l,s,n)),[s,l]}function M7(t,e,n){var r=t.l+e,a,s=t.read_shift(2),l=qc(t,s,n);return s==65535?[[],rr(t,e-2)]:(e!==s+2&&(a=zc(t,r-s-2,l,n)),[l,a])}function D7(t){var e;if($a(t,t.l+6)!==65535)return[er(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return e=t[t.l+2]===1,t.l+=8,[e,"b"];case 2:return e=t[t.l+2],t.l+=8,[e,"e"];case 3:return t.l+=8,["","s"]}return[]}function R7(t){if(t==null){var e=xe(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof t=="number")return _s(t);return _s(0)}function kh(t,e,n){var r=t.l+e,a=ba(t);n.biff==2&&++t.l;var s=D7(t),l=t.read_shift(1);n.biff!=2&&(t.read_shift(1),n.biff>=5&&t.read_shift(4));var c=k7(t,r-t.l,n);return{cell:a,val:s[0],formula:c,shared:l>>3&1,tt:s[1]}}function F7(t,e,n,r,a){var s=ws(e,n,a),l=R7(t.v),c=xe(6),f=33;c.write_shift(2,f),c.write_shift(4,0);for(var d=xe(t.bf.length),g=0;g<t.bf.length;++g)d[g]=t.bf[g];var x=In([s,l,c,d]);return x}function Qf(t,e,n){var r=t.read_shift(4),a=qc(t,r,n),s=t.read_shift(4),l=s>0?zc(t,s,a,n):null;return[a,l]}var I7=Qf,e0=Qf,P7=Qf,L7=Qf,O7={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},vS={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},U7={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function c2(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,n){return n.replace(/\./g,"")}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function B7(t){var e="of:="+t.replace(xp,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function Nh(t){var e=t.split(":"),n=e[0].split(".")[0];return[n,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}function V7(t){return t.replace(/\./,"!")}var hc={},Oo={},mc=typeof Map<"u";function _p(t,e,n){var r=0,a=t.length;if(n){if(mc?n.has(e):Object.prototype.hasOwnProperty.call(n,e)){for(var s=mc?n.get(e):n[e];r<s.length;++r)if(t[s[r]].t===e)return t.Count++,s[r]}}else for(;r<a;++r)if(t[r].t===e)return t.Count++,r;return t[a]={t:e},t.Count++,t.Unique++,n&&(mc?(n.has(e)||n.set(e,[]),n.get(e).push(a)):(Object.prototype.hasOwnProperty.call(n,e)||(n[e]=[]),n[e].push(a))),a}function t0(t,e){var n={min:t+1,max:t+1},r=-1;return e.MDW&&(Qn=e.MDW),e.width!=null?n.customWidth=1:e.wpx!=null?r=kc(e.wpx):e.wch!=null&&(r=e.wch),r>-1?(n.width=Uf(r),n.customWidth=1):e.width!=null&&(n.width=e.width),e.hidden&&(n.hidden=!0),e.level!=null&&(n.outlineLevel=n.level=e.level),n}function ps(t,e){if(t){var n=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(n=[1,1,1,1,.5,.5]),t.left==null&&(t.left=n[0]),t.right==null&&(t.right=n[1]),t.top==null&&(t.top=n[2]),t.bottom==null&&(t.bottom=n[3]),t.header==null&&(t.header=n[4]),t.footer==null&&(t.footer=n[5])}}function Gi(t,e,n){var r=n.revssf[e.z!=null?e.z:"General"],a=60,s=t.length;if(r==null&&n.ssf){for(;a<392;++a)if(n.ssf[a]==null){Ya(e.z,a),n.ssf[a]=e.z,n.revssf[e.z]=r=a;break}}for(a=0;a!=s;++a)if(t[a].numFmtId===r)return a;return t[s]={numFmtId:r,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function yS(t,e,n,r,a,s){try{r.cellNF&&(t.z=Ye[e])}catch(c){if(r.WTF)throw c}if(!(t.t==="z"&&!r.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=Xt(t.v)),(!r||r.cellText!==!1)&&t.t!=="z")try{if(Ye[e]==null&&Ya(OI[e]||"General",e),t.t==="e")t.w=t.w||ni[t.v];else if(e===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=Tc(t.v);else if(t.t==="d"){var l=En(t.v);(l|0)===l?t.w=l.toString(10):t.w=Tc(l)}else{if(t.v===void 0)return"";t.w=vs(t.v,Oo)}else t.t==="d"?t.w=Kr(e,En(t.v),Oo):t.w=Kr(e,t.v,Oo)}catch(c){if(r.WTF)throw c}if(r.cellStyles&&n!=null)try{t.s=s.Fills[n],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=Of(a.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),r.WTF&&(t.s.fgColor.raw_rgb=a.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=Of(a.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),r.WTF&&(t.s.bgColor.raw_rgb=a.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(c){if(r.WTF&&s.Fills)throw c}}}function G7(t,e,n){if(t&&t["!ref"]){var r=xt(t["!ref"]);if(r.e.c<r.s.c||r.e.r<r.s.r)throw new Error("Bad range ("+n+"): "+t["!ref"])}}function H7(t,e){var n=xt(e);n.s.r<=n.e.r&&n.s.c<=n.e.c&&n.s.r>=0&&n.s.c>=0&&(t["!ref"]=rt(n))}var z7=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,q7=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,j7=/<(?:\w:)?hyperlink [^>]*>/mg,$7=/"(\w*:\w*)"/,W7=/<(?:\w:)?col\b[^>]*[\/]?>/g,Y7=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,J7=/<(?:\w:)?pageMargins[^>]*\/>/g,_S=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,X7=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,K7=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function Z7(t,e,n,r,a,s,l){if(!t)return t;r||(r={"!id":{}});var c=e.dense?[]:{},f={s:{r:2e6,c:2e6},e:{r:0,c:0}},d="",g="",x=t.match(q7);x?(d=t.slice(0,x.index),g=t.slice(x.index+x[0].length)):d=g=t;var _=d.match(_S);_?Tp(_[0],c,a,n):(_=d.match(X7))&&e9(_[0],_[1]||"",c,a,n);var T=(d.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(T>0){var E=d.slice(T,T+50).match($7);E&&H7(c,E[1])}var S=d.match(K7);S&&S[1]&&h9(S[1],a);var C=[];if(e.cellStyles){var k=d.match(W7);k&&l9(C,k)}x&&g9(x[1],c,e,f,s,l);var N=g.match(Y7);N&&(c["!autofilter"]=u9(N[0]));var b=[],I=g.match(z7);if(I)for(T=0;T!=I.length;++T)b[T]=xt(I[T].slice(I[T].indexOf('"')+1));var F=g.match(j7);F&&i9(c,F,r);var P=g.match(J7);if(P&&(c["!margins"]=s9(Ze(P[0]))),!c["!ref"]&&f.e.c>=f.s.c&&f.e.r>=f.s.r&&(c["!ref"]=rt(f)),e.sheetRows>0&&c["!ref"]){var D=xt(c["!ref"]);e.sheetRows<=+D.e.r&&(D.e.r=e.sheetRows-1,D.e.r>f.e.r&&(D.e.r=f.e.r),D.e.r<D.s.r&&(D.s.r=D.e.r),D.e.c>f.e.c&&(D.e.c=f.e.c),D.e.c<D.s.c&&(D.s.c=D.e.c),c["!fullref"]=c["!ref"],c["!ref"]=rt(D))}return C.length>0&&(c["!cols"]=C),b.length>0&&(c["!merges"]=b),c}function Q7(t){if(t.length===0)return"";for(var e='<mergeCells count="'+t.length+'">',n=0;n!=t.length;++n)e+='<mergeCell ref="'+rt(t[n])+'"/>';return e+"</mergeCells>"}function Tp(t,e,n,r){var a=Ze(t);n.Sheets[r]||(n.Sheets[r]={}),a.codeName&&(n.Sheets[r].CodeName=gt(Bt(a.codeName)))}function e9(t,e,n,r,a){Tp(t.slice(0,t.indexOf(">")),n,r,a)}function t9(t,e,n,r,a){var s=!1,l={},c=null;if(r.bookType!=="xlsx"&&e.vbaraw){var f=e.SheetNames[n];try{e.Workbook&&(f=e.Workbook.Sheets[n].CodeName||f)}catch{}s=!0,l.codeName=Ea(Dt(f))}if(t&&t["!outline"]){var d={summaryBelow:1,summaryRight:1};t["!outline"].above&&(d.summaryBelow=0),t["!outline"].left&&(d.summaryRight=0),c=(c||"")+Fe("outlinePr",null,d)}!s&&!c||(a[a.length]=Fe("sheetPr",c,l))}var n9=["objects","scenarios","selectLockedCells","selectUnlockedCells"],r9=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function a9(t){var e={sheet:1};return n9.forEach(function(n){t[n]!=null&&t[n]&&(e[n]="1")}),r9.forEach(function(n){t[n]!=null&&!t[n]&&(e[n]="0")}),t.password&&(e.password=mp(t.password).toString(16).toUpperCase()),Fe("sheetProtection",null,e)}function i9(t,e,n){for(var r=Array.isArray(t),a=0;a!=e.length;++a){var s=Ze(Bt(e[a]),!0);if(!s.ref)return;var l=((n||{})["!id"]||[])[s.id];l?(s.Target=l.Target,s.location&&(s.Target+="#"+gt(s.location))):(s.Target="#"+gt(s.location),l={Target:s.Target,TargetMode:"Internal"}),s.Rel=l,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var c=xt(s.ref),f=c.s.r;f<=c.e.r;++f)for(var d=c.s.c;d<=c.e.c;++d){var g=Je({c:d,r:f});r?(t[f]||(t[f]=[]),t[f][d]||(t[f][d]={t:"z",v:void 0}),t[f][d].l=s):(t[g]||(t[g]={t:"z",v:void 0}),t[g].l=s)}}}function s9(t){var e={};return["left","right","top","bottom","header","footer"].forEach(function(n){t[n]&&(e[n]=parseFloat(t[n]))}),e}function o9(t){return ps(t),Fe("pageMargins",null,t)}function l9(t,e){for(var n=!1,r=0;r!=e.length;++r){var a=Ze(e[r],!0);a.hidden&&(a.hidden=Jt(a.hidden));var s=parseInt(a.min,10)-1,l=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!n&&a.width&&(n=!0,pp(a.width)),Pi(a);s<=l;)t[s++]=Kt(a)}}function c9(t,e){for(var n=["<cols>"],r,a=0;a!=e.length;++a)(r=e[a])&&(n[n.length]=Fe("col",null,t0(a,r)));return n[n.length]="</cols>",n.join("")}function u9(t){var e={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return e}function f9(t,e,n,r){var a=typeof t.ref=="string"?t.ref:rt(t.ref);n.Workbook||(n.Workbook={Sheets:[]}),n.Workbook.Names||(n.Workbook.Names=[]);var s=n.Workbook.Names,l=vr(a);l.s.r==l.e.r&&(l.e.r=vr(e["!ref"]).e.r,a=rt(l));for(var c=0;c<s.length;++c){var f=s[c];if(f.Name=="_xlnm._FilterDatabase"&&f.Sheet==r){f.Ref="'"+n.SheetNames[r]+"'!"+a;break}}return c==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+n.SheetNames[r]+"'!"+a}),Fe("autoFilter",null,{ref:a})}var d9=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function h9(t,e){e.Views||(e.Views=[{}]),(t.match(d9)||[]).forEach(function(n,r){var a=Ze(n);e.Views[r]||(e.Views[r]={}),+a.zoomScale&&(e.Views[r].zoom=+a.zoomScale),Jt(a.rightToLeft)&&(e.Views[r].RTL=!0)})}function m9(t,e,n,r){var a={workbookViewId:"0"};return(((r||{}).Workbook||{}).Views||[])[0]&&(a.rightToLeft=r.Workbook.Views[0].RTL?"1":"0"),Fe("sheetViews",Fe("sheetView",null,a),{})}function p9(t,e,n,r){if(t.c&&n["!comments"].push([e,t.c]),t.v===void 0&&typeof t.f!="string"||t.t==="z"&&!t.f)return"";var a="",s=t.t,l=t.v;if(t.t!=="z")switch(t.t){case"b":a=t.v?"1":"0";break;case"n":a=""+t.v;break;case"e":a=ni[t.v];break;case"d":r&&r.cellDates?a=Xt(t.v,-1).toISOString():(t=Kt(t),t.t="n",a=""+(t.v=En(Xt(t.v)))),typeof t.z>"u"&&(t.z=Ye[14]);break;default:a=t.v;break}var c=jn("v",Dt(a)),f={r:e},d=Gi(r.cellXfs,t,r);switch(d!==0&&(f.s=d),t.t){case"n":break;case"d":f.t="d";break;case"b":f.t="b";break;case"e":f.t="e";break;case"z":break;default:if(t.v==null){delete t.t;break}if(t.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(r&&r.bookSST){c=jn("v",""+_p(r.Strings,t.v,r.revStrings)),f.t="s";break}f.t="str";break}if(t.t!=s&&(t.t=s,t.v=l),typeof t.f=="string"&&t.f){var g=t.F&&t.F.slice(0,e.length)==e?{t:"array",ref:t.F}:null;c=Fe("f",Dt(t.f),g)+(t.v!=null?c:"")}return t.l&&n["!links"].push([e,t.l]),t.D&&(f.cm=1),Fe("c",c,f)}var g9=function(){var t=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,n=/r=["']([^"']*)["']/,r=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,s=wc("v"),l=wc("f");return function(f,d,g,x,_,T){for(var E=0,S="",C=[],k=[],N=0,b=0,I=0,F="",P,D,j=0,B=0,te,X,Z=0,ye=0,Me=Array.isArray(T.CellXf),Se,ee=[],me=[],Pe=Array.isArray(d),re=[],z={},ce=!1,L=!!g.sheetStubs,W=f.split(e),q=0,K=W.length;q!=K;++q){S=W[q].trim();var ie=S.length;if(ie!==0){var Ce=0;e:for(E=0;E<ie;++E)switch(S[E]){case">":if(S[E-1]!="/"){++E;break e}if(g&&g.cellStyles){if(D=Ze(S.slice(Ce,E),!0),j=D.r!=null?parseInt(D.r,10):j+1,B=-1,g.sheetRows&&g.sheetRows<j)continue;z={},ce=!1,D.ht&&(ce=!0,z.hpt=parseFloat(D.ht),z.hpx=Go(z.hpt)),D.hidden=="1"&&(ce=!0,z.hidden=!0),D.outlineLevel!=null&&(ce=!0,z.level=+D.outlineLevel),ce&&(re[j-1]=z)}break;case"<":Ce=E;break}if(Ce>=E)break;if(D=Ze(S.slice(Ce,E),!0),j=D.r!=null?parseInt(D.r,10):j+1,B=-1,!(g.sheetRows&&g.sheetRows<j)){x.s.r>j-1&&(x.s.r=j-1),x.e.r<j-1&&(x.e.r=j-1),g&&g.cellStyles&&(z={},ce=!1,D.ht&&(ce=!0,z.hpt=parseFloat(D.ht),z.hpx=Go(z.hpt)),D.hidden=="1"&&(ce=!0,z.hidden=!0),D.outlineLevel!=null&&(ce=!0,z.level=+D.outlineLevel),ce&&(re[j-1]=z)),C=S.slice(E).split(t);for(var Te=0;Te!=C.length&&C[Te].trim().charAt(0)=="<";++Te);for(C=C.slice(Te),E=0;E!=C.length;++E)if(S=C[E].trim(),S.length!==0){if(k=S.match(n),N=E,b=0,I=0,S="<c "+(S.slice(0,1)=="<"?">":"")+S,k!=null&&k.length===2){for(N=0,F=k[1],b=0;b!=F.length&&!((I=F.charCodeAt(b)-64)<1||I>26);++b)N=26*N+I;--N,B=N}else++B;for(b=0;b!=S.length&&S.charCodeAt(b)!==62;++b);if(++b,D=Ze(S.slice(0,b),!0),D.r||(D.r=Je({r:j-1,c:B})),F=S.slice(b),P={t:""},(k=F.match(s))!=null&&k[1]!==""&&(P.v=gt(k[1])),g.cellFormula){if((k=F.match(l))!=null&&k[1]!==""){if(P.f=gt(Bt(k[1])).replace(/\r\n/g,`
`),g.xlfn||(P.f=i2(P.f)),k[0].indexOf('t="array"')>-1)P.F=(F.match(a)||[])[1],P.F.indexOf(":")>-1&&ee.push([xt(P.F),P.F]);else if(k[0].indexOf('t="shared"')>-1){X=Ze(k[0]);var be=gt(Bt(k[1]));g.xlfn||(be=i2(be)),me[parseInt(X.si,10)]=[X,be,D.r]}}else(k=F.match(/<f[^>]*\/>/))&&(X=Ze(k[0]),me[X.si]&&(P.f=dB(me[X.si][1],me[X.si][2],D.r)));var Ae=nn(D.r);for(b=0;b<ee.length;++b)Ae.r>=ee[b][0].s.r&&Ae.r<=ee[b][0].e.r&&Ae.c>=ee[b][0].s.c&&Ae.c<=ee[b][0].e.c&&(P.F=ee[b][1])}if(D.t==null&&P.v===void 0)if(P.f||P.F)P.v=0,P.t="n";else if(L)P.t="z";else continue;else P.t=D.t||"n";switch(x.s.c>B&&(x.s.c=B),x.e.c<B&&(x.e.c=B),P.t){case"n":if(P.v==""||P.v==null){if(!L)continue;P.t="z"}else P.v=parseFloat(P.v);break;case"s":if(typeof P.v>"u"){if(!L)continue;P.t="z"}else te=hc[parseInt(P.v,10)],P.v=te.t,P.r=te.r,g.cellHTML&&(P.h=te.h);break;case"str":P.t="s",P.v=P.v!=null?Bt(P.v):"",g.cellHTML&&(P.h=Qm(P.v));break;case"inlineStr":k=F.match(r),P.t="s",k!=null&&(te=hp(k[1]))?(P.v=te.t,g.cellHTML&&(P.h=te.h)):P.v="";break;case"b":P.v=Jt(P.v);break;case"d":g.cellDates?P.v=Xt(P.v,1):(P.v=En(Xt(P.v,1)),P.t="n");break;case"e":(!g||g.cellText!==!1)&&(P.w=P.v),P.v=ww[P.v];break}if(Z=ye=0,Se=null,Me&&D.s!==void 0&&(Se=T.CellXf[D.s],Se!=null&&(Se.numFmtId!=null&&(Z=Se.numFmtId),g.cellStyles&&Se.fillId!=null&&(ye=Se.fillId))),yS(P,Z,ye,g,_,T),g.cellDates&&Me&&P.t=="n"&&Jo(Ye[Z])&&(P.t="d",P.v=Kf(P.v)),D.cm&&g.xlmeta){var Xe=(g.xlmeta.Cell||[])[+D.cm-1];Xe&&Xe.type=="XLDAPR"&&(P.D=!0)}if(Pe){var Y=nn(D.r);d[Y.r]||(d[Y.r]=[]),d[Y.r][Y.c]=P}else d[D.r]=P}}}}re.length>0&&(d["!rows"]=re)}}();function x9(t,e,n,r){var a=[],s=[],l=xt(t["!ref"]),c="",f,d="",g=[],x=0,_=0,T=t["!rows"],E=Array.isArray(t),S={r:d},C,k=-1;for(_=l.s.c;_<=l.e.c;++_)g[_]=tn(_);for(x=l.s.r;x<=l.e.r;++x){for(s=[],d=mn(x),_=l.s.c;_<=l.e.c;++_){f=g[_]+d;var N=E?(t[x]||[])[_]:t[f];N!==void 0&&(c=p9(N,f,t,e))!=null&&s.push(c)}(s.length>0||T&&T[x])&&(S={r:d},T&&T[x]&&(C=T[x],C.hidden&&(S.hidden=1),k=-1,C.hpx?k=Nc(C.hpx):C.hpt&&(k=C.hpt),k>-1&&(S.ht=k,S.customHeight=1),C.level&&(S.outlineLevel=C.level)),a[a.length]=Fe("row",s.join(""),S))}if(T)for(;x<T.length;++x)T&&T[x]&&(S={r:x+1},C=T[x],C.hidden&&(S.hidden=1),k=-1,C.hpx?k=Nc(C.hpx):C.hpt&&(k=C.hpt),k>-1&&(S.ht=k,S.customHeight=1),C.level&&(S.outlineLevel=C.level),a[a.length]=Fe("row","",S));return a.join("")}function TS(t,e,n,r){var a=[pn,Fe("worksheet",null,{xmlns:bs[0],"xmlns:r":Sn.r})],s=n.SheetNames[t],l=0,c="",f=n.Sheets[s];f==null&&(f={});var d=f["!ref"]||"A1",g=xt(d);if(g.e.c>16383||g.e.r>1048575){if(e.WTF)throw new Error("Range "+d+" exceeds format limit A1:XFD1048576");g.e.c=Math.min(g.e.c,16383),g.e.r=Math.min(g.e.c,1048575),d=rt(g)}r||(r={}),f["!comments"]=[];var x=[];t9(f,n,t,e,a),a[a.length]=Fe("dimension",null,{ref:d}),a[a.length]=m9(f,e,t,n),e.sheetFormat&&(a[a.length]=Fe("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),f["!cols"]!=null&&f["!cols"].length>0&&(a[a.length]=c9(f,f["!cols"])),a[l=a.length]="<sheetData/>",f["!links"]=[],f["!ref"]!=null&&(c=x9(f,e),c.length>0&&(a[a.length]=c)),a.length>l+1&&(a[a.length]="</sheetData>",a[l]=a[l].replace("/>",">")),f["!protect"]&&(a[a.length]=a9(f["!protect"])),f["!autofilter"]!=null&&(a[a.length]=f9(f["!autofilter"],f,n,t)),f["!merges"]!=null&&f["!merges"].length>0&&(a[a.length]=Q7(f["!merges"]));var _=-1,T,E=-1;return f["!links"].length>0&&(a[a.length]="<hyperlinks>",f["!links"].forEach(function(S){S[1].Target&&(T={ref:S[0]},S[1].Target.charAt(0)!="#"&&(E=Mt(r,-1,Dt(S[1].Target).replace(/#.*$/,""),ut.HLINK),T["r:id"]="rId"+E),(_=S[1].Target.indexOf("#"))>-1&&(T.location=Dt(S[1].Target.slice(_+1))),S[1].Tooltip&&(T.tooltip=Dt(S[1].Tooltip)),a[a.length]=Fe("hyperlink",null,T))}),a[a.length]="</hyperlinks>"),delete f["!links"],f["!margins"]!=null&&(a[a.length]=o9(f["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(a[a.length]=jn("ignoredErrors",Fe("ignoredError",null,{numberStoredAsText:1,sqref:d}))),x.length>0&&(E=Mt(r,-1,"../drawings/drawing"+(t+1)+".xml",ut.DRAW),a[a.length]=Fe("drawing",null,{"r:id":"rId"+E}),f["!drawing"]=x),f["!comments"].length>0&&(E=Mt(r,-1,"../drawings/vmlDrawing"+(t+1)+".vml",ut.VML),a[a.length]=Fe("legacyDrawing",null,{"r:id":"rId"+E}),f["!legacy"]=E),a.length>1&&(a[a.length]="</worksheet>",a[1]=a[1].replace("/>",">")),a.join("")}function v9(t,e){var n={},r=t.l+e;n.r=t.read_shift(4),t.l+=4;var a=t.read_shift(2);t.l+=1;var s=t.read_shift(1);return t.l=r,s&7&&(n.level=s&7),s&16&&(n.hidden=!0),s&32&&(n.hpt=a/20),n}function y9(t,e,n){var r=xe(145),a=(n["!rows"]||[])[t]||{};r.write_shift(4,t),r.write_shift(4,0);var s=320;a.hpx?s=Nc(a.hpx)*20:a.hpt&&(s=a.hpt*20),r.write_shift(2,s),r.write_shift(1,0);var l=0;a.level&&(l|=a.level),a.hidden&&(l|=16),(a.hpx||a.hpt)&&(l|=32),r.write_shift(1,l),r.write_shift(1,0);var c=0,f=r.l;r.l+=4;for(var d={r:t,c:0},g=0;g<16;++g)if(!(e.s.c>g+1<<10||e.e.c<g<<10)){for(var x=-1,_=-1,T=g<<10;T<g+1<<10;++T){d.c=T;var E=Array.isArray(n)?(n[d.r]||[])[d.c]:n[Je(d)];E&&(x<0&&(x=T),_=T)}x<0||(++c,r.write_shift(4,x),r.write_shift(4,_))}var S=r.l;return r.l=f,r.write_shift(4,c),r.l=S,r.length>r.l?r.slice(0,r.l):r}function _9(t,e,n,r){var a=y9(r,n,e);(a.length>17||(e["!rows"]||[])[r])&&Ee(t,0,a)}var T9=Ms,w9=Zo;function S9(){}function E9(t,e){var n={},r=t[t.l];return++t.l,n.above=!(r&64),n.left=!(r&128),t.l+=18,n.name=A5(t),n}function C9(t,e,n){n==null&&(n=xe(84+4*t.length));var r=192;e&&(e.above&&(r&=-65),e.left&&(r&=-129)),n.write_shift(1,r);for(var a=1;a<3;++a)n.write_shift(1,0);return If({auto:1},n),n.write_shift(-4,-1),n.write_shift(-4,-1),xw(t,n),n.slice(0,n.l)}function b9(t){var e=Zr(t);return[e]}function A9(t,e,n){return n==null&&(n=xe(8)),As(e,n)}function k9(t){var e=ks(t);return[e]}function N9(t,e,n){return n==null&&(n=xe(4)),Ns(e,n)}function M9(t){var e=Zr(t),n=t.read_shift(1);return[e,n,"b"]}function D9(t,e,n){return n==null&&(n=xe(9)),As(e,n),n.write_shift(1,t.v?1:0),n}function R9(t){var e=ks(t),n=t.read_shift(1);return[e,n,"b"]}function F9(t,e,n){return n==null&&(n=xe(5)),Ns(e,n),n.write_shift(1,t.v?1:0),n}function I9(t){var e=Zr(t),n=t.read_shift(1);return[e,n,"e"]}function P9(t,e,n){return n==null&&(n=xe(9)),As(e,n),n.write_shift(1,t.v),n}function L9(t){var e=ks(t),n=t.read_shift(1);return[e,n,"e"]}function O9(t,e,n){return n==null&&(n=xe(8)),Ns(e,n),n.write_shift(1,t.v),n.write_shift(2,0),n.write_shift(1,0),n}function U9(t){var e=Zr(t),n=t.read_shift(4);return[e,n,"s"]}function B9(t,e,n){return n==null&&(n=xe(12)),As(e,n),n.write_shift(4,e.v),n}function V9(t){var e=ks(t),n=t.read_shift(4);return[e,n,"s"]}function G9(t,e,n){return n==null&&(n=xe(8)),Ns(e,n),n.write_shift(4,e.v),n}function H9(t){var e=Zr(t),n=er(t);return[e,n,"n"]}function z9(t,e,n){return n==null&&(n=xe(16)),As(e,n),_s(t.v,n),n}function wS(t){var e=ks(t),n=er(t);return[e,n,"n"]}function q9(t,e,n){return n==null&&(n=xe(12)),Ns(e,n),_s(t.v,n),n}function j9(t){var e=Zr(t),n=lp(t);return[e,n,"n"]}function $9(t,e,n){return n==null&&(n=xe(12)),As(e,n),vw(t.v,n),n}function W9(t){var e=ks(t),n=lp(t);return[e,n,"n"]}function Y9(t,e,n){return n==null&&(n=xe(8)),Ns(e,n),vw(t.v,n),n}function J9(t){var e=Zr(t),n=ip(t);return[e,n,"is"]}function X9(t){var e=Zr(t),n=nr(t);return[e,n,"str"]}function K9(t,e,n){return n==null&&(n=xe(12+4*t.v.length)),As(e,n),Pn(t.v,n),n.length>n.l?n.slice(0,n.l):n}function Z9(t){var e=ks(t),n=nr(t);return[e,n,"str"]}function Q9(t,e,n){return n==null&&(n=xe(8+4*t.v.length)),Ns(e,n),Pn(t.v,n),n.length>n.l?n.slice(0,n.l):n}function eV(t,e,n){var r=t.l+e,a=Zr(t);a.r=n["!row"];var s=t.read_shift(1),l=[a,s,"b"];if(n.cellFormula){t.l+=2;var c=e0(t,r-t.l,n);l[3]=Zn(c,null,a,n.supbooks,n)}else t.l=r;return l}function tV(t,e,n){var r=t.l+e,a=Zr(t);a.r=n["!row"];var s=t.read_shift(1),l=[a,s,"e"];if(n.cellFormula){t.l+=2;var c=e0(t,r-t.l,n);l[3]=Zn(c,null,a,n.supbooks,n)}else t.l=r;return l}function nV(t,e,n){var r=t.l+e,a=Zr(t);a.r=n["!row"];var s=er(t),l=[a,s,"n"];if(n.cellFormula){t.l+=2;var c=e0(t,r-t.l,n);l[3]=Zn(c,null,a,n.supbooks,n)}else t.l=r;return l}function rV(t,e,n){var r=t.l+e,a=Zr(t);a.r=n["!row"];var s=nr(t),l=[a,s,"str"];if(n.cellFormula){t.l+=2;var c=e0(t,r-t.l,n);l[3]=Zn(c,null,a,n.supbooks,n)}else t.l=r;return l}var aV=Ms,iV=Zo;function sV(t,e){return e==null&&(e=xe(4)),e.write_shift(4,t),e}function oV(t,e){var n=t.l+e,r=Ms(t),a=sp(t),s=nr(t),l=nr(t),c=nr(t);t.l=n;var f={rfx:r,relId:a,loc:s,display:c};return l&&(f.Tooltip=l),f}function lV(t,e){var n=xe(50+4*(t[1].Target.length+(t[1].Tooltip||"").length));Zo({s:nn(t[0]),e:nn(t[0])},n),op("rId"+e,n);var r=t[1].Target.indexOf("#"),a=r==-1?"":t[1].Target.slice(r+1);return Pn(a||"",n),Pn(t[1].Tooltip||"",n),Pn("",n),n.slice(0,n.l)}function cV(){}function uV(t,e,n){var r=t.l+e,a=yw(t),s=t.read_shift(1),l=[a];if(l[2]=s,n.cellFormula){var c=I7(t,r-t.l,n);l[1]=c}else t.l=r;return l}function fV(t,e,n){var r=t.l+e,a=Ms(t),s=[a];if(n.cellFormula){var l=L7(t,r-t.l,n);s[1]=l,t.l=r}else t.l=r;return s}function dV(t,e,n){n==null&&(n=xe(18));var r=t0(t,e);n.write_shift(-4,t),n.write_shift(-4,t),n.write_shift(4,(r.width||10)*256),n.write_shift(4,0);var a=0;return e.hidden&&(a|=1),typeof r.width=="number"&&(a|=2),e.level&&(a|=e.level<<8),n.write_shift(2,a),n}var SS=["left","right","top","bottom","header","footer"];function hV(t){var e={};return SS.forEach(function(n){e[n]=er(t)}),e}function mV(t,e){return e==null&&(e=xe(6*8)),ps(t),SS.forEach(function(n){_s(t[n],e)}),e}function pV(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function gV(t,e,n){n==null&&(n=xe(30));var r=924;return(((e||{}).Views||[])[0]||{}).RTL&&(r|=32),n.write_shift(2,r),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(1,0),n.write_shift(1,0),n.write_shift(2,0),n.write_shift(2,100),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(4,0),n}function xV(t){var e=xe(24);return e.write_shift(4,4),e.write_shift(4,1),Zo(t,e),e}function vV(t,e){return e==null&&(e=xe(16*4+2)),e.write_shift(2,t.password?mp(t.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(n){n[1]?e.write_shift(4,t[n[0]]!=null&&!t[n[0]]?1:0):e.write_shift(4,t[n[0]]!=null&&t[n[0]]?0:1)}),e}function yV(){}function _V(){}function TV(t,e,n,r,a,s,l){if(!t)return t;var c=e||{};r||(r={"!id":{}});var f=c.dense?[]:{},d,g={s:{r:2e6,c:2e6},e:{r:0,c:0}},x=!1,_=!1,T,E,S,C,k,N,b,I,F,P=[];c.biff=12,c["!row"]=0;var D=0,j=!1,B=[],te={},X=c.supbooks||a.supbooks||[[]];if(X.sharedf=te,X.arrayf=B,X.SheetNames=a.SheetNames||a.Sheets.map(function(Pe){return Pe.name}),!c.supbooks&&(c.supbooks=X,a.Names))for(var Z=0;Z<a.Names.length;++Z)X[0][Z+1]=a.Names[Z];var ye=[],Me=[],Se=!1;Mc[16]={n:"BrtShortReal",f:wS};var ee;if(ti(t,function(re,z,ce){if(!_)switch(ce){case 148:d=re;break;case 0:T=re,c.sheetRows&&c.sheetRows<=T.r&&(_=!0),I=mn(C=T.r),c["!row"]=T.r,(re.hidden||re.hpt||re.level!=null)&&(re.hpt&&(re.hpx=Go(re.hpt)),Me[re.r]=re);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(E={t:re[2]},re[2]){case"n":E.v=re[1];break;case"s":b=hc[re[1]],E.v=b.t,E.r=b.r;break;case"b":E.v=!!re[1];break;case"e":E.v=re[1],c.cellText!==!1&&(E.w=ni[E.v]);break;case"str":E.t="s",E.v=re[1];break;case"is":E.t="s",E.v=re[1].t;break}if((S=l.CellXf[re[0].iStyleRef])&&yS(E,S.numFmtId,null,c,s,l),k=re[0].c==-1?k+1:re[0].c,c.dense?(f[C]||(f[C]=[]),f[C][k]=E):f[tn(k)+I]=E,c.cellFormula){for(j=!1,D=0;D<B.length;++D){var L=B[D];T.r>=L[0].s.r&&T.r<=L[0].e.r&&k>=L[0].s.c&&k<=L[0].e.c&&(E.F=rt(L[0]),j=!0)}!j&&re.length>3&&(E.f=re[3])}if(g.s.r>T.r&&(g.s.r=T.r),g.s.c>k&&(g.s.c=k),g.e.r<T.r&&(g.e.r=T.r),g.e.c<k&&(g.e.c=k),c.cellDates&&S&&E.t=="n"&&Jo(Ye[S.numFmtId])){var W=fs(E.v);W&&(E.t="d",E.v=new Date(W.y,W.m-1,W.d,W.H,W.M,W.S,W.u))}ee&&(ee.type=="XLDAPR"&&(E.D=!0),ee=void 0);break;case 1:case 12:if(!c.sheetStubs||x)break;E={t:"z",v:void 0},k=re[0].c==-1?k+1:re[0].c,c.dense?(f[C]||(f[C]=[]),f[C][k]=E):f[tn(k)+I]=E,g.s.r>T.r&&(g.s.r=T.r),g.s.c>k&&(g.s.c=k),g.e.r<T.r&&(g.e.r=T.r),g.e.c<k&&(g.e.c=k),ee&&(ee.type=="XLDAPR"&&(E.D=!0),ee=void 0);break;case 176:P.push(re);break;case 49:ee=((c.xlmeta||{}).Cell||[])[re-1];break;case 494:var q=r["!id"][re.relId];for(q?(re.Target=q.Target,re.loc&&(re.Target+="#"+re.loc),re.Rel=q):re.relId==""&&(re.Target="#"+re.loc),C=re.rfx.s.r;C<=re.rfx.e.r;++C)for(k=re.rfx.s.c;k<=re.rfx.e.c;++k)c.dense?(f[C]||(f[C]=[]),f[C][k]||(f[C][k]={t:"z",v:void 0}),f[C][k].l=re):(N=Je({c:k,r:C}),f[N]||(f[N]={t:"z",v:void 0}),f[N].l=re);break;case 426:if(!c.cellFormula)break;B.push(re),F=c.dense?f[C][k]:f[tn(k)+I],F.f=Zn(re[1],g,{r:T.r,c:k},X,c),F.F=rt(re[0]);break;case 427:if(!c.cellFormula)break;te[Je(re[0].s)]=re[1],F=c.dense?f[C][k]:f[tn(k)+I],F.f=Zn(re[1],g,{r:T.r,c:k},X,c);break;case 60:if(!c.cellStyles)break;for(;re.e>=re.s;)ye[re.e--]={width:re.w/256,hidden:!!(re.flags&1),level:re.level},Se||(Se=!0,pp(re.w/256)),Pi(ye[re.e+1]);break;case 161:f["!autofilter"]={ref:rt(re)};break;case 476:f["!margins"]=re;break;case 147:a.Sheets[n]||(a.Sheets[n]={}),re.name&&(a.Sheets[n].CodeName=re.name),(re.above||re.left)&&(f["!outline"]={above:re.above,left:re.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),re.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:x=!0;break;case 36:x=!1;break;case 37:x=!0;break;case 38:x=!1;break;default:if(!z.T){if(!x||c.WTF)throw new Error("Unexpected record 0x"+ce.toString(16))}}},c),delete c.supbooks,delete c["!row"],!f["!ref"]&&(g.s.r<2e6||d&&(d.e.r>0||d.e.c>0||d.s.r>0||d.s.c>0))&&(f["!ref"]=rt(d||g)),c.sheetRows&&f["!ref"]){var me=xt(f["!ref"]);c.sheetRows<=+me.e.r&&(me.e.r=c.sheetRows-1,me.e.r>g.e.r&&(me.e.r=g.e.r),me.e.r<me.s.r&&(me.s.r=me.e.r),me.e.c>g.e.c&&(me.e.c=g.e.c),me.e.c<me.s.c&&(me.s.c=me.e.c),f["!fullref"]=f["!ref"],f["!ref"]=rt(me))}return P.length>0&&(f["!merges"]=P),ye.length>0&&(f["!cols"]=ye),Me.length>0&&(f["!rows"]=Me),f}function wV(t,e,n,r,a,s,l){if(e.v===void 0)return!1;var c="";switch(e.t){case"b":c=e.v?"1":"0";break;case"d":e=Kt(e),e.z=e.z||Ye[14],e.v=En(Xt(e.v)),e.t="n";break;case"n":case"e":c=""+e.v;break;default:c=e.v;break}var f={r:n,c:r};switch(f.s=Gi(a.cellXfs,e,a),e.l&&s["!links"].push([Je(f),e.l]),e.c&&s["!comments"].push([Je(f),e.c]),e.t){case"s":case"str":return a.bookSST?(c=_p(a.Strings,e.v,a.revStrings),f.t="s",f.v=c,l?Ee(t,18,G9(e,f)):Ee(t,7,B9(e,f))):(f.t="str",l?Ee(t,17,Q9(e,f)):Ee(t,6,K9(e,f))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?l?Ee(t,13,Y9(e,f)):Ee(t,2,$9(e,f)):l?Ee(t,16,q9(e,f)):Ee(t,5,z9(e,f)),!0;case"b":return f.t="b",l?Ee(t,15,F9(e,f)):Ee(t,4,D9(e,f)),!0;case"e":return f.t="e",l?Ee(t,14,O9(e,f)):Ee(t,3,P9(e,f)),!0}return l?Ee(t,12,N9(e,f)):Ee(t,1,A9(e,f)),!0}function SV(t,e,n,r){var a=xt(e["!ref"]||"A1"),s,l="",c=[];Ee(t,145);var f=Array.isArray(e),d=a.e.r;e["!rows"]&&(d=Math.max(a.e.r,e["!rows"].length-1));for(var g=a.s.r;g<=d;++g){l=mn(g),_9(t,e,a,g);var x=!1;if(g<=a.e.r)for(var _=a.s.c;_<=a.e.c;++_){g===a.s.r&&(c[_]=tn(_)),s=c[_]+l;var T=f?(e[g]||[])[_]:e[s];if(!T){x=!1;continue}x=wV(t,T,g,_,r,e,x)}}Ee(t,146)}function EV(t,e){!e||!e["!merges"]||(Ee(t,177,sV(e["!merges"].length)),e["!merges"].forEach(function(n){Ee(t,176,iV(n))}),Ee(t,178))}function CV(t,e){!e||!e["!cols"]||(Ee(t,390),e["!cols"].forEach(function(n,r){n&&Ee(t,60,dV(r,n))}),Ee(t,391))}function bV(t,e){!e||!e["!ref"]||(Ee(t,648),Ee(t,649,xV(xt(e["!ref"]))),Ee(t,650))}function AV(t,e,n){e["!links"].forEach(function(r){if(r[1].Target){var a=Mt(n,-1,r[1].Target.replace(/#.*$/,""),ut.HLINK);Ee(t,494,lV(r,a))}}),delete e["!links"]}function kV(t,e,n,r){if(e["!comments"].length>0){var a=Mt(r,-1,"../drawings/vmlDrawing"+(n+1)+".vml",ut.VML);Ee(t,551,op("rId"+a)),e["!legacy"]=a}}function NV(t,e,n,r){if(e["!autofilter"]){var a=e["!autofilter"],s=typeof a.ref=="string"?a.ref:rt(a.ref);n.Workbook||(n.Workbook={Sheets:[]}),n.Workbook.Names||(n.Workbook.Names=[]);var l=n.Workbook.Names,c=vr(s);c.s.r==c.e.r&&(c.e.r=vr(e["!ref"]).e.r,s=rt(c));for(var f=0;f<l.length;++f){var d=l[f];if(d.Name=="_xlnm._FilterDatabase"&&d.Sheet==r){d.Ref="'"+n.SheetNames[r]+"'!"+s;break}}f==l.length&&l.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+n.SheetNames[r]+"'!"+s}),Ee(t,161,Zo(xt(s))),Ee(t,162)}}function MV(t,e,n){Ee(t,133),Ee(t,137,gV(e,n)),Ee(t,138),Ee(t,134)}function DV(t,e){e["!protect"]&&Ee(t,535,vV(e["!protect"]))}function RV(t,e,n,r){var a=xr(),s=n.SheetNames[t],l=n.Sheets[s]||{},c=s;try{n&&n.Workbook&&(c=n.Workbook.Sheets[t].CodeName||c)}catch{}var f=xt(l["!ref"]||"A1");if(f.e.c>16383||f.e.r>1048575){if(e.WTF)throw new Error("Range "+(l["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");f.e.c=Math.min(f.e.c,16383),f.e.r=Math.min(f.e.c,1048575)}return l["!links"]=[],l["!comments"]=[],Ee(a,129),(n.vbaraw||l["!outline"])&&Ee(a,147,C9(c,l["!outline"])),Ee(a,148,w9(f)),MV(a,l,n.Workbook),CV(a,l),SV(a,l,t,e),DV(a,l),NV(a,l,n,t),EV(a,l),AV(a,l,r),l["!margins"]&&Ee(a,476,mV(l["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&bV(a,l),kV(a,l,t,r),Ee(a,130),a.end()}function FV(t){var e=[],n=t.match(/^<c:numCache>/),r;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var l=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);l&&(e[+l[1]]=n?+l[2]:l[2])});var a=gt((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){r=s.replace(/<.*?>/g,"")}),[e,a,r]}function IV(t,e,n,r,a,s){var l=s||{"!type":"chart"};if(!t)return s;var c=0,f=0,d="A",g={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(x){var _=FV(x);g.s.r=g.s.c=0,g.e.c=c,d=tn(c),_[0].forEach(function(T,E){l[d+mn(E)]={t:"n",v:T,z:_[1]},f=E}),g.e.r<f&&(g.e.r=f),++c}),c>0&&(l["!ref"]=rt(g)),l}function PV(t,e,n,r,a){if(!t)return t;r||(r={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},l,c=t.match(_S);return c&&Tp(c[0],s,a,n),(l=t.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=l[1]),r["!id"][s["!rel"]]&&(s["!drawel"]=r["!id"][s["!rel"]]),s}function LV(t,e){t.l+=10;var n=nr(t);return{name:n}}function OV(t,e,n,r,a){if(!t)return t;r||(r={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},l=!1;return ti(t,function(f,d,g){switch(g){case 550:s["!rel"]=f;break;case 651:a.Sheets[n]||(a.Sheets[n]={}),f.name&&(a.Sheets[n].CodeName=f.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:break;case 38:break;default:if(!(d.T>0)){if(!(d.T<0)){if(!l||e.WTF)throw new Error("Unexpected record 0x"+g.toString(16))}}}},e),r["!id"][s["!rel"]]&&(s["!drawel"]=r["!id"][s["!rel"]]),s}var wp=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],UV=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],BV=[],VV=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function u2(t,e){for(var n=0;n!=t.length;++n)for(var r=t[n],a=0;a!=e.length;++a){var s=e[a];if(r[s[0]]==null)r[s[0]]=s[1];else switch(s[2]){case"bool":typeof r[s[0]]=="string"&&(r[s[0]]=Jt(r[s[0]]));break;case"int":typeof r[s[0]]=="string"&&(r[s[0]]=parseInt(r[s[0]],10));break}}}function f2(t,e){for(var n=0;n!=e.length;++n){var r=e[n];if(t[r[0]]==null)t[r[0]]=r[1];else switch(r[2]){case"bool":typeof t[r[0]]=="string"&&(t[r[0]]=Jt(t[r[0]]));break;case"int":typeof t[r[0]]=="string"&&(t[r[0]]=parseInt(t[r[0]],10));break}}}function ES(t){f2(t.WBProps,wp),f2(t.CalcPr,VV),u2(t.WBView,UV),u2(t.Sheets,BV),Oo.date1904=Jt(t.WBProps.date1904)}function GV(t){return!t.Workbook||!t.Workbook.WBProps?"false":Jt(t.Workbook.WBProps.date1904)?"true":"false"}var HV="][*?/\\".split("");function CS(t,e){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var n=!0;return HV.forEach(function(r){if(t.indexOf(r)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),n}function zV(t,e,n){t.forEach(function(r,a){CS(r);for(var s=0;s<a;++s)if(r==t[s])throw new Error("Duplicate Sheet Name: "+r);if(n){var l=e&&e[a]&&e[a].CodeName||r;if(l.charCodeAt(0)==95&&l.length>22)throw new Error("Bad Code Name: Worksheet"+l)}})}function qV(t){if(!t||!t.SheetNames||!t.Sheets)throw new Error("Invalid Workbook");if(!t.SheetNames.length)throw new Error("Workbook is empty");var e=t.Workbook&&t.Workbook.Sheets||[];zV(t.SheetNames,e,!!t.vbaraw);for(var n=0;n<t.SheetNames.length;++n)G7(t.Sheets[t.SheetNames[n]],t.SheetNames[n],n)}var jV=/<\w+:workbook/;function $V(t,e){if(!t)throw new Error("Could not find file");var n={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},r=!1,a="xmlns",s={},l=0;if(t.replace(ar,function(f,d){var g=Ze(f);switch(Ca(g[0])){case"<?xml":break;case"<workbook":f.match(jV)&&(a="xmlns"+f.match(/<(\w+):/)[1]),n.xmlns=g[a];break;case"</workbook>":break;case"<fileVersion":delete g[0],n.AppVersion=g;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":wp.forEach(function(x){if(g[x[0]]!=null)switch(x[2]){case"bool":n.WBProps[x[0]]=Jt(g[x[0]]);break;case"int":n.WBProps[x[0]]=parseInt(g[x[0]],10);break;default:n.WBProps[x[0]]=g[x[0]]}}),g.codeName&&(n.WBProps.CodeName=Bt(g.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete g[0],n.WBView.push(g);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(g.state){case"hidden":g.Hidden=1;break;case"veryHidden":g.Hidden=2;break;default:g.Hidden=0}delete g.state,g.name=gt(Bt(g.name)),delete g[0],n.Sheets.push(g);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":r=!0;break;case"</definedNames>":r=!1;break;case"<definedName":s={},s.Name=Bt(g.name),g.comment&&(s.Comment=g.comment),g.localSheetId&&(s.Sheet=+g.localSheetId),Jt(g.hidden||"0")&&(s.Hidden=!0),l=d+f.length;break;case"</definedName>":s.Ref=gt(Bt(t.slice(l,d))),n.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete g[0],n.CalcPr=g;break;case"<calcPr/>":delete g[0],n.CalcPr=g;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":r=!0;break;case"</AlternateContent>":r=!1;break;case"<revisionPtr":break;default:if(!r&&e.WTF)throw new Error("unrecognized "+g[0]+" in workbook")}return f}),bs.indexOf(n.xmlns)===-1)throw new Error("Unknown Namespace: "+n.xmlns);return ES(n),n}function bS(t){var e=[pn];e[e.length]=Fe("workbook",null,{xmlns:bs[0],"xmlns:r":Sn.r});var n=t.Workbook&&(t.Workbook.Names||[]).length>0,r={codeName:"ThisWorkbook"};t.Workbook&&t.Workbook.WBProps&&(wp.forEach(function(c){t.Workbook.WBProps[c[0]]!=null&&t.Workbook.WBProps[c[0]]!=c[1]&&(r[c[0]]=t.Workbook.WBProps[c[0]])}),t.Workbook.WBProps.CodeName&&(r.codeName=t.Workbook.WBProps.CodeName,delete r.CodeName)),e[e.length]=Fe("workbookPr",null,r);var a=t.Workbook&&t.Workbook.Sheets||[],s=0;if(a&&a[0]&&a[0].Hidden){for(e[e.length]="<bookViews>",s=0;s!=t.SheetNames.length&&!(!a[s]||!a[s].Hidden);++s);s==t.SheetNames.length&&(s=0),e[e.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",s=0;s!=t.SheetNames.length;++s){var l={name:Dt(t.SheetNames[s].slice(0,31))};if(l.sheetId=""+(s+1),l["r:id"]="rId"+(s+1),a[s])switch(a[s].Hidden){case 1:l.state="hidden";break;case 2:l.state="veryHidden";break}e[e.length]=Fe("sheet",null,l)}return e[e.length]="</sheets>",n&&(e[e.length]="<definedNames>",t.Workbook&&t.Workbook.Names&&t.Workbook.Names.forEach(function(c){var f={name:c.Name};c.Comment&&(f.comment=c.Comment),c.Sheet!=null&&(f.localSheetId=""+c.Sheet),c.Hidden&&(f.hidden="1"),c.Ref&&(e[e.length]=Fe("definedName",Dt(c.Ref),f))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function WV(t,e){var n={};return n.Hidden=t.read_shift(4),n.iTabID=t.read_shift(4),n.strRelID=rm(t),n.name=nr(t),n}function YV(t,e){return e||(e=xe(127)),e.write_shift(4,t.Hidden),e.write_shift(4,t.iTabID),op(t.strRelID,e),Pn(t.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function JV(t,e){var n={},r=t.read_shift(4);n.defaultThemeVersion=t.read_shift(4);var a=e>8?nr(t):"";return a.length>0&&(n.CodeName=a),n.autoCompressPictures=!!(r&65536),n.backupFile=!!(r&64),n.checkCompatibility=!!(r&4096),n.date1904=!!(r&1),n.filterPrivacy=!!(r&8),n.hidePivotFieldList=!!(r&1024),n.promptedSolutions=!!(r&16),n.publishItems=!!(r&2048),n.refreshAllConnections=!!(r&262144),n.saveExternalLinkValues=!!(r&128),n.showBorderUnselectedTables=!!(r&4),n.showInkAnnotation=!!(r&32),n.showObjects=["all","placeholders","none"][r>>13&3],n.showPivotChartFilter=!!(r&32768),n.updateLinks=["userSet","never","always"][r>>8&3],n}function XV(t,e){e||(e=xe(72));var n=0;return t&&t.filterPrivacy&&(n|=8),e.write_shift(4,n),e.write_shift(4,0),xw(t&&t.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function KV(t,e){var n={};return t.read_shift(4),n.ArchID=t.read_shift(4),t.l+=e-8,n}function ZV(t,e,n){var r=t.l+e;t.l+=4,t.l+=1;var a=t.read_shift(4),s=k5(t),l=P7(t,0,n),c=sp(t);t.l=r;var f={Name:s,Ptg:l};return a<268435455&&(f.Sheet=a),c&&(f.Comment=c),f}function QV(t,e){var n={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},r=[],a=!1;e||(e={}),e.biff=12;var s=[],l=[[]];return l.SheetNames=[],l.XTI=[],Mc[16]={n:"BrtFRTArchID$",f:KV},ti(t,function(f,d,g){switch(g){case 156:l.SheetNames.push(f.name),n.Sheets.push(f);break;case 153:n.WBProps=f;break;case 39:f.Sheet!=null&&(e.SID=f.Sheet),f.Ref=Zn(f.Ptg,null,null,l,e),delete e.SID,delete f.Ptg,s.push(f);break;case 1036:break;case 357:case 358:case 355:case 667:l[0].length?l.push([g,f]):l[0]=[g,f],l[l.length-1].XTI=[];break;case 362:l.length===0&&(l[0]=[],l[0].XTI=[]),l[l.length-1].XTI=l[l.length-1].XTI.concat(f),l.XTI=l.XTI.concat(f);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:r.push(g),a=!0;break;case 36:r.pop(),a=!1;break;case 37:r.push(g),a=!0;break;case 38:r.pop(),a=!1;break;case 16:break;default:if(!d.T){if(!a||e.WTF&&r[r.length-1]!=37&&r[r.length-1]!=35)throw new Error("Unexpected record 0x"+g.toString(16))}}},e),ES(n),n.Names=s,n.supbooks=l,n}function eG(t,e){Ee(t,143);for(var n=0;n!=e.SheetNames.length;++n){var r=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[n]&&e.Workbook.Sheets[n].Hidden||0,a={Hidden:r,iTabID:n+1,strRelID:"rId"+(n+1),name:e.SheetNames[n]};Ee(t,156,YV(a))}Ee(t,144)}function tG(t,e){e||(e=xe(127));for(var n=0;n!=4;++n)e.write_shift(4,0);return Pn("SheetJS",e),Pn(Af.version,e),Pn(Af.version,e),Pn("7262",e),e.length>e.l?e.slice(0,e.l):e}function nG(t,e){e||(e=xe(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,t),e.write_shift(4,t);var n=120;return e.write_shift(1,n),e.length>e.l?e.slice(0,e.l):e}function rG(t,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var n=e.Workbook.Sheets,r=0,a=-1,s=-1;r<n.length;++r)!n[r]||!n[r].Hidden&&a==-1?a=r:n[r].Hidden==1&&s==-1&&(s=r);s>a||(Ee(t,135),Ee(t,158,nG(a)),Ee(t,136))}}function aG(t,e){var n=xr();return Ee(n,131),Ee(n,128,tG()),Ee(n,153,XV(t.Workbook&&t.Workbook.WBProps||null)),rG(n,t),eG(n,t),Ee(n,132),n.end()}function iG(t,e,n){return e.slice(-4)===".bin"?QV(t,n):$V(t,n)}function sG(t,e,n,r,a,s,l,c){return e.slice(-4)===".bin"?TV(t,r,n,a,s,l,c):Z7(t,r,n,a,s,l,c)}function oG(t,e,n,r,a,s,l,c){return e.slice(-4)===".bin"?OV(t,r,n,a,s):PV(t,r,n,a,s)}function lG(t,e,n,r,a,s,l,c){return e.slice(-4)===".bin"?uB():fB()}function cG(t,e,n,r,a,s,l,c){return e.slice(-4)===".bin"?lB():cB()}function uG(t,e,n,r){return e.slice(-4)===".bin"?iU(t,n,r):WO(t,n,r)}function fG(t,e,n){return sS(t,n)}function dG(t,e,n){return e.slice(-4)===".bin"?dO(t,n):cO(t,n)}function hG(t,e,n){return e.slice(-4)===".bin"?rB(t,n):YU(t,n)}function mG(t,e,n){return e.slice(-4)===".bin"?jU(t):zU(t)}function pG(t,e,n,r){return n.slice(-4)===".bin"?$U(t,e,n,r):void 0}function gG(t,e,n){return e.slice(-4)===".bin"?VU(t,e,n):HU(t,e,n)}function xG(t,e,n){return(e.slice(-4)===".bin"?aG:bS)(t)}function vG(t,e,n,r,a){return(e.slice(-4)===".bin"?RV:TS)(t,n,r,a)}function yG(t,e,n){return(e.slice(-4)===".bin"?pU:aS)(t,n)}function _G(t,e,n){return(e.slice(-4)===".bin"?pO:Xw)(t,n)}function TG(t,e,n){return(e.slice(-4)===".bin"?aB:cS)(t)}function wG(t){return(t.slice(-4)===".bin"?GU:oS)()}var AS=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,kS=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function ia(t,e){var n=t.split(/\s+/),r=[];if(r[0]=n[0],n.length===1)return r;var a=t.match(AS),s,l,c,f;if(a)for(f=0;f!=a.length;++f)s=a[f].match(kS),(l=s[1].indexOf(":"))===-1?r[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?c="xmlns"+s[1].slice(6):c=s[1].slice(l+1),r[c]=s[2].slice(1,s[2].length-1));return r}function SG(t){var e=t.split(/\s+/),n={};if(e.length===1)return n;var r=t.match(AS),a,s,l,c;if(r)for(c=0;c!=r.length;++c)a=r[c].match(kS),(s=a[1].indexOf(":"))===-1?n[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?l="xmlns"+a[1].slice(6):l=a[1].slice(s+1),n[l]=a[2].slice(1,a[2].length-1));return n}var pc;function EG(t,e){var n=pc[t]||gt(t);return n==="General"?vs(e):Kr(n,e)}function CG(t,e,n,r){var a=r;switch((n[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=Jt(r);break;case"i2":case"int":a=parseInt(r,10);break;case"r4":case"float":a=parseFloat(r);break;case"date":case"dateTime.tz":a=Xt(r);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+n[0])}t[gt(e)]=a}function bG(t,e,n){if(t.t!=="z"){if(!n||n.cellText!==!1)try{t.t==="e"?t.w=t.w||ni[t.v]:e==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=Tc(t.v):t.w=vs(t.v):t.w=EG(e||"General",t.v)}catch(s){if(n.WTF)throw s}try{var r=pc[e]||e||"General";if(n.cellNF&&(t.z=r),n.cellDates&&t.t=="n"&&Jo(r)){var a=fs(t.v);a&&(t.t="d",t.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(s){if(n.WTF)throw s}}}function AG(t,e,n){if(n.cellStyles&&e.Interior){var r=e.Interior;r.Pattern&&(r.patternType=BO[r.Pattern]||r.Pattern)}t[e.ID]=e}function kG(t,e,n,r,a,s,l,c,f,d){var g="General",x=r.StyleID,_={};d=d||{};var T=[],E=0;for(x===void 0&&c&&(x=c.StyleID),x===void 0&&l&&(x=l.StyleID);s[x]!==void 0&&(s[x].nf&&(g=s[x].nf),s[x].Interior&&T.push(s[x].Interior),!!s[x].Parent);)x=s[x].Parent;switch(n.Type){case"Boolean":r.t="b",r.v=Jt(t);break;case"String":r.t="s",r.r=k_(gt(t)),r.v=t.indexOf("<")>-1?gt(e||t).replace(/<.*?>/g,""):r.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),r.v=(Xt(t)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),r.v!==r.v?r.v=gt(t):r.v<60&&(r.v=r.v-1),(!g||g=="General")&&(g="yyyy-mm-dd");case"Number":r.v===void 0&&(r.v=+t),r.t||(r.t="n");break;case"Error":r.t="e",r.v=ww[t],d.cellText!==!1&&(r.w=t);break;default:t==""&&e==""?r.t="z":(r.t="s",r.v=k_(e||t));break}if(bG(r,g,d),d.cellFormula!==!1)if(r.Formula){var S=gt(r.Formula);S.charCodeAt(0)==61&&(S=S.slice(1)),r.f=Lo(S,a),delete r.Formula,r.ArrayRange=="RC"?r.F=Lo("RC:RC",a):r.ArrayRange&&(r.F=Lo(r.ArrayRange,a),f.push([xt(r.F),r.F]))}else for(E=0;E<f.length;++E)a.r>=f[E][0].s.r&&a.r<=f[E][0].e.r&&a.c>=f[E][0].s.c&&a.c<=f[E][0].e.c&&(r.F=f[E][1]);d.cellStyles&&(T.forEach(function(C){!_.patternType&&C.patternType&&(_.patternType=C.patternType)}),r.s=_),r.StyleID!==void 0&&(r.ixfe=r.StyleID)}function NG(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function Mh(t,e){var n=e||{};Xo();var r=nc(ep(t));(n.type=="binary"||n.type=="array"||n.type=="base64")&&(r=Bt(r));var a=r.slice(0,1024).toLowerCase(),s=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var l=Kt(n);return l.type="string",Vo.to_workbook(r,l)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(bt){a.indexOf("<"+bt)>=0&&(s=!0)}),s)return mH(r,n);pc={"General Number":"General","General Date":Ye[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Ye[15],"Short Date":Ye[14],"Long Time":Ye[19],"Medium Time":Ye[18],"Short Time":Ye[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Ye[2],Standard:Ye[4],Percent:Ye[10],Scientific:Ye[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var c,f=[],d,g={},x=[],_=n.dense?[]:{},T="",E={},S={},C=ia('<Data ss:Type="String">'),k=0,N=0,b=0,I={s:{r:2e6,c:2e6},e:{r:0,c:0}},F={},P={},D="",j=0,B=[],te={},X={},Z=0,ye=[],Me=[],Se={},ee=[],me,Pe=!1,re=[],z=[],ce={},L=0,W=0,q={Sheets:[],WBProps:{date1904:!1}},K={};Ec.lastIndex=0,r=r.replace(/<!--([\s\S]*?)-->/mg,"");for(var ie="";c=Ec.exec(r);)switch(c[3]=(ie=c[3]).toLowerCase()){case"data":if(ie=="data"){if(c[1]==="/"){if((d=f.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&f.push([c[3],!0]);break}if(f[f.length-1][1])break;c[1]==="/"?kG(r.slice(k,c.index),D,C,f[f.length-1][0]=="comment"?Se:E,{c:N,r:b},F,ee[N],S,re,n):(D="",C=ia(c[0]),k=c.index+c[0].length);break;case"cell":if(c[1]==="/")if(Me.length>0&&(E.c=Me),(!n.sheetRows||n.sheetRows>b)&&E.v!==void 0&&(n.dense?(_[b]||(_[b]=[]),_[b][N]=E):_[tn(N)+mn(b)]=E),E.HRef&&(E.l={Target:gt(E.HRef)},E.HRefScreenTip&&(E.l.Tooltip=E.HRefScreenTip),delete E.HRef,delete E.HRefScreenTip),(E.MergeAcross||E.MergeDown)&&(L=N+(parseInt(E.MergeAcross,10)|0),W=b+(parseInt(E.MergeDown,10)|0),B.push({s:{c:N,r:b},e:{c:L,r:W}})),!n.sheetStubs)E.MergeAcross?N=L+1:++N;else if(E.MergeAcross||E.MergeDown){for(var Ce=N;Ce<=L;++Ce)for(var Te=b;Te<=W;++Te)(Ce>N||Te>b)&&(n.dense?(_[Te]||(_[Te]=[]),_[Te][Ce]={t:"z"}):_[tn(Ce)+mn(Te)]={t:"z"});N=L+1}else++N;else E=SG(c[0]),E.Index&&(N=+E.Index-1),N<I.s.c&&(I.s.c=N),N>I.e.c&&(I.e.c=N),c[0].slice(-2)==="/>"&&++N,Me=[];break;case"row":c[1]==="/"||c[0].slice(-2)==="/>"?(b<I.s.r&&(I.s.r=b),b>I.e.r&&(I.e.r=b),c[0].slice(-2)==="/>"&&(S=ia(c[0]),S.Index&&(b=+S.Index-1)),N=0,++b):(S=ia(c[0]),S.Index&&(b=+S.Index-1),ce={},(S.AutoFitHeight=="0"||S.Height)&&(ce.hpx=parseInt(S.Height,10),ce.hpt=Nc(ce.hpx),z[b]=ce),S.Hidden=="1"&&(ce.hidden=!0,z[b]=ce));break;case"worksheet":if(c[1]==="/"){if((d=f.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"));x.push(T),I.s.r<=I.e.r&&I.s.c<=I.e.c&&(_["!ref"]=rt(I),n.sheetRows&&n.sheetRows<=I.e.r&&(_["!fullref"]=_["!ref"],I.e.r=n.sheetRows-1,_["!ref"]=rt(I))),B.length&&(_["!merges"]=B),ee.length>0&&(_["!cols"]=ee),z.length>0&&(_["!rows"]=z),g[T]=_}else I={s:{r:2e6,c:2e6},e:{r:0,c:0}},b=N=0,f.push([c[3],!1]),d=ia(c[0]),T=gt(d.Name),_=n.dense?[]:{},B=[],re=[],z=[],K={name:T,Hidden:0},q.Sheets.push(K);break;case"table":if(c[1]==="/"){if((d=f.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"))}else{if(c[0].slice(-2)=="/>")break;f.push([c[3],!1]),ee=[],Pe=!1}break;case"style":c[1]==="/"?AG(F,P,n):P=ia(c[0]);break;case"numberformat":P.nf=gt(ia(c[0]).Format||"General"),pc[P.nf]&&(P.nf=pc[P.nf]);for(var be=0;be!=392&&Ye[be]!=P.nf;++be);if(be==392){for(be=57;be!=392;++be)if(Ye[be]==null){Ya(P.nf,be);break}}break;case"column":if(f[f.length-1][0]!=="table")break;if(me=ia(c[0]),me.Hidden&&(me.hidden=!0,delete me.Hidden),me.Width&&(me.wpx=parseInt(me.Width,10)),!Pe&&me.wpx>10){Pe=!0,Qn=nS;for(var Ae=0;Ae<ee.length;++Ae)ee[Ae]&&Pi(ee[Ae])}Pe&&Pi(me),ee[me.Index-1||ee.length]=me;for(var Xe=0;Xe<+me.Span;++Xe)ee[ee.length]=Kt(me);break;case"namedrange":if(c[1]==="/")break;q.Names||(q.Names=[]);var Y=Ze(c[0]),yt={Name:Y.Name,Ref:Lo(Y.RefersTo.slice(1),{r:0,c:0})};q.Sheets.length>0&&(yt.Sheet=q.Sheets.length-1),q.Names.push(yt);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(c[0].slice(-2)==="/>")break;c[1]==="/"?D+=r.slice(j,c.index):j=c.index+c[0].length;break;case"interior":if(!n.cellStyles)break;P.Interior=ia(c[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(c[0].slice(-2)==="/>")break;c[1]==="/"?Q5(te,ie,r.slice(Z,c.index)):Z=c.index+c[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(c[1]==="/"){if((d=f.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"))}else f.push([c[3],!1]);break;case"comment":if(c[1]==="/"){if((d=f.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"));NG(Se),Me.push(Se)}else f.push([c[3],!1]),d=ia(c[0]),Se={a:d.Author};break;case"autofilter":if(c[1]==="/"){if((d=f.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"))}else if(c[0].charAt(c[0].length-2)!=="/"){var st=ia(c[0]);_["!autofilter"]={ref:Lo(st.Range).replace(/\$/g,"")},f.push([c[3],!0])}break;case"name":break;case"datavalidation":if(c[1]==="/"){if((d=f.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&f.push([c[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(c[1]==="/"){if((d=f.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&f.push([c[3],!0]);break;case"null":break;default:if(f.length==0&&c[3]=="document"||f.length==0&&c[3]=="uof")return g2(r,n);var _t=!0;switch(f[f.length-1][0]){case"officedocumentsettings":switch(c[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:_t=!1}break;case"componentoptions":switch(c[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:_t=!1}break;case"excelworkbook":switch(c[3]){case"date1904":q.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:_t=!1}break;case"workbookoptions":switch(c[3]){case"owcversion":break;case"height":break;case"width":break;default:_t=!1}break;case"worksheetoptions":switch(c[3]){case"visible":if(c[0].slice(-2)!=="/>")if(c[1]==="/")switch(r.slice(Z,c.index)){case"SheetHidden":K.Hidden=1;break;case"SheetVeryHidden":K.Hidden=2;break}else Z=c.index+c[0].length;break;case"header":_["!margins"]||ps(_["!margins"]={},"xlml"),isNaN(+Ze(c[0]).Margin)||(_["!margins"].header=+Ze(c[0]).Margin);break;case"footer":_["!margins"]||ps(_["!margins"]={},"xlml"),isNaN(+Ze(c[0]).Margin)||(_["!margins"].footer=+Ze(c[0]).Margin);break;case"pagemargins":var qe=Ze(c[0]);_["!margins"]||ps(_["!margins"]={},"xlml"),isNaN(+qe.Top)||(_["!margins"].top=+qe.Top),isNaN(+qe.Left)||(_["!margins"].left=+qe.Left),isNaN(+qe.Right)||(_["!margins"].right=+qe.Right),isNaN(+qe.Bottom)||(_["!margins"].bottom=+qe.Bottom);break;case"displayrighttoleft":q.Views||(q.Views=[]),q.Views[0]||(q.Views[0]={}),q.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":_["!outline"]||(_["!outline"]={}),_["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":_["!outline"]||(_["!outline"]={}),_["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:_t=!1}break;case"pivottable":case"pivotcache":switch(c[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:_t=!1}break;case"pagebreaks":switch(c[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:_t=!1}break;case"autofilter":switch(c[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:_t=!1}break;case"querytable":switch(c[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:_t=!1}break;case"datavalidation":switch(c[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:_t=!1}break;case"sorting":case"conditionalformatting":switch(c[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:_t=!1}break;case"mapinfo":case"schema":case"data":switch(c[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:_t=!1}break;case"smarttags":break;default:_t=!1;break}if(_t||c[3].match(/!\[CDATA/))break;if(!f[f.length-1][1])throw"Unrecognized tag: "+c[3]+"|"+f.join("|");if(f[f.length-1][0]==="customdocumentproperties"){if(c[0].slice(-2)==="/>")break;c[1]==="/"?CG(X,ie,ye,r.slice(Z,c.index)):(ye=c,Z=c.index+c[0].length);break}if(n.WTF)throw"Unrecognized tag: "+c[3]+"|"+f.join("|")}var Ne={};return!n.bookSheets&&!n.bookProps&&(Ne.Sheets=g),Ne.SheetNames=x,Ne.Workbook=q,Ne.SSF=Kt(Ye),Ne.Props=te,Ne.Custprops=X,Ne}function um(t,e){switch(Ep(e=e||{}),e.type||"base64"){case"base64":return Mh(Dr(t),e);case"binary":case"buffer":case"file":return Mh(t,e);case"array":return Mh(Bi(t),e)}}function MG(t,e){var n=[];return t.Props&&n.push(eP(t.Props,e)),t.Custprops&&n.push(tP(t.Props,t.Custprops)),n.join("")}function DG(){return""}function RG(t,e){var n=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(r,a){var s=[];s.push(Fe("NumberFormat",null,{"ss:Format":Dt(Ye[r.numFmtId])}));var l={"ss:ID":"s"+(21+a)};n.push(Fe("Style",s.join(""),l))}),Fe("Styles",n.join(""))}function NS(t){return Fe("NamedRange",null,{"ss:Name":t.Name,"ss:RefersTo":"="+vp(t.Ref,{r:0,c:0})})}function FG(t){if(!((t||{}).Workbook||{}).Names)return"";for(var e=t.Workbook.Names,n=[],r=0;r<e.length;++r){var a=e[r];a.Sheet==null&&(a.Name.match(/^_xlfn\./)||n.push(NS(a)))}return Fe("Names",n.join(""))}function IG(t,e,n,r){if(!t||!((r||{}).Workbook||{}).Names)return"";for(var a=r.Workbook.Names,s=[],l=0;l<a.length;++l){var c=a[l];c.Sheet==n&&(c.Name.match(/^_xlfn\./)||s.push(NS(c)))}return s.join("")}function PG(t,e,n,r){if(!t)return"";var a=[];if(t["!margins"]&&(a.push("<PageSetup>"),t["!margins"].header&&a.push(Fe("Header",null,{"x:Margin":t["!margins"].header})),t["!margins"].footer&&a.push(Fe("Footer",null,{"x:Margin":t["!margins"].footer})),a.push(Fe("PageMargins",null,{"x:Bottom":t["!margins"].bottom||"0.75","x:Left":t["!margins"].left||"0.7","x:Right":t["!margins"].right||"0.7","x:Top":t["!margins"].top||"0.75"})),a.push("</PageSetup>")),r&&r.Workbook&&r.Workbook.Sheets&&r.Workbook.Sheets[n])if(r.Workbook.Sheets[n].Hidden)a.push(Fe("Visible",r.Workbook.Sheets[n].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<n&&!(r.Workbook.Sheets[s]&&!r.Workbook.Sheets[s].Hidden);++s);s==n&&a.push("<Selected/>")}return((((r||{}).Workbook||{}).Views||[])[0]||{}).RTL&&a.push("<DisplayRightToLeft/>"),t["!protect"]&&(a.push(jn("ProtectContents","True")),t["!protect"].objects&&a.push(jn("ProtectObjects","True")),t["!protect"].scenarios&&a.push(jn("ProtectScenarios","True")),t["!protect"].selectLockedCells!=null&&!t["!protect"].selectLockedCells?a.push(jn("EnableSelection","NoSelection")):t["!protect"].selectUnlockedCells!=null&&!t["!protect"].selectUnlockedCells&&a.push(jn("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(l){t["!protect"][l[0]]&&a.push("<"+l[1]+"/>")})),a.length==0?"":Fe("WorksheetOptions",a.join(""),{xmlns:Ar.x})}function LG(t){return t.map(function(e){var n=r5(e.t||""),r=Fe("ss:Data",n,{xmlns:"http://www.w3.org/TR/REC-html40"});return Fe("Comment",r,{"ss:Author":e.a})}).join("")}function OG(t,e,n,r,a,s,l){if(!t||t.v==null&&t.f==null)return"";var c={};if(t.f&&(c["ss:Formula"]="="+Dt(vp(t.f,l))),t.F&&t.F.slice(0,e.length)==e){var f=nn(t.F.slice(e.length+1));c["ss:ArrayRange"]="RC:R"+(f.r==l.r?"":"["+(f.r-l.r)+"]")+"C"+(f.c==l.c?"":"["+(f.c-l.c)+"]")}if(t.l&&t.l.Target&&(c["ss:HRef"]=Dt(t.l.Target),t.l.Tooltip&&(c["x:HRefScreenTip"]=Dt(t.l.Tooltip))),n["!merges"])for(var d=n["!merges"],g=0;g!=d.length;++g)d[g].s.c!=l.c||d[g].s.r!=l.r||(d[g].e.c>d[g].s.c&&(c["ss:MergeAcross"]=d[g].e.c-d[g].s.c),d[g].e.r>d[g].s.r&&(c["ss:MergeDown"]=d[g].e.r-d[g].s.r));var x="",_="";switch(t.t){case"z":if(!r.sheetStubs)return"";break;case"n":x="Number",_=String(t.v);break;case"b":x="Boolean",_=t.v?"1":"0";break;case"e":x="Error",_=ni[t.v];break;case"d":x="DateTime",_=new Date(t.v).toISOString(),t.z==null&&(t.z=t.z||Ye[14]);break;case"s":x="String",_=n5(t.v||"");break}var T=Gi(r.cellXfs,t,r);c["ss:StyleID"]="s"+(21+T),c["ss:Index"]=l.c+1;var E=t.v!=null?_:"",S=t.t=="z"?"":'<Data ss:Type="'+x+'">'+E+"</Data>";return(t.c||[]).length>0&&(S+=LG(t.c)),Fe("Cell",S,c)}function UG(t,e){var n='<Row ss:Index="'+(t+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=Go(e.hpt)),e.hpx&&(n+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(n+=' ss:Hidden="1"')),n+">"}function BG(t,e,n,r){if(!t["!ref"])return"";var a=xt(t["!ref"]),s=t["!merges"]||[],l=0,c=[];t["!cols"]&&t["!cols"].forEach(function(C,k){Pi(C);var N=!!C.width,b=t0(k,C),I={"ss:Index":k+1};N&&(I["ss:Width"]=Ac(b.width)),C.hidden&&(I["ss:Hidden"]="1"),c.push(Fe("Column",null,I))});for(var f=Array.isArray(t),d=a.s.r;d<=a.e.r;++d){for(var g=[UG(d,(t["!rows"]||[])[d])],x=a.s.c;x<=a.e.c;++x){var _=!1;for(l=0;l!=s.length;++l)if(!(s[l].s.c>x)&&!(s[l].s.r>d)&&!(s[l].e.c<x)&&!(s[l].e.r<d)){(s[l].s.c!=x||s[l].s.r!=d)&&(_=!0);break}if(!_){var T={r:d,c:x},E=Je(T),S=f?(t[d]||[])[x]:t[E];g.push(OG(S,E,t,e,n,r,T))}}g.push("</Row>"),g.length>2&&c.push(g.join(""))}return c.join("")}function VG(t,e,n){var r=[],a=n.SheetNames[t],s=n.Sheets[a],l=s?IG(s,e,t,n):"";return l.length>0&&r.push("<Names>"+l+"</Names>"),l=s?BG(s,e,t,n):"",l.length>0&&r.push("<Table>"+l+"</Table>"),r.push(PG(s,e,t,n)),r.join("")}function GG(t,e){e||(e={}),t.SSF||(t.SSF=Kt(Ye)),t.SSF&&(Xo(),Yf(t.SSF),e.revssf=Xf(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF,e.cellXfs=[],Gi(e.cellXfs,{},{revssf:{General:0}}));var n=[];n.push(MG(t,e)),n.push(DG()),n.push(""),n.push("");for(var r=0;r<t.SheetNames.length;++r)n.push(Fe("Worksheet",VG(r,e,t),{"ss:Name":Dt(t.SheetNames[r])}));return n[2]=RG(t,e),n[3]=FG(t),pn+Fe("Workbook",n.join(""),{xmlns:Ar.ss,"xmlns:o":Ar.o,"xmlns:x":Ar.x,"xmlns:ss":Ar.ss,"xmlns:dt":Ar.dt,"xmlns:html":Ar.html})}function HG(t){var e={},n=t.content;if(n.l=28,e.AnsiUserType=n.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=F5(n),n.length-n.l<=4)return e;var r=n.read_shift(4);if(r==0||r>40||(n.l-=4,e.Reserved1=n.read_shift(0,"lpstr-ansi"),n.length-n.l<=4)||(r=n.read_shift(4),r!==1907505652)||(e.UnicodeClipboardFormat=I5(n),r=n.read_shift(4),r==0||r>40))return e;n.l-=4,e.Reserved2=n.read_shift(0,"lpwstr")}var zG=[60,1084,2066,2165,2175];function qG(t,e,n,r,a){var s=r,l=[],c=n.slice(n.l,n.l+s);if(a&&a.enc&&a.enc.insitu&&c.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(c)}l.push(c),n.l+=s;for(var f=$a(n,n.l),d=fm[f],g=0;d!=null&&zG.indexOf(f)>-1;)s=$a(n,n.l+2),g=n.l+4,f==2066?g+=4:(f==2165||f==2175)&&(g+=12),c=n.slice(g,n.l+4+s),l.push(c),n.l+=4+s,d=fm[f=$a(n,n.l)];var x=In(l);qn(x,0);var _=0;x.lens=[];for(var T=0;T<l.length;++T)x.lens.push(_),_+=l[T].length;if(x.length<r)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+x.length+" < "+r;return e.f(x,x.length,a)}function Ta(t,e,n){if(t.t!=="z"&&t.XF){var r=0;try{r=t.z||t.XF.numFmtId||0,e.cellNF&&(t.z=Ye[r])}catch(s){if(e.WTF)throw s}if(!e||e.cellText!==!1)try{t.t==="e"?t.w=t.w||ni[t.v]:r===0||r=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=Tc(t.v):t.w=vs(t.v):t.w=Kr(r,t.v,{date1904:!!n,dateNF:e&&e.dateNF})}catch(s){if(e.WTF)throw s}if(e.cellDates&&r&&t.t=="n"&&Jo(Ye[r]||String(r))){var a=fs(t.v);a&&(t.t="d",t.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function xf(t,e,n){return{v:t,ixfe:e,t:n}}function jG(t,e){var n={opts:{}},r={},a=e.dense?[]:{},s={},l={},c=null,f=[],d="",g={},x,_="",T,E,S,C,k={},N=[],b,I,F=[],P=[],D={Sheets:[],WBProps:{date1904:!1},Views:[{}]},j={},B=function(et){return et<8?ds[et]:et<64&&P[et-8]||ds[et]},te=function(et,Ft,ir){var qt=Ft.XF.data;if(!(!qt||!qt.patternType||!ir||!ir.cellStyles)){Ft.s={},Ft.s.patternType=qt.patternType;var sr;(sr=bc(B(qt.icvFore)))&&(Ft.s.fgColor={rgb:sr}),(sr=bc(B(qt.icvBack)))&&(Ft.s.bgColor={rgb:sr})}},X=function(et,Ft,ir){if(!(ce>1)&&!(ir.sheetRows&&et.r>=ir.sheetRows)){if(ir.cellStyles&&Ft.XF&&Ft.XF.data&&te(et,Ft,ir),delete Ft.ixfe,delete Ft.XF,x=et,_=Je(et),(!l||!l.s||!l.e)&&(l={s:{r:0,c:0},e:{r:0,c:0}}),et.r<l.s.r&&(l.s.r=et.r),et.c<l.s.c&&(l.s.c=et.c),et.r+1>l.e.r&&(l.e.r=et.r+1),et.c+1>l.e.c&&(l.e.c=et.c+1),ir.cellFormula&&Ft.f){for(var qt=0;qt<N.length;++qt)if(!(N[qt][0].s.c>et.c||N[qt][0].s.r>et.r)&&!(N[qt][0].e.c<et.c||N[qt][0].e.r<et.r)){Ft.F=rt(N[qt][0]),(N[qt][0].s.c!=et.c||N[qt][0].s.r!=et.r)&&delete Ft.f,Ft.f&&(Ft.f=""+Zn(N[qt][1],l,et,re,Z));break}}ir.dense?(a[et.r]||(a[et.r]=[]),a[et.r][et.c]=Ft):a[_]=Ft}},Z={enc:!1,sbcch:0,snames:[],sharedf:k,arrayf:N,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(Z.password=e.password);var ye,Me=[],Se=[],ee=[],me=[],Pe=!1,re=[];re.SheetNames=Z.snames,re.sharedf=Z.sharedf,re.arrayf=Z.arrayf,re.names=[],re.XTI=[];var z=0,ce=0,L=0,W=[],q=[],K;Z.codepage=1200,la(1200);for(var ie=!1;t.l<t.length-1;){var Ce=t.l,Te=t.read_shift(2);if(Te===0&&z===10)break;var be=t.l===t.length?0:t.read_shift(2),Ae=fm[Te];if(Ae&&Ae.f){if(e.bookSheets&&z===133&&Te!==133)break;if(z=Te,Ae.r===2||Ae.r==12){var Xe=t.read_shift(2);if(be-=2,!Z.enc&&Xe!==Te&&((Xe&255)<<8|Xe>>8)!==Te)throw new Error("rt mismatch: "+Xe+"!="+Te);Ae.r==12&&(t.l+=10,be-=10)}var Y={};if(Te===10?Y=Ae.f(t,be,Z):Y=qG(Te,Ae,t,be,Z),ce==0&&[9,521,1033,2057].indexOf(z)===-1)continue;switch(Te){case 34:n.opts.Date1904=D.WBProps.date1904=Y;break;case 134:n.opts.WriteProtect=!0;break;case 47:if(Z.enc||(t.l=0),Z.enc=Y,!e.password)throw new Error("File is password-protected");if(Y.valid==null)throw new Error("Encryption scheme unsupported");if(!Y.valid)throw new Error("Password is incorrect");break;case 92:Z.lastuser=Y;break;case 66:var yt=Number(Y);switch(yt){case 21010:yt=1200;break;case 32768:yt=1e4;break;case 32769:yt=1252;break}la(Z.codepage=yt),ie=!0;break;case 317:Z.rrtabid=Y;break;case 25:Z.winlocked=Y;break;case 439:n.opts.RefreshAll=Y;break;case 12:n.opts.CalcCount=Y;break;case 16:n.opts.CalcDelta=Y;break;case 17:n.opts.CalcIter=Y;break;case 13:n.opts.CalcMode=Y;break;case 14:n.opts.CalcPrecision=Y;break;case 95:n.opts.CalcSaveRecalc=Y;break;case 15:Z.CalcRefMode=Y;break;case 2211:n.opts.FullCalc=Y;break;case 129:Y.fDialog&&(a["!type"]="dialog"),Y.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),Y.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:F.push(Y);break;case 430:re.push([Y]),re[re.length-1].XTI=[];break;case 35:case 547:re[re.length-1].push(Y);break;case 24:case 536:K={Name:Y.Name,Ref:Zn(Y.rgce,l,null,re,Z)},Y.itab>0&&(K.Sheet=Y.itab-1),re.names.push(K),re[0]||(re[0]=[],re[0].XTI=[]),re[re.length-1].push(Y),Y.Name=="_xlnm._FilterDatabase"&&Y.itab>0&&Y.rgce&&Y.rgce[0]&&Y.rgce[0][0]&&Y.rgce[0][0][0]=="PtgArea3d"&&(q[Y.itab-1]={ref:rt(Y.rgce[0][0][1][2])});break;case 22:Z.ExternCount=Y;break;case 23:re.length==0&&(re[0]=[],re[0].XTI=[]),re[re.length-1].XTI=re[re.length-1].XTI.concat(Y),re.XTI=re.XTI.concat(Y);break;case 2196:if(Z.biff<8)break;K!=null&&(K.Comment=Y[1]);break;case 18:a["!protect"]=Y;break;case 19:Y!==0&&Z.WTF&&console.error("Password verifier: "+Y);break;case 133:s[Y.pos]=Y,Z.snames.push(Y.name);break;case 10:{if(--ce)break;if(l.e){if(l.e.r>0&&l.e.c>0){if(l.e.r--,l.e.c--,a["!ref"]=rt(l),e.sheetRows&&e.sheetRows<=l.e.r){var st=l.e.r;l.e.r=e.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=rt(l),l.e.r=st}l.e.r++,l.e.c++}Me.length>0&&(a["!merges"]=Me),Se.length>0&&(a["!objects"]=Se),ee.length>0&&(a["!cols"]=ee),me.length>0&&(a["!rows"]=me),D.Sheets.push(j)}d===""?g=a:r[d]=a,a=e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(Z.biff===8&&(Z.biff={9:2,521:3,1033:4}[Te]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[Y.BIFFVer]||8),Z.biffguess=Y.BIFFVer==0,Y.BIFFVer==0&&Y.dt==4096&&(Z.biff=5,ie=!0,la(Z.codepage=28591)),Z.biff==8&&Y.BIFFVer==0&&Y.dt==16&&(Z.biff=2),ce++)break;if(a=e.dense?[]:{},Z.biff<8&&!ie&&(ie=!0,la(Z.codepage=e.codepage||1252)),Z.biff<5||Y.BIFFVer==0&&Y.dt==4096){d===""&&(d="Sheet1"),l={s:{r:0,c:0},e:{r:0,c:0}};var _t={pos:t.l-be,name:d};s[_t.pos]=_t,Z.snames.push(d)}else d=(s[Ce]||{name:""}).name;Y.dt==32&&(a["!type"]="chart"),Y.dt==64&&(a["!type"]="macro"),Me=[],Se=[],Z.arrayf=N=[],ee=[],me=[],Pe=!1,j={Hidden:(s[Ce]||{hs:0}).hs,name:d}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(e.dense?(a[Y.r]||[])[Y.c]:a[Je({c:Y.c,r:Y.r})])&&++Y.c,b={ixfe:Y.ixfe,XF:F[Y.ixfe]||{},v:Y.val,t:"n"},L>0&&(b.z=W[b.ixfe>>8&63]),Ta(b,e,n.opts.Date1904),X({c:Y.c,r:Y.r},b,e);break;case 5:case 517:b={ixfe:Y.ixfe,XF:F[Y.ixfe],v:Y.val,t:Y.t},L>0&&(b.z=W[b.ixfe>>8&63]),Ta(b,e,n.opts.Date1904),X({c:Y.c,r:Y.r},b,e);break;case 638:b={ixfe:Y.ixfe,XF:F[Y.ixfe],v:Y.rknum,t:"n"},L>0&&(b.z=W[b.ixfe>>8&63]),Ta(b,e,n.opts.Date1904),X({c:Y.c,r:Y.r},b,e);break;case 189:for(var qe=Y.c;qe<=Y.C;++qe){var Ne=Y.rkrec[qe-Y.c][0];b={ixfe:Ne,XF:F[Ne],v:Y.rkrec[qe-Y.c][1],t:"n"},L>0&&(b.z=W[b.ixfe>>8&63]),Ta(b,e,n.opts.Date1904),X({c:qe,r:Y.r},b,e)}break;case 6:case 518:case 1030:{if(Y.val=="String"){c=Y;break}if(b=xf(Y.val,Y.cell.ixfe,Y.tt),b.XF=F[b.ixfe],e.cellFormula){var bt=Y.formula;if(bt&&bt[0]&&bt[0][0]&&bt[0][0][0]=="PtgExp"){var Ln=bt[0][0][1][0],On=bt[0][0][1][1],$n=Je({r:Ln,c:On});k[$n]?b.f=""+Zn(Y.formula,l,Y.cell,re,Z):b.F=((e.dense?(a[Ln]||[])[On]:a[$n])||{}).F}else b.f=""+Zn(Y.formula,l,Y.cell,re,Z)}L>0&&(b.z=W[b.ixfe>>8&63]),Ta(b,e,n.opts.Date1904),X(Y.cell,b,e),c=Y}break;case 7:case 519:if(c)c.val=Y,b=xf(Y,c.cell.ixfe,"s"),b.XF=F[b.ixfe],e.cellFormula&&(b.f=""+Zn(c.formula,l,c.cell,re,Z)),L>0&&(b.z=W[b.ixfe>>8&63]),Ta(b,e,n.opts.Date1904),X(c.cell,b,e),c=null;else throw new Error("String record expects Formula");break;case 33:case 545:{N.push(Y);var ha=Je(Y[0].s);if(T=e.dense?(a[Y[0].s.r]||[])[Y[0].s.c]:a[ha],e.cellFormula&&T){if(!c||!ha||!T)break;T.f=""+Zn(Y[1],l,Y[0],re,Z),T.F=rt(Y[0])}}break;case 1212:{if(!e.cellFormula)break;if(_){if(!c)break;k[Je(c.cell)]=Y[0],T=e.dense?(a[c.cell.r]||[])[c.cell.c]:a[Je(c.cell)],(T||{}).f=""+Zn(Y[0],l,x,re,Z)}}break;case 253:b=xf(f[Y.isst].t,Y.ixfe,"s"),f[Y.isst].h&&(b.h=f[Y.isst].h),b.XF=F[b.ixfe],L>0&&(b.z=W[b.ixfe>>8&63]),Ta(b,e,n.opts.Date1904),X({c:Y.c,r:Y.r},b,e);break;case 513:e.sheetStubs&&(b={ixfe:Y.ixfe,XF:F[Y.ixfe],t:"z"},L>0&&(b.z=W[b.ixfe>>8&63]),Ta(b,e,n.opts.Date1904),X({c:Y.c,r:Y.r},b,e));break;case 190:if(e.sheetStubs)for(var Un=Y.c;Un<=Y.C;++Un){var Cn=Y.ixfe[Un-Y.c];b={ixfe:Cn,XF:F[Cn],t:"z"},L>0&&(b.z=W[b.ixfe>>8&63]),Ta(b,e,n.opts.Date1904),X({c:Un,r:Y.r},b,e)}break;case 214:case 516:case 4:b=xf(Y.val,Y.ixfe,"s"),b.XF=F[b.ixfe],L>0&&(b.z=W[b.ixfe>>8&63]),Ta(b,e,n.opts.Date1904),X({c:Y.c,r:Y.r},b,e);break;case 0:case 512:ce===1&&(l=Y);break;case 252:f=Y;break;case 1054:if(Z.biff==4){W[L++]=Y[1];for(var yr=0;yr<L+163&&Ye[yr]!=Y[1];++yr);yr>=163&&Ya(Y[1],L+163)}else Ya(Y[1],Y[0]);break;case 30:{W[L++]=Y;for(var Bn=0;Bn<L+163&&Ye[Bn]!=Y;++Bn);Bn>=163&&Ya(Y,L+163)}break;case 229:Me=Me.concat(Y);break;case 93:Se[Y.cmo[0]]=Z.lastobj=Y;break;case 438:Z.lastobj.TxO=Y;break;case 127:Z.lastobj.ImData=Y;break;case 440:for(C=Y[0].s.r;C<=Y[0].e.r;++C)for(S=Y[0].s.c;S<=Y[0].e.c;++S)T=e.dense?(a[C]||[])[S]:a[Je({c:S,r:C})],T&&(T.l=Y[1]);break;case 2048:for(C=Y[0].s.r;C<=Y[0].e.r;++C)for(S=Y[0].s.c;S<=Y[0].e.c;++S)T=e.dense?(a[C]||[])[S]:a[Je({c:S,r:C})],T&&T.l&&(T.l.Tooltip=Y[1]);break;case 28:{if(Z.biff<=5&&Z.biff>=2)break;T=e.dense?(a[Y[0].r]||[])[Y[0].c]:a[Je(Y[0])];var cn=Se[Y[2]];T||(e.dense?(a[Y[0].r]||(a[Y[0].r]=[]),T=a[Y[0].r][Y[0].c]={t:"z"}):T=a[Je(Y[0])]={t:"z"},l.e.r=Math.max(l.e.r,Y[0].r),l.s.r=Math.min(l.s.r,Y[0].r),l.e.c=Math.max(l.e.c,Y[0].c),l.s.c=Math.min(l.s.c,Y[0].c)),T.c||(T.c=[]),E={a:Y[1],t:cn.TxO.t},T.c.push(E)}break;case 2173:RU(F[Y.ixfe],Y.ext);break;case 125:{if(!Z.cellStyles)break;for(;Y.e>=Y.s;)ee[Y.e--]={width:Y.w/256,level:Y.level||0,hidden:!!(Y.flags&1)},Pe||(Pe=!0,pp(Y.w/256)),Pi(ee[Y.e+1])}break;case 520:{var Ht={};Y.level!=null&&(me[Y.r]=Ht,Ht.level=Y.level),Y.hidden&&(me[Y.r]=Ht,Ht.hidden=!0),Y.hpt&&(me[Y.r]=Ht,Ht.hpt=Y.hpt,Ht.hpx=Go(Y.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||ps(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[Te]]=Y;break;case 161:a["!margins"]||ps(a["!margins"]={}),a["!margins"].header=Y.header,a["!margins"].footer=Y.footer;break;case 574:Y.RTL&&(D.Views[0].RTL=!0);break;case 146:P=Y;break;case 2198:ye=Y;break;case 140:I=Y;break;case 442:d?j.CodeName=Y||j.name:D.WBProps.CodeName=Y||"ThisWorkbook";break}}else Ae||console.error("Missing Info for XLS Record 0x"+Te.toString(16)),t.l+=be}return n.SheetNames=ln(s).sort(function(zt,et){return Number(zt)-Number(et)}).map(function(zt){return s[zt].name}),e.bookSheets||(n.Sheets=r),!n.SheetNames.length&&g["!ref"]?(n.SheetNames.push("Sheet1"),n.Sheets&&(n.Sheets.Sheet1=g)):n.Preamble=g,n.Sheets&&q.forEach(function(zt,et){n.Sheets[n.SheetNames[et]]["!autofilter"]=zt}),n.Strings=f,n.SSF=Kt(Ye),Z.enc&&(n.Encryption=Z.enc),ye&&(n.Themes=ye),n.Metadata={},I!==void 0&&(n.Metadata.Country=I),re.names.length>0&&(D.Names=re.names),n.Workbook=D,n}var gc={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function $G(t,e,n){var r=ze.find(t,"/!DocumentSummaryInformation");if(r&&r.size>0)try{var a=$_(r,am,gc.DSI);for(var s in a)e[s]=a[s]}catch(d){if(n.WTF)throw d}var l=ze.find(t,"/!SummaryInformation");if(l&&l.size>0)try{var c=$_(l,im,gc.SI);for(var f in c)e[f]==null&&(e[f]=c[f])}catch(d){if(n.WTF)throw d}e.HeadingPairs&&e.TitlesOfParts&&(kw(e.HeadingPairs,e.TitlesOfParts,e,n),delete e.HeadingPairs,delete e.TitlesOfParts)}function WG(t,e){var n=[],r=[],a=[],s=0,l,c=w_(am,"n"),f=w_(im,"n");if(t.Props)for(l=ln(t.Props),s=0;s<l.length;++s)(Object.prototype.hasOwnProperty.call(c,l[s])?n:Object.prototype.hasOwnProperty.call(f,l[s])?r:a).push([l[s],t.Props[l[s]]]);if(t.Custprops)for(l=ln(t.Custprops),s=0;s<l.length;++s)Object.prototype.hasOwnProperty.call(t.Props||{},l[s])||(Object.prototype.hasOwnProperty.call(c,l[s])?n:Object.prototype.hasOwnProperty.call(f,l[s])?r:a).push([l[s],t.Custprops[l[s]]]);var d=[];for(s=0;s<a.length;++s)Pw.indexOf(a[s][0])>-1||Aw.indexOf(a[s][0])>-1||a[s][1]!=null&&d.push(a[s]);r.length&&ze.utils.cfb_add(e,"/SummaryInformation",W_(r,gc.SI,f,im)),(n.length||d.length)&&ze.utils.cfb_add(e,"/DocumentSummaryInformation",W_(n,gc.DSI,c,am,d.length?d:null,gc.UDI))}function MS(t,e){e||(e={}),Ep(e),jm(),e.codepage&&qm(e.codepage);var n,r;if(t.FullPaths){if(ze.find(t,"/encryption"))throw new Error("File is password-protected");n=ze.find(t,"!CompObj"),r=ze.find(t,"/Workbook")||ze.find(t,"/Book")}else{switch(e.type){case"base64":t=Nr(Dr(t));break;case"binary":t=Nr(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}qn(t,0),r={content:t}}var a,s;if(n&&HG(n),e.bookProps&&!e.bookSheets)a={};else{var l=lt?"buffer":"array";if(r&&r.content)a=jG(r.content,e);else if((s=ze.find(t,"PerfectOffice_MAIN"))&&s.content)a=ms.to_workbook(s.content,(e.type=l,e));else if((s=ze.find(t,"NativeContent_MAIN"))&&s.content)a=ms.to_workbook(s.content,(e.type=l,e));else throw(s=ze.find(t,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&t.FullPaths&&ze.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=sB(t))}var c={};return t.FullPaths&&$G(t,c,e),a.Props=a.Custprops=c,e.bookFiles&&(a.cfb=t),a}function YG(t,e){var n=e||{},r=ze.utils.cfb_new({root:"R"}),a="/Workbook";switch(n.bookType||"xls"){case"xls":n.bookType="biff8";case"xla":n.bookType||(n.bookType="xla");case"biff8":a="/Workbook",n.biff=8;break;case"biff5":a="/Book",n.biff=5;break;default:throw new Error("invalid type "+n.bookType+" for XLS CFB")}return ze.utils.cfb_add(r,a,DS(t,n)),n.biff==8&&(t.Props||t.Custprops)&&WG(t,r),n.biff==8&&t.vbaraw&&oB(r,ze.read(t.vbaraw,{type:typeof t.vbaraw=="string"?"binary":"buffer"})),r}var Mc={0:{f:v9},1:{f:b9},2:{f:j9},3:{f:I9},4:{f:M9},5:{f:H9},6:{f:X9},7:{f:U9},8:{f:rV},9:{f:nV},10:{f:eV},11:{f:tV},12:{f:k9},13:{f:W9},14:{f:L9},15:{f:R9},16:{f:wS},17:{f:Z9},18:{f:V9},19:{f:ip},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:ZV},40:{},42:{},43:{f:XO},44:{f:YO},45:{f:QO},46:{f:tU},47:{f:eU},48:{},49:{f:T5},50:{},51:{f:PU},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:$w},62:{f:J9},63:{f:qU},64:{f:yV},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:rr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:pV},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:E9},148:{f:T9,p:16},151:{f:cV},152:{},153:{f:JV},154:{},155:{},156:{f:WV},157:{},158:{},159:{T:1,f:fO},160:{T:-1},161:{T:1,f:Ms},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:aV},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:FU},336:{T:-1},337:{f:UU,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:rm},357:{},358:{},359:{},360:{T:1},361:{},362:{f:jw},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:uV},427:{f:fV},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:hV},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:S9},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:oV},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:rm},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:tB},633:{T:1},634:{T:-1},635:{T:1,f:QU},636:{T:-1},637:{f:C5},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:LV},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:_V},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},fm={6:{f:kh},10:{f:ki},12:{f:_n},13:{f:_n},14:{f:dn},15:{f:dn},16:{f:er},17:{f:dn},18:{f:dn},19:{f:_n},20:{f:Q_},21:{f:Q_},23:{f:jw},24:{f:t2},25:{f:dn},26:{},27:{},28:{f:_L},29:{},34:{f:dn},35:{f:e2},38:{f:er},39:{f:er},40:{f:er},41:{f:er},42:{f:dn},43:{f:dn},47:{f:RO},49:{f:WP},51:{f:_n},60:{},61:{f:HP},64:{f:dn},65:{f:$P},66:{f:_n},77:{},80:{},81:{},82:{},85:{f:_n},89:{},90:{},91:{},92:{f:DP},93:{f:SL},94:{},95:{f:dn},96:{},97:{},99:{f:dn},125:{f:$w},128:{f:lL},129:{f:FP},130:{f:_n},131:{f:dn},132:{f:dn},133:{f:IP},134:{},140:{f:DL},141:{f:_n},144:{},146:{f:IL},151:{},152:{},153:{},154:{},155:{},156:{f:_n},157:{},158:{},160:{f:GL},161:{f:OL},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:aL},190:{f:iL},193:{f:ki},197:{},198:{},199:{},200:{},201:{},202:{f:dn},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:_n},220:{},221:{f:dn},222:{},224:{f:oL},225:{f:MP},226:{f:ki},227:{},229:{f:TL},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:LP},253:{f:JP},255:{f:UP},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:Lw},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:dn},353:{f:ki},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:hL},431:{f:dn},432:{},433:{},434:{},437:{},438:{f:bL},439:{f:dn},440:{f:AL},441:{},442:{f:Gc},443:{},444:{f:_n},445:{},446:{},448:{f:ki},449:{f:GP,r:2},450:{f:ki},512:{f:X_},513:{f:VL},515:{f:fL},516:{f:KP},517:{f:Z_},519:{f:HL},520:{f:BP},523:{},545:{f:n2},549:{f:J_},566:{},574:{f:qP},638:{f:rL},659:{},1048:{},1054:{f:QP},1084:{},1212:{f:xL},2048:{f:NL},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:mf},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:ki},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:PL,r:12},2173:{f:DU,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:dn,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:gL,r:12},2197:{},2198:{f:CU,r:12},2199:{},2200:{},2201:{},2202:{f:vL,r:12},2203:{f:ki},2204:{},2205:{},2206:{},2207:{},2211:{f:VP},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:_n},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:UL},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:FL},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:X_},1:{},2:{f:WL},3:{f:jL},4:{f:qL},5:{f:Z_},7:{f:JL},8:{},9:{f:mf},11:{},22:{f:_n},30:{f:tL},31:{},32:{},33:{f:n2},36:{},37:{f:J_},50:{f:XL},62:{},52:{},67:{},68:{f:_n},69:{},86:{},126:{},127:{f:zL},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:KL},223:{},234:{},354:{},421:{},518:{f:kh},521:{f:mf},536:{f:t2},547:{f:e2},561:{},579:{},1030:{f:kh},1033:{f:mf},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Ie(t,e,n,r){var a=e;if(!isNaN(a)){var s=r||(n||[]).length||0,l=t.next(4);l.write_shift(2,a),l.write_shift(2,s),s>0&&np(n)&&t.push(n)}}function JG(t,e,n,r){var a=(n||[]).length||0;if(a<=8224)return Ie(t,e,n,a);var s=e;if(!isNaN(s)){for(var l=n.parts||[],c=0,f=0,d=0;d+(l[c]||8224)<=8224;)d+=l[c]||8224,c++;var g=t.next(4);for(g.write_shift(2,s),g.write_shift(2,d),t.push(n.slice(f,f+d)),f+=d;f<a;){for(g=t.next(4),g.write_shift(2,60),d=0;d+(l[c]||8224)<=8224;)d+=l[c]||8224,c++;g.write_shift(2,d),t.push(n.slice(f,f+d)),f+=d}}}function jc(t,e,n){return t||(t=xe(7)),t.write_shift(2,e),t.write_shift(2,n),t.write_shift(2,0),t.write_shift(1,0),t}function XG(t,e,n,r){var a=xe(9);return jc(a,t,e),Ow(n,r||"b",a),a}function KG(t,e,n){var r=xe(8+2*n.length);return jc(r,t,e),r.write_shift(1,n.length),r.write_shift(n.length,n,"sbcs"),r.l<r.length?r.slice(0,r.l):r}function ZG(t,e,n,r){if(e.v!=null)switch(e.t){case"d":case"n":var a=e.t=="d"?En(Xt(e.v)):e.v;a==(a|0)&&a>=0&&a<65536?Ie(t,2,YL(n,r,a)):Ie(t,3,$L(n,r,a));return;case"b":case"e":Ie(t,5,XG(n,r,e.v,e.t));return;case"s":case"str":Ie(t,4,KG(n,r,(e.v||"").slice(0,255)));return}Ie(t,1,jc(null,n,r))}function QG(t,e,n,r){var a=Array.isArray(e),s=xt(e["!ref"]||"A1"),l,c="",f=[];if(s.e.c>255||s.e.r>16383){if(r.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),l=rt(s)}for(var d=s.s.r;d<=s.e.r;++d){c=mn(d);for(var g=s.s.c;g<=s.e.c;++g){d===s.s.r&&(f[g]=tn(g)),l=f[g]+c;var x=a?(e[d]||[])[g]:e[l];x&&ZG(t,x,d,g)}}}function eH(t,e){for(var n=e||{},r=xr(),a=0,s=0;s<t.SheetNames.length;++s)t.SheetNames[s]==n.sheet&&(a=s);if(a==0&&n.sheet&&t.SheetNames[0]!=n.sheet)throw new Error("Sheet not found: "+n.sheet);return Ie(r,n.biff==4?1033:n.biff==3?521:9,dp(t,16,n)),QG(r,t.Sheets[t.SheetNames[a]],a,n),Ie(r,10),r.end()}function tH(t,e,n){Ie(t,49,YP({sz:12,name:"Arial"},n))}function nH(t,e,n){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var a=r[0];a<=r[1];++a)e[a]!=null&&Ie(t,1054,eL(a,e[a],n))})}function rH(t,e){var n=xe(19);n.write_shift(4,2151),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(2,3),n.write_shift(1,1),n.write_shift(4,0),Ie(t,2151,n),n=xe(39),n.write_shift(4,2152),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(2,3),n.write_shift(1,0),n.write_shift(4,0),n.write_shift(2,1),n.write_shift(4,4),n.write_shift(2,0),Hw(xt(e["!ref"]||"A1"),n),n.write_shift(4,4),Ie(t,2152,n)}function aH(t,e){for(var n=0;n<16;++n)Ie(t,224,K_({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(r){Ie(t,224,K_(r,0,e))})}function iH(t,e){for(var n=0;n<e["!links"].length;++n){var r=e["!links"][n];Ie(t,440,kL(r)),r[1].Tooltip&&Ie(t,2048,ML(r))}delete e["!links"]}function sH(t,e){if(e){var n=0;e.forEach(function(r,a){++n<=256&&r&&Ie(t,125,LL(t0(a,r),a))})}}function oH(t,e,n,r,a){var s=16+Gi(a.cellXfs,e,a);if(e.v==null&&!e.bf){Ie(t,513,ws(n,r,s));return}if(e.bf)Ie(t,6,F7(e,n,r,a,s));else switch(e.t){case"d":case"n":var l=e.t=="d"?En(Xt(e.v)):e.v;Ie(t,515,dL(n,r,l,s));break;case"b":case"e":Ie(t,517,uL(n,r,e.v,s,a,e.t));break;case"s":case"str":if(a.bookSST){var c=_p(a.Strings,e.v,a.revStrings);Ie(t,253,XP(n,r,c,s))}else Ie(t,516,ZP(n,r,(e.v||"").slice(0,255),s,a));break;default:Ie(t,513,ws(n,r,s))}}function lH(t,e,n){var r=xr(),a=n.SheetNames[t],s=n.Sheets[a]||{},l=(n||{}).Workbook||{},c=(l.Sheets||[])[t]||{},f=Array.isArray(s),d=e.biff==8,g,x="",_=[],T=xt(s["!ref"]||"A1"),E=d?65536:16384;if(T.e.c>255||T.e.r>=E){if(e.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");T.e.c=Math.min(T.e.c,255),T.e.r=Math.min(T.e.c,E-1)}Ie(r,2057,dp(n,16,e)),Ie(r,13,Yr(1)),Ie(r,12,Yr(100)),Ie(r,15,cr(!0)),Ie(r,17,cr(!1)),Ie(r,16,_s(.001)),Ie(r,95,cr(!0)),Ie(r,42,cr(!1)),Ie(r,43,cr(!1)),Ie(r,130,Yr(1)),Ie(r,128,cL()),Ie(r,131,cr(!1)),Ie(r,132,cr(!1)),d&&sH(r,s["!cols"]),Ie(r,512,nL(T,e)),d&&(s["!links"]=[]);for(var S=T.s.r;S<=T.e.r;++S){x=mn(S);for(var C=T.s.c;C<=T.e.c;++C){S===T.s.r&&(_[C]=tn(C)),g=_[C]+x;var k=f?(s[S]||[])[C]:s[g];k&&(oH(r,k,S,C,e),d&&k.l&&s["!links"].push([g,k.l]))}}var N=c.CodeName||c.name||a;return d&&Ie(r,574,jP((l.Views||[])[0])),d&&(s["!merges"]||[]).length&&Ie(r,229,wL(s["!merges"])),d&&iH(r,s),Ie(r,442,Uw(N)),d&&rH(r,s),Ie(r,10),r.end()}function cH(t,e,n){var r=xr(),a=(t||{}).Workbook||{},s=a.Sheets||[],l=a.WBProps||{},c=n.biff==8,f=n.biff==5;if(Ie(r,2057,dp(t,5,n)),n.bookType=="xla"&&Ie(r,135),Ie(r,225,c?Yr(1200):null),Ie(r,193,uP(2)),f&&Ie(r,191),f&&Ie(r,192),Ie(r,226),Ie(r,92,RP("SheetJS",n)),Ie(r,66,Yr(c?1200:1252)),c&&Ie(r,353,Yr(0)),c&&Ie(r,448),Ie(r,317,BL(t.SheetNames.length)),c&&t.vbaraw&&Ie(r,211),c&&t.vbaraw){var d=l.CodeName||"ThisWorkbook";Ie(r,442,Uw(d))}Ie(r,156,Yr(17)),Ie(r,25,cr(!1)),Ie(r,18,cr(!1)),Ie(r,19,Yr(0)),c&&Ie(r,431,cr(!1)),c&&Ie(r,444,Yr(0)),Ie(r,61,zP()),Ie(r,64,cr(!1)),Ie(r,141,Yr(0)),Ie(r,34,cr(GV(t)=="true")),Ie(r,14,cr(!0)),c&&Ie(r,439,cr(!1)),Ie(r,218,Yr(0)),tH(r,t,n),nH(r,t.SSF,n),aH(r,n),c&&Ie(r,352,cr(!1));var g=r.end(),x=xr();c&&Ie(x,140,RL()),c&&n.Strings&&JG(x,252,OP(n.Strings)),Ie(x,10);var _=x.end(),T=xr(),E=0,S=0;for(S=0;S<t.SheetNames.length;++S)E+=(c?12:11)+(c?2:1)*t.SheetNames[S].length;var C=g.length+E+_.length;for(S=0;S<t.SheetNames.length;++S){var k=s[S]||{};Ie(T,133,PP({pos:C,hs:k.Hidden||0,dt:0,name:t.SheetNames[S]},n)),C+=e[S].length}var N=T.end();if(E!=N.length)throw new Error("BS8 "+E+" != "+N.length);var b=[];return g.length&&b.push(g),N.length&&b.push(N),_.length&&b.push(_),In(b)}function uH(t,e){var n=e||{},r=[];t&&!t.SSF&&(t.SSF=Kt(Ye)),t&&t.SSF&&(Xo(),Yf(t.SSF),n.revssf=Xf(t.SSF),n.revssf[t.SSF[65535]]=0,n.ssf=t.SSF),n.Strings=[],n.Strings.Count=0,n.Strings.Unique=0,Cp(n),n.cellXfs=[],Gi(n.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={});for(var a=0;a<t.SheetNames.length;++a)r[r.length]=lH(a,n,t);return r.unshift(cH(t,r,n)),In(r)}function DS(t,e){for(var n=0;n<=t.SheetNames.length;++n){var r=t.Sheets[t.SheetNames[n]];if(!(!r||!r["!ref"])){var a=vr(r["!ref"]);a.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+t.SheetNames[n]+"' extends beyond column IV (255).  Data may be lost.")}}var s=e||{};switch(s.biff||2){case 8:case 5:return uH(t,e);case 4:case 3:case 2:return eH(t,e)}throw new Error("invalid type "+s.bookType+" for BIFF")}function d2(t,e){var n=e||{},r=n.dense?[]:{};t=t.replace(/<!--.*?-->/g,"");var a=t.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var s=t.match(/<\/table/i),l=a.index,c=s&&s.index||t.length,f=YI(t.slice(l,c),/(:?<tr[^>]*>)/i,"<tr>"),d=-1,g=0,x=0,_=0,T={s:{r:1e7,c:1e7},e:{r:0,c:0}},E=[];for(l=0;l<f.length;++l){var S=f[l].trim(),C=S.slice(0,3).toLowerCase();if(C=="<tr"){if(++d,n.sheetRows&&n.sheetRows<=d){--d;break}g=0;continue}if(!(C!="<td"&&C!="<th")){var k=S.split(/<\/t[dh]>/i);for(c=0;c<k.length;++c){var N=k[c].trim();if(N.match(/<t[dh]/i)){for(var b=N,I=0;b.charAt(0)=="<"&&(I=b.indexOf(">"))>-1;)b=b.slice(I+1);for(var F=0;F<E.length;++F){var P=E[F];P.s.c==g&&P.s.r<d&&d<=P.e.r&&(g=P.e.c+1,F=-1)}var D=Ze(N.slice(0,N.indexOf(">")));_=D.colspan?+D.colspan:1,((x=+D.rowspan)>1||_>1)&&E.push({s:{r:d,c:g},e:{r:d+(x||1)-1,c:g+_-1}});var j=D.t||D["data-t"]||"";if(!b.length){g+=_;continue}if(b=tw(b),T.s.r>d&&(T.s.r=d),T.e.r<d&&(T.e.r=d),T.s.c>g&&(T.s.c=g),T.e.c<g&&(T.e.c=g),!b.length){g+=_;continue}var B={t:"s",v:b};n.raw||!b.trim().length||j=="s"||(b==="TRUE"?B={t:"b",v:!0}:b==="FALSE"?B={t:"b",v:!1}:isNaN(ua(b))?isNaN(Bo(b).getDate())||(B={t:"d",v:Xt(b)},n.cellDates||(B={t:"n",v:En(B.v)}),B.z=n.dateNF||Ye[14]):B={t:"n",v:ua(b)}),n.dense?(r[d]||(r[d]=[]),r[d][g]=B):r[Je({r:d,c:g})]=B,g+=_}}}}return r["!ref"]=rt(T),E.length&&(r["!merges"]=E),r}function fH(t,e,n,r){for(var a=t["!merges"]||[],s=[],l=e.s.c;l<=e.e.c;++l){for(var c=0,f=0,d=0;d<a.length;++d)if(!(a[d].s.r>n||a[d].s.c>l)&&!(a[d].e.r<n||a[d].e.c<l)){if(a[d].s.r<n||a[d].s.c<l){c=-1;break}c=a[d].e.r-a[d].s.r+1,f=a[d].e.c-a[d].s.c+1;break}if(!(c<0)){var g=Je({r:n,c:l}),x=r.dense?(t[n]||[])[l]:t[g],_=x&&x.v!=null&&(x.h||Qm(x.w||(Xa(x),x.w)||""))||"",T={};c>1&&(T.rowspan=c),f>1&&(T.colspan=f),r.editable?_='<span contenteditable="true">'+_+"</span>":x&&(T["data-t"]=x&&x.t||"z",x.v!=null&&(T["data-v"]=x.v),x.z!=null&&(T["data-z"]=x.z),x.l&&(x.l.Target||"#").charAt(0)!="#"&&(_='<a href="'+x.l.Target+'">'+_+"</a>")),T.id=(r.id||"sjs")+"-"+g,s.push(Fe("td",_,T))}}var E="<tr>";return E+s.join("")+"</tr>"}var dH='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',hH="</body></html>";function mH(t,e){var n=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!n||n.length==0)throw new Error("Invalid HTML: could not find <table>");if(n.length==1)return Vi(d2(n[0],e),e);var r=kp();return n.forEach(function(a,s){Np(r,d2(a,e),"Sheet"+(s+1))}),r}function pH(t,e,n){var r=[];return r.join("")+"<table"+(n&&n.id?' id="'+n.id+'"':"")+">"}function RS(t,e){var n=e||{},r=n.header!=null?n.header:dH,a=n.footer!=null?n.footer:hH,s=[r],l=vr(t["!ref"]);n.dense=Array.isArray(t),s.push(pH(t,l,n));for(var c=l.s.r;c<=l.e.r;++c)s.push(fH(t,l,c,n));return s.push("</table>"+a),s.join("")}function FS(t,e,n){var r=n||{},a=0,s=0;if(r.origin!=null)if(typeof r.origin=="number")a=r.origin;else{var l=typeof r.origin=="string"?nn(r.origin):r.origin;a=l.r,s=l.c}var c=e.getElementsByTagName("tr"),f=Math.min(r.sheetRows||1e7,c.length),d={s:{r:0,c:0},e:{r:a,c:s}};if(t["!ref"]){var g=vr(t["!ref"]);d.s.r=Math.min(d.s.r,g.s.r),d.s.c=Math.min(d.s.c,g.s.c),d.e.r=Math.max(d.e.r,g.e.r),d.e.c=Math.max(d.e.c,g.e.c),a==-1&&(d.e.r=a=g.e.r+1)}var x=[],_=0,T=t["!rows"]||(t["!rows"]=[]),E=0,S=0,C=0,k=0,N=0,b=0;for(t["!cols"]||(t["!cols"]=[]);E<c.length&&S<f;++E){var I=c[E];if(h2(I)){if(r.display)continue;T[S]={hidden:!0}}var F=I.children;for(C=k=0;C<F.length;++C){var P=F[C];if(!(r.display&&h2(P))){var D=P.hasAttribute("data-v")?P.getAttribute("data-v"):P.hasAttribute("v")?P.getAttribute("v"):tw(P.innerHTML),j=P.getAttribute("data-z")||P.getAttribute("z");for(_=0;_<x.length;++_){var B=x[_];B.s.c==k+s&&B.s.r<S+a&&S+a<=B.e.r&&(k=B.e.c+1-s,_=-1)}b=+P.getAttribute("colspan")||1,((N=+P.getAttribute("rowspan")||1)>1||b>1)&&x.push({s:{r:S+a,c:k+s},e:{r:S+a+(N||1)-1,c:k+s+(b||1)-1}});var te={t:"s",v:D},X=P.getAttribute("data-t")||P.getAttribute("t")||"";D!=null&&(D.length==0?te.t=X||"z":r.raw||D.trim().length==0||X=="s"||(D==="TRUE"?te={t:"b",v:!0}:D==="FALSE"?te={t:"b",v:!1}:isNaN(ua(D))?isNaN(Bo(D).getDate())||(te={t:"d",v:Xt(D)},r.cellDates||(te={t:"n",v:En(te.v)}),te.z=r.dateNF||Ye[14]):te={t:"n",v:ua(D)})),te.z===void 0&&j!=null&&(te.z=j);var Z="",ye=P.getElementsByTagName("A");if(ye&&ye.length)for(var Me=0;Me<ye.length&&!(ye[Me].hasAttribute("href")&&(Z=ye[Me].getAttribute("href"),Z.charAt(0)!="#"));++Me);Z&&Z.charAt(0)!="#"&&(te.l={Target:Z}),r.dense?(t[S+a]||(t[S+a]=[]),t[S+a][k+s]=te):t[Je({c:k+s,r:S+a})]=te,d.e.c<k+s&&(d.e.c=k+s),k+=b}}++S}return x.length&&(t["!merges"]=(t["!merges"]||[]).concat(x)),d.e.r=Math.max(d.e.r,S-1+a),t["!ref"]=rt(d),S>=f&&(t["!fullref"]=rt((d.e.r=c.length-E+S-1+a,d))),t}function IS(t,e){var n=e||{},r=n.dense?[]:{};return FS(r,t,e)}function gH(t,e){return Vi(IS(t,e),e)}function h2(t){var e="",n=xH(t);return n&&(e=n(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function xH(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function vH(t){var e=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(r,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),n=gt(e.replace(/<[^>]*>/g,""));return[n]}var m2={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function PS(t,e){var n=e||{},r=ep(t),a=[],s,l,c={name:""},f="",d=0,g,x,_={},T=[],E=n.dense?[]:{},S,C,k={value:""},N="",b=0,I=[],F=-1,P=-1,D={s:{r:1e6,c:1e7},e:{r:0,c:0}},j=0,B={},te=[],X={},Z=0,ye=0,Me=[],Se=1,ee=1,me=[],Pe={Names:[]},re={},z=["",""],ce=[],L={},W="",q=0,K=!1,ie=!1,Ce=0;for(Ec.lastIndex=0,r=r.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");S=Ec.exec(r);)switch(S[3]=S[3].replace(/_.*$/,"")){case"table":case"":S[1]==="/"?(D.e.c>=D.s.c&&D.e.r>=D.s.r?E["!ref"]=rt(D):E["!ref"]="A1:A1",n.sheetRows>0&&n.sheetRows<=D.e.r&&(E["!fullref"]=E["!ref"],D.e.r=n.sheetRows-1,E["!ref"]=rt(D)),te.length&&(E["!merges"]=te),Me.length&&(E["!rows"]=Me),g.name=g.||g.name,typeof JSON<"u"&&JSON.stringify(g),T.push(g.name),_[g.name]=E,ie=!1):S[0].charAt(S[0].length-2)!=="/"&&(g=Ze(S[0],!1),F=P=-1,D.s.r=D.s.c=1e7,D.e.r=D.e.c=0,E=n.dense?[]:{},te=[],Me=[],ie=!0);break;case"table-row-group":S[1]==="/"?--j:++j;break;case"table-row":case"":if(S[1]==="/"){F+=Se,Se=1;break}if(x=Ze(S[0],!1),x.?F=x.-1:F==-1&&(F=0),Se=+x["number-rows-repeated"]||1,Se<10)for(Ce=0;Ce<Se;++Ce)j>0&&(Me[F+Ce]={level:j});P=-1;break;case"covered-table-cell":S[1]!=="/"&&++P,n.sheetStubs&&(n.dense?(E[F]||(E[F]=[]),E[F][P]={t:"z"}):E[Je({r:F,c:P})]={t:"z"}),N="",I=[];break;case"table-cell":case"":if(S[0].charAt(S[0].length-2)==="/")++P,k=Ze(S[0],!1),ee=parseInt(k["number-columns-repeated"]||"1",10),C={t:"z",v:null},k.formula&&n.cellFormula!=!1&&(C.f=c2(gt(k.formula))),(k.||k["value-type"])=="string"&&(C.t="s",C.v=gt(k["string-value"]||""),n.dense?(E[F]||(E[F]=[]),E[F][P]=C):E[Je({r:F,c:P})]=C),P+=ee-1;else if(S[1]!=="/"){++P,N="",b=0,I=[],ee=1;var Te=Se?F+Se-1:F;if(P>D.e.c&&(D.e.c=P),P<D.s.c&&(D.s.c=P),F<D.s.r&&(D.s.r=F),Te>D.e.r&&(D.e.r=Te),k=Ze(S[0],!1),ce=[],L={},C={t:k.||k["value-type"],v:null},n.cellFormula)if(k.formula&&(k.formula=gt(k.formula)),k["number-matrix-columns-spanned"]&&k["number-matrix-rows-spanned"]&&(Z=parseInt(k["number-matrix-rows-spanned"],10)||0,ye=parseInt(k["number-matrix-columns-spanned"],10)||0,X={s:{r:F,c:P},e:{r:F+Z-1,c:P+ye-1}},C.F=rt(X),me.push([X,C.F])),k.formula)C.f=c2(k.formula);else for(Ce=0;Ce<me.length;++Ce)F>=me[Ce][0].s.r&&F<=me[Ce][0].e.r&&P>=me[Ce][0].s.c&&P<=me[Ce][0].e.c&&(C.F=me[Ce][1]);switch((k["number-columns-spanned"]||k["number-rows-spanned"])&&(Z=parseInt(k["number-rows-spanned"],10)||0,ye=parseInt(k["number-columns-spanned"],10)||0,X={s:{r:F,c:P},e:{r:F+Z-1,c:P+ye-1}},te.push(X)),k["number-columns-repeated"]&&(ee=parseInt(k["number-columns-repeated"],10)),C.t){case"boolean":C.t="b",C.v=Jt(k["boolean-value"]);break;case"float":C.t="n",C.v=parseFloat(k.value);break;case"percentage":C.t="n",C.v=parseFloat(k.value);break;case"currency":C.t="n",C.v=parseFloat(k.value);break;case"date":C.t="d",C.v=Xt(k["date-value"]),n.cellDates||(C.t="n",C.v=En(C.v)),C.z="m/d/yy";break;case"time":C.t="n",C.v=jI(k["time-value"])/86400,n.cellDates&&(C.t="d",C.v=Kf(C.v)),C.z="HH:MM:SS";break;case"number":C.t="n",C.v=parseFloat(k.);break;default:if(C.t==="string"||C.t==="text"||!C.t)C.t="s",k["string-value"]!=null&&(N=gt(k["string-value"]),I=[]);else throw new Error("Unsupported value type "+C.t)}}else{if(K=!1,C.t==="s"&&(C.v=N||"",I.length&&(C.R=I),K=b==0),re.Target&&(C.l=re),ce.length>0&&(C.c=ce,ce=[]),N&&n.cellText!==!1&&(C.w=N),K&&(C.t="z",delete C.v),(!K||n.sheetStubs)&&!(n.sheetRows&&n.sheetRows<=F))for(var be=0;be<Se;++be){if(ee=parseInt(k["number-columns-repeated"]||"1",10),n.dense)for(E[F+be]||(E[F+be]=[]),E[F+be][P]=be==0?C:Kt(C);--ee>0;)E[F+be][P+ee]=Kt(C);else for(E[Je({r:F+be,c:P})]=C;--ee>0;)E[Je({r:F+be,c:P+ee})]=Kt(C);D.e.c<=P&&(D.e.c=P)}ee=parseInt(k["number-columns-repeated"]||"1",10),P+=ee-1,ee=0,C={},N="",I=[]}re={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(S[1]==="/"){if((s=a.pop())[0]!==S[3])throw"Bad state: "+s}else S[0].charAt(S[0].length-2)!=="/"&&a.push([S[3],!0]);break;case"annotation":if(S[1]==="/"){if((s=a.pop())[0]!==S[3])throw"Bad state: "+s;L.t=N,I.length&&(L.R=I),L.a=W,ce.push(L)}else S[0].charAt(S[0].length-2)!=="/"&&a.push([S[3],!1]);W="",q=0,N="",b=0,I=[];break;case"creator":S[1]==="/"?W=r.slice(q,S.index):q=S.index+S[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(S[1]==="/"){if((s=a.pop())[0]!==S[3])throw"Bad state: "+s}else S[0].charAt(S[0].length-2)!=="/"&&a.push([S[3],!1]);N="",b=0,I=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(S[1]==="/"){if(B[c.name]=f,(s=a.pop())[0]!==S[3])throw"Bad state: "+s}else S[0].charAt(S[0].length-2)!=="/"&&(f="",c=Ze(S[0],!1),a.push([S[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":l=Ze(S[0],!1),f+=m2[S[3]][l.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":l=Ze(S[0],!1),f+=m2[S[3]][l.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(S[0].slice(-2)==="/>")break;if(S[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":f+=r.slice(d,S.index);break}else d=S.index+S[0].length;break;case"named-range":l=Ze(S[0],!1),z=Nh(l["cell-range-address"]);var Ae={Name:l.name,Ref:z[0]+"!"+z[1]};ie&&(Ae.Sheet=T.length),Pe.Names.push(Ae);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(S[1]==="/"&&(!k||!k["string-value"])){var Xe=vH(r.slice(b,S.index));N=(N.length>0?N+`
`:"")+Xe[0]}else Ze(S[0],!1),b=S.index+S[0].length;break;case"s":break;case"database-range":if(S[1]==="/")break;try{z=Nh(Ze(S[0])["target-range-address"]),_[z[0]]["!autofilter"]={ref:z[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(S[1]!=="/"){if(re=Ze(S[0],!1),!re.href)break;re.Target=gt(re.href),delete re.href,re.Target.charAt(0)=="#"&&re.Target.indexOf(".")>-1?(z=Nh(re.Target.slice(1)),re.Target="#"+z[0]+"!"+z[1]):re.Target.match(/^\.\.[\\\/]/)&&(re.Target=re.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(S[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(n.WTF)throw new Error(S)}}var Y={Sheets:_,SheetNames:T,Workbook:Pe};return n.bookSheets&&delete Y.Sheets,Y}function p2(t,e){e=e||{},Wr(t,"META-INF/manifest.xml")&&j5(yn(t,"META-INF/manifest.xml"),e);var n=Mr(t,"content.xml");if(!n)throw new Error("Missing content.xml in ODS / UOF file");var r=PS(Bt(n),e);return Wr(t,"meta.xml")&&(r.Props=Cw(yn(t,"meta.xml"))),r}function g2(t,e){return PS(t,e)}var yH=function(){var t=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+Sc({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+t+"</office:document-styles>";return function(){return pn+e}}(),x2=function(){var t=function(s){return Dt(s).replace(/  +/g,function(l){return'<text:s text:c="'+l.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,n=`          <table:covered-table-cell/>
`,r=function(s,l,c){var f=[];f.push('      <table:table table:name="'+Dt(l.SheetNames[c])+`" table:style-name="ta1">
`);var d=0,g=0,x=vr(s["!ref"]||"A1"),_=s["!merges"]||[],T=0,E=Array.isArray(s);if(s["!cols"])for(g=0;g<=x.e.c;++g)f.push("        <table:table-column"+(s["!cols"][g]?' table:style-name="co'+s["!cols"][g].ods+'"':"")+`></table:table-column>
`);var S="",C=s["!rows"]||[];for(d=0;d<x.s.r;++d)S=C[d]?' table:style-name="ro'+C[d].ods+'"':"",f.push("        <table:table-row"+S+`></table:table-row>
`);for(;d<=x.e.r;++d){for(S=C[d]?' table:style-name="ro'+C[d].ods+'"':"",f.push("        <table:table-row"+S+`>
`),g=0;g<x.s.c;++g)f.push(e);for(;g<=x.e.c;++g){var k=!1,N={},b="";for(T=0;T!=_.length;++T)if(!(_[T].s.c>g)&&!(_[T].s.r>d)&&!(_[T].e.c<g)&&!(_[T].e.r<d)){(_[T].s.c!=g||_[T].s.r!=d)&&(k=!0),N["table:number-columns-spanned"]=_[T].e.c-_[T].s.c+1,N["table:number-rows-spanned"]=_[T].e.r-_[T].s.r+1;break}if(k){f.push(n);continue}var I=Je({r:d,c:g}),F=E?(s[d]||[])[g]:s[I];if(F&&F.f&&(N["table:formula"]=Dt(B7(F.f)),F.F&&F.F.slice(0,I.length)==I)){var P=vr(F.F);N["table:number-matrix-columns-spanned"]=P.e.c-P.s.c+1,N["table:number-matrix-rows-spanned"]=P.e.r-P.s.r+1}if(!F){f.push(e);continue}switch(F.t){case"b":b=F.v?"TRUE":"FALSE",N["office:value-type"]="boolean",N["office:boolean-value"]=F.v?"true":"false";break;case"n":b=F.w||String(F.v||0),N["office:value-type"]="float",N["office:value"]=F.v||0;break;case"s":case"str":b=F.v==null?"":F.v,N["office:value-type"]="string";break;case"d":b=F.w||Xt(F.v).toISOString(),N["office:value-type"]="date",N["office:date-value"]=Xt(F.v).toISOString(),N["table:style-name"]="ce1";break;default:f.push(e);continue}var D=t(b);if(F.l&&F.l.Target){var j=F.l.Target;j=j.charAt(0)=="#"?"#"+V7(j.slice(1)):j,j.charAt(0)!="#"&&!j.match(/^\w+:/)&&(j="../"+j),D=Fe("text:a",D,{"xlink:href":j.replace(/&/g,"&amp;")})}f.push("          "+Fe("table:table-cell",Fe("text:p",D,{}),N)+`
`)}f.push(`        </table:table-row>
`)}return f.push(`      </table:table>
`),f.join("")},a=function(s,l){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var c=0;l.SheetNames.map(function(d){return l.Sheets[d]}).forEach(function(d){if(d&&d["!cols"]){for(var g=0;g<d["!cols"].length;++g)if(d["!cols"][g]){var x=d["!cols"][g];if(x.width==null&&x.wpx==null&&x.wch==null)continue;Pi(x),x.ods=c;var _=d["!cols"][g].wpx+"px";s.push('  <style:style style:name="co'+c+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+_+`"/>
`),s.push(`  </style:style>
`),++c}}});var f=0;l.SheetNames.map(function(d){return l.Sheets[d]}).forEach(function(d){if(d&&d["!rows"]){for(var g=0;g<d["!rows"].length;++g)if(d["!rows"][g]){d["!rows"][g].ods=f;var x=d["!rows"][g].hpx+"px";s.push('  <style:style style:name="ro'+f+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+x+`"/>
`),s.push(`  </style:style>
`),++f}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(l,c){var f=[pn],d=Sc({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),g=Sc({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});c.bookType=="fods"?(f.push("<office:document"+d+g+`>
`),f.push(Ew().replace(/office:document-meta/g,"office:meta"))):f.push("<office:document-content"+d+`>
`),a(f,l),f.push(`  <office:body>
`),f.push(`    <office:spreadsheet>
`);for(var x=0;x!=l.SheetNames.length;++x)f.push(r(l.Sheets[l.SheetNames[x]],l,x));return f.push(`    </office:spreadsheet>
`),f.push(`  </office:body>
`),c.bookType=="fods"?f.push("</office:document>"):f.push("</office:document-content>"),f.join("")}}();function LS(t,e){if(e.bookType=="fods")return x2(t,e);var n=Xm(),r="",a=[],s=[];return r="mimetype",it(n,r,"application/vnd.oasis.opendocument.spreadsheet"),r="content.xml",it(n,r,x2(t,e)),a.push([r,"text/xml"]),s.push([r,"ContentFile"]),r="styles.xml",it(n,r,yH(t,e)),a.push([r,"text/xml"]),s.push([r,"StylesFile"]),r="meta.xml",it(n,r,pn+Ew()),a.push([r,"text/xml"]),s.push([r,"MetadataFile"]),r="manifest.rdf",it(n,r,Y5(s)),a.push([r,"application/rdf+xml"]),r="META-INF/manifest.xml",it(n,r,$5(a)),n}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Ss(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function dm(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):Bt(Bi(t))}function _H(t){return typeof TextEncoder<"u"?new TextEncoder().encode(t):Nr(Ea(t))}function TH(t,e){e:for(var n=0;n<=t.length-e.length;++n){for(var r=0;r<e.length;++r)if(t[n+r]!=e[r])continue e;return!0}return!1}function Oi(t){var e=t.reduce(function(a,s){return a+s.length},0),n=new Uint8Array(e),r=0;return t.forEach(function(a){n.set(a,r),r+=a.length}),n}function v2(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function wH(t,e){for(var n=(t[e+15]&127)<<7|t[e+14]>>1,r=t[e+14]&1,a=e+13;a>=e;--a)r=r*256+t[a];return(t[e+15]&128?-r:r)*Math.pow(10,n-6176)}function SH(t,e,n){var r=Math.floor(n==0?0:Math.LOG10E*Math.log(Math.abs(n)))+6176-20,a=n/Math.pow(10,r-6176);t[e+15]|=r>>7,t[e+14]|=(r&127)<<1;for(var s=0;a>=1;++s,a/=256)t[e+s]=a&255;t[e+15]|=n>=0?0:128}function Dc(t,e){var n=e?e[0]:0,r=t[n]&127;e:if(t[n++]>=128&&(r|=(t[n]&127)<<7,t[n++]<128||(r|=(t[n]&127)<<14,t[n++]<128)||(r|=(t[n]&127)<<21,t[n++]<128)||(r+=(t[n]&127)*Math.pow(2,28),++n,t[n++]<128)||(r+=(t[n]&127)*Math.pow(2,35),++n,t[n++]<128)||(r+=(t[n]&127)*Math.pow(2,42),++n,t[n++]<128)))break e;return e&&(e[0]=n),r}function Nt(t){var e=new Uint8Array(7);e[0]=t&127;var n=1;e:if(t>127){if(e[n-1]|=128,e[n]=t>>7&127,++n,t<=16383||(e[n-1]|=128,e[n]=t>>14&127,++n,t<=2097151)||(e[n-1]|=128,e[n]=t>>21&127,++n,t<=268435455)||(e[n-1]|=128,e[n]=t/256>>>21&127,++n,t<=34359738367)||(e[n-1]|=128,e[n]=t/65536>>>21&127,++n,t<=4398046511103))break e;e[n-1]|=128,e[n]=t/16777216>>>21&127,++n}return e.slice(0,n)}function on(t){var e=0,n=t[e]&127;e:if(t[e++]>=128){if(n|=(t[e]&127)<<7,t[e++]<128||(n|=(t[e]&127)<<14,t[e++]<128)||(n|=(t[e]&127)<<21,t[e++]<128))break e;n|=(t[e]&127)<<28}return n}function wt(t){for(var e=[],n=[0];n[0]<t.length;){var r=n[0],a=Dc(t,n),s=a&7;a=Math.floor(a/8);var l=0,c;if(a==0)break;switch(s){case 0:{for(var f=n[0];t[n[0]++]>=128;);c=t.slice(f,n[0])}break;case 5:l=4,c=t.slice(n[0],n[0]+l),n[0]+=l;break;case 1:l=8,c=t.slice(n[0],n[0]+l),n[0]+=l;break;case 2:l=Dc(t,n),c=t.slice(n[0],n[0]+l),n[0]+=l;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(a," at offset ").concat(r))}var d={data:c,type:s};e[a]==null?e[a]=[d]:e[a].push(d)}return e}function zn(t){var e=[];return t.forEach(function(n,r){n.forEach(function(a){a.data&&(e.push(Nt(r*8+a.type)),a.type==2&&e.push(Nt(a.data.length)),e.push(a.data))})}),Oi(e)}function Sp(t,e){return(t==null?void 0:t.map(function(n){return e(n.data)}))||[]}function jr(t){for(var e,n=[],r=[0];r[0]<t.length;){var a=Dc(t,r),s=wt(t.slice(r[0],r[0]+a));r[0]+=a;var l={id:on(s[1][0].data),messages:[]};s[2].forEach(function(c){var f=wt(c.data),d=on(f[3][0].data);l.messages.push({meta:f,data:t.slice(r[0],r[0]+d)}),r[0]+=d}),(e=s[3])!=null&&e[0]&&(l.merge=on(s[3][0].data)>>>0>0),n.push(l)}return n}function Eo(t){var e=[];return t.forEach(function(n){var r=[];r[1]=[{data:Nt(n.id),type:0}],r[2]=[],n.merge!=null&&(r[3]=[{data:Nt(+!!n.merge),type:0}]);var a=[];n.messages.forEach(function(l){a.push(l.data),l.meta[3]=[{type:0,data:Nt(l.data.length)}],r[2].push({data:zn(l.meta),type:2})});var s=zn(r);e.push(Nt(s.length)),e.push(s),a.forEach(function(l){return e.push(l)})}),Oi(e)}function EH(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var n=[0],r=Dc(e,n),a=[];n[0]<e.length;){var s=e[n[0]]&3;if(s==0){var l=e[n[0]++]>>2;if(l<60)++l;else{var c=l-59;l=e[n[0]],c>1&&(l|=e[n[0]+1]<<8),c>2&&(l|=e[n[0]+2]<<16),c>3&&(l|=e[n[0]+3]<<24),l>>>=0,l++,n[0]+=c}a.push(e.slice(n[0],n[0]+l)),n[0]+=l;continue}else{var f=0,d=0;if(s==1?(d=(e[n[0]]>>2&7)+4,f=(e[n[0]++]&224)<<3,f|=e[n[0]++]):(d=(e[n[0]++]>>2)+1,s==2?(f=e[n[0]]|e[n[0]+1]<<8,n[0]+=2):(f=(e[n[0]]|e[n[0]+1]<<8|e[n[0]+2]<<16|e[n[0]+3]<<24)>>>0,n[0]+=4)),a=[Oi(a)],f==0)throw new Error("Invalid offset 0");if(f>a[0].length)throw new Error("Invalid offset beyond length");if(d>=f)for(a.push(a[0].slice(-f)),d-=f;d>=a[a.length-1].length;)a.push(a[a.length-1]),d-=a[a.length-1].length;a.push(a[0].slice(-f,-f+d))}}var g=Oi(a);if(g.length!=r)throw new Error("Unexpected length: ".concat(g.length," != ").concat(r));return g}function $r(t){for(var e=[],n=0;n<t.length;){var r=t[n++],a=t[n]|t[n+1]<<8|t[n+2]<<16;n+=3,e.push(EH(r,t.slice(n,n+a))),n+=a}if(n!==t.length)throw new Error("data is not a valid framed stream!");return Oi(e)}function Co(t){for(var e=[],n=0;n<t.length;){var r=Math.min(t.length-n,268435455),a=new Uint8Array(4);e.push(a);var s=Nt(r),l=s.length;e.push(s),r<=60?(l++,e.push(new Uint8Array([r-1<<2]))):r<=256?(l+=2,e.push(new Uint8Array([240,r-1&255]))):r<=65536?(l+=3,e.push(new Uint8Array([244,r-1&255,r-1>>8&255]))):r<=16777216?(l+=4,e.push(new Uint8Array([248,r-1&255,r-1>>8&255,r-1>>16&255]))):r<=4294967296&&(l+=5,e.push(new Uint8Array([252,r-1&255,r-1>>8&255,r-1>>16&255,r-1>>>24&255]))),e.push(t.slice(n,n+r)),l+=r,a[0]=0,a[1]=l&255,a[2]=l>>8&255,a[3]=l>>16&255,n+=r}return Oi(e)}function CH(t,e,n,r){var a=Ss(t),s=a.getUint32(4,!0),l=(r>1?12:8)+v2(s&(r>1?3470:398))*4,c=-1,f=-1,d=NaN,g=new Date(2001,0,1);s&512&&(c=a.getUint32(l,!0),l+=4),l+=v2(s&(r>1?12288:4096))*4,s&16&&(f=a.getUint32(l,!0),l+=4),s&32&&(d=a.getFloat64(l,!0),l+=8),s&64&&(g.setTime(g.getTime()+a.getFloat64(l,!0)*1e3),l+=8);var x;switch(t[2]){case 0:break;case 2:x={t:"n",v:d};break;case 3:x={t:"s",v:e[f]};break;case 5:x={t:"d",v:g};break;case 6:x={t:"b",v:d>0};break;case 7:x={t:"n",v:d/86400};break;case 8:x={t:"e",v:0};break;case 9:if(c>-1)x={t:"s",v:n[c]};else if(f>-1)x={t:"s",v:e[f]};else if(!isNaN(d))x={t:"n",v:d};else throw new Error("Unsupported cell type ".concat(t.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return x}function bH(t,e,n){var r=Ss(t),a=r.getUint32(8,!0),s=12,l=-1,c=-1,f=NaN,d=NaN,g=new Date(2001,0,1);a&1&&(f=wH(t,s),s+=16),a&2&&(d=r.getFloat64(s,!0),s+=8),a&4&&(g.setTime(g.getTime()+r.getFloat64(s,!0)*1e3),s+=8),a&8&&(c=r.getUint32(s,!0),s+=4),a&16&&(l=r.getUint32(s,!0),s+=4);var x;switch(t[1]){case 0:break;case 2:x={t:"n",v:f};break;case 3:x={t:"s",v:e[c]};break;case 5:x={t:"d",v:g};break;case 6:x={t:"b",v:d>0};break;case 7:x={t:"n",v:d/86400};break;case 8:x={t:"e",v:0};break;case 9:if(l>-1)x={t:"s",v:n[l]};else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(a&31," : ").concat(t.slice(0,4)));break;case 10:x={t:"n",v:f};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(a&31," : ").concat(t.slice(0,4)))}return x}function Dh(t,e){var n=new Uint8Array(32),r=Ss(n),a=12,s=0;switch(n[0]=5,t.t){case"n":n[1]=2,SH(n,a,t.v),s|=1,a+=16;break;case"b":n[1]=6,r.setFloat64(a,t.v?1:0,!0),s|=2,a+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));n[1]=3,r.setUint32(a,e.indexOf(t.v),!0),s|=8,a+=4;break;default:throw"unsupported cell type "+t.t}return r.setUint32(8,s,!0),n.slice(0,a)}function Rh(t,e){var n=new Uint8Array(32),r=Ss(n),a=12,s=0;switch(n[0]=3,t.t){case"n":n[2]=2,r.setFloat64(a,t.v,!0),s|=32,a+=8;break;case"b":n[2]=6,r.setFloat64(a,t.v?1:0,!0),s|=32,a+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));n[2]=3,r.setUint32(a,e.indexOf(t.v),!0),s|=16,a+=4;break;default:throw"unsupported cell type "+t.t}return r.setUint32(4,s,!0),n.slice(0,a)}function AH(t,e,n){switch(t[0]){case 0:case 1:case 2:case 3:return CH(t,e,n,t[0]);case 5:return bH(t,e,n);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function Kn(t){var e=wt(t);return Dc(e[1][0].data)}function y2(t,e){var n=wt(e.data),r=on(n[1][0].data),a=n[3],s=[];return(a||[]).forEach(function(l){var c=wt(l.data),f=on(c[1][0].data)>>>0;switch(r){case 1:s[f]=dm(c[3][0].data);break;case 8:{var d=t[Kn(c[9][0].data)][0],g=wt(d.data),x=t[Kn(g[1][0].data)][0],_=on(x.meta[1][0].data);if(_!=2001)throw new Error("2000 unexpected reference to ".concat(_));var T=wt(x.data);s[f]=T[3].map(function(E){return dm(E.data)}).join("")}break}}),s}function kH(t,e){var n,r,a,s,l,c,f,d,g,x,_,T,E,S,C=wt(t),k=on(C[1][0].data)>>>0,N=on(C[2][0].data)>>>0,b=((r=(n=C[8])==null?void 0:n[0])==null?void 0:r.data)&&on(C[8][0].data)>0||!1,I,F;if((s=(a=C[7])==null?void 0:a[0])!=null&&s.data&&e!=0)I=(c=(l=C[7])==null?void 0:l[0])==null?void 0:c.data,F=(d=(f=C[6])==null?void 0:f[0])==null?void 0:d.data;else if((x=(g=C[4])==null?void 0:g[0])!=null&&x.data&&e!=1)I=(T=(_=C[4])==null?void 0:_[0])==null?void 0:T.data,F=(S=(E=C[3])==null?void 0:E[0])==null?void 0:S.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var P=b?4:1,D=Ss(I),j=[],B=0;B<I.length/2;++B){var te=D.getUint16(B*2,!0);te<65535&&j.push([B,te])}if(j.length!=N)throw"Expected ".concat(N," cells, found ").concat(j.length);var X=[];for(B=0;B<j.length-1;++B)X[j[B][0]]=F.subarray(j[B][1]*P,j[B+1][1]*P);return j.length>=1&&(X[j[j.length-1][0]]=F.subarray(j[j.length-1][1]*P)),{R:k,cells:X}}function NH(t,e){var n,r=wt(e.data),a=(n=r==null?void 0:r[7])!=null&&n[0]?on(r[7][0].data)>>>0>0?1:0:-1,s=Sp(r[5],function(l){return kH(l,a)});return{nrows:on(r[4][0].data)>>>0,data:s.reduce(function(l,c){return l[c.R]||(l[c.R]=[]),c.cells.forEach(function(f,d){if(l[c.R][d])throw new Error("Duplicate cell r=".concat(c.R," c=").concat(d));l[c.R][d]=f}),l},[])}}function MH(t,e,n){var r,a=wt(e.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(on(a[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(s.e.c=(on(a[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));n["!ref"]=rt(s);var l=wt(a[4][0].data),c=y2(t,t[Kn(l[4][0].data)][0]),f=(r=l[17])!=null&&r[0]?y2(t,t[Kn(l[17][0].data)][0]):[],d=wt(l[3][0].data),g=0;d[1].forEach(function(x){var _=wt(x.data),T=t[Kn(_[2][0].data)][0],E=on(T.meta[1][0].data);if(E!=6002)throw new Error("6001 unexpected reference to ".concat(E));var S=NH(t,T);S.data.forEach(function(C,k){C.forEach(function(N,b){var I=Je({r:g+k,c:b}),F=AH(N,c,f);F&&(n[I]=F)})}),g+=S.nrows})}function DH(t,e){var n=wt(e.data),r={"!ref":"A1"},a=t[Kn(n[2][0].data)],s=on(a[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return MH(t,a[0],r),r}function RH(t,e){var n,r=wt(e.data),a={name:(n=r[1])!=null&&n[0]?dm(r[1][0].data):"",sheets:[]},s=Sp(r[2],Kn);return s.forEach(function(l){t[l].forEach(function(c){var f=on(c.meta[1][0].data);f==6e3&&a.sheets.push(DH(t,c))})}),a}function FH(t,e){var n=kp(),r=wt(e.data),a=Sp(r[1],Kn);if(a.forEach(function(s){t[s].forEach(function(l){var c=on(l.meta[1][0].data);if(c==2){var f=RH(t,l);f.sheets.forEach(function(d,g){Np(n,d,g==0?f.name:f.name+"_"+g,!0)})}})}),n.SheetNames.length==0)throw new Error("Empty NUMBERS file");return n}function Fh(t){var e,n,r,a,s={},l=[];if(t.FullPaths.forEach(function(f){if(f.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(f){if(f.name.match(/\.iwa$/)){var d;try{d=$r(f.content)}catch(x){return console.log("?? "+f.content.length+" "+(x.message||x))}var g;try{g=jr(d)}catch(x){return console.log("## "+(x.message||x))}g.forEach(function(x){s[x.id]=x.messages,l.push(x.id)})}}),!l.length)throw new Error("File has no messages");var c=((a=(r=(n=(e=s==null?void 0:s[1])==null?void 0:e[0])==null?void 0:n.meta)==null?void 0:r[1])==null?void 0:a[0].data)&&on(s[1][0].meta[1][0].data)==1&&s[1][0];if(c||l.forEach(function(f){s[f].forEach(function(d){var g=on(d.meta[1][0].data)>>>0;if(g==1)if(!c)c=d;else throw new Error("Document has multiple roots")})}),!c)throw new Error("Cannot find Document root");return FH(s,c)}function IH(t,e,n){var r,a,s,l;if(!((r=t[6])!=null&&r[0])||!((a=t[7])!=null&&a[0]))throw"Mutation only works on post-BNC storages!";var c=((l=(s=t[8])==null?void 0:s[0])==null?void 0:l.data)&&on(t[8][0].data)>0||!1;if(c)throw"Math only works with normal offsets";for(var f=0,d=Ss(t[7][0].data),g=0,x=[],_=Ss(t[4][0].data),T=0,E=[],S=0;S<e.length;++S){if(e[S]==null){d.setUint16(S*2,65535,!0),_.setUint16(S*2,65535);continue}d.setUint16(S*2,g,!0),_.setUint16(S*2,T,!0);var C,k;switch(typeof e[S]){case"string":C=Dh({t:"s",v:e[S]},n),k=Rh({t:"s",v:e[S]},n);break;case"number":C=Dh({t:"n",v:e[S]},n),k=Rh({t:"n",v:e[S]},n);break;case"boolean":C=Dh({t:"b",v:e[S]},n),k=Rh({t:"b",v:e[S]},n);break;default:throw new Error("Unsupported value "+e[S])}x.push(C),g+=C.length,E.push(k),T+=k.length,++f}for(t[2][0].data=Nt(f);S<t[7][0].data.length/2;++S)d.setUint16(S*2,65535,!0),_.setUint16(S*2,65535,!0);return t[6][0].data=Oi(x),t[3][0].data=Oi(E),f}function PH(t,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var n=t.Sheets[t.SheetNames[0]];t.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var r=vr(n["!ref"]);r.s.r=r.s.c=0;var a=!1;r.e.c>9&&(a=!0,r.e.c=9),r.e.r>49&&(a=!0,r.e.r=49),a&&console.error("The Numbers writer is currently limited to ".concat(rt(r)));var s=Bf(n,{range:r,header:1}),l=["~Sh33tJ5~"];s.forEach(function(W){return W.forEach(function(q){typeof q=="string"&&l.push(q)})});var c={},f=[],d=ze.read(e.numbers,{type:"base64"});d.FileIndex.map(function(W,q){return[W,d.FullPaths[q]]}).forEach(function(W){var q=W[0],K=W[1];if(q.type==2&&q.name.match(/\.iwa/)){var ie=q.content,Ce=$r(ie),Te=jr(Ce);Te.forEach(function(be){f.push(be.id),c[be.id]={deps:[],location:K,type:on(be.messages[0].meta[1][0].data)}})}}),f.sort(function(W,q){return W-q});var g=f.filter(function(W){return W>1}).map(function(W){return[W,Nt(W)]});d.FileIndex.map(function(W,q){return[W,d.FullPaths[q]]}).forEach(function(W){var q=W[0];if(W[1],!!q.name.match(/\.iwa/)){var K=jr($r(q.content));K.forEach(function(ie){ie.messages.forEach(function(Ce){g.forEach(function(Te){ie.messages.some(function(be){return on(be.meta[1][0].data)!=11006&&TH(be.data,Te[1])})&&c[Te[0]].deps.push(ie.id)})})})}});for(var x=ze.find(d,c[1].location),_=jr($r(x.content)),T,E=0;E<_.length;++E){var S=_[E];S.id==1&&(T=S)}var C=Kn(wt(T.messages[0].data)[1][0].data);for(x=ze.find(d,c[C].location),_=jr($r(x.content)),E=0;E<_.length;++E)S=_[E],S.id==C&&(T=S);for(C=Kn(wt(T.messages[0].data)[2][0].data),x=ze.find(d,c[C].location),_=jr($r(x.content)),E=0;E<_.length;++E)S=_[E],S.id==C&&(T=S);for(C=Kn(wt(T.messages[0].data)[2][0].data),x=ze.find(d,c[C].location),_=jr($r(x.content)),E=0;E<_.length;++E)S=_[E],S.id==C&&(T=S);var k=wt(T.messages[0].data);{k[6][0].data=Nt(r.e.r+1),k[7][0].data=Nt(r.e.c+1);var N=Kn(k[46][0].data),b=ze.find(d,c[N].location),I=jr($r(b.content));{for(var F=0;F<I.length&&I[F].id!=N;++F);if(I[F].id!=N)throw"Bad ColumnRowUIDMapArchive";var P=wt(I[F].messages[0].data);P[1]=[],P[2]=[],P[3]=[];for(var D=0;D<=r.e.c;++D){var j=[];j[1]=j[2]=[{type:0,data:Nt(D+420690)}],P[1].push({type:2,data:zn(j)}),P[2].push({type:0,data:Nt(D)}),P[3].push({type:0,data:Nt(D)})}P[4]=[],P[5]=[],P[6]=[];for(var B=0;B<=r.e.r;++B)j=[],j[1]=j[2]=[{type:0,data:Nt(B+726270)}],P[4].push({type:2,data:zn(j)}),P[5].push({type:0,data:Nt(B)}),P[6].push({type:0,data:Nt(B)});I[F].messages[0].data=zn(P)}b.content=Co(Eo(I)),b.size=b.content.length,delete k[46];var te=wt(k[4][0].data);{te[7][0].data=Nt(r.e.r+1);var X=wt(te[1][0].data),Z=Kn(X[2][0].data);b=ze.find(d,c[Z].location),I=jr($r(b.content));{if(I[0].id!=Z)throw"Bad HeaderStorageBucket";var ye=wt(I[0].messages[0].data);for(B=0;B<s.length;++B){var Me=wt(ye[2][0].data);Me[1][0].data=Nt(B),Me[4][0].data=Nt(s[B].length),ye[2][B]={type:ye[2][0].type,data:zn(Me)}}I[0].messages[0].data=zn(ye)}b.content=Co(Eo(I)),b.size=b.content.length;var Se=Kn(te[2][0].data);b=ze.find(d,c[Se].location),I=jr($r(b.content));{if(I[0].id!=Se)throw"Bad HeaderStorageBucket";for(ye=wt(I[0].messages[0].data),D=0;D<=r.e.c;++D)Me=wt(ye[2][0].data),Me[1][0].data=Nt(D),Me[4][0].data=Nt(r.e.r+1),ye[2][D]={type:ye[2][0].type,data:zn(Me)};I[0].messages[0].data=zn(ye)}b.content=Co(Eo(I)),b.size=b.content.length;var ee=Kn(te[4][0].data);(function(){for(var W=ze.find(d,c[ee].location),q=jr($r(W.content)),K,ie=0;ie<q.length;++ie){var Ce=q[ie];Ce.id==ee&&(K=Ce)}var Te=wt(K.messages[0].data);{Te[3]=[];var be=[];l.forEach(function(Y,yt){be[1]=[{type:0,data:Nt(yt)}],be[2]=[{type:0,data:Nt(1)}],be[3]=[{type:2,data:_H(Y)}],Te[3].push({type:2,data:zn(be)})})}K.messages[0].data=zn(Te);var Ae=Eo(q),Xe=Co(Ae);W.content=Xe,W.size=W.content.length})();var me=wt(te[3][0].data);{var Pe=me[1][0];delete me[2];var re=wt(Pe.data);{var z=Kn(re[2][0].data);(function(){for(var W=ze.find(d,c[z].location),q=jr($r(W.content)),K,ie=0;ie<q.length;++ie){var Ce=q[ie];Ce.id==z&&(K=Ce)}var Te=wt(K.messages[0].data);{delete Te[6],delete me[7];var be=new Uint8Array(Te[5][0].data);Te[5]=[];for(var Ae=0,Xe=0;Xe<=r.e.r;++Xe){var Y=wt(be);Ae+=IH(Y,s[Xe],l),Y[1][0].data=Nt(Xe),Te[5].push({data:zn(Y),type:2})}Te[1]=[{type:0,data:Nt(r.e.c+1)}],Te[2]=[{type:0,data:Nt(r.e.r+1)}],Te[3]=[{type:0,data:Nt(Ae)}],Te[4]=[{type:0,data:Nt(r.e.r+1)}]}K.messages[0].data=zn(Te);var yt=Eo(q),st=Co(yt);W.content=st,W.size=W.content.length})()}Pe.data=zn(re)}te[3][0].data=zn(me)}k[4][0].data=zn(te)}T.messages[0].data=zn(k);var ce=Eo(_),L=Co(ce);return x.content=L,x.size=x.content.length,d}function OS(t){return function(n){for(var r=0;r!=t.length;++r){var a=t[r];n[a[0]]===void 0&&(n[a[0]]=a[1]),a[2]==="n"&&(n[a[0]]=Number(n[a[0]]))}}}function Ep(t){OS([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function Cp(t){OS([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(t)}function LH(t){return ut.WS.indexOf(t)>-1?"sheet":t==ut.CS?"chart":t==ut.DS?"dialog":t==ut.MS?"macro":t&&t.length?t:"sheet"}function OH(t,e){if(!t)return 0;try{t=e.map(function(r){return r.id||(r.id=r.strRelID),[r.name,t["!id"][r.id].Target,LH(t["!id"][r.id].Type)]})}catch{return null}return!t||t.length===0?null:t}function UH(t,e,n,r,a,s,l,c,f,d,g,x){try{s[r]=dc(Mr(t,n,!0),e);var _=yn(t,e),T;switch(c){case"sheet":T=sG(_,e,a,f,s[r],d,g,x);break;case"chart":if(T=oG(_,e,a,f,s[r],d,g,x),!T||!T["!drawel"])break;var E=ac(T["!drawel"].Target,e),S=Cc(E),C=WU(Mr(t,E,!0),dc(Mr(t,S,!0),E)),k=ac(C,E),N=Cc(k);T=IV(Mr(t,k,!0),k,f,dc(Mr(t,N,!0),k),d,T);break;case"macro":T=lG(_,e,a,f,s[r],d,g,x);break;case"dialog":T=cG(_,e,a,f,s[r],d,g,x);break;default:throw new Error("Unrecognized sheet type "+c)}l[r]=T;var b=[];s&&s[r]&&ln(s[r]).forEach(function(I){var F="";if(s[r][I].Type==ut.CMNT){F=ac(s[r][I].Target,e);var P=hG(yn(t,F,!0),F,f);if(!P||!P.length)return;a2(T,P,!1)}s[r][I].Type==ut.TCMNT&&(F=ac(s[r][I].Target,e),b=b.concat(JU(yn(t,F,!0),f)))}),b&&b.length&&a2(T,b,!0,f.people||[])}catch(I){if(f.WTF)throw I}}function zr(t){return t.charAt(0)=="/"?t.slice(1):t}function BH(t,e){if(Xo(),e=e||{},Ep(e),Wr(t,"META-INF/manifest.xml")||Wr(t,"objectdata.xml"))return p2(t,e);if(Wr(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Fh<"u"){if(t.FileIndex)return Fh(t);var n=ze.utils.cfb_new();return C_(t).forEach(function(Me){it(n,Me,XI(t,Me))}),Fh(n)}throw new Error("Unsupported NUMBERS file")}if(!Wr(t,"[Content_Types].xml"))throw Wr(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Wr(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var r=C_(t),a=z5(Mr(t,"[Content_Types].xml")),s=!1,l,c;if(a.workbooks.length===0&&(c="xl/workbook.xml",yn(t,c,!0)&&a.workbooks.push(c)),a.workbooks.length===0){if(c="xl/workbook.bin",!yn(t,c,!0))throw new Error("Could not find workbook");a.workbooks.push(c),s=!0}a.workbooks[0].slice(-3)=="bin"&&(s=!0);var f={},d={};if(!e.bookSheets&&!e.bookProps){if(hc=[],a.sst)try{hc=dG(yn(t,zr(a.sst)),a.sst,e)}catch(Me){if(e.WTF)throw Me}e.cellStyles&&a.themes.length&&(f=fG(Mr(t,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],e)),a.style&&(d=uG(yn(t,zr(a.style)),a.style,f,e))}a.links.map(function(Me){try{var Se=dc(Mr(t,Cc(zr(Me))),Me);return pG(yn(t,zr(Me)),Se,Me,e)}catch{}});var g=iG(yn(t,zr(a.workbooks[0])),a.workbooks[0],e),x={},_="";a.coreprops.length&&(_=yn(t,zr(a.coreprops[0]),!0),_&&(x=Cw(_)),a.extprops.length!==0&&(_=yn(t,zr(a.extprops[0]),!0),_&&X5(_,x,e)));var T={};(!e.bookSheets||e.bookProps)&&a.custprops.length!==0&&(_=Mr(t,zr(a.custprops[0]),!0),_&&(T=Z5(_,e)));var E={};if((e.bookSheets||e.bookProps)&&(g.Sheets?l=g.Sheets.map(function(Se){return Se.name}):x.Worksheets&&x.SheetNames.length>0&&(l=x.SheetNames),e.bookProps&&(E.Props=x,E.Custprops=T),e.bookSheets&&typeof l<"u"&&(E.SheetNames=l),e.bookSheets?E.SheetNames:e.bookProps))return E;l={};var S={};e.bookDeps&&a.calcchain&&(S=mG(yn(t,zr(a.calcchain)),a.calcchain));var C=0,k={},N,b;{var I=g.Sheets;x.Worksheets=I.length,x.SheetNames=[];for(var F=0;F!=I.length;++F)x.SheetNames[F]=I[F].name}var P=s?"bin":"xml",D=a.workbooks[0].lastIndexOf("/"),j=(a.workbooks[0].slice(0,D+1)+"_rels/"+a.workbooks[0].slice(D+1)+".rels").replace(/^\//,"");Wr(t,j)||(j="xl/_rels/workbook."+P+".rels");var B=dc(Mr(t,j,!0),j.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(e.xlmeta=gG(yn(t,zr(a.metadata[0])),a.metadata[0],e)),(a.people||[]).length>=1&&(e.people=KU(yn(t,zr(a.people[0])),e)),B&&(B=OH(B,g.Sheets));var te=yn(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(C=0;C!=x.Worksheets;++C){var X="sheet";if(B&&B[C]?(N="xl/"+B[C][1].replace(/[\/]?xl\//,""),Wr(t,N)||(N=B[C][1]),Wr(t,N)||(N=j.replace(/_rels\/.*$/,"")+B[C][1]),X=B[C][2]):(N="xl/worksheets/sheet"+(C+1-te)+"."+P,N=N.replace(/sheet0\./,"sheet.")),b=N.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(C!=e.sheets)continue e;break;case"string":if(x.SheetNames[C].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var Z=!1,ye=0;ye!=e.sheets.length;++ye)typeof e.sheets[ye]=="number"&&e.sheets[ye]==C&&(Z=1),typeof e.sheets[ye]=="string"&&e.sheets[ye].toLowerCase()==x.SheetNames[C].toLowerCase()&&(Z=1);if(!Z)continue e}}UH(t,N,b,x.SheetNames[C],C,k,l,X,e,g,f,d)}return E={Directory:a,Workbook:g,Props:x,Custprops:T,Deps:S,Sheets:l,SheetNames:x.SheetNames,Strings:hc,Styles:d,Themes:f,SSF:Kt(Ye)},e&&e.bookFiles&&(t.files?(E.keys=r,E.files=t.files):(E.keys=[],E.files={},t.FullPaths.forEach(function(Me,Se){Me=Me.replace(/^Root Entry[\/]/,""),E.keys.push(Me),E.files[Me]=t.FileIndex[Se]}))),e&&e.bookVBA&&(a.vba.length>0?E.vbaraw=yn(t,zr(a.vba[0]),!0):a.defaults&&a.defaults.bin===iB&&(E.vbaraw=yn(t,"xl/vbaProject.bin",!0))),E}function VH(t,e){var n=e||{},r="Workbook",a=ze.find(t,r);try{if(r="/!DataSpaces/Version",a=ze.find(t,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);if(gO(a.content),r="/!DataSpaces/DataSpaceMap",a=ze.find(t,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);var s=vO(a.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+r);if(r="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=ze.find(t,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);var l=yO(a.content);if(l.length!=1||l[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+r);if(r="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=ze.find(t,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);TO(a.content)}catch{}if(r="/EncryptionInfo",a=ze.find(t,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);var c=wO(a.content);if(r="/EncryptedPackage",a=ze.find(t,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);if(c[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(c[1],a.content,n.password||"",n);if(c[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(c[1],a.content,n.password||"",n);throw new Error("File is password-protected")}function GH(t,e){return e.bookType=="ods"?LS(t,e):e.bookType=="numbers"?PH(t,e):e.bookType=="xlsb"?HH(t,e):zH(t,e)}function HH(t,e){Do=1024,t&&!t.SSF&&(t.SSF=Kt(Ye)),t&&t.SSF&&(Xo(),Yf(t.SSF),e.revssf=Xf(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,mc?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var n=e.bookType=="xlsb"?"bin":"xml",r=uS.indexOf(e.bookType)>-1,a=up();Cp(e=e||{});var s=Xm(),l="",c=0;if(e.cellXfs=[],Gi(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),l="docProps/core.xml",it(s,l,bw(t.Props,e)),a.coreprops.push(l),Mt(e.rels,2,l,ut.CORE_PROPS),l="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var f=[],d=0;d<t.SheetNames.length;++d)(t.Workbook.Sheets[d]||{}).Hidden!=2&&f.push(t.SheetNames[d]);t.Props.SheetNames=f}for(t.Props.Worksheets=t.Props.SheetNames.length,it(s,l,Nw(t.Props)),a.extprops.push(l),Mt(e.rels,3,l,ut.EXT_PROPS),t.Custprops!==t.Props&&ln(t.Custprops||{}).length>0&&(l="docProps/custom.xml",it(s,l,Mw(t.Custprops)),a.custprops.push(l),Mt(e.rels,4,l,ut.CUST_PROPS)),c=1;c<=t.SheetNames.length;++c){var g={"!id":{}},x=t.Sheets[t.SheetNames[c-1]],_=(x||{})["!type"]||"sheet";switch(_){case"chart":default:l="xl/worksheets/sheet"+c+"."+n,it(s,l,vG(c-1,l,e,t,g)),a.sheets.push(l),Mt(e.wbrels,-1,"worksheets/sheet"+c+"."+n,ut.WS[0])}if(x){var T=x["!comments"],E=!1,S="";T&&T.length>0&&(S="xl/comments"+c+"."+n,it(s,S,TG(T,S)),a.comments.push(S),Mt(g,-1,"../comments"+c+"."+n,ut.CMNT),E=!0),x["!legacy"]&&E&&it(s,"xl/drawings/vmlDrawing"+c+".vml",lS(c,x["!comments"])),delete x["!comments"],delete x["!legacy"]}g["!id"].rId1&&it(s,Cc(l),Po(g))}return e.Strings!=null&&e.Strings.length>0&&(l="xl/sharedStrings."+n,it(s,l,_G(e.Strings,l,e)),a.strs.push(l),Mt(e.wbrels,-1,"sharedStrings."+n,ut.SST)),l="xl/workbook."+n,it(s,l,xG(t,l)),a.workbooks.push(l),Mt(e.rels,1,l,ut.WB),l="xl/theme/theme1.xml",it(s,l,gp(t.Themes,e)),a.themes.push(l),Mt(e.wbrels,-1,"theme/theme1.xml",ut.THEME),l="xl/styles."+n,it(s,l,yG(t,l,e)),a.styles.push(l),Mt(e.wbrels,-1,"styles."+n,ut.STY),t.vbaraw&&r&&(l="xl/vbaProject.bin",it(s,l,t.vbaraw),a.vba.push(l),Mt(e.wbrels,-1,"vbaProject.bin",ut.VBA)),l="xl/metadata."+n,it(s,l,wG(l)),a.metadata.push(l),Mt(e.wbrels,-1,"metadata."+n,ut.XLMETA),it(s,"[Content_Types].xml",Sw(a,e)),it(s,"_rels/.rels",Po(e.rels)),it(s,"xl/_rels/workbook."+n+".rels",Po(e.wbrels)),delete e.revssf,delete e.ssf,s}function zH(t,e){Do=1024,t&&!t.SSF&&(t.SSF=Kt(Ye)),t&&t.SSF&&(Xo(),Yf(t.SSF),e.revssf=Xf(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,mc?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var n="xml",r=uS.indexOf(e.bookType)>-1,a=up();Cp(e=e||{});var s=Xm(),l="",c=0;if(e.cellXfs=[],Gi(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),l="docProps/core.xml",it(s,l,bw(t.Props,e)),a.coreprops.push(l),Mt(e.rels,2,l,ut.CORE_PROPS),l="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var f=[],d=0;d<t.SheetNames.length;++d)(t.Workbook.Sheets[d]||{}).Hidden!=2&&f.push(t.SheetNames[d]);t.Props.SheetNames=f}t.Props.Worksheets=t.Props.SheetNames.length,it(s,l,Nw(t.Props)),a.extprops.push(l),Mt(e.rels,3,l,ut.EXT_PROPS),t.Custprops!==t.Props&&ln(t.Custprops||{}).length>0&&(l="docProps/custom.xml",it(s,l,Mw(t.Custprops)),a.custprops.push(l),Mt(e.rels,4,l,ut.CUST_PROPS));var g=["SheetJ5"];for(e.tcid=0,c=1;c<=t.SheetNames.length;++c){var x={"!id":{}},_=t.Sheets[t.SheetNames[c-1]],T=(_||{})["!type"]||"sheet";switch(T){case"chart":default:l="xl/worksheets/sheet"+c+"."+n,it(s,l,TS(c-1,e,t,x)),a.sheets.push(l),Mt(e.wbrels,-1,"worksheets/sheet"+c+"."+n,ut.WS[0])}if(_){var E=_["!comments"],S=!1,C="";if(E&&E.length>0){var k=!1;E.forEach(function(N){N[1].forEach(function(b){b.T==!0&&(k=!0)})}),k&&(C="xl/threadedComments/threadedComment"+c+"."+n,it(s,C,XU(E,g,e)),a.threadedcomments.push(C),Mt(x,-1,"../threadedComments/threadedComment"+c+"."+n,ut.TCMNT)),C="xl/comments"+c+"."+n,it(s,C,cS(E)),a.comments.push(C),Mt(x,-1,"../comments"+c+"."+n,ut.CMNT),S=!0}_["!legacy"]&&S&&it(s,"xl/drawings/vmlDrawing"+c+".vml",lS(c,_["!comments"])),delete _["!comments"],delete _["!legacy"]}x["!id"].rId1&&it(s,Cc(l),Po(x))}return e.Strings!=null&&e.Strings.length>0&&(l="xl/sharedStrings."+n,it(s,l,Xw(e.Strings,e)),a.strs.push(l),Mt(e.wbrels,-1,"sharedStrings."+n,ut.SST)),l="xl/workbook."+n,it(s,l,bS(t)),a.workbooks.push(l),Mt(e.rels,1,l,ut.WB),l="xl/theme/theme1.xml",it(s,l,gp(t.Themes,e)),a.themes.push(l),Mt(e.wbrels,-1,"theme/theme1.xml",ut.THEME),l="xl/styles."+n,it(s,l,aS(t,e)),a.styles.push(l),Mt(e.wbrels,-1,"styles."+n,ut.STY),t.vbaraw&&r&&(l="xl/vbaProject.bin",it(s,l,t.vbaraw),a.vba.push(l),Mt(e.wbrels,-1,"vbaProject.bin",ut.VBA)),l="xl/metadata."+n,it(s,l,oS()),a.metadata.push(l),Mt(e.wbrels,-1,"metadata."+n,ut.XLMETA),g.length>1&&(l="xl/persons/person.xml",it(s,l,ZU(g)),a.people.push(l),Mt(e.wbrels,-1,"persons/person.xml",ut.PEOPLE)),it(s,"[Content_Types].xml",Sw(a,e)),it(s,"_rels/.rels",Po(e.rels)),it(s,"xl/_rels/workbook."+n+".rels",Po(e.wbrels)),delete e.revssf,delete e.ssf,s}function bp(t,e){var n="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":n=Dr(t.slice(0,12));break;case"binary":n=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[n.charCodeAt(0),n.charCodeAt(1),n.charCodeAt(2),n.charCodeAt(3),n.charCodeAt(4),n.charCodeAt(5),n.charCodeAt(6),n.charCodeAt(7)]}function qH(t,e){return ze.find(t,"EncryptedPackage")?VH(t,e):MS(t,e)}function jH(t,e){var n,r=t,a=e||{};return a.type||(a.type=lt&&Buffer.isBuffer(t)?"buffer":"base64"),n=ZT(r,a),BH(n,a)}function US(t,e){var n=0;e:for(;n<t.length;)switch(t.charCodeAt(n)){case 10:case 13:case 32:++n;break;case 60:return um(t.slice(n),e);default:break e}return Vo.to_workbook(t,e)}function $H(t,e){var n="",r=bp(t,e);switch(e.type){case"base64":n=Dr(t);break;case"binary":n=t;break;case"buffer":n=t.toString("binary");break;case"array":n=ys(t);break;default:throw new Error("Unrecognized type "+e.type)}return r[0]==239&&r[1]==187&&r[2]==191&&(n=Bt(n)),e.type="binary",US(n,e)}function WH(t,e){var n=t;return e.type=="base64"&&(n=Dr(n)),n=yc.utils.decode(1200,n.slice(2),"str"),e.type="binary",US(n,e)}function YH(t){return t.match(/[^\x00-\x7F]/)?Ea(t):t}function Ih(t,e,n,r){return r?(n.type="string",Vo.to_workbook(t,n)):Vo.to_workbook(e,n)}function hm(t,e){jm();var n=e||{};if(typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return hm(new Uint8Array(t),(n=Kt(n),n.type="array",n));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!n.type&&(n.type=typeof Deno<"u"?"buffer":"array");var r=t,a=[0,0,0,0],s=!1;if(n.cellStyles&&(n.cellNF=!0,n.sheetStubs=!0),Oo={},n.dateNF&&(Oo.dateNF=n.dateNF),n.type||(n.type=lt&&Buffer.isBuffer(t)?"buffer":"base64"),n.type=="file"&&(n.type=lt?"buffer":"binary",r=HI(t),typeof Uint8Array<"u"&&!lt&&(n.type="array")),n.type=="string"&&(s=!0,n.type="binary",n.codepage=65001,r=YH(t)),n.type=="array"&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var l=new ArrayBuffer(3),c=new Uint8Array(l);if(c.foo="bar",!c.foo)return n=Kt(n),n.type="array",hm($m(r),n)}switch((a=bp(r,n))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return qH(ze.read(r,n),n);break;case 9:if(a[1]<=8)return MS(r,n);break;case 60:return um(r,n);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return QL(r,n);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return Yw.to_workbook(r,n);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?jH(r,n):Ih(t,r,n,s);case 239:return a[3]===60?um(r,n):Ih(t,r,n,s);case 255:if(a[1]===254)return WH(r,n);if(a[1]===0&&a[2]===2&&a[3]===0)return ms.to_workbook(r,n);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return ms.to_workbook(r,n);break;case 3:case 131:case 139:case 140:return cm.to_workbook(r,n);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return tS.to_workbook(r,n);break;case 10:case 13:case 32:return $H(r,n);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return ZL.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?cm.to_workbook(r,n):Ih(t,r,n,s)}function BS(t,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return Uc(e.file,ze.write(t,{type:lt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return ze.write(t,e)}function JH(t,e){var n=Kt(e||{}),r=GH(t,n);return XH(r,n)}function XH(t,e){var n={},r=lt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(n.compression="DEFLATE"),e.password)n.type=r;else switch(e.type){case"base64":n.type="base64";break;case"binary":n.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":n.type=r;break;default:throw new Error("Unrecognized type "+e.type)}var a=t.FullPaths?ze.write(t,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[n.type]||n.type,compression:!!e.compression}):t.generate(n);if(typeof Deno<"u"&&typeof a=="string"){if(e.type=="binary"||e.type=="base64")return a;a=new Uint8Array(Wf(a))}return e.password&&typeof encrypt_agile<"u"?BS(encrypt_agile(a,e.password),e):e.type==="file"?Uc(e.file,a):e.type=="string"?Bt(a):a}function KH(t,e){var n=e||{},r=YG(t,n);return BS(r,n)}function Sa(t,e,n){n||(n="");var r=n+t;switch(e.type){case"base64":return _c(Ea(r));case"binary":return Ea(r);case"string":return t;case"file":return Uc(e.file,r,"utf8");case"buffer":return lt?ei(r,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(r):Sa(r,{type:"binary"}).split("").map(function(a){return a.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function ZH(t,e){switch(e.type){case"base64":return _c(t);case"binary":return t;case"string":return t;case"file":return Uc(e.file,t,"binary");case"buffer":return lt?ei(t,"binary"):t.split("").map(function(n){return n.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function vf(t,e){switch(e.type){case"string":case"base64":case"binary":for(var n="",r=0;r<t.length;++r)n+=String.fromCharCode(t[r]);return e.type=="base64"?_c(n):e.type=="string"?Bt(n):n;case"file":return Uc(e.file,t);case"buffer":return t;default:throw new Error("Unrecognized type "+e.type)}}function VS(t,e){jm(),qV(t);var n=Kt(e||{});if(n.cellStyles&&(n.cellNF=!0,n.sheetStubs=!0),n.type=="array"){n.type="binary";var r=VS(t,n);return n.type="array",Wf(r)}var a=0;if(n.sheet&&(typeof n.sheet=="number"?a=n.sheet:a=t.SheetNames.indexOf(n.sheet),!t.SheetNames[a]))throw new Error("Sheet not found: "+n.sheet+" : "+typeof n.sheet);switch(n.bookType||"xlsb"){case"xml":case"xlml":return Sa(GG(t,n),n);case"slk":case"sylk":return Sa(Ww.from_sheet(t.Sheets[t.SheetNames[a]],n),n);case"htm":case"html":return Sa(RS(t.Sheets[t.SheetNames[a]],n),n);case"txt":return ZH(GS(t.Sheets[t.SheetNames[a]],n),n);case"csv":return Sa(Ap(t.Sheets[t.SheetNames[a]],n),n,"\uFEFF");case"dif":return Sa(Yw.from_sheet(t.Sheets[t.SheetNames[a]],n),n);case"dbf":return vf(cm.from_sheet(t.Sheets[t.SheetNames[a]],n),n);case"prn":return Sa(Vo.from_sheet(t.Sheets[t.SheetNames[a]],n),n);case"rtf":return Sa(tS.from_sheet(t.Sheets[t.SheetNames[a]],n),n);case"eth":return Sa(Jw.from_sheet(t.Sheets[t.SheetNames[a]],n),n);case"fods":return Sa(LS(t,n),n);case"wk1":return vf(ms.sheet_to_wk1(t.Sheets[t.SheetNames[a]],n),n);case"wk3":return vf(ms.book_to_wk3(t,n),n);case"biff2":n.biff||(n.biff=2);case"biff3":n.biff||(n.biff=3);case"biff4":return n.biff||(n.biff=4),vf(DS(t,n),n);case"biff5":n.biff||(n.biff=5);case"biff8":case"xla":case"xls":return n.biff||(n.biff=8),KH(t,n);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return JH(t,n);default:throw new Error("Unrecognized bookType |"+n.bookType+"|")}}function QH(t){if(!t.bookType){var e={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},n=t.file.slice(t.file.lastIndexOf(".")).toLowerCase();n.match(/^\.[a-z]+$/)&&(t.bookType=n.slice(1)),t.bookType=e[t.bookType]||t.bookType}}function ez(t,e,n){var r={};return r.type="file",r.file=e,QH(r),VS(t,r)}function tz(t,e,n,r,a,s,l,c){var f=mn(n),d=c.defval,g=c.raw||!Object.prototype.hasOwnProperty.call(c,"raw"),x=!0,_=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(_,"__rowNum__",{value:n,enumerable:!1})}catch{_.__rowNum__=n}else _.__rowNum__=n;if(!l||t[n])for(var T=e.s.c;T<=e.e.c;++T){var E=l?t[n][T]:t[r[T]+f];if(E===void 0||E.t===void 0){if(d===void 0)continue;s[T]!=null&&(_[s[T]]=d);continue}var S=E.v;switch(E.t){case"z":if(S==null)break;continue;case"e":S=S==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+E.t)}if(s[T]!=null){if(S==null)if(E.t=="e"&&S===null)_[s[T]]=null;else if(d!==void 0)_[s[T]]=d;else if(g&&S===null)_[s[T]]=null;else continue;else _[s[T]]=g&&(E.t!=="n"||E.t==="n"&&c.rawNumbers!==!1)?S:Xa(E,S,c);S!=null&&(x=!1)}}return{row:_,isempty:x}}function Bf(t,e){if(t==null||t["!ref"]==null)return[];var n={t:"n",v:0},r=0,a=1,s=[],l=0,c="",f={s:{r:0,c:0},e:{r:0,c:0}},d=e||{},g=d.range!=null?d.range:t["!ref"];switch(d.header===1?r=1:d.header==="A"?r=2:Array.isArray(d.header)?r=3:d.header==null&&(r=0),typeof g){case"string":f=xt(g);break;case"number":f=xt(t["!ref"]),f.s.r=g;break;default:f=g}r>0&&(a=0);var x=mn(f.s.r),_=[],T=[],E=0,S=0,C=Array.isArray(t),k=f.s.r,N=0,b={};C&&!t[k]&&(t[k]=[]);var I=d.skipHidden&&t["!cols"]||[],F=d.skipHidden&&t["!rows"]||[];for(N=f.s.c;N<=f.e.c;++N)if(!(I[N]||{}).hidden)switch(_[N]=tn(N),n=C?t[k][N]:t[_[N]+x],r){case 1:s[N]=N-f.s.c;break;case 2:s[N]=_[N];break;case 3:s[N]=d.header[N-f.s.c];break;default:if(n==null&&(n={w:"__EMPTY",t:"s"}),c=l=Xa(n,null,d),S=b[l]||0,!S)b[l]=1;else{do c=l+"_"+S++;while(b[c]);b[l]=S,b[c]=1}s[N]=c}for(k=f.s.r+a;k<=f.e.r;++k)if(!(F[k]||{}).hidden){var P=tz(t,f,k,_,r,s,C,d);(P.isempty===!1||(r===1?d.blankrows!==!1:d.blankrows))&&(T[E++]=P.row)}return T.length=E,T}var _2=/"/g;function nz(t,e,n,r,a,s,l,c){for(var f=!0,d=[],g="",x=mn(n),_=e.s.c;_<=e.e.c;++_)if(r[_]){var T=c.dense?(t[n]||[])[_]:t[r[_]+x];if(T==null)g="";else if(T.v!=null){f=!1,g=""+(c.rawNumbers&&T.t=="n"?T.v:Xa(T,null,c));for(var E=0,S=0;E!==g.length;++E)if((S=g.charCodeAt(E))===a||S===s||S===34||c.forceQuotes){g='"'+g.replace(_2,'""')+'"';break}g=="ID"&&(g='"ID"')}else T.f!=null&&!T.F?(f=!1,g="="+T.f,g.indexOf(",")>=0&&(g='"'+g.replace(_2,'""')+'"')):g="";d.push(g)}return c.blankrows===!1&&f?null:d.join(l)}function Ap(t,e){var n=[],r=e??{};if(t==null||t["!ref"]==null)return"";var a=xt(t["!ref"]),s=r.FS!==void 0?r.FS:",",l=s.charCodeAt(0),c=r.RS!==void 0?r.RS:`
`,f=c.charCodeAt(0),d=new RegExp((s=="|"?"\\|":s)+"+$"),g="",x=[];r.dense=Array.isArray(t);for(var _=r.skipHidden&&t["!cols"]||[],T=r.skipHidden&&t["!rows"]||[],E=a.s.c;E<=a.e.c;++E)(_[E]||{}).hidden||(x[E]=tn(E));for(var S=0,C=a.s.r;C<=a.e.r;++C)(T[C]||{}).hidden||(g=nz(t,a,C,x,l,f,s,r),g!=null&&(r.strip&&(g=g.replace(d,"")),(g||r.blankrows!==!1)&&n.push((S++?c:"")+g)));return delete r.dense,n.join("")}function GS(t,e){e||(e={}),e.FS="	",e.RS=`
`;var n=Ap(t,e);return n}function rz(t){var e="",n,r="";if(t==null||t["!ref"]==null)return[];var a=xt(t["!ref"]),s="",l=[],c,f=[],d=Array.isArray(t);for(c=a.s.c;c<=a.e.c;++c)l[c]=tn(c);for(var g=a.s.r;g<=a.e.r;++g)for(s=mn(g),c=a.s.c;c<=a.e.c;++c)if(e=l[c]+s,n=d?(t[g]||[])[c]:t[e],r="",n!==void 0){if(n.F!=null){if(e=n.F,!n.f)continue;r=n.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(n.f!=null)r=n.f;else{if(n.t=="z")continue;if(n.t=="n"&&n.v!=null)r=""+n.v;else if(n.t=="b")r=n.v?"TRUE":"FALSE";else if(n.w!==void 0)r="'"+n.w;else{if(n.v===void 0)continue;n.t=="s"?r="'"+n.v:r=""+n.v}}f[f.length]=e+"="+r}return f}function HS(t,e,n){var r=n||{},a=+!r.skipHeader,s=t||{},l=0,c=0;if(s&&r.origin!=null)if(typeof r.origin=="number")l=r.origin;else{var f=typeof r.origin=="string"?nn(r.origin):r.origin;l=f.r,c=f.c}var d,g={s:{c:0,r:0},e:{c,r:l+e.length-1+a}};if(s["!ref"]){var x=xt(s["!ref"]);g.e.c=Math.max(g.e.c,x.e.c),g.e.r=Math.max(g.e.r,x.e.r),l==-1&&(l=x.e.r+1,g.e.r=l+e.length-1+a)}else l==-1&&(l=0,g.e.r=e.length-1+a);var _=r.header||[],T=0;e.forEach(function(S,C){ln(S).forEach(function(k){(T=_.indexOf(k))==-1&&(_[T=_.length]=k);var N=S[k],b="z",I="",F=Je({c:c+T,r:l+C+a});d=Rc(s,F),N&&typeof N=="object"&&!(N instanceof Date)?s[F]=N:(typeof N=="number"?b="n":typeof N=="boolean"?b="b":typeof N=="string"?b="s":N instanceof Date?(b="d",r.cellDates||(b="n",N=En(N)),I=r.dateNF||Ye[14]):N===null&&r.nullError&&(b="e",N=0),d?(d.t=b,d.v=N,delete d.w,delete d.R,I&&(d.z=I)):s[F]=d={t:b,v:N},I&&(d.z=I))})}),g.e.c=Math.max(g.e.c,c+_.length-1);var E=mn(l);if(a)for(T=0;T<_.length;++T)s[tn(T+c)+E]={t:"s",v:_[T]};return s["!ref"]=rt(g),s}function az(t,e){return HS(null,t,e)}function Rc(t,e,n){if(typeof e=="string"){if(Array.isArray(t)){var r=nn(e);return t[r.r]||(t[r.r]=[]),t[r.r][r.c]||(t[r.r][r.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?Rc(t,Je(e)):Rc(t,Je({r:e,c:n||0}))}function iz(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var n=t.SheetNames.indexOf(e);if(n>-1)return n;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function kp(){return{SheetNames:[],Sheets:{}}}function Np(t,e,n,r){var a=1;if(!n)for(;a<=65535&&t.SheetNames.indexOf(n="Sheet"+a)!=-1;++a,n=void 0);if(!n||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(r&&t.SheetNames.indexOf(n)>=0){var s=n.match(/(^.*?)(\d+)$/);a=s&&+s[2]||0;var l=s&&s[1]||n;for(++a;a<=65535&&t.SheetNames.indexOf(n=l+a)!=-1;++a);}if(CS(n),t.SheetNames.indexOf(n)>=0)throw new Error("Worksheet with name |"+n+"| already exists!");return t.SheetNames.push(n),t.Sheets[n]=e,n}function sz(t,e,n){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var r=iz(t,e);switch(t.Workbook.Sheets[r]||(t.Workbook.Sheets[r]={}),n){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+n)}t.Workbook.Sheets[r].Hidden=n}function oz(t,e){return t.z=e,t}function zS(t,e,n){return e?(t.l={Target:e},n&&(t.l.Tooltip=n)):delete t.l,t}function lz(t,e,n){return zS(t,"#"+e,n)}function cz(t,e,n){t.c||(t.c=[]),t.c.push({t:e,a:n||"SheetJS"})}function uz(t,e,n,r){for(var a=typeof e!="string"?e:xt(e),s=typeof e=="string"?e:rt(e),l=a.s.r;l<=a.e.r;++l)for(var c=a.s.c;c<=a.e.c;++c){var f=Rc(t,l,c);f.t="n",f.F=s,delete f.v,l==a.s.r&&c==a.s.c&&(f.f=n,r&&(f.D=!0))}return t}var No={encode_col:tn,encode_row:mn,encode_cell:Je,encode_range:rt,decode_col:ap,decode_row:rp,split_cell:_5,decode_cell:nn,decode_range:vr,format_cell:Xa,sheet_add_aoa:gw,sheet_add_json:HS,sheet_add_dom:FS,aoa_to_sheet:Ko,json_to_sheet:az,table_to_sheet:IS,table_to_book:gH,sheet_to_csv:Ap,sheet_to_txt:GS,sheet_to_json:Bf,sheet_to_html:RS,sheet_to_formulae:rz,sheet_to_row_object_array:Bf,sheet_get_cell:Rc,book_new:kp,book_append_sheet:Np,book_set_sheet_visibility:sz,cell_set_number_format:oz,cell_set_hyperlink:zS,cell_set_internal_link:lz,cell_add_comment:cz,sheet_set_array_formula:uz,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const fz=(t,e)=>{const n=No.book_new(),r=t.map(l=>{const c=l.history.length>0?l.history[0]:null,f=l.history.filter(d=>new Date(d.date).toDateString()===new Date().toDateString()).reduce((d,g)=>d+g.nutrition.calories,0);return{"Full Name":l.profile.fullName,"Phone Number":l.profile.phoneNumber,Age:IT(l.profile.dob),Gender:l.profile.gender,"Height (cm)":l.profile.heightCm,"Weight (kg)":l.profile.weightKg,"Medical History":l.profile.medicalHistory,"Total Entries":l.history.length,"Last Logged Date":c?new Date(c.date).toLocaleDateString():"N/A","Calories Today":f>0?f.toFixed(0):"N/A"}}),a=No.json_to_sheet(r);No.book_append_sheet(n,a,"My Patients"),t.forEach(l=>{var g;const c=l.history.map(x=>{var _,T,E,S;return{Date:new Date(x.date).toLocaleString(),"Food Item":x.foodName,"Est. Weight (g)":x.estimatedWeightGrams.toFixed(1),"Calories (kcal)":x.nutrition.calories.toFixed(1),"Protein (g)":x.nutrition.proteinGrams.toFixed(1),"Carbs (g)":x.nutrition.carbohydratesGrams.toFixed(1),"Fat (g)":x.nutrition.fatGrams.toFixed(1),"Sugar (g)":x.nutrition.sugarGrams.toFixed(1),"Sodium (mg)":x.nutrition.sodiumMilligrams.toFixed(1),"Iron (mg)":((T=(_=x.nutrition.micronutrients)==null?void 0:_.ironMg)==null?void 0:T.toFixed(2))??"N/A","Calcium (mg)":((S=(E=x.nutrition.micronutrients)==null?void 0:E.calciumMg)==null?void 0:S.toFixed(2))??"N/A"}}),f=No.json_to_sheet(c),d=((g=l.profile.fullName)==null?void 0:g.replace(/[\\/?*:"<>|]/g,"").substring(0,30))||`Patient_${l.profile.id.substring(0,5)}`;No.book_append_sheet(n,f,d)});const s=`MyNutriMate_Export_${e.replace(/\s+/g,"_")}_${new Date().toISOString().split("T")[0]}.xlsx`;ez(n,s)},dz=({file:t,onView:e,onDownload:n,onDelete:r,isDoctorView:a})=>{const{t:s}=Vt();return y.jsxs("div",{className:"p-3 sm:p-4 rounded-lg border bg-slate-100 dark:bg-slate-900/50 border-ui-border dark:border-slate-700 flex justify-between items-center gap-2 sm:gap-4",children:[y.jsxs("div",{className:"flex items-center gap-3 overflow-hidden",children:[y.jsx(Pc,{className:"h-6 w-6 text-brand-primary flex-shrink-0"}),y.jsx("p",{className:"font-medium text-ui-text dark:text-slate-200 truncate",title:t.name,children:t.name})]}),y.jsxs("div",{className:"flex-shrink-0 flex items-center gap-1 sm:gap-2",children:[y.jsx("button",{onClick:()=>e(t.name),className:"p-2 rounded-full hover:bg-slate-200 dark:hover:bg-slate-700",title:s("filesView"),children:y.jsx(Nm,{className:"h-5 w-5 text-ui-text-secondary"})}),y.jsx("button",{onClick:()=>n(t.name),className:"p-2 rounded-full hover:bg-slate-200 dark:hover:bg-slate-700",title:s("filesDownload"),children:y.jsx(lT,{className:"h-5 w-5 text-ui-text-secondary"})}),!a&&y.jsx("button",{onClick:()=>r(t.name),className:"p-2 rounded-full hover:bg-red-100 dark:hover:bg-red-900/50",title:s("filesDelete"),children:y.jsx(Wo,{className:"h-5 w-5 text-red-500"})})]})]})},qS=({userId:t,isDoctorView:e,userName:n})=>{const[r,a]=pe.useState([]),[s,l]=pe.useState(!0),[c,f]=pe.useState(null),[d,g]=pe.useState(!1),[x,_]=pe.useState(null),{t:T}=Vt(),E=pe.useCallback((F,P)=>{var j;let D="An unknown error occurred.";F instanceof Error&&((j=F.message)!=null&&j.toLowerCase().includes("bucket not found")?D=T("filesConfigError"):D=F.message),console.error(`Error during ${P}:`,F),f(D)},[T]),S=pe.useCallback(async()=>{l(!0),f(null);try{const{data:F,error:P}=await nt.storage.from("medical-documents").list(t,{limit:100,offset:0,sortBy:{column:"created_at",order:"desc"}});if(P)throw P;a(F||[])}catch(F){E(F,"fetch")}finally{l(!1)}},[t,E]);pe.useEffect(()=>{S()},[S]);const C=async F=>{if(!F.target.files||F.target.files.length===0)return;const P=F.target.files[0];if(!["application/pdf","image/png","image/jpeg","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-excel"].includes(P.type)){f(T("filesInvalidType"));return}if(P.size>5*1024*1024){f(T("filesTooLarge"));return}g(!0),f(null);try{const j=P.name.replace(/[^\w.-]/g,"_"),{error:B}=await nt.storage.from("medical-documents").upload(`${t}/${j}`,P,{upsert:!0});if(B)throw B;await S()}catch(j){E(j,"upload")}finally{g(!1),F.target.value=""}},k=async F=>{var D;f(null);const P=(D=F.split(".").pop())==null?void 0:D.toLowerCase();try{if(P==="pdf"||["png","jpg","jpeg"].includes(P)){const{data:j,error:B}=await nt.storage.from("medical-documents").createSignedUrl(`${t}/${F}`,60);if(B)throw B;_({url:j.signedUrl,type:P==="pdf"?"pdf":"image",name:F})}else if(["xlsx","xls"].includes(P)){const{data:j,error:B}=await nt.storage.from("medical-documents").download(`${t}/${F}`);if(B)throw B;const te=await j.arrayBuffer(),X=hm(te,{type:"buffer"}),Z=X.SheetNames[0],ye=X.Sheets[Z],Me=No.sheet_to_json(ye,{header:1});_({url:"",type:"excel",content:Me,name:F})}else await N(F)}catch(j){E(j,"view")}},N=async F=>{f(null);try{const{data:P,error:D}=await nt.storage.from("medical-documents").download(`${t}/${F}`);if(D)throw D;const j=URL.createObjectURL(P),B=document.createElement("a");B.href=j,B.download=F,document.body.appendChild(B),B.click(),document.body.removeChild(B),URL.revokeObjectURL(j)}catch(P){E(P,"download")}},b=async F=>{if(window.confirm(T("filesDeleteConfirm",{fileName:F}))){f(null);try{const{error:P}=await nt.storage.from("medical-documents").remove([`${t}/${F}`]);if(P)throw P;await S()}catch(P){E(P,"delete")}}},I=()=>{if(!x)return null;const F=()=>{var P,D,j;switch(x.type){case"pdf":return y.jsx("iframe",{src:x.url,title:T("filesPdfViewerTitle"),className:"w-full h-full border-none"});case"image":return y.jsx("div",{className:"w-full h-full flex items-center justify-center p-4",children:y.jsx("img",{src:x.url,alt:T("filesImageAlt"),className:"max-w-full max-h-full object-contain"})});case"excel":return y.jsx("div",{className:"p-4 overflow-auto h-full",children:y.jsxs("table",{className:"w-full text-left border-collapse text-sm",children:[y.jsx("thead",{className:"bg-slate-200 dark:bg-slate-700 sticky top-0 z-10",children:y.jsx("tr",{children:(D=(P=x.content)==null?void 0:P[0])==null?void 0:D.map((B,te)=>y.jsx("th",{className:"p-2 border border-slate-300 dark:border-slate-600 font-semibold",children:B},te))})}),y.jsx("tbody",{children:(j=x.content)==null?void 0:j.slice(1).map((B,te)=>y.jsx("tr",{className:"odd:bg-slate-50 even:bg-white dark:odd:bg-slate-800/50 dark:even:bg-slate-800",children:B.map((X,Z)=>y.jsx("td",{className:"p-2 border border-slate-200 dark:border-slate-700",children:X},Z))},te))})]})});default:return null}};return y.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-80 flex flex-col items-center justify-center z-50 animate-fade-in p-4",children:y.jsxs("div",{className:"w-full h-full max-w-5xl max-h-[90vh] bg-ui-card dark:bg-slate-800 rounded-lg shadow-2xl flex flex-col",children:[y.jsxs("div",{className:"flex justify-between items-center p-2 border-b border-ui-border dark:border-slate-600 flex-shrink-0",children:[y.jsx("p",{className:"font-semibold ml-2 truncate text-ui-text dark:text-slate-200",title:x.name,children:x.name}),y.jsx("button",{onClick:()=>_(null),className:"p-2 rounded-full text-ui-text-secondary dark:text-slate-300 hover:bg-slate-200 dark:hover:bg-slate-700","aria-label":T("filesCloseViewer"),children:y.jsx(Wo,{className:"h-6 w-6"})})]}),y.jsx("div",{className:"flex-grow w-full h-full overflow-hidden",children:F()})]})})};return y.jsxs("div",{className:"w-full max-w-3xl mx-auto animate-fade-in space-y-6",children:[x&&y.jsx(I,{}),y.jsxs("div",{className:"text-center",children:[y.jsxs("h1",{className:"text-3xl font-bold text-ui-text dark:text-slate-50 flex items-center justify-center gap-3",children:[y.jsx(Im,{className:"h-8 w-8 text-brand-primary"}),e?T("filesDoctorTitle",{name:n}):T("filesPatientTitle")]}),y.jsx("p",{className:"text-ui-text-secondary dark:text-slate-400",children:T("filesSubtitle")})]}),!e&&y.jsxs("div",{className:"p-4 sm:p-6 bg-ui-card dark:bg-slate-800 rounded-xl shadow-lg border border-ui-border dark:border-slate-700",children:[y.jsx("h2",{className:"text-xl font-semibold text-center mb-4",children:T("filesUploadTitle")}),y.jsxs("label",{htmlFor:"file-upload",className:"relative block w-full rounded-lg border-2 border-dashed border-ui-border dark:border-slate-600 p-8 text-center cursor-pointer hover:border-brand-primary transition-colors",children:[y.jsx(eT,{className:"mx-auto h-12 w-12 text-slate-400 dark:text-slate-500"}),y.jsx("span",{className:"mt-2 block text-sm font-semibold text-brand-primary",children:T(d?"filesUploading":"filesClickToSelect")}),y.jsx("span",{className:"block text-xs text-ui-text-secondary dark:text-slate-400",children:T("filesFormats")}),y.jsx("input",{id:"file-upload",type:"file",className:"sr-only",accept:".pdf,.png,.jpg,.jpeg,.xlsx,.xls",onChange:C,disabled:d})]}),d&&y.jsx("div",{className:"flex justify-center mt-4",children:y.jsx(hn,{})})]}),y.jsxs("div",{className:"bg-ui-card dark:bg-slate-800 p-4 sm:p-6 rounded-xl shadow-lg border border-ui-border dark:border-slate-700",children:[y.jsx("h2",{className:"text-xl font-bold text-ui-text dark:text-slate-100 mb-4",children:T("filesStoredCount",{count:r.length})}),s?y.jsx("div",{className:"flex justify-center p-8",children:y.jsx(hn,{})}):c?y.jsxs("div",{className:"p-4 bg-red-100 dark:bg-red-900/50 rounded-lg text-center",children:[y.jsx(Qa,{className:"h-8 w-8 text-red-500 mx-auto mb-2"}),y.jsx("p",{className:"text-red-700 dark:text-red-200 font-semibold",children:T("error")}),y.jsx("p",{className:"text-red-600 dark:text-red-300 text-sm",children:c})]}):r.length===0?y.jsx("div",{className:"text-center py-12",children:y.jsx("p",{className:"text-ui-text-secondary dark:text-slate-400",children:T(e?"filesEmptyDoctor":"filesEmptyPatient")})}):y.jsx("div",{className:"space-y-3",children:r.map(F=>y.jsx(dz,{file:F,onView:k,onDownload:N,onDelete:b,isDoctorView:e},F.id))})]})]})},hz=({patient:t,doctorId:e,onDataChange:n})=>{const[r,a]=pe.useState([]),[s,l]=pe.useState(!0),[c,f]=pe.useState(""),[d,g]=pe.useState(""),{t:x}=Vt(),_=pe.useCallback(async()=>{l(!0);const{data:S}=await nt.from("safe_foods").select("*").eq("user_id",t.profile.id).eq("doctor_id",e);a(S||[]),l(!1)},[t.profile.id,e]);pe.useEffect(()=>{_()},[_]);const T=async S=>{if(S.preventDefault(),!c.trim())return;const C={user_id:t.profile.id,doctor_id:e,food_name:c,brand_name:d||null};await nt.from("safe_foods").insert(C),f(""),g(""),await _(),n()},E=async S=>{await nt.from("safe_foods").delete().eq("id",S),await _(),n()};return y.jsxs("div",{children:[y.jsxs("h4",{className:"font-semibold mb-2 text-green-600 dark:text-green-400 flex items-center gap-2",children:[y.jsx(xc,{})," ",x("modalSafeFoods")]}),y.jsxs("form",{onSubmit:T,className:"flex flex-col sm:flex-row items-end gap-2 mb-2",children:[y.jsx("input",{value:c,onChange:S=>f(S.target.value),placeholder:x("modalFoodName"),className:"w-full text-sm mt-1 px-3 py-1.5 bg-slate-100 dark:bg-slate-900/50 border border-ui-border dark:border-slate-600 rounded-lg"}),y.jsx("input",{value:d,onChange:S=>g(S.target.value),placeholder:x("modalBrand"),className:"w-full text-sm mt-1 px-3 py-1.5 bg-slate-100 dark:bg-slate-900/50 border border-ui-border dark:border-slate-600 rounded-lg"}),y.jsx("button",{type:"submit",className:"px-3 py-1.5 bg-brand-primary text-white rounded-lg flex-shrink-0",children:y.jsx(uT,{})})]}),y.jsx("div",{className:"max-h-32 overflow-y-auto space-y-1 pr-2",children:s?y.jsx(hn,{className:"h-6 w-6"}):r.map(S=>y.jsxs("div",{className:"flex justify-between items-center text-sm p-1.5 pl-3 bg-slate-100 dark:bg-slate-700/50 rounded-md",children:[y.jsxs("span",{children:[S.food_name," ",S.brand_name&&`(${S.brand_name})`]}),y.jsx("button",{onClick:()=>E(S.id),className:"p-1 text-red-500 hover:bg-red-100 rounded-full",children:y.jsx(Wo,{className:"h-4 w-4"})})]},S.id))})]})},mz=({patient:t,doctorId:e,onDataChange:n})=>{const[r,a]=pe.useState([]),[s,l]=pe.useState(!0),[c,f]=pe.useState(""),[d,g]=pe.useState(""),[x,_]=pe.useState(""),{t:T}=Vt(),E=pe.useCallback(async()=>{l(!0);const{data:k}=await nt.from("restricted_foods").select("*").eq("user_id",t.profile.id).eq("doctor_id",e);a(k||[]),l(!1)},[t.profile.id,e]);pe.useEffect(()=>{E()},[E]);const S=async k=>{if(k.preventDefault(),!c.trim()||!x.trim())return;const N={user_id:t.profile.id,doctor_id:e,food_name:c,brand_name:d||null,reason:x};await nt.from("restricted_foods").insert(N),f(""),g(""),_(""),await E(),n()},C=async k=>{await nt.from("restricted_foods").delete().eq("id",k),await E(),n()};return y.jsxs("div",{children:[y.jsxs("h4",{className:"font-semibold mb-2 text-red-600 dark:text-red-400 flex items-center gap-2",children:[y.jsx(Qa,{})," ",T("modalRestrictedFoods")]}),y.jsxs("form",{onSubmit:S,className:"space-y-2 mb-2",children:[y.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:[y.jsx("input",{value:c,onChange:k=>f(k.target.value),placeholder:T("modalFoodName"),className:"w-full text-sm px-3 py-1.5 bg-slate-100 dark:bg-slate-900/50 border border-ui-border dark:border-slate-600 rounded-lg"}),y.jsx("input",{value:d,onChange:k=>g(k.target.value),placeholder:T("modalBrand"),className:"w-full text-sm px-3 py-1.5 bg-slate-100 dark:bg-slate-900/50 border border-ui-border dark:border-slate-600 rounded-lg"})]}),y.jsx("input",{value:x,onChange:k=>_(k.target.value),placeholder:T("modalReason"),className:"w-full text-sm px-3 py-1.5 bg-slate-100 dark:bg-slate-900/50 border border-ui-border dark:border-slate-600 rounded-lg"}),y.jsx("button",{type:"submit",className:"w-full px-3 py-1.5 bg-brand-primary text-white rounded-lg flex items-center justify-center",children:y.jsx(uT,{})})]}),y.jsx("div",{className:"max-h-32 overflow-y-auto space-y-1 pr-2",children:s?y.jsx(hn,{className:"h-6 w-6"}):r.map(k=>y.jsxs("div",{className:"flex justify-between items-center text-sm p-1.5 pl-3 bg-red-100 dark:bg-red-900/40 rounded-md",children:[y.jsxs("span",{children:[k.food_name," - ",y.jsx("i",{className:"text-red-700 dark:text-red-300",children:k.reason})]}),y.jsx("button",{onClick:()=>C(k.id),className:"p-1 text-red-500 hover:bg-red-200 rounded-full",children:y.jsx(Wo,{className:"h-4 w-4"})})]},k.id))})]})},yf=({icon:t,label:e,isActive:n,onClick:r})=>y.jsxs("button",{onClick:r,className:`flex-1 flex sm:flex-none sm:w-auto items-center justify-center sm:justify-start gap-2 px-3 py-2 text-sm font-semibold rounded-t-lg border-b-2 ${n?"border-brand-primary text-brand-primary":"border-transparent text-ui-text-secondary hover:text-brand-secondary hover:border-brand-secondary/50"}`,children:[t,y.jsx("span",{className:"hidden sm:inline",children:e})]}),pz=({patient:t,doctorId:e,onClose:n,onDataChange:r})=>{const[a,s]=pe.useState(t.connection.doctor_note||""),[l,c]=pe.useState(!1),[f,d]=pe.useState("note"),[g,x]=pe.useState(null),[_,T]=pe.useState(!1),{t:E}=Vt(),S=async()=>{c(!0),x(null),T(!1);const{error:N}=await tI(t.connection.id,a);N?x(`${N} ${E("modalSaveErrorHint")}`):(r(),T(!0),setTimeout(()=>T(!1),3e3)),c(!1)},C=async()=>{window.confirm(E("modalDisconnectConfirm"))&&(await FT(t.connection.id),r(),n())},k=()=>{switch(f){case"note":return y.jsxs("div",{children:[y.jsx("h3",{className:"font-semibold mb-2 text-ui-text dark:text-slate-200",children:E("modalPatientNote")}),y.jsx("textarea",{value:a,onChange:N=>s(N.target.value),rows:8,placeholder:E("modalNotePlaceholder"),className:"w-full text-sm p-2 bg-slate-100 dark:bg-slate-700 border border-ui-border dark:border-slate-600 rounded-lg"}),y.jsxs("button",{onClick:S,disabled:l||_,className:`w-full mt-2 flex items-center justify-center gap-2 px-3 py-2 text-white text-sm font-semibold rounded-lg ${_?"bg-green-500 cursor-default":"bg-green-600 hover:bg-green-700 disabled:opacity-70"}`,children:[l?y.jsx(hn,{className:"h-4 w-4"}):_?y.jsx(Ic,{className:"h-4 w-4"}):y.jsx(jf,{className:"h-4 w-4"}),l?E("saving"):_?E("saved"):E("save")+" Note"]}),g&&y.jsx("p",{className:"text-sm text-red-500 mt-2",children:g})]});case"foods":return y.jsxs("div",{className:"space-y-6",children:[y.jsx(hz,{patient:t,doctorId:e,onDataChange:r}),y.jsx(mz,{patient:t,doctorId:e,onDataChange:r})]});case"history":return y.jsx("div",{className:"max-h-[60vh] overflow-y-auto -m-6 p-6",children:y.jsx(dT,{history:t.history,userProfile:t.profile,setView:()=>{},userName:t.profile.fullName||""})});case"files":return y.jsx("div",{className:"max-h-[60vh] overflow-y-auto -m-6 p-6",children:y.jsx(qS,{userId:t.profile.id,isDoctorView:!0,userName:t.profile.fullName||"Patient"})});default:return null}};return y.jsx("div",{className:"fixed inset-0 bg-black/60 z-40 flex items-center justify-center p-4 animate-scale-in",children:y.jsxs("div",{className:"bg-ui-card dark:bg-slate-800 rounded-xl shadow-lg w-full max-w-5xl max-h-[90vh] flex flex-col",children:[y.jsxs("header",{className:"p-4 border-b border-ui-border dark:border-slate-700 flex justify-between items-center flex-shrink-0",children:[y.jsxs("div",{className:"flex items-center gap-4",children:[y.jsx(xs,{className:"h-10 w-10 text-brand-primary"}),y.jsxs("div",{children:[y.jsx("h2",{className:"text-2xl font-bold text-ui-text dark:text-slate-100",children:t.profile.fullName}),y.jsx("p",{className:"text-ui-text-secondary dark:text-slate-400",children:t.profile.phoneNumber})]})]}),y.jsx("button",{onClick:n,className:"p-1 rounded-full hover:bg-slate-200 dark:hover:bg-slate-700",children:y.jsx(Wo,{})})]}),y.jsxs("nav",{className:"px-4 border-b border-ui-border dark:border-slate-700 flex items-center gap-2 flex-wrap flex-shrink-0",children:[y.jsx(yf,{icon:y.jsx(Pc,{className:"h-5 w-5"}),label:E("modalTabNote"),isActive:f==="note",onClick:()=>d("note")}),y.jsx(yf,{icon:y.jsx(xc,{className:"h-5 w-5"}),label:E("modalTabFood"),isActive:f==="foods",onClick:()=>d("foods")}),y.jsx(yf,{icon:y.jsx(qf,{className:"h-5 w-5"}),label:E("modalTabHistory"),isActive:f==="history",onClick:()=>d("history")}),y.jsx(yf,{icon:y.jsx(Im,{className:"h-5 w-5"}),label:E("modalTabFiles"),isActive:f==="files",onClick:()=>d("files")})]}),y.jsx("main",{className:"p-6 overflow-y-auto",children:k()}),y.jsx("footer",{className:"mt-auto p-4 border-t border-ui-border dark:border-slate-700 flex-shrink-0",children:y.jsx("button",{onClick:C,className:"w-full flex items-center justify-center gap-2 px-3 py-2 bg-red-100 text-red-700 dark:bg-red-900/40 dark:text-red-200 text-sm font-semibold rounded-lg hover:bg-red-200 dark:hover:bg-red-900/60",children:E("modalDisconnect")})})]})})},gz=({client:t})=>{const{t:e}=Vt(),{status:n,color:r,hint:a}=pe.useMemo(()=>{const s=t.profile.dailyCalorieGoal;if(!s||t.history.length===0)return{status:e("na"),color:"bg-slate-200 dark:bg-slate-700 text-slate-600 dark:text-slate-300",hint:e("doctorDashboardNoData")};const l=t.history.slice(0,7),c=new Set(l.map(g=>new Date(g.date).toDateString())).size,d=l.reduce((g,x)=>g+x.nutrition.calories,0)/Math.max(1,c)/s;return d<.75?{status:e("statusLow"),color:"bg-status-medium-bg text-status-medium-text",hint:e("doctorDashboardHintLow")}:d>1.25?{status:e("statusHigh"),color:"bg-status-bad-bg text-status-bad-text",hint:e("doctorDashboardHintHigh")}:{status:e("statusNormal"),color:"bg-status-ok-bg text-status-ok-text",hint:e("doctorDashboardHintNormal")}},[t.history,t.profile.dailyCalorieGoal,e]);return y.jsxs("div",{className:"p-2 bg-slate-100 dark:bg-slate-700/50 rounded-md",title:a,children:[y.jsx("p",{className:"text-xs text-ui-text-secondary dark:text-slate-400",children:e("doctorDashboardCalorieStatus")}),y.jsx("p",{className:`font-bold px-2 py-0.5 rounded-full inline-block text-center text-xs ${r}`,children:n})]})},xz=({client:t,onManagePatient:e,index:n})=>{const{t:r}=Vt(),{profile:a,history:s}=t,l=pe.useMemo(()=>IT(a.dob,r),[a.dob,r]),c=pe.useMemo(()=>Hm(a.weightKg,a.heightCm),[a.weightKg,a.heightCm]),f=pe.useMemo(()=>Gm(c),[c]);s.length>0?new Date(s[0].date).toLocaleDateString():r("na");const d=s.length>0&&new Date().getTime()-new Date(s[0].date).getTime()>3*24*60*60*1e3,g=(f==null?void 0:f.isRisk)||d,x=d?r("doctorDashboardInactiveHint"):f?r("doctorDashboardBmiHint",{status:r(f.status)}):"";return y.jsxs("div",{className:"bg-ui-card dark:bg-slate-800 p-4 rounded-xl shadow-md border border-ui-border dark:border-slate-700 space-y-3 animate-slide-up flex flex-col transform hover:-translate-y-1",style:{animationDelay:`${n*50}ms`},children:[y.jsxs("div",{className:"flex justify-between items-start",children:[y.jsxs("div",{children:[y.jsxs("h3",{className:"text-lg font-bold text-ui-text dark:text-slate-100",children:[n+1,". ",a.fullName||r("doctorDashboardUnnamed")]}),y.jsxs("p",{className:"text-sm text-ui-text-secondary dark:text-slate-400 capitalize",children:[l,", ",r(a.gender)]})]}),g&&y.jsx("div",{className:"flex-shrink-0",title:x,children:y.jsx(Qa,{className:"h-6 w-6 text-yellow-500"})})]}),y.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[y.jsx(gz,{client:t}),y.jsxs("div",{className:"p-2 bg-slate-100 dark:bg-slate-700/50 rounded-md",children:[y.jsx("p",{className:"text-xs text-ui-text-secondary dark:text-slate-400",children:"BMI"}),y.jsx("p",{className:`font-bold ${f==null?void 0:f.colorClass}`,children:c?c.toFixed(1):r("na")})]})]}),y.jsx("div",{className:"flex flex-col gap-2 pt-3 border-t border-ui-border dark:border-slate-700 mt-auto",children:y.jsxs("button",{onClick:()=>e(t),className:"w-full flex items-center justify-center gap-2 px-3 py-2 bg-brand-primary text-white text-sm font-semibold rounded-lg hover:bg-brand-secondary",children:[y.jsx(xs,{className:"h-4 w-4"})," ",r("doctorDashboardManage")]})})]})},vz=({doctorProfile:t})=>{const[e,n]=pe.useState([]),[r,a]=pe.useState(!0),[s,l]=pe.useState(null),[c,f]=pe.useState(null),[d,g]=pe.useState(!1),{t:x}=Vt(),_=pe.useCallback(async()=>{a(!0),l(null);const{data:S,error:C}=await eI(t.id);C?l(C):S&&n(S),a(!1)},[t.id]);pe.useEffect(()=>{_()},[_]);const T=()=>{e.length>0?fz(e,t.fullName||"Doctor"):alert(x("doctorDashboardExportEmpty"))},E=()=>{navigator.clipboard.writeText(t.doctorCode),g(!0),setTimeout(()=>g(!1),2e3)};return y.jsxs("div",{className:"w-full max-w-6xl mx-auto animate-fade-in space-y-6",children:[c&&y.jsx(pz,{patient:c,doctorId:t.id,onClose:()=>f(null),onDataChange:_}),y.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-4",children:[y.jsxs("div",{children:[y.jsx("h1",{className:"text-3xl font-bold text-ui-text dark:text-slate-50",children:x("doctorDashboardTitle")}),y.jsx("p",{className:"text-ui-text-secondary dark:text-slate-400",children:x("doctorDashboardSubtitle")})]}),y.jsxs("button",{onClick:T,disabled:e.length===0,className:"w-full sm:w-auto inline-flex items-center justify-center gap-2 px-4 py-2 bg-brand-primary text-white font-bold rounded-lg hover:bg-brand-secondary disabled:bg-slate-400 disabled:cursor-not-allowed",children:[y.jsx(lT,{className:"h-5 w-5"}),x("doctorDashboardExport")]})]}),y.jsxs("div",{className:"bg-ui-card dark:bg-slate-800 p-4 rounded-xl shadow-md border border-ui-border dark:border-slate-700 flex flex-col sm:flex-row items-center justify-between gap-4",children:[y.jsxs("div",{children:[y.jsx("h3",{className:"font-semibold text-ui-text dark:text-slate-200",children:x("doctorDashboardCodeTitle")}),y.jsx("p",{className:"text-sm text-ui-text-secondary dark:text-slate-400",children:x("doctorDashboardCodeSubtitle")})]}),y.jsxs("div",{className:"p-3 bg-slate-100 dark:bg-slate-900/50 rounded-lg flex items-center gap-4",children:[y.jsx("p",{className:"text-xl sm:text-3xl font-bold font-mono text-brand-primary tracking-widest",children:t.doctorCode}),y.jsx("button",{onClick:E,title:x("doctorDashboardCopyCode"),className:"p-2 rounded-md hover:bg-slate-200 dark:hover:bg-slate-700",children:d?y.jsx(Ic,{className:"h-5 w-5 text-green-500"}):y.jsx(cT,{className:"h-5 w-5 text-ui-text-secondary"})})]})]}),y.jsxs("div",{className:"p-4 sm:p-6 bg-ui-card dark:bg-slate-800 rounded-xl shadow-md border border-ui-border dark:border-slate-700",children:[y.jsxs("h2",{className:"text-xl font-bold text-ui-text dark:text-slate-100 mb-4 flex items-center gap-2",children:[y.jsx(sT,{})," ",x("doctorDashboardAllPatients",{count:e.length})]}),r?y.jsx("div",{className:"flex justify-center p-8",children:y.jsx(hn,{})}):s?y.jsx("p",{className:"text-red-500 text-center p-8",children:s}):e.length===0?y.jsx("div",{className:"text-center py-8 px-4",children:y.jsx("p",{className:"text-ui-text-secondary dark:text-slate-400",children:x("doctorDashboardNoPatients")})}):y.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:e.map((S,C)=>y.jsx(xz,{client:S,onManagePatient:f,index:C},S.profile.id))})]})]})},yz=({userProfile:t,onProfileUpdate:e,setView:n})=>{const[r,a]=pe.useState(null),[s,l]=pe.useState(""),[c,f]=pe.useState(null),[d,g]=pe.useState(!1),[x,_]=pe.useState(!1),[T,E]=pe.useState(null),{t:S,languageName:C}=Vt(),k=P=>{if(P){const D=new FileReader;D.readAsDataURL(P),D.onload=()=>{a(D.result),b(D.result,"")}}},N=P=>{l(P.target.value)},b=async(P,D)=>{g(!0),E(null),f(null);try{const j=await TF(P,D,C);f(j)}catch(j){E(j instanceof Error?j.message:"An unknown error occurred.")}finally{g(!1)}},I=()=>{s.trim()&&(a(null),b(null,s))},F=async()=>{if(!c)return;_(!0),E(null);const P=c.diagnoses.length>0?`Diagnoses: ${c.diagnoses.join(", ")}.`:"",D=c.medications.length>0?`Medications: ${c.medications.map(X=>`${X.name} (${X.dosage})`).join(", ")}.`:"",B={medical_history:[t.medicalHistory,P,D].filter(Boolean).join(`
`)},{error:te}=await nt.from("profiles").update(B).eq("id",t.id);te?E(`Failed to update profile: ${te.message}`):(await e(),alert(S("prescriptionSaveSuccess")),n("dashboard")),_(!1)};return y.jsxs("div",{className:"w-full max-w-4xl mx-auto animate-fade-in space-y-6",children:[y.jsxs("div",{className:"text-center",children:[y.jsx("h1",{className:"text-3xl font-bold text-ui-text dark:text-slate-50",children:S("prescriptionTitle")}),y.jsx("p",{className:"text-ui-text-secondary dark:text-slate-400 max-w-2xl mx-auto",children:S("prescriptionSubtitle")})]}),y.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[y.jsxs("div",{className:"space-y-4",children:[y.jsx("h2",{className:"text-xl font-semibold text-ui-text dark:text-slate-100",children:S("prescriptionUploadOrPaste")}),y.jsx($h,{onFileSelect:k,disabled:d}),y.jsx("textarea",{value:s,onChange:N,placeholder:S("prescriptionTextPlaceholder"),rows:6,className:"w-full p-3 bg-slate-100 dark:bg-slate-700 border border-ui-border dark:border-slate-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-brand-primary",disabled:d}),y.jsxs("button",{onClick:I,disabled:d||!s.trim(),className:"w-full flex items-center justify-center gap-2 px-4 py-2 bg-brand-primary text-white font-semibold rounded-lg hover:bg-brand-secondary transition-colors disabled:bg-slate-400",children:[y.jsx(sc,{className:"h-5 w-5"}),S("prescriptionAnalyzeText")]})]}),y.jsxs("div",{className:"space-y-4",children:[y.jsx("h2",{className:"text-xl font-semibold text-ui-text dark:text-slate-100",children:S("prescriptionAiResult")}),y.jsx("div",{className:"bg-ui-card dark:bg-slate-800 p-6 rounded-xl shadow-lg border border-ui-border dark:border-slate-700 min-h-[300px] flex flex-col justify-between",children:d?y.jsxs("div",{className:"flex flex-col items-center justify-center h-full",children:[y.jsx(hn,{}),y.jsx("p",{className:"mt-2",children:S("prescriptionAnalyzing")})]}):T?y.jsx("div",{className:"text-red-500",children:T}):c?y.jsxs("div",{className:"space-y-4 animate-fade-in",children:[y.jsxs("div",{children:[y.jsx("h3",{className:"font-bold text-ui-text dark:text-slate-100",children:S("prescriptionDiagnoses")}),c.diagnoses.length>0?y.jsx("ul",{className:"list-disc list-inside text-sm text-ui-text-secondary dark:text-slate-300",children:c.diagnoses.map((P,D)=>y.jsx("li",{children:P},D))}):y.jsx("p",{className:"text-sm text-ui-text-secondary dark:text-slate-400",children:S("prescriptionNoneFound")})]}),y.jsxs("div",{children:[y.jsx("h3",{className:"font-bold text-ui-text dark:text-slate-100",children:S("prescriptionMedications")}),c.medications.length>0?y.jsx("ul",{className:"list-disc list-inside text-sm text-ui-text-secondary dark:text-slate-300",children:c.medications.map((P,D)=>y.jsxs("li",{children:[P.name," ",y.jsxs("span",{className:"text-xs",children:["(",P.dosage,")"]})]},D))}):y.jsx("p",{className:"text-sm text-ui-text-secondary dark:text-slate-400",children:S("prescriptionNoneFound")})]}),y.jsxs("button",{onClick:F,disabled:x,className:"w-full mt-4 flex items-center justify-center gap-2 px-4 py-2 bg-green-600 text-white font-semibold rounded-lg hover:bg-green-700 transition-colors disabled:bg-slate-400",children:[x?y.jsx(hn,{className:"h-5 w-5"}):y.jsx(jf,{className:"h-5 w-5"}),S("prescriptionSaveToHistory")]})]}):y.jsxs("div",{className:"text-center text-ui-text-secondary dark:text-slate-400 m-auto",children:[y.jsx(Pc,{className:"h-12 w-12 mx-auto mb-2"}),S("prescriptionResultsPlaceholder")]})})]})]})]})},ec=({label:t,value:e,onChange:n,placeholder:r,name:a,required:s=!1,disabled:l=!1})=>y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-ui-text-secondary dark:text-slate-300 mb-1",children:t}),y.jsx("input",{name:a,type:"text",value:e??"",onChange:n,placeholder:r,required:s,disabled:l,className:"w-full px-3 py-2 bg-slate-100 dark:bg-slate-700 border border-ui-border dark:border-slate-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-brand-primary text-ui-text dark:text-slate-50 disabled:bg-slate-200 dark:disabled:bg-slate-800 disabled:cursor-not-allowed"})]}),_z=({currentProfile:t,onSave:e,isSaving:n})=>{const[r,a]=pe.useState(t),[s,l]=pe.useState(!1),{t:c}=Vt(),f=x=>{const{name:_,value:T}=x.target;a(E=>({...E,[_]:T}))},d=x=>{x.preventDefault(),e(r)},g=()=>{navigator.clipboard.writeText(r.doctorCode),l(!0),setTimeout(()=>l(!1),2e3)};return y.jsx("div",{className:"w-full max-w-2xl mx-auto animate-fade-in p-4 sm:p-0",children:y.jsxs("form",{onSubmit:d,className:"bg-ui-card dark:bg-slate-800 p-6 sm:p-8 rounded-xl shadow-lg border border-ui-border dark:border-slate-700",children:[y.jsxs("div",{className:"text-center mb-8",children:[y.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-ui-text dark:text-slate-50",children:c("doctorProfileTitle")}),y.jsx("p",{className:"text-ui-text-secondary dark:text-slate-400 mt-2",children:c("doctorProfileSubtitle")})]}),y.jsxs("div",{className:"space-y-6",children:[y.jsx(ec,{label:c("authFullName"),name:"fullName",value:r.fullName,onChange:f,placeholder:c("authFullNamePlaceholder"),required:!0}),y.jsx(ec,{label:c("authSpecialization"),name:"specialization",value:r.specialization,onChange:f,placeholder:c("authSpecializationPlaceholder")}),y.jsx(ec,{label:c("authPhoneNumber"),name:"phoneNumber",value:r.phoneNumber,onChange:f,placeholder:c("doctorProfilePhonePlaceholder")}),y.jsx(ec,{label:c("authUsername"),name:"username",value:r.username,onChange:()=>{},placeholder:"",disabled:!0}),y.jsx(ec,{label:c("authMedicalId"),name:"medicalRegistrationId",value:r.medicalRegistrationId,onChange:()=>{},placeholder:"",disabled:!0}),y.jsxs("div",{className:"pt-4",children:[y.jsx("label",{className:"block text-sm font-medium text-ui-text-secondary dark:text-slate-300 mb-1",children:c("doctorDashboardCodeTitle")}),y.jsxs("div",{className:"p-3 bg-slate-100 dark:bg-slate-900/50 rounded-lg flex items-center justify-between gap-4",children:[y.jsx("p",{className:"text-2xl font-bold font-mono text-brand-primary tracking-widest",children:r.doctorCode}),y.jsx("button",{type:"button",onClick:g,title:c("doctorDashboardCopyCode"),className:"p-2 rounded-md hover:bg-slate-200 dark:hover:bg-slate-700 transition-colors",children:s?y.jsx(Ic,{className:"h-5 w-5 text-green-500"}):y.jsx(cT,{className:"h-5 w-5 text-ui-text-secondary"})})]}),y.jsx("p",{className:"text-xs text-ui-text-secondary dark:text-slate-400 mt-2",children:c("doctorDashboardCodeSubtitle")})]})]}),y.jsx("div",{className:"mt-8 pt-6 border-t border-ui-border dark:border-slate-700",children:y.jsxs("button",{type:"submit",disabled:n,className:"w-full flex justify-center items-center gap-2 py-3 px-4 bg-brand-primary text-white font-semibold rounded-lg shadow-sm hover:bg-brand-secondary focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-brand-primary disabled:bg-slate-400 disabled:cursor-not-allowed",children:[n?y.jsx(hn,{className:"h-5 w-5"}):y.jsx(jf,{className:"h-5 w-5"}),c("save")," ",c("changes")]})})]})})},Tz=({text:t})=>{const e=c=>{const f=c.replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\*(.*?)\*/g,"<em>$1</em>");return y.jsx("span",{dangerouslySetInnerHTML:{__html:f}})},n=t.split(`
`),r=[];let a=[],s=null;const l=()=>{if(a.length>0&&s){const c=s;r.push(y.jsx(c,{className:`${c==="ul"?"list-disc":"list-decimal"} list-inside space-y-1 my-2`,children:a.map((f,d)=>y.jsx("li",{children:e(f)},d))},`list-${r.length}`)),a=[],s=null}};return n.forEach(c=>{const f=c.match(/^(\s*)(-|\*) (.*)/),d=c.match(/^(\s*)(\d+)\. (.*)/);f?(s!=="ul"&&l(),s="ul",a.push(f[3])):d?(s!=="ol"&&l(),s="ol",a.push(d[3])):(l(),c.trim()!==""&&r.push(y.jsx("p",{className:"my-1",children:e(c)},`p-${r.length}`)))}),l(),y.jsx("div",{className:"leading-relaxed",children:r})},wz=({healthChat:t})=>{const[e,n]=pe.useState(!1),[r,a]=pe.useState([]),[s,l]=pe.useState(""),[c,f]=pe.useState(!1),d=pe.useRef(null),{t:g}=Vt(),[x,_]=pe.useState(!1),[T,E]=pe.useState(""),S=pe.useCallback(()=>{window.speechSynthesis.speaking&&window.speechSynthesis.cancel(),_(!1),E("")},[]),C=N=>{if(x&&T===N){S();return}window.speechSynthesis.speaking&&window.speechSynthesis.cancel();const b=new SpeechSynthesisUtterance(N.replace(/(\*\*|\*)/g,""));b.onend=()=>{_(!1),E("")},b.onerror=()=>{console.error("Speech synthesis error"),_(!1),E("")},window.speechSynthesis.speak(b),_(!0),E(N)};pe.useEffect(()=>()=>{S()},[S]),pe.useEffect(()=>{d.current&&(d.current.scrollTop=d.current.scrollHeight)},[r]),pe.useEffect(()=>{e&&r.length===0&&a([{role:"bot",text:g("chatbotGreeting")}]),e||S()},[e,r.length,S,g]);const k=async N=>{if(N.preventDefault(),!s.trim()||c||!t)return;S();const b={role:"user",text:s};a(I=>[...I,b]),l(""),f(!0);try{const I=await t.sendMessageStream({message:s});let F="";for await(const P of I)F+=P.text,a(D=>{const j=D[D.length-1];if(j.role==="bot"){const B=[...D];return B[B.length-1]={...j,text:F},B}else return[...D,{role:"bot",text:F}]})}catch(I){console.error("Chat error:",I),a(F=>[...F,{role:"bot",text:g("chatbotError")}])}finally{f(!1)}};return y.jsxs(y.Fragment,{children:[y.jsx("button",{onClick:()=>n(!e),className:"fixed bottom-24 md:bottom-6 right-6 bg-brand-primary text-white p-3 sm:p-4 rounded-full shadow-lg hover:bg-brand-secondary transition-transform transform hover:scale-110 z-50 animate-pulse-fast","aria-label":g("chatbotToggle"),children:e?y.jsx(Wo,{className:"h-6 w-6 sm:h-8 sm:w-8"}):y.jsx(sc,{className:"h-6 w-6 sm:h-8 sm:w-8"})}),e&&y.jsxs(y.Fragment,{children:[y.jsx("div",{className:"fixed inset-0 bg-black/60 z-40 animate-fade-in",onClick:()=>n(!1)}),y.jsxs("div",{className:"fixed bottom-24 right-4 sm:right-6 w-[calc(100%-2rem)] sm:w-full max-w-sm md:max-w-md max-h-[calc(100vh-10rem)] sm:max-h-[550px] md:max-h-[600px] bg-ui-card dark:bg-slate-800 rounded-2xl shadow-2xl flex flex-col animate-slide-up z-50 border border-ui-border dark:border-slate-700",children:[y.jsxs("header",{className:"p-4 border-b border-ui-border dark:border-slate-700 flex items-center gap-3",children:[y.jsx(sc,{className:"h-7 w-7 text-brand-primary"}),y.jsx("h2",{className:"text-xl font-bold text-ui-text dark:text-slate-100",children:g("chatbotTitle")})]}),y.jsxs("div",{ref:d,className:"flex-1 p-4 overflow-y-auto space-y-4 min-h-0",children:[r.map((N,b)=>y.jsxs("div",{className:`flex items-start gap-2.5 ${N.role==="user"?"justify-end":""}`,children:[N.role==="bot"&&y.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-full bg-brand-primary/20 flex items-center justify-center",children:y.jsx(sc,{className:"w-5 h-5 text-brand-primary"})}),y.jsxs("div",{className:`relative group p-3 rounded-xl max-w-xs break-words ${N.role==="user"?"bg-brand-primary text-white rounded-br-none":"bg-slate-100 dark:bg-slate-700 text-ui-text dark:text-slate-200 rounded-bl-none"}`,children:[N.role==="bot"?y.jsx(Tz,{text:N.text}):N.text,N.role==="bot"&&N.text&&y.jsx("button",{onClick:()=>C(N.text),className:"absolute -bottom-3 -right-3 p-1 bg-slate-200 dark:bg-slate-600 rounded-full opacity-0 group-hover:opacity-100 transition-opacity","aria-label":x&&T===N.text?g("chatbotStopSpeaking"):g("chatbotSpeak"),children:x&&T===N.text?y.jsx(VF,{className:"h-4 w-4 text-ui-text-secondary"}):y.jsx(BF,{className:"h-4 w-4 text-ui-text-secondary"})})]})]},b)),c&&y.jsxs("div",{className:"flex items-start gap-2.5",children:[y.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-full bg-brand-primary/20 flex items-center justify-center",children:y.jsx(hn,{className:"w-5 h-5"})}),y.jsx("div",{className:"p-3 rounded-xl max-w-xs bg-slate-100 dark:bg-slate-700 text-ui-text-secondary dark:text-slate-400 rounded-bl-none italic",children:g("chatbotThinking")})]})]}),y.jsxs("form",{onSubmit:k,className:"p-4 border-t border-ui-border dark:border-slate-700 flex items-center gap-2",children:[y.jsx("input",{type:"text",value:s,onChange:N=>l(N.target.value),placeholder:g("chatbotPlaceholder"),disabled:c,className:"flex-1 w-full px-4 py-2 bg-slate-100 dark:bg-slate-700 border border-ui-border dark:border-slate-600 rounded-full focus:outline-none focus:ring-2 focus:ring-brand-primary"}),y.jsx("button",{type:"submit",disabled:c||!s.trim(),className:"p-3 bg-brand-primary text-white rounded-full hover:bg-brand-secondary disabled:bg-slate-400 disabled:cursor-not-allowed","aria-label":g("chatbotSpeak"),children:y.jsx(UF,{className:"h-5 w-5"})})]})]})]})]})},Sz=({item:t,onToggle:e})=>{const{product_name:n,brand_name:r,health_stars:a,nutrition_info:s,is_purchased:l,id:c}=t,f=s,{t:d}=Vt();return y.jsxs("div",{className:`p-3 sm:p-4 rounded-lg border flex gap-4 items-center transition-all duration-300 ${l?"bg-slate-100 dark:bg-slate-800 opacity-60":"bg-ui-card dark:bg-slate-800/50"}`,children:[y.jsx("button",{onClick:()=>e(c,!l),className:`flex-shrink-0 w-7 h-7 sm:w-8 sm:h-8 rounded-full border-2 flex items-center justify-center transition-colors ${l?"bg-brand-primary border-brand-primary":"border-slate-300 dark:border-slate-600 hover:border-brand-primary"}`,children:l&&y.jsx(Ic,{className:"w-5 h-5 text-white"})}),y.jsxs("div",{className:"flex-grow",children:[y.jsx("p",{className:`font-bold capitalize text-ui-text dark:text-slate-200 ${l?"line-through":""}`,children:n}),r&&y.jsx("p",{className:"text-sm text-ui-text-secondary dark:text-slate-400",children:r})]}),y.jsxs("div",{className:"flex-shrink-0 flex items-center gap-2 sm:gap-4 text-sm text-ui-text-secondary dark:text-slate-400",children:[a&&y.jsxs("div",{className:"flex items-center gap-1",title:d("groceryStarsHint",{stars:a.toFixed(1)}),children:[y.jsx(aT,{className:"h-5 w-5 text-yellow-400",filled:!0}),y.jsx("span",{className:"font-semibold",children:a.toFixed(1)})]}),f&&y.jsxs("div",{className:"flex items-center gap-1",title:d("groceryCaloriesHint",{calories:f.calories.toFixed(0)}),children:[y.jsx(Sm,{className:"h-5 w-5 text-orange-400"}),y.jsx("span",{className:"font-semibold",children:f.calories.toFixed(0)})]})]})]})},Ez=({userProfile:t,setView:e})=>{const[n,r]=pe.useState([]),[a,s]=pe.useState(!0),[l,c]=pe.useState(null),{t:f}=Vt(),d=pe.useCallback(async()=>{s(!0),c(null);try{const{data:_,error:T}=await nt.from("grocery_list_items").select("*").eq("user_id",t.id).order("is_purchased",{ascending:!0}).order("created_at",{ascending:!1});if(T)throw T;const E=(_||[]).map(S=>({...S,nutrition_info:S.nutrition_info}));r(E)}catch(_){c(_ instanceof Error?_.message:"Failed to fetch grocery list.")}finally{s(!1)}},[t.id]);pe.useEffect(()=>{d()},[d]);const g=async(_,T)=>{r(C=>C.map(k=>k.id===_?{...k,is_purchased:T}:k));const E={is_purchased:T},{error:S}=await nt.from("grocery_list_items").update(E).eq("id",_);S&&(alert(f("groceryUpdateError")),d())},x=async()=>{if(!window.confirm(f("groceryClearConfirm")))return;const _=n.filter(E=>E.is_purchased).map(E=>E.id);if(_.length===0)return;const{error:T}=await nt.from("grocery_list_items").delete().in("id",_);T?alert(f("groceryClearError")):d()};return y.jsxs("div",{className:"w-full max-w-3xl mx-auto animate-fade-in space-y-6",children:[y.jsxs("div",{className:"text-center",children:[y.jsxs("h1",{className:"text-3xl font-bold text-ui-text dark:text-slate-50 flex items-center justify-center gap-3",children:[y.jsx(Fm,{className:"h-8 w-8 text-brand-primary"}),f("groceryTitle")]}),y.jsx("p",{className:"text-ui-text-secondary dark:text-slate-400",children:f("grocerySubtitle")})]}),y.jsxs("div",{className:"flex justify-between items-center",children:[y.jsxs("button",{onClick:()=>e("grocery"),className:"flex items-center gap-2 px-4 py-2 text-sm font-semibold rounded-lg bg-ui-card dark:bg-slate-700 hover:bg-slate-100 dark:hover:bg-slate-600 transition-colors",children:[y.jsx(oT,{className:"h-4 w-4"}),f("groceryBackToScanner")]}),y.jsx("button",{onClick:x,disabled:!n.some(_=>_.is_purchased),className:"flex items-center gap-2 px-4 py-2 text-sm font-semibold text-red-600 dark:text-red-400 rounded-lg bg-red-100 dark:bg-red-900/40 hover:bg-red-200 dark:hover:bg-red-800/60 disabled:opacity-50 disabled:cursor-not-allowed",children:f("groceryClearPurchased")})]}),y.jsx("div",{className:"bg-ui-card dark:bg-slate-800 p-4 sm:p-6 rounded-xl shadow-lg border border-ui-border dark:border-slate-700",children:a?y.jsx("div",{className:"flex justify-center p-8",children:y.jsx(hn,{})}):l?y.jsx("p",{className:"text-red-500 text-center p-8",children:l}):n.length===0?y.jsxs("div",{className:"text-center py-12",children:[y.jsx("p",{className:"text-ui-text-secondary dark:text-slate-400",children:f("groceryEmpty")}),y.jsx("button",{onClick:()=>e("grocery"),className:"mt-4 font-semibold text-brand-primary hover:text-brand-secondary",children:f("groceryScanToStart")})]}):y.jsx("div",{className:"space-y-3",children:n.map(_=>y.jsx(Sz,{item:_,onToggle:g},_.id))})})]})};function T2(t,e){const[n,r]=pe.useState(()=>{try{const s=window.localStorage.getItem(t);return s?JSON.parse(s):e}catch(s){return console.error(`Error reading localStorage key ${t}:`,s),e}}),a=pe.useCallback(s=>{try{r(l=>{const c=s instanceof Function?s(l):s;return window.localStorage.setItem(t,JSON.stringify(c)),c})}catch(l){console.error(`Error setting localStorage key ${t}:`,l)}},[t]);return[n,a]}const Cz=({onLogout:t,onToggleTheme:e,theme:n,setView:r,isDoctor:a})=>{const[s,l]=pe.useState(!1),c=pe.useRef(null),{language:f,setLanguage:d,t:g}=Vt();pe.useEffect(()=>{const _=T=>{c.current&&!c.current.contains(T.target)&&l(!1)};return document.addEventListener("mousedown",_),()=>document.removeEventListener("mousedown",_)},[c]);const x=[{code:"en",label:"English"},{code:"hi",label:""},{code:"ml",label:""}];return y.jsxs("div",{className:"relative",ref:c,children:[y.jsxs("button",{onClick:()=>l(!s),className:"p-2 rounded-full hover:bg-slate-100 dark:hover:bg-slate-600 flex items-center gap-2",children:[y.jsx(xs,{className:"h-6 w-6"}),y.jsx(GF,{className:"h-4 w-4 text-ui-text-secondary"})]}),s&&y.jsxs("div",{className:"absolute right-0 mt-2 w-56 bg-ui-card dark:bg-slate-700 rounded-md shadow-lg z-20 border border-ui-border dark:border-slate-600 animate-scale-in origin-top-right",children:[y.jsxs("div",{className:"p-2",children:[!a&&y.jsxs("button",{onClick:()=>{r("profile"),l(!1)},className:"w-full flex items-center gap-3 p-2 text-sm rounded-md hover:bg-slate-100 dark:hover:bg-slate-600",children:[y.jsx(xs,{className:"h-5 w-5 text-ui-text-secondary"}),y.jsx("span",{children:g("navProfile")})]}),y.jsxs("button",{onClick:e,className:"w-full flex items-center justify-between p-2 text-sm rounded-md hover:bg-slate-100 dark:hover:bg-slate-600",children:[y.jsxs("span",{className:"flex items-center gap-3",children:[n==="light"?y.jsx(FF,{className:"h-5 w-5 text-ui-text-secondary"}):y.jsx(Dm,{className:"h-5 w-5 text-ui-text-secondary"}),y.jsx("span",{children:"Theme"})]}),y.jsx("span",{className:"capitalize text-xs font-semibold text-ui-text-secondary",children:n})]})]}),y.jsxs("div",{className:"border-t border-ui-border dark:border-slate-600 p-2",children:[y.jsx("p",{className:"text-xs text-ui-text-secondary px-2 mb-1 font-semibold",children:"Language"}),x.map(_=>y.jsxs("button",{onClick:()=>{d(_.code),l(!1)},className:`w-full flex items-center justify-between p-2 text-sm rounded-md hover:bg-slate-100 dark:hover:bg-slate-600 ${f===_.code?"font-bold text-brand-primary":""}`,children:[y.jsx("span",{children:_.label}),f===_.code&&y.jsx(Ic,{className:"h-4 w-4 text-brand-primary"})]},_.code))]}),y.jsx("div",{className:"border-t border-ui-border dark:border-slate-600 p-2",children:y.jsxs("button",{onClick:t,className:"w-full flex items-center gap-3 p-2 text-sm rounded-md text-red-600 dark:text-red-400 hover:bg-red-100 dark:hover:bg-red-900/40",children:[y.jsx(IF,{className:"h-5 w-5"}),y.jsx("span",{children:"Logout"})]})})]})]})},bz=({navItems:t,activeView:e,setView:n})=>y.jsxs("aside",{className:"hidden md:flex md:flex-col md:fixed md:inset-y-0 md:w-64 bg-ui-card dark:bg-slate-800 border-r border-ui-border dark:border-slate-700 z-40",children:[y.jsx("div",{className:"flex items-center justify-center h-16 border-b border-ui-border dark:border-slate-700 flex-shrink-0 px-4",children:y.jsx(wm,{className:"h-9"})}),y.jsx("nav",{className:"flex-1 px-4 py-4 space-y-2",children:t.map(r=>y.jsxs("button",{onClick:()=>n(r.view),className:`w-full flex items-center gap-3 px-3 py-2.5 rounded-lg text-sm font-semibold transition-colors ${e===r.view?"bg-brand-primary/10 text-brand-primary dark:bg-brand-primary/20":"text-ui-text-secondary hover:bg-slate-100 dark:hover:bg-slate-700"}`,children:[Vf.cloneElement(r.icon,{className:"h-6 w-6"}),y.jsx("span",{children:r.label})]},r.view))})]}),Az=({navItems:t,activeView:e,setView:n})=>y.jsx("nav",{className:"md:hidden fixed bottom-0 inset-x-0 bg-ui-card dark:bg-slate-800 border-t border-ui-border dark:border-slate-700 p-2 z-40",children:y.jsx("div",{className:"flex justify-around items-center",children:t.map(r=>y.jsxs("button",{onClick:()=>n(r.view),className:`flex flex-col items-center justify-center p-1 rounded-md w-16 h-14 transition-colors ${e===r.view?"text-brand-primary":"text-ui-text-secondary"}`,"aria-label":r.label,children:[Vf.cloneElement(r.icon,{className:"h-6 w-6"}),y.jsx("span",{className:"text-[10px] font-medium mt-1 text-center",children:r.label})]},r.view))})}),kz=()=>{var sr;const[t,e]=pe.useState(null),[n,r]=pe.useState(null),[a,s]=pe.useState(null),[l,c]=pe.useState(null),[f,d]=pe.useState(!1),[g,x]=pe.useState(!0),[_,T]=pe.useState(null),[E,S]=T2("active-view","dashboard"),[C,k]=pe.useState(null),[N,b]=pe.useState(null),[I,F]=pe.useState(!1),[P,D]=pe.useState(!1),[j,B]=pe.useState(!1),[te,X]=pe.useState([]),[Z,ye]=pe.useState([]),[Me,Se]=pe.useState([]),[ee,me]=pe.useState([]),[Pe,re]=pe.useState([]),[z,ce]=T2("theme","light"),[L,W]=pe.useState({calories:0,proteinGrams:0,carbohydratesGrams:0,fatGrams:0,sugarGrams:0,sodiumMilligrams:0}),[q,K]=pe.useState(null),[ie,Ce]=pe.useState(!1),[Te,be]=pe.useState(null),[Ae,Xe]=pe.useState(!1),[Y,yt]=pe.useState(-1),[st,_t]=pe.useState(null),{t:qe,languageName:Ne}=Vt();pe.useEffect(()=>{nt.auth.getSession().then(({data:{session:St}})=>{e(St)});const{data:{subscription:Oe}}=nt.auth.onAuthStateChange((St,Be)=>{e(Be),St==="SIGNED_OUT"&&(D(!1),k(null),b(null),F(!1),S("dashboard"))});return()=>Oe.unsubscribe()},[S]);const bt=pe.useCallback(async()=>{if(!t){x(!1);return}T(null),x(!0);try{let{data:Oe,error:St}=await nt.from("doctors").select("id, username, full_name, phone_number, medical_registration_id, specialization, doctor_code").eq("id",t.user.id).maybeSingle();if(St)throw St;if(Oe){const ft={id:Oe.id,username:Oe.username,fullName:Oe.full_name,phoneNumber:Oe.phone_number,medicalRegistrationId:Oe.medical_registration_id,specialization:Oe.specialization,doctorCode:Oe.doctor_code};b(ft),F(!0),S("doctor_clients"),k(null),x(!1);return}F(!1);let{data:Be,error:Zt}=await nt.from("profiles").select("*").eq("id",t.user.id).maybeSingle();if(Zt)throw Zt;if(!Be){const ft={id:t.user.id,username:t.user.user_metadata.username||null,fullName:t.user.user_metadata.full_name||null,phoneNumber:t.user.user_metadata.phone_number||null,gender:"other",dob:null,age:null,heightCm:null,weightKg:null,activityLevel:"sedentary",medicalHistory:null,healthStarRating:null,dailyCalorieGoal:null,dailyProteinGoal:null,dailyCarbohydratesGoal:null,dailyFatGoal:null,dailySugarGoal:null,dailySodiumGoal:null,dailyHydrationGoalMl:null};k(ft),D(!1),S("profile"),x(!1);return}const Et={id:Be.id,username:Be.username,fullName:Be.full_name,phoneNumber:Be.phone_number,gender:Be.gender||"other",dob:Be.dob,age:null,heightCm:Be.height_cm,weightKg:Be.weight_kg,activityLevel:Be.activity_level||"sedentary",medicalHistory:Be.medical_history,updated_at:Be.updated_at,healthStarRating:Be.health_star_rating,dailyCalorieGoal:Be.daily_calorie_goal,dailyProteinGoal:Be.daily_protein_goal,dailyCarbohydratesGoal:Be.daily_carbohydrates_goal,dailyFatGoal:Be.daily_fat_goal,dailySugarGoal:Be.daily_sugar_goal,dailySodiumGoal:Be.daily_sodium_goal,dailyHydrationGoalMl:Be.daily_hydration_goal_ml},ma=!!(Et.dob&&Et.gender&&Et.heightCm&&Et.weightKg&&Et.activityLevel);if(D(ma),ma||S("profile"),!Et.dailyCalorieGoal){const ft=c_(Et);ft&&(Et.dailyCalorieGoal=ft.calories,Et.dailyProteinGoal=ft.proteinGrams,Et.dailyCarbohydratesGoal=ft.carbohydratesGrams,Et.dailyFatGoal=ft.fatGrams,Et.dailySugarGoal=ft.sugarGrams,Et.dailySodiumGoal=ft.sodiumMilligrams)}k(Et);const Aa=await nt.from("food_history").select("*").eq("user_id",t.user.id).order("created_at",{ascending:!1}),Qr=await nt.from("prescriptions").select("*").eq("user_id",t.user.id).order("created_at",{ascending:!1}),Rr=await RT(t.user.id);if(Aa.error)throw Aa.error;if(Qr.error)throw Qr.error;if(Rr.error)throw new Error(Rr.error);const Rs=(Aa.data||[]).filter(ft=>ft.nutrition).map(ft=>({id:ft.id,user_id:ft.user_id,date:ft.created_at,foodName:ft.food_name||"Unnamed Food",estimatedWeightGrams:ft.estimated_weight_grams||0,nutrition:ft.nutrition,type:"food",dietaryWarnings:ft.dietary_warnings,safetyVerdict:ft.safety_verdict?ft.safety_verdict:void 0}));if(X(Rs),ye((Qr.data||[]).map(ft=>({id:ft.id,user_id:ft.user_id,created_at:ft.created_at,raw_text:ft.raw_text,image_url:ft.image_url,parsed_content:ft.parsed_content}))),re(Rr.data||[]),Rr.data&&Rr.data.length>0){const{data:ft}=await nt.from("safe_foods").select("*").eq("user_id",t.user.id);Se(ft);const{data:Hi}=await nt.from("restricted_foods").select("*").eq("user_id",t.user.id);me(Hi)}}catch(Oe){console.error(Oe),T(Oe instanceof Error?Oe.message:"Failed to fetch your data.")}finally{x(!1)}},[t,S]);pe.useEffect(()=>{t?bt():x(!1)},[t,bt]),pe.useEffect(()=>{if(C&&P&&!I){const Oe=bF(C,te,Z,Ne);_t(Oe)}else _t(null)},[C,P,I,te,Z,Ne]),pe.useEffect(()=>{const Oe=new Date().toDateString(),Be=te.filter(Zt=>new Date(Zt.date).toDateString()===Oe).reduce((Zt,Et)=>(Zt.calories+=Et.nutrition.calories,Zt.proteinGrams+=Et.nutrition.proteinGrams,Zt.carbohydratesGrams+=Et.nutrition.carbohydratesGrams,Zt.fatGrams+=Et.nutrition.fatGrams,Zt.sugarGrams+=Et.nutrition.sugarGrams,Zt.sodiumMilligrams+=Et.nutrition.sodiumMilligrams,Zt),{calories:0,proteinGrams:0,carbohydratesGrams:0,fatGrams:0,sugarGrams:0,sodiumMilligrams:0});W(Be)},[te]),pe.useEffect(()=>{!C||!P||!t||!C.dailyCalorieGoal||(L.calories>0&&Math.abs(L.calories-Y)>50?(Ce(!0),yt(L.calories),SF(L,C,Ne).then(K).catch(Oe=>console.error("Insight error",Oe)).finally(()=>Ce(!1))):L.calories===0&&(K(null),yt(-1)))},[C,P,L,t,Y,Ne]),pe.useEffect(()=>{document.documentElement.classList.toggle("dark",z==="dark")},[z]);const Ln=()=>ce(Oe=>Oe==="light"?"dark":"light"),On=pe.useCallback(async Oe=>{if(!C)return T("User profile not loaded.");d(!0),T(null),r(null),s(URL.createObjectURL(Oe));const St=new FileReader;St.readAsDataURL(Oe),St.onload=async()=>{const Be=St.result.split(",")[1];if(c(Be),Be)try{const Zt=await vF(Be,C,Me,ee,Ne),ma={...{id:-1,date:new Date().toISOString(),user_id:C.id},...Zt};r(ma)}catch(Zt){T(Zt instanceof Error?`Failed to analyze image. ${Zt.message}`:"An unknown error occurred.")}finally{d(!1)}}},[C,Me,ee,Ne]),$n=pe.useCallback(async Oe=>{await On(Oe),S("grocery")},[On,S]),ha=async Oe=>{if(!l||!C||!n)return T("Cannot refine analysis.");d(!0),T(null);try{const St=await yF(l,C,n,Oe,Me,ee,Ne),Be={...n,...St,date:new Date().toISOString()};r(Be)}catch(St){T(St instanceof Error?`Refinement failed. ${St.message}`:"An unknown error occurred.")}finally{d(!1)}},Un=()=>{r(null),s(null),T(null),d(!1),c(null),S(I?"doctor_clients":"dashboard")},Cn=async()=>{if(n&&t&&C){d(!0),T(null);const Oe={user_id:t.user.id,nutrition:n.nutrition,food_name:n.type==="food"?n.foodName:n.productName,estimated_weight_grams:n.type==="food"?n.estimatedWeightGrams:n.servingSizeGrams,dietary_warnings:n.dietaryWarnings,safety_verdict:n.safetyVerdict??null},{error:St}=await nt.from("food_history").insert([Oe]);St?T(`Failed to save to diary: ${St.message}`):(await bt(),Un()),d(!1)}},yr=async Oe=>{if(n&&t&&C){d(!0),T(null);const St={user_id:t.user.id,product_name:Oe.product_name,brand_name:Oe.brand_name,nutrition_info:Oe.nutrition_info,health_stars:Oe.health_stars},{error:Be}=await nt.from("grocery_list_items").insert([St]);Be?(T(`Failed to save to grocery list: ${Be.message}`),alert(`Error: ${Be.message}`)):(alert("Item added to your grocery list!"),Un()),d(!1)}},Bn=async(Oe,St)=>{if(!t)return;B(!0),T(null);const Be=c_(Oe),Zt={username:Oe.username,full_name:Oe.fullName,phone_number:Oe.phoneNumber,gender:Oe.gender,dob:Oe.dob,height_cm:Oe.heightCm,weight_kg:Oe.weightKg,activity_level:Oe.activityLevel,medical_history:Oe.medicalHistory,daily_calorie_goal:(Be==null?void 0:Be.calories)??null,daily_protein_goal:(Be==null?void 0:Be.proteinGrams)??null,daily_carbohydrates_goal:(Be==null?void 0:Be.carbohydratesGrams)??null,daily_fat_goal:(Be==null?void 0:Be.fatGrams)??null,daily_sugar_goal:(Be==null?void 0:Be.sugarGrams)??null,daily_sodium_goal:(Be==null?void 0:Be.sodiumMilligrams)??null},{error:Et}=await nt.from("profiles").update(Zt).eq("id",t.user.id);Et?T(`Failed to save profile: ${Et.message}`):(await bt(),S("dashboard")),B(!1)},cn=async Oe=>{if(!t)return;B(!0),T(null);const St={full_name:Oe.fullName,phone_number:Oe.phoneNumber,specialization:Oe.specialization},{error:Be}=await nt.from("doctors").update(St).eq("id",t.user.id);Be?T(`Failed to save profile: ${Be.message}`):(await bt(),alert("Profile saved successfully!")),B(!1)},Ht=async()=>{if(C){Xe(!0),T(null);try{const Oe=await CF(L,C,Ne);be(Oe)}catch(Oe){T(Oe instanceof Error?Oe.message:"Could not generate suggestion.")}finally{Xe(!1)}}},zt=async()=>{await nt.auth.signOut()};if(g)return y.jsx("div",{className:"min-h-screen flex items-center justify-center",children:y.jsx(hn,{})});if(!t)return y.jsx(rI,{});if(!P&&!I)return y.jsx("div",{className:"min-h-screen bg-ui-bg dark:bg-slate-900 py-12 px-4",children:C&&y.jsx(f_,{currentProfile:C,onSave:Bn,isSetupMode:!0,isSaving:j})});const et=()=>{if(I&&N)switch(E){case"doctor_clients":return y.jsx(vz,{doctorProfile:N});case"profile":return y.jsx(_z,{currentProfile:N,onSave:cn,isSaving:j});default:return S("doctor_clients"),null}if(C){if(n){if(n.type==="food")return y.jsx(jF,{analysis:n,imagePreview:a,onAddToDiary:Cn,onReset:Un,onRefine:ha,isLoading:f});if(n.type==="label")return y.jsx(YF,{analysis:n,imagePreview:a,onReset:Un,onRefine:ha,isLoading:f,mode:E==="grocery"?"grocery":"diary",onAddToDiary:Cn,onAddToGroceryList:yr})}switch(E){case"dashboard":return y.jsx(cI,{userProfile:C,todaysIntake:L,healthInsight:q,isLoadingInsight:ie,mealSuggestion:Te,isSuggestingMeal:Ae,onSuggestMeal:Ht,setView:S,error:_,doctorConnections:Pe});case"analyze":return y.jsx($h,{onFileSelect:On,disabled:f});case"grocery":return y.jsx($h,{onFileSelect:$n,disabled:f});case"grocery_list":return y.jsx(Ez,{userProfile:C,setView:S});case"prescription":return y.jsx(yz,{userProfile:C,onProfileUpdate:bt,setView:S});case"history":return y.jsx(dT,{history:te,userProfile:C,setView:S});case"medical_files":return y.jsx(qS,{userId:C.id,isDoctorView:!1});case"profile":return y.jsx(f_,{currentProfile:C,onSave:Bn,isSaving:j,safeFoods:Me,restrictedFoods:ee});default:return y.jsx("div",{children:"View not found"})}}return y.jsx(hn,{})},Ft=I?[{view:"doctor_clients",icon:y.jsx(sT,{}),label:qe("navMyPatients")},{view:"profile",icon:y.jsx(xs,{}),label:qe("navProfile")}]:[{view:"dashboard",icon:y.jsx(RF,{}),label:qe("navDashboard")},{view:"analyze",icon:y.jsx(Mm,{}),label:qe("navLogMeal")},{view:"grocery",icon:y.jsx(Fm,{}),label:qe("navGrocery")},{view:"prescription",icon:y.jsx(Pc,{}),label:qe("navPrescription")},{view:"history",icon:y.jsx(qf,{}),label:qe("navHistory")},{view:"medical_files",icon:y.jsx(Im,{}),label:qe("navMyFiles")}],qt=((sr=(I?Ft:[...Ft,{view:"profile",icon:y.jsx(xs,{}),label:qe("navProfile")}]).find(Oe=>Oe.view===E))==null?void 0:sr.label)||"MyNutriMate";return y.jsxs("div",{className:"min-h-screen bg-ui-bg dark:bg-slate-900",children:[y.jsx(bz,{navItems:Ft,activeView:E,setView:S}),y.jsxs("div",{className:"md:pl-64 flex flex-col min-h-screen",children:[y.jsx("header",{className:"sticky top-0 bg-ui-card/80 dark:bg-slate-800/80 backdrop-blur-lg z-30 border-b border-ui-border dark:border-slate-700",children:y.jsxs("div",{className:"w-full max-w-6xl mx-auto px-4 sm:px-6 flex items-center h-16",children:[y.jsxs("div",{className:"flex items-center gap-4 md:hidden",children:[y.jsx(wm,{className:"h-8"}),y.jsx("span",{className:"font-bold text-lg",children:qt})]}),y.jsx("div",{className:"flex-1"}),y.jsx("div",{className:"flex items-center gap-2",children:y.jsx(Cz,{onLogout:zt,onToggleTheme:Ln,theme:z,setView:S,isDoctor:I})})]})}),y.jsxs("main",{className:"flex-grow w-full max-w-6xl mx-auto py-6 sm:py-8 px-4 sm:px-6 pb-24 md:pb-8",children:[f&&!n&&y.jsxs("div",{className:"flex flex-col items-center justify-center text-center p-8 space-y-4",children:[y.jsx(hn,{}),y.jsx("p",{className:"text-ui-text-secondary dark:text-slate-400 font-semibold",children:qe(E==="grocery"?"scanningLabel":"analyzing")})]}),!f&&_&&y.jsxs("div",{className:"p-4 bg-red-100 dark:bg-red-900/40 text-red-700 dark:text-red-200 rounded-lg text-center",children:[y.jsxs("p",{children:[y.jsx("span",{className:"font-bold",children:"Error:"})," ",_]}),y.jsx("button",{onClick:Un,className:"mt-2 font-semibold underline",children:"Try again"})]}),!_&&et()]}),y.jsxs("footer",{className:"w-full px-4 sm:px-6 flex flex-col items-center justify-center gap-4 text-center border-t border-ui-border dark:border-slate-800 pt-8 pb-24 md:py-8",children:[y.jsx(Q2,{className:"h-auto max-w-[280px] sm:max-w-xs"}),y.jsxs("p",{className:"text-xs text-ui-text-secondary dark:text-slate-400",children:[qe("footerCredit")," ",y.jsx("a",{href:"https://abdm.gov.in/",target:"_blank",rel:"noopener noreferrer",className:"text-brand-primary hover:underline",children:qe("footerAbdm")}),qe("footerAnd"),y.jsx("a",{href:"https://pmjay.gov.in/",target:"_blank",rel:"noopener noreferrer",className:"text-brand-primary hover:underline",children:qe("footerPmjay")})]})]})]}),y.jsx(Az,{navItems:Ft,activeView:E,setView:S}),!I&&y.jsx(wz,{healthChat:st})]})},jS=document.getElementById("root");if(!jS)throw new Error("Could not find root element to mount to");const Nz=lb.createRoot(jS);Nz.render(y.jsx(Vf.StrictMode,{children:y.jsx(qF,{children:y.jsx(kz,{})})}));

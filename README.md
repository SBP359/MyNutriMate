# MyNutriMate AI Health Assistant

This contains everything you need to run your app locally.

## Run Locally

**Prerequisites:** Node.js

1.  **Install dependencies:**
    `npm install`

2.  **Configure Environment Variables**:
    *   **Gemini API Key**: The application is configured to use the `API_KEY` environment variable for the Gemini API. Ensure this is set in your deployment environment.
    *   **Supabase Credentials**: The Supabase URL and anonymous key are also located in env. The anonymous key is safe to be public. You can replace these with your own project's credentials if needed.

3.  **Set up Supabase Database & Storage**:
    *   Log in to your Supabase project dashboard.
    *   Go to the **SQL Editor** section.
    *   Copy and run the entire SQL script provided below to create the necessary tables and policies.
    *   After running the table creation scripts, go to the **Storage** section in your dashboard.
    *   Create a new **private** bucket named exactly `medical-documents`.
    *   Return to the **SQL Editor** and run the storage policies section from the SQL script below (under "Step 4"). This step is crucial for enabling file access.

4.  **Run the app:**
    `npm run dev`

---

## Supabase Setup SQL

Copy and run this entire script in your Supabase SQL Editor.

```sql
-- This script sets up all the required tables and policies for the application.

-- Step 1: Create the grocery list table and its policies.
CREATE TABLE IF NOT EXISTS public.grocery_list_items (
    id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    user_id UUID NOT NULL REFERENCES auth.users(id) ON DELETE CASCADE,
    created_at TIMESTAMPTZ NOT NULL DEFAULT NOW(),
    product_name TEXT NOT NULL,
    brand_name TEXT,
    nutrition_info JSONB,
    health_stars SMALLINT,
    is_purchased BOOLEAN NOT NULL DEFAULT FALSE
);

-- Enable RLS for the new table
ALTER TABLE public.grocery_list_items ENABLE ROW LEVEL SECURITY;

-- Add policies so users can only manage their own grocery items
DROP POLICY IF EXISTS "Users can manage their own grocery list items" ON public.grocery_list_items;
CREATE POLICY "Users can manage their own grocery list items"
ON public.grocery_list_items
FOR ALL
USING (auth.uid() = user_id);


-- Step 2: Add a column to the 'doctor_connections' table for notes and set up RLS.
-- This is safe to run even if the column already exists.
ALTER TABLE public.doctor_connections
ADD COLUMN IF NOT EXISTS doctor_note TEXT;

-- Enable RLS and add policies for doctor_connections table
ALTER TABLE public.doctor_connections ENABLE ROW LEVEL SECURITY;

DROP POLICY IF EXISTS "Doctors can view and update their own patient connections" ON public.doctor_connections;
CREATE POLICY "Doctors can view and update their own patient connections"
ON public.doctor_connections
FOR ALL
USING (auth.uid() = doctor_id)
WITH CHECK (auth.uid() = doctor_id);

DROP POLICY IF EXISTS "Patients can view their own doctor connections" ON public.doctor_connections;
CREATE POLICY "Patients can view their own doctor connections"
ON public.doctor_connections
FOR SELECT
USING (auth.uid() = user_id);


-- Step 3: Create the Storage Bucket MANUALLY.
-- Go to the Storage section in your Supabase dashboard and create a
-- new BUCKET named "medical-documents". Make it a private bucket.
-- You must do this before running step 4.


-- Step 4: Add Row Level Security (RLS) policies to the new storage bucket.
-- These policies ensure that only a patient and their connected doctor can access files.
-- RUN THIS AFTER CREATING THE BUCKET MANUALLY.

-- Policy for Patients to manage their own medical files.
CREATE POLICY "Patients can manage their own medical files"
ON storage.objects FOR ALL
USING (
  bucket_id = 'medical-documents'
  AND auth.uid() = (storage.foldername(name))[1]::uuid
);

-- Policy for connected Doctors to view their patients' files.
CREATE POLICY "Doctors can view their connected patients' files"
ON storage.objects FOR SELECT
USING (
  bucket_id = 'medical-documents'
  AND EXISTS (
    SELECT 1
    FROM public.doctor_connections dc
    WHERE dc.user_id = (storage.foldername(name))[1]::uuid
    AND dc.doctor_id = auth.uid()
  )
);
```
## Gallery
![Gallery 1](https://raw.githubusercontent.com/SBP359/SBP359/main/nutrimate/gallery.jpg)
![Gallery 2](https://raw.githubusercontent.com/SBP359/SBP359/main/nutrimate/gallery%20(1).jpg)
![Gallery 3](https://raw.githubusercontent.com/SBP359/SBP359/main/nutrimate/gallery%20(2).jpg)
![Gallery 4](https://raw.githubusercontent.com/SBP359/SBP359/main/nutrimate/gallery%20(3).jpg)
![Gallery 5](https://raw.githubusercontent.com/SBP359/SBP359/main/nutrimate/gallery%20(4).jpg)
![Gallery 6](https://raw.githubusercontent.com/SBP359/SBP359/main/nutrimate/gallery%20(5).jpg)


![Logo](https://github.com/SBP359/SBP359/blob/b26bb10b6fc4ab6ab842affc5dfec1cc7e17bf78/nutrimate/bannerdark.png)
for screenshots go to !(https://github.com/SBP359/SBP359/tree/main/nutrimate)
